var at=Object.defineProperty;var rt=(s,t,a)=>t in s?at(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var L=(s,t,a)=>rt(s,typeof t!="symbol"?t+"":t,a);import{r as i,a as nt,R as pe,g as it}from"./vendor-DJ1oPbzn.js";import{M as Re,P as Te,l as Ie,a as lt,b as ot,T as ct,u as dt}from"./maps-DYzuhxqw.js";import{m as D,A as P}from"./ui-Bb994duZ.js";import{R as mt,L as xt,C as ut,X as ht,Y as gt,T as pt,a as ft,b as vt}from"./charts-WATkrfCP.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=a(n);fetch(n.href,l)}})();var Oe={exports:{}},de={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yt=i,bt=Symbol.for("react.element"),jt=Symbol.for("react.fragment"),wt=Object.prototype.hasOwnProperty,Nt=yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kt={key:!0,ref:!0,__self:!0,__source:!0};function Fe(s,t,a){var r,n={},l=null,o=null;a!==void 0&&(l=""+a),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)wt.call(t,r)&&!kt.hasOwnProperty(r)&&(n[r]=t[r]);if(s&&s.defaultProps)for(r in t=s.defaultProps,t)n[r]===void 0&&(n[r]=t[r]);return{$$typeof:bt,type:s,key:l,ref:o,props:n,_owner:Nt.current}}de.Fragment=jt;de.jsx=Fe;de.jsxs=Fe;Oe.exports=de;var e=Oe.exports,he={},we=nt;he.createRoot=we.createRoot,he.hydrateRoot=we.hydrateRoot;function St({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"}))}const Pe=i.forwardRef(St);function Ct({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const Mt=i.forwardRef(Ct);function Dt({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const G=i.forwardRef(Dt);function $t({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const We=i.forwardRef($t);function At({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}const _e=i.forwardRef(At);function Et({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 10.5h.375c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125H21M3.75 18h15A2.25 2.25 0 0 0 21 15.75v-6a2.25 2.25 0 0 0-2.25-2.25h-15A2.25 2.25 0 0 0 1.5 9.75v6A2.25 2.25 0 0 0 3.75 18Z"}))}const se=i.forwardRef(Et);function Lt({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const Rt=i.forwardRef(Lt);function Tt({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.412 15.655 9.75 21.75l3.745-4.012M9.257 13.5H3.75l2.659-2.849m2.048-2.194L14.25 2.25 12 10.5h8.25l-4.707 5.043M8.457 8.457 3 3m5.457 5.457 7.086 7.086m0 0L21 21"}))}const It=i.forwardRef(Tt);function Ot({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))}const z=i.forwardRef(Ot);function Ft({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const Be=i.forwardRef(Ft);function Pt({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const I=i.forwardRef(Pt);function Wt({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const Ue=i.forwardRef(Wt);function _t({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const Bt=i.forwardRef(_t);function Ut({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const Qt=i.forwardRef(Ut);function qt({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}const zt=i.forwardRef(qt);function Vt({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const Ht=i.forwardRef(Vt);function Zt({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const U=i.forwardRef(Zt);function Gt({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const Jt=i.forwardRef(Gt);function Yt({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077 1.41-.513m14.095-5.13 1.41-.513M5.106 17.785l1.15-.964m11.49-9.642 1.149-.964M7.501 19.795l.75-1.3m7.5-12.99.75-1.3m-6.063 16.658.26-1.477m2.605-14.772.26-1.477m0 17.726-.26-1.477M10.698 4.614l-.26-1.477M16.5 19.794l-.75-1.299M7.5 4.205 12 12m6.894 5.785-1.149-.964M6.256 7.178l-1.15-.964m15.352 8.864-1.41-.513M4.954 9.435l-1.41-.514M12.002 12l-3.75 6.495"}))}const Kt=i.forwardRef(Yt);function Xt({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 0 0 2.25-2.25V6.75a2.25 2.25 0 0 0-2.25-2.25H6.75A2.25 2.25 0 0 0 4.5 6.75v10.5a2.25 2.25 0 0 0 2.25 2.25Zm.75-12h9v9h-9v-9Z"}))}const Ne=i.forwardRef(Xt);function es({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const R=i.forwardRef(es);function ts({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const fe=i.forwardRef(ts);function ss({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.362 5.214A8.252 8.252 0 0 1 12 21 8.25 8.25 0 0 1 6.038 7.047 8.287 8.287 0 0 0 9 9.601a8.983 8.983 0 0 1 3.361-6.867 8.21 8.21 0 0 0 3 2.48Z"}),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18a3.75 3.75 0 0 0 .495-7.468 5.99 5.99 0 0 0-1.925 3.547 5.975 5.975 0 0 1-2.133-1.001A3.75 3.75 0 0 0 12 18Z"}))}const ve=i.forwardRef(ss);function as({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const rs=i.forwardRef(as);function ns({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"}))}const is=i.forwardRef(ns);function ls({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const ke=i.forwardRef(ls);function os({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const Se=i.forwardRef(os);function cs({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const ae=i.forwardRef(cs);function ds({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const ye=i.forwardRef(ds);function ms({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const Qe=i.forwardRef(ms);function xs({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))}const oe=i.forwardRef(xs);function us({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const re=i.forwardRef(us);function hs({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z"}))}const le=i.forwardRef(hs);function gs({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}))}const V=i.forwardRef(gs);function ps({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const te=i.forwardRef(ps);function fs({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m0-10.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.25-8.25-3.286Zm0 13.036h.008v.008H12v-.008Z"}))}const X=i.forwardRef(fs);function vs({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3 3 8.735 8.735m0 0a.374.374 0 1 1 .53.53m-.53-.53.53.53m0 0L21 21M14.652 9.348a3.75 3.75 0 0 1 0 5.304m2.121-7.425a6.75 6.75 0 0 1 0 9.546m2.121-11.667c3.808 3.807 3.808 9.98 0 13.788m-9.546-4.242a3.733 3.733 0 0 1-1.06-2.122m-1.061 4.243a6.75 6.75 0 0 1-1.625-6.929m-.496 9.05c-3.068-3.067-3.664-7.67-1.79-11.334M12 12h.008v.008H12V12Z"}))}const ys=i.forwardRef(vs);function bs({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.348 14.652a3.75 3.75 0 0 1 0-5.304m5.304 0a3.75 3.75 0 0 1 0 5.304m-7.425 2.121a6.75 6.75 0 0 1 0-9.546m9.546 0a6.75 6.75 0 0 1 0 9.546M5.106 18.894c-3.808-3.807-3.808-9.98 0-13.788m13.788 0c3.808 3.807 3.808 9.98 0 13.788M12 12h.008v.008H12V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const be=i.forwardRef(bs);function js({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"}))}const qe=i.forwardRef(js);function ws({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const ze=i.forwardRef(ws);function Ns({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const ee=i.forwardRef(Ns);function ks({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z"}))}const je=i.forwardRef(ks);function Ss({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17 17.25 21A2.652 2.652 0 0 0 21 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 1 1-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 0 0 4.486-6.336l-3.276 3.277a3.004 3.004 0 0 1-2.25-2.25l3.276-3.276a4.5 4.5 0 0 0-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437 1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008Z"}))}const Ce=i.forwardRef(Ss);function Cs({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Q=i.forwardRef(Cs);function Ms({title:s,titleId:t,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?i.createElement("title",{id:t},s):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const H=i.forwardRef(Ms),Ds=({drone:s,isSelected:t,onSelect:a,getBatteryColor:r,getStatusColor:n})=>{const l=()=>{const p=n(s.status),h=r(s.batteryLevel),g=s.batteryLevel<30;return Ie.divIcon({html:`
        <div class="relative">
          <!-- Pulse animation for selected drone -->
          ${t?`
            <div class="absolute inset-0 animate-ping">
              <div class="w-6 h-6 bg-blue-400 rounded-full opacity-30"></div>
            </div>
          `:""}
          
          <!-- Low battery warning pulse -->
          ${g?`
            <div class="absolute inset-0 animate-pulse">
              <div class="w-6 h-6 bg-red-400 rounded-full opacity-40"></div>
            </div>
          `:""}
          
          <!-- Main drone icon -->
          <div class="relative w-6 h-6 rounded-full border-2 flex items-center justify-center transform transition-transform hover:scale-110"
               style="background-color: #161b22; border-color: ${p}">
            <!-- Drone symbol -->
            <svg class="w-3 h-3" style="color: ${p}" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2l3.5 3.5h-7L12 2zM5.5 8.5L2 12l3.5 3.5V8.5zM18.5 8.5v7L22 12l-3.5-3.5zM8.5 18.5L12 22l3.5-3.5h-7z"/>
              <circle cx="12" cy="12" r="2"/>
            </svg>
          </div>
          
          <!-- Battery indicator -->
          <div class="absolute -bottom-1 -right-1 w-3 h-1.5 rounded-sm border"
               style="background-color: ${h}; border-color: #30363d">
          </div>
          
          <!-- Status indicator dot -->
          <div class="absolute -top-1 -right-1 w-2 h-2 rounded-full"
               style="background-color: ${p}">
          </div>
        </div>
      `,className:"drone-marker",iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]})},o=p=>{const h=new Date(p),f=new Date().getTime()-h.getTime(),x=Math.floor(f/1e3);return x<60?`${x}s ago`:x<3600?`${Math.floor(x/60)}m ago`:`${Math.floor(x/3600)}h ago`},u=(p=>p>-50?{level:"Excellent",color:"#238636"}:p>-70?{level:"Good",color:"#d29922"}:p>-90?{level:"Poor",color:"#da3633"}:{level:"Very Poor",color:"#f85149"})(s.signalStrength);return!s.position.lat||!s.position.lng?null:e.jsx(Re,{position:[s.position.lat,s.position.lng],icon:l(),eventHandlers:{click:a},children:e.jsx(Te,{className:"drone-popup",maxWidth:320,minWidth:280,children:e.jsxs("div",{className:"bg-dark-secondary text-text-primary p-4 rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.name}),e.jsx("p",{className:"text-text-secondary text-sm",children:s.id})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium",style:{backgroundColor:n(s.status)+"20",color:n(s.status)},children:s.status.toUpperCase()})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(se,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Battery"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-dark-border rounded-full h-1.5",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-300",style:{width:`${s.batteryLevel}%`,backgroundColor:r(s.batteryLevel)}})}),e.jsxs("span",{className:"text-sm font-mono",children:[s.batteryLevel,"%"]})]})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(be,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Signal"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs",style:{color:u.color},children:u.level}),e.jsxs("span",{className:"text-sm font-mono text-text-secondary",children:[s.signalStrength,"dBm"]})]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Altitude"}),e.jsxs("span",{className:"font-mono",children:[s.position.alt.toFixed(1),"m"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Speed"}),e.jsxs("span",{className:"font-mono",children:[s.speed.toFixed(1)," m/s"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Heading"}),e.jsxs("span",{className:"font-mono",children:[s.heading.toFixed(0),"Â°"]})]})]}),s.currentMission&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-status-active"}),e.jsx("span",{className:"text-sm font-medium",children:"Active Mission"})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Mission"}),e.jsx("span",{children:s.currentMission.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Progress"}),e.jsxs("span",{children:[s.currentMission.progress,"%"]})]}),s.currentMission.eta&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"ETA"}),e.jsx("span",{children:s.currentMission.eta})]})]})]}),s.alerts&&s.alerts.length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(R,{className:"w-4 h-4 text-status-warning"}),e.jsxs("span",{className:"text-sm font-medium text-status-warning",children:[s.alerts.length," Alert",s.alerts.length>1?"s":""]})]}),e.jsxs("div",{className:"space-y-1",children:[s.alerts.slice(0,2).map((p,h)=>e.jsx("div",{className:"text-xs p-2 bg-dark-primary rounded border-l-2",style:{borderLeftColor:p.severity==="critical"?"#da3633":"#d29922"},children:p.message},h)),s.alerts.length>2&&e.jsxs("p",{className:"text-xs text-text-secondary",children:["+",s.alerts.length-2," more alerts"]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-border text-xs text-text-muted",children:["Last updated: ",o(s.lastUpdate)]})]})})})},$s=({mission:s})=>{const t=o=>{switch(o.toLowerCase()){case"active":case"in_progress":return"#1f6feb";case"completed":return"#238636";case"failed":case"cancelled":return"#da3633";case"pending":default:return"#8b949e"}},a=(o,c)=>{const u=o.completed||c<(s.currentWaypoint||0),p=c===(s.currentWaypoint||0);return Ie.divIcon({html:`
        <div class="relative">
          <div class="w-4 h-4 rounded-full border-2 flex items-center justify-center text-xs font-bold"
               style="background-color: ${u?"#238636":p?"#1f6feb":"#161b22"}; 
                      border-color: ${u?"#238636":p?"#1f6feb":"#8b949e"};
                      color: #f0f6fc">
            ${c+1}
          </div>
          ${p?`
            <div class="absolute inset-0 animate-ping">
              <div class="w-4 h-4 bg-blue-400 rounded-full opacity-30"></div>
            </div>
          `:""}
        </div>
      `,className:"waypoint-marker",iconSize:[16,16],iconAnchor:[8,8],popupAnchor:[0,-8]})},r=o=>{switch(o.toLowerCase()){case"pickup":return"ðŸ“¦";case"delivery":return"ðŸšš";case"hover":return"â¸ï¸";case"survey":return"ðŸ“·";default:return"ðŸ“"}};if(!s.waypoints||s.waypoints.length===0)return null;const n=s.waypoints.filter(o=>o.position.lat&&o.position.lng).map(o=>[o.position.lat,o.position.lng]);if(n.length===0)return null;const l=t(s.status);return e.jsxs(e.Fragment,{children:[e.jsx(lt,{positions:n,pathOptions:{color:l,weight:3,opacity:.8,dashArray:s.status==="pending"?"10, 5":void 0}}),s.waypoints.map((o,c)=>!o.position.lat||!o.position.lng?null:e.jsx(Re,{position:[o.position.lat,o.position.lng],icon:a(o,c),children:e.jsx(Te,{className:"waypoint-popup",maxWidth:250,children:e.jsxs("div",{className:"bg-dark-secondary text-text-primary p-3 rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-semibold",children:["Waypoint ",c+1]}),e.jsx("span",{className:"text-lg",children:r(o.action)})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Action"}),e.jsx("span",{className:"capitalize",children:o.action})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Altitude"}),e.jsxs("span",{className:"font-mono",children:[o.position.alt,"m"]})]}),o.hoverTime&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Hover Time"}),e.jsxs("span",{className:"font-mono",children:[o.hoverTime,"s"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Status"}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${o.completed||c<(s.currentWaypoint||0)?"bg-green-900/30 text-green-400":c===(s.currentWaypoint||0)?"bg-blue-900/30 text-blue-400":"bg-gray-900/30 text-gray-400"}`,children:o.completed||c<(s.currentWaypoint||0)?"Completed":c===(s.currentWaypoint||0)?"Current":"Pending"})]})]}),o.notes&&e.jsx("div",{className:"mt-2 pt-2 border-t border-dark-border",children:e.jsx("p",{className:"text-xs text-text-secondary",children:o.notes})})]})})},`${s.id}-wp-${c}`))]})},As=()=>{const s=dt();return i.useEffect(()=>{const t=setTimeout(()=>{s.invalidateSize()},100);return()=>clearTimeout(t)},[s]),null},Es=({drones:s,missions:t=[],selectedDroneId:a,onDroneSelect:r,className:n=""})=>{const[l,o]=i.useState([37.7749,-122.4194]),[c,u]=i.useState(12),p=i.useRef(null);i.useEffect(()=>{if(s.length>0){const f=s.filter(x=>x.position.lat&&x.position.lng);if(f.length>0){const x=f.reduce((y,d)=>y+d.position.lat,0)/f.length,k=f.reduce((y,d)=>y+d.position.lng,0)/f.length;o([x,k])}}},[s]),i.useEffect(()=>{const f=new ResizeObserver(()=>{setTimeout(()=>{window.dispatchEvent(new Event("resize"))},100)});return p.current&&f.observe(p.current),()=>{f.disconnect()}},[]);const h=f=>f>70?"#238636":f>30?"#d29922":f>15?"#da3633":"#f85149",g=f=>{switch(f.toLowerCase()){case"active":case"in_flight":return"#238636";case"charging":case"returning":return"#d29922";case"maintenance":case"emergency":return"#da3633";case"idle":default:return"#8b949e"}};return e.jsxs("div",{ref:p,className:`fleet-map-container relative h-full w-full bg-dark-primary rounded-lg overflow-hidden border border-dark-border ${n}`,children:[e.jsxs(D.div,{className:"absolute top-4 left-4 z-[1000] bg-dark-secondary/90 backdrop-blur-sm rounded-lg p-3 shadow-lg border border-dark-border",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsx("h3",{className:"text-text-primary font-semibold mb-2",children:"Fleet Overview"}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-status-operational"}),e.jsxs("span",{className:"text-text-secondary",children:[s.filter(f=>f.status==="active"||f.status==="in_flight").length," Active"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-status-warning"}),e.jsxs("span",{className:"text-text-secondary",children:[s.filter(f=>f.status==="charging"||f.status==="idle").length," Standby"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-status-critical"}),e.jsxs("span",{className:"text-text-secondary",children:[s.filter(f=>f.status==="maintenance"||f.status==="emergency").length," Issues"]})]})]})]}),e.jsx(D.div,{className:"absolute top-4 right-4 z-[1000] bg-dark-secondary/90 backdrop-blur-sm rounded-lg p-2 shadow-lg border border-dark-border",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{className:"px-3 py-1 text-xs bg-dark-tertiary hover:bg-dark-hover text-text-primary rounded border border-dark-border transition-colors",onClick:()=>u(Math.min(c+1,18)),children:"Zoom In"}),e.jsx("button",{className:"px-3 py-1 text-xs bg-dark-tertiary hover:bg-dark-hover text-text-primary rounded border border-dark-border transition-colors",onClick:()=>u(Math.max(c-1,1)),children:"Zoom Out"}),e.jsx("button",{className:"px-3 py-1 text-xs bg-dark-tertiary hover:bg-dark-hover text-text-primary rounded border border-dark-border transition-colors",onClick:()=>{if(s.length>0){const f=s.filter(x=>x.position.lat&&x.position.lng);if(f.length>0){const x=f.reduce((y,d)=>y+d.position.lat,0)/f.length,k=f.reduce((y,d)=>y+d.position.lng,0)/f.length;o([x,k]),u(12)}}},children:"Center Fleet"})]})}),e.jsx("div",{className:"absolute inset-0 w-full h-full",children:e.jsxs(ot,{center:l,zoom:c,style:{height:"100%",width:"100%",minHeight:"400px"},zoomControl:!1,attributionControl:!1,className:"leaflet-container bg-dark-primary",children:[e.jsx(As,{}),e.jsx(ct,{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors Â© <a href="https://carto.com/attributions">CARTO</a>'}),t.map(f=>e.jsx($s,{mission:f},f.id)),s.map(f=>e.jsx(Ds,{drone:f,isSelected:f.id===a,onSelect:()=>r(f.id),getBatteryColor:h,getStatusColor:g},f.id))]})}),e.jsxs(D.div,{className:"absolute bottom-4 left-4 z-[1000] bg-dark-secondary/90 backdrop-blur-sm rounded-lg p-3 shadow-lg border border-dark-border",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[e.jsx("h4",{className:"text-text-primary font-medium text-sm mb-2",children:"Legend"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-status-operational border border-dark-border"}),e.jsx("span",{className:"text-text-secondary",children:"Active Drone"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-status-warning border border-dark-border"}),e.jsx("span",{className:"text-text-secondary",children:"Standby/Charging"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-status-critical border border-dark-border"}),e.jsx("span",{className:"text-text-secondary",children:"Issue/Maintenance"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-0.5 bg-status-active"}),e.jsx("span",{className:"text-text-secondary",children:"Mission Path"})]})]})]})]})},Ve=({level:s,voltage:t,size:a="md",showLabel:r=!1,showVoltage:n=!1,className:l=""})=>{const o=x=>x>70?"#238636":x>30?"#d29922":x>15?"#da3633":"#f85149",c=()=>{switch(a){case"sm":return"w-12";case"lg":return"w-20";default:return"w-16"}},u=()=>{switch(a){case"sm":return"h-6";case"lg":return"h-10";default:return"h-8"}},p=()=>{switch(a){case"sm":return"text-xs";case"lg":return"text-base";default:return"text-sm"}},h=o(s),g=s<30,f=s<15;return e.jsxs("div",{className:`flex items-center gap-2 ${l}`,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:`${c()} ${u()} border-2 rounded-sm relative overflow-hidden`,style:{borderColor:h},children:[e.jsx(D.div,{className:"h-full rounded-sm",style:{backgroundColor:h},initial:{width:0},animate:{width:`${Math.max(s,0)}%`},transition:{duration:.5,ease:"easeOut"}}),f&&e.jsx(D.div,{className:"absolute inset-0 bg-red-500",animate:{opacity:[.3,.7,.3]},transition:{duration:1,repeat:1/0}})]}),e.jsx("div",{className:`absolute -right-1 top-1/2 transform -translate-y-1/2 w-1 bg-current rounded-r-sm ${a==="sm"?"h-2":a==="lg"?"h-4":"h-3"}`,style:{color:h}}),g&&e.jsx("div",{className:"absolute -top-1 -right-1",children:e.jsx(z,{className:`${a==="sm"?"w-3 h-3":"w-4 h-4"} text-red-500`})})]}),r&&e.jsxs("span",{className:`font-mono font-semibold ${p()}`,style:{color:h},children:[s.toFixed(0),"%"]})]}),n&&t&&e.jsx("div",{className:`text-text-secondary ${p()}`,children:e.jsxs("span",{className:"font-mono",children:[t.toFixed(1),"V"]})}),r&&a!=="sm"&&e.jsx("div",{className:`${p()} text-text-secondary`,children:f?"Critical":g?"Low":s>80?"Excellent":"Good"})]})},Ls=({drone:s,isSelected:t,onSelect:a,onAction:r,index:n})=>{var h,g,f,x,k,y,d;const l=b=>{switch(b.toLowerCase()){case"active":case"in_flight":return{color:"#238636",bgColor:"#238636",label:"Active",icon:I};case"charging":return{color:"#d29922",bgColor:"#d29922",label:"Charging",icon:se};case"maintenance":return{color:"#da3633",bgColor:"#da3633",label:"Maintenance",icon:R};case"emergency":return{color:"#f85149",bgColor:"#f85149",label:"Emergency",icon:X};case"idle":default:return{color:"#8b949e",bgColor:"#8b949e",label:"Idle",icon:U}}},o=b=>{const m=new Date(b),j=new Date().getTime()-m.getTime(),v=Math.floor(j/1e3);return v<60?`${v}s ago`:v<3600?`${Math.floor(v/60)}m ago`:`${Math.floor(v/3600)}h ago`},c=l(s.status),u=c.icon,p=(b,m)=>{m.stopPropagation(),a()};return e.jsxs(D.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,delay:n*.05},onClick:a,className:`
        relative bg-dark-tertiary rounded-lg p-3 border cursor-pointer transition-all duration-200 hover:bg-dark-hover w-full
        ${t?"border-status-active shadow-glow":"border-dark-border hover:border-dark-hover"}
      `,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxs("div",{className:"flex-shrink-0 relative",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center border",style:{backgroundColor:c.bgColor+"20",borderColor:c.color},children:e.jsx(u,{className:"w-4 h-4",style:{color:c.color}})}),s.alerts&&s.alerts.length>0&&e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-status-warning rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-white text-[10px]",children:s.alerts.length})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-text-primary text-sm truncate",children:s.name}),e.jsx("span",{className:"text-text-secondary text-xs font-mono",children:s.id})]}),e.jsx("div",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium mt-1",style:{backgroundColor:c.color+"20",color:c.color},children:c.label})]})]}),e.jsx("button",{onClick:b=>p("view",b),className:"p-1.5 rounded hover:bg-dark-secondary transition-colors flex-shrink-0",title:"View Details",style:{color:"#1f6feb"},children:e.jsx(fe,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-text-secondary text-xs",children:"Battery"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-16",children:e.jsx(Ve,{level:s.batteryLevel,voltage:s.batteryVoltage,inFlight:["active","in_flight"].includes(s.status),status:s.status,size:"sm",showVoltage:!1})}),e.jsxs("span",{className:"text-xs text-text-primary font-mono",children:[Math.round(s.batteryLevel),"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-text-secondary text-xs",children:"Signal"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-end gap-0.5",children:[0,1,2,3].map(b=>e.jsx("div",{className:`w-0.5 rounded-sm ${b===0?"h-2":b===1?"h-3":"h-4"}`,style:{backgroundColor:s.signalStrength>-50-b*20?"#238636":"#30363d"}},b))}),e.jsxs("span",{className:"text-xs font-mono text-text-secondary truncate",children:[Math.round(s.signalStrength),"dBm"]})]})]}),s.emergencyState&&!s.emergencyState.resolved&&e.jsxs("div",{className:"flex items-center justify-between bg-red-900/20 border border-red-500/30 rounded p-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-3 h-3 text-red-400 flex-shrink-0"}),e.jsx("span",{className:"text-xs font-medium text-red-400",children:"EMERGENCY"})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{className:"text-xs text-red-300 truncate max-w-20",title:s.emergencyState.description,children:s.emergencyState.type.replace("_"," ").toUpperCase()})})]}),((h=s.alerts)==null?void 0:h.some(b=>b.category==="coordination"))&&e.jsxs("div",{className:"flex items-center justify-between bg-blue-900/20 border border-blue-500/30 rounded p-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-3 h-3 text-blue-400 flex-shrink-0"}),e.jsx("span",{className:"text-xs font-medium text-blue-400",children:"COORDINATION"})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{className:"text-xs text-blue-300 truncate max-w-24",children:(g=s.alerts.find(b=>b.category==="coordination"))!=null&&g.message.includes("avoidance")?"MANEUVER":"WARNING"})})]}),((f=s.alerts)==null?void 0:f.some(b=>b.category==="charging"))&&e.jsxs("div",{className:"flex items-center justify-between bg-yellow-900/20 border border-yellow-500/30 rounded p-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.status==="charging"?e.jsx(se,{className:"w-3 h-3 text-yellow-400 flex-shrink-0"}):e.jsx(le,{className:"w-3 h-3 text-yellow-400 flex-shrink-0"}),e.jsx("span",{className:"text-xs font-medium text-yellow-400",children:s.status==="charging"?"CHARGING":"QUEUED"})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{className:"text-xs text-yellow-300 truncate max-w-24",children:s.status==="charging"?((k=(x=s.alerts.find(b=>b.category==="charging"))==null?void 0:x.message.match(/\d+min/))==null?void 0:k[0])||"ACTIVE":`POS ${((d=(y=s.alerts.find(b=>b.category==="charging"))==null?void 0:y.message.match(/position (\d+)/))==null?void 0:d[1])||"?"}`})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-text-secondary text-xs",children:s.currentMission?"Mission":"Altitude"}),s.currentMission?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-status-active rounded-full"}),e.jsxs("span",{className:"text-xs text-text-primary font-medium",children:[Math.round(s.currentMission.progress),"%"]})]}):e.jsxs("span",{className:"text-xs text-text-primary font-mono",children:[Math.round(s.position.alt),"m"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2 pt-2 border-t border-dark-border text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsxs("span",{className:"text-text-secondary whitespace-nowrap",children:[Math.round(s.speed*10)/10,"m/s"]}),s.alerts&&s.alerts.length>0&&e.jsxs("span",{className:"text-status-warning whitespace-nowrap",children:[s.alerts.length," alerts"]})]}),e.jsx("span",{className:"text-text-muted text-right whitespace-nowrap flex-shrink-0",children:o(s.lastUpdate)})]})]})},Rs=({stats:s})=>{const t=r=>r>70?"#238636":r>30?"#d29922":"#da3633",a=[{label:"Total Drones",value:s.total,color:"#8b949e",icon:null},{label:"Active",value:s.active,color:"#238636",icon:I},{label:"Avg Battery",value:`${s.avgBattery.toFixed(0)}%`,color:t(s.avgBattery),icon:se},{label:"Alerts",value:s.alerts,color:s.alerts>0?"#d29922":"#8b949e",icon:R,highlight:s.alerts>0}];return e.jsx("div",{className:"grid grid-cols-4 gap-4",children:a.map((r,n)=>e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:n*.1},className:`text-center p-3 rounded-lg ${r.highlight?"bg-dark-tertiary border border-status-warning/30":"bg-dark-tertiary"}`,children:[r.icon&&e.jsx("div",{className:"flex justify-center mb-1",children:e.jsx(r.icon,{className:"w-4 h-4",style:{color:r.color}})}),e.jsx("div",{className:"text-xl font-bold",style:{color:r.color},children:r.value}),e.jsx("div",{className:"text-xs text-text-secondary",children:r.label})]},r.label))})},Ts=({drones:s,selectedDroneId:t,onDroneSelect:a,onDroneAction:r,className:n=""})=>{const[l,o]=i.useState("all"),[c,u]=i.useState("status"),p={total:s.length,active:s.filter(x=>x.status==="active"||x.status==="in_flight").length,charging:s.filter(x=>x.status==="charging").length,maintenance:s.filter(x=>x.status==="maintenance"||x.status==="emergency").length,idle:s.filter(x=>x.status==="idle").length,lowBattery:s.filter(x=>x.batteryLevel<30).length,alerts:s.reduce((x,k)=>{var y;return x+(((y=k.alerts)==null?void 0:y.length)||0)},0),avgBattery:s.length>0?s.reduce((x,k)=>x+k.batteryLevel,0)/s.length:0},h=s.filter(x=>{switch(l){case"active":return x.status==="active"||x.status==="in_flight";case"issues":return x.status==="maintenance"||x.status==="emergency"||x.alerts&&x.alerts.length>0;case"idle":return x.status==="idle"||x.status==="charging";default:return!0}}).sort((x,k)=>{switch(c){case"name":return x.name.localeCompare(k.name);case"battery":return k.batteryLevel-x.batteryLevel;case"status":const y={emergency:0,maintenance:1,active:2,in_flight:2,charging:3,idle:4};return(y[x.status]||5)-(y[k.status]||5);case"lastUpdate":return new Date(k.lastUpdate).getTime()-new Date(x.lastUpdate).getTime();default:return 0}}),g=[{value:"all",label:`All (${p.total})`,count:p.total},{value:"active",label:`Active (${p.active})`,count:p.active},{value:"issues",label:`Issues (${p.maintenance})`,count:p.maintenance},{value:"idle",label:`Idle (${p.idle+p.charging})`,count:p.idle+p.charging}],f=[{id:"1",type:"mission_complete",drone:"DRN001",message:"Delivery mission completed successfully",timestamp:new Date(Date.now()-3e5)},{id:"2",type:"battery_low",drone:"DRN003",message:"Battery level below 25%",timestamp:new Date(Date.now()-6e5)},{id:"3",type:"charging_start",drone:"DRN002",message:"Started charging at Station Alpha",timestamp:new Date(Date.now()-9e5)},{id:"4",type:"mission_start",drone:"DRN004",message:"Started emergency medical delivery",timestamp:new Date(Date.now()-12e5)},{id:"5",type:"maintenance",drone:"DRN005",message:"Scheduled maintenance completed",timestamp:new Date(Date.now()-18e5)}];return e.jsxs("div",{className:`h-full flex flex-col ${n}`,children:[e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsx(Rs,{stats:p})}),e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"grid grid-cols-2 gap-1",children:g.map(x=>e.jsx("button",{onClick:()=>o(x.value),className:`px-2 py-1 rounded text-xs font-medium transition-all duration-200 ${l===x.value?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:x.label},x.value))}),e.jsxs("select",{value:c,onChange:x=>u(x.target.value),className:"w-full px-2 py-1 bg-dark-tertiary text-text-primary rounded border border-dark-border text-xs focus:outline-none focus:ring-1 focus:ring-status-active",children:[e.jsx("option",{value:"status",children:"Sort by Status"}),e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"battery",children:"Sort by Battery"}),e.jsx("option",{value:"lastUpdate",children:"Sort by Update"})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin",children:e.jsxs("div",{className:"p-2 space-y-3",children:[e.jsx(P,{mode:"popLayout",children:h.map((x,k)=>e.jsx(Ls,{drone:x,isSelected:x.id===t,onSelect:()=>a(x.id),onAction:r,index:k},x.id))}),h.length===0&&e.jsxs("div",{className:"text-center py-8 text-text-secondary",children:[e.jsx(Q,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No drones match filter"}),e.jsx("button",{onClick:()=>o("all"),className:"mt-2 px-2 py-1 bg-dark-tertiary text-text-primary rounded text-xs hover:bg-dark-hover transition-colors",children:"Show All"})]})]})}),e.jsx("div",{className:"border-t border-dark-border",children:e.jsxs("div",{className:"p-3",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-2",children:"Recent Activity"}),e.jsx("div",{className:"space-y-1",children:f.slice(0,3).map(x=>e.jsxs("div",{className:"text-xs text-text-secondary",children:[e.jsxs("span",{className:"font-medium",children:[x.drone,":"]})," ",x.message]},x.id))})]})})]})},Is=({strength:s,quality:t,size:a="md",showLabel:r=!1,showStrength:n=!1,className:l=""})=>{const o=x=>x>-50?{level:"Excellent",color:"#238636",bars:4}:x>-70?{level:"Good",color:"#d29922",bars:3}:x>-85?{level:"Fair",color:"#d29922",bars:2}:x>-95?{level:"Poor",color:"#da3633",bars:1}:{level:"Very Poor",color:"#f85149",bars:0},c=x=>{switch(a){case"sm":return x===0?"h-2":x===1?"h-3":x===2?"h-4":"h-5";case"lg":return x===0?"h-4":x===1?"h-6":x===2?"h-8":"h-10";default:return x===0?"h-3":x===1?"h-4":x===2?"h-5":"h-6"}},u=()=>{switch(a){case"sm":return"w-0.5";case"lg":return"w-1";default:return"w-0.5"}},p=()=>{switch(a){case"sm":return"text-xs";case"lg":return"text-base";default:return"text-sm"}},h=o(s),f=(t?{excellent:{level:"Excellent",color:"#238636",bars:4},good:{level:"Good",color:"#238636",bars:3},poor:{level:"Poor",color:"#da3633",bars:2},very_poor:{level:"Very Poor",color:"#f85149",bars:1}}[t]:null)||h;return e.jsxs("div",{className:`flex items-center gap-2 ${l}`,children:[e.jsx("div",{className:"flex items-end gap-0.5",children:[0,1,2,3].map(x=>e.jsx(D.div,{className:`${u()} ${c(x)} rounded-sm`,style:{backgroundColor:x<f.bars?f.color:"#30363d"},initial:{scaleY:0},animate:{scaleY:1},transition:{duration:.3,delay:x*.1}},x))}),r&&e.jsx("span",{className:`font-medium ${p()}`,style:{color:f.color},children:f.level}),n&&e.jsx("div",{className:`text-text-secondary ${p()}`,children:e.jsxs("span",{className:"font-mono",children:[s,"dBm"]})}),f.bars===0&&e.jsxs("div",{className:"relative",children:[e.jsx(je,{className:`${a==="sm"?"w-3 h-3":"w-4 h-4"} text-red-500`}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-0.5 h-full bg-red-500 rotate-45"})})]})]})},Os=({data:s})=>{var u;const[t,a]=i.useState("battery"),r=[{id:"battery",label:"Battery Level",color:"#238636",unit:"%",min:0,max:100,criticalLevel:20},{id:"altitude",label:"Altitude",color:"#1f6feb",unit:"m",min:0,max:Math.max(150,Math.max(...s.map(p=>p.altitude||0))+20)},{id:"speed",label:"Ground Speed",color:"#d29922",unit:"m/s",min:0,max:Math.max(20,Math.max(...s.map(p=>p.speed||0))+5)},{id:"signal",label:"Signal Strength",color:"#8957e5",unit:"dBm",min:-100,max:-30,criticalLevel:-90}],n=r.find(p=>p.id===t),l=p=>p.map(h=>({...h,time:new Date(h.timestamp).toLocaleTimeString("en-US",{hour12:!1,minute:"2-digit",second:"2-digit"})})),o=({active:p,payload:h,label:g})=>p&&h&&h.length?e.jsxs("div",{className:"bg-dark-secondary border border-dark-border rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"text-text-secondary text-sm",children:`Time: ${g}`}),e.jsx("p",{className:"text-text-primary font-semibold",children:`${n.label}: ${h[0].value.toFixed(1)}${n.unit}`})]}):null;if(s.length===0)return e.jsxs("div",{className:"text-center text-text-secondary py-8",children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸ“ˆ"}),e.jsx("p",{children:"No telemetry data available"}),e.jsx("p",{className:"text-sm",children:"Charts will appear once data starts flowing"})]});const c=l(s);return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(p=>e.jsx("button",{onClick:()=>a(p.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${t===p.id?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:p.color}}),p.label]})},p.id))}),e.jsxs(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-dark-tertiary rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-text-primary font-semibold",children:[n.label," Over Time"]}),e.jsxs("div",{className:"text-text-secondary text-sm",children:["Last ",c.length," data points"]})]}),e.jsx("div",{className:"h-64",children:e.jsx(mt,{width:"100%",height:"100%",children:e.jsxs(xt,{data:c,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(ut,{strokeDasharray:"3 3",stroke:"#30363d"}),e.jsx(ht,{dataKey:"time",stroke:"#8b949e",fontSize:12,interval:"preserveStartEnd"}),e.jsx(gt,{stroke:"#8b949e",fontSize:12,domain:[n.min,n.max]}),e.jsx(pt,{content:e.jsx(o,{})}),n.criticalLevel!==void 0&&e.jsx(ft,{y:n.criticalLevel,stroke:"#da3633",strokeDasharray:"5 5",label:{value:"Critical",position:"top",fill:"#da3633",fontSize:10}}),e.jsx(vt,{type:"monotone",dataKey:t,stroke:n.color,strokeWidth:2,dot:{fill:n.color,strokeWidth:2,r:3},activeDot:{r:5,stroke:n.color,strokeWidth:2},connectNulls:!1})]})})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Current Value:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-text-primary",children:c.length>0&&((u=c[c.length-1][t])==null?void 0:u.toFixed(1))||"N/A"}),e.jsx("span",{className:"text-text-secondary",children:n.unit})]})]}),c.length>1&&e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:"text-text-secondary",children:"Trend:"}),(()=>{const p=c[c.length-1][t],h=c[c.length-2][t],g=p-h,f=g>0,x=g<0;return e.jsxs("div",{className:`flex items-center gap-1 text-sm ${f?"text-green-400":x?"text-red-400":"text-text-secondary"}`,children:[e.jsx("span",{children:f?"â†—":x?"â†˜":"â†’"}),e.jsxs("span",{children:[Math.abs(g).toFixed(2)," ",n.unit]})]})})()]})]})]},t),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:["min","max","avg","current"].map(p=>{let h,g;const f=c.map(x=>x[t]).filter(x=>x!=null);switch(p){case"min":h=f.length>0?Math.min(...f):0,g="Minimum";break;case"max":h=f.length>0?Math.max(...f):0,g="Maximum";break;case"avg":h=f.length>0?f.reduce((x,k)=>x+k,0)/f.length:0,g="Average";break;case"current":h=f.length>0?f[f.length-1]:0,g="Current";break;default:h=0,g=""}return e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3",children:[e.jsx("div",{className:"text-text-secondary text-sm",children:g}),e.jsx("div",{className:"text-xl font-bold text-text-primary",children:h.toFixed(1)}),e.jsx("div",{className:"text-xs text-text-secondary",children:n.unit})]},p)})})]})},Fs=({alerts:s,droneId:t,onAcknowledge:a,onResolve:r,onDismiss:n})=>{const l=h=>{switch(h){case"critical":return{color:"#f85149",bgColor:"#da3633",icon:Q,label:"Critical"};case"error":return{color:"#da3633",bgColor:"#da3633",icon:Q,label:"Error"};case"warning":return{color:"#d29922",bgColor:"#d29922",icon:R,label:"Warning"};case"info":return{color:"#1f6feb",bgColor:"#1f6feb",icon:ke,label:"Info"};default:return{color:"#8b949e",bgColor:"#8b949e",icon:ke,label:"Unknown"}}},o=h=>{const g=new Date(h),x=new Date().getTime()-g.getTime(),k=Math.floor(x/1e3),y=Math.floor(k/60),d=Math.floor(y/60);return k<60?`${k}s ago`:y<60?`${y}m ago`:d<24?`${d}h ago`:g.toLocaleDateString()},{activeAlerts:c,resolvedAlerts:u}=i.useMemo(()=>{const h=[...s].sort((g,f)=>{const x={critical:4,error:3,warning:2,info:1},k=(x[f.severity]||0)-(x[g.severity]||0);return k!==0?k:new Date(f.timestamp).getTime()-new Date(g.timestamp).getTime()});return{activeAlerts:h.filter(g=>!g.resolved),resolvedAlerts:h.filter(g=>g.resolved)}},[s]);if(s.length===0)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx(I,{className:"w-12 h-12 mx-auto text-status-operational mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"No Active Alerts"}),e.jsx("p",{className:"text-text-secondary",children:"All systems are operating normally"})]});const p=pe.memo(({alert:h,index:g})=>{const f=l(h.severity),x=f.icon;return e.jsx(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2,delay:Math.min(g*.05,.3)},className:`bg-dark-tertiary rounded-lg border-l-4 p-4 ${h.acknowledged?"opacity-75":""} ${h.resolved?"opacity-50":""}`,style:{borderLeftColor:f.color},children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx(x,{className:"w-5 h-5",style:{color:f.color}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium",style:{backgroundColor:f.bgColor+"20",color:f.color},children:f.label}),h.category&&e.jsx("span",{className:"px-2 py-1 bg-dark-border text-text-secondary rounded text-xs",children:h.category}),h.acknowledged&&e.jsx("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-400 rounded text-xs",children:"Acknowledged"}),h.resolved&&e.jsx("span",{className:"px-2 py-1 bg-green-900/30 text-green-400 rounded text-xs",children:"Resolved"})]}),e.jsx("p",{className:"text-text-primary text-sm mb-2",children:h.message}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-text-secondary",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"w-3 h-3"}),o(h.timestamp)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"Drone:"}),e.jsx("span",{className:"font-mono",children:t})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[!h.resolved&&!h.acknowledged&&a&&e.jsx("button",{onClick:()=>a(h.id),className:"px-2 py-1 bg-blue-900/30 text-blue-400 hover:bg-blue-900/50 rounded text-xs transition-colors",title:"Acknowledge alert",children:"Ack"}),h.acknowledged&&!h.resolved&&r&&e.jsx("button",{onClick:()=>r(h.id),className:"px-2 py-1 bg-green-900/30 text-green-400 hover:bg-green-900/50 rounded text-xs transition-colors",title:"Mark as resolved",children:"Resolve"}),n&&e.jsx("button",{onClick:()=>n(h.id),className:"p-1 text-text-secondary hover:text-text-primary transition-colors",title:"Dismiss alert",children:e.jsx(H,{className:"w-4 h-4"})})]})]})})});return e.jsxs("div",{className:"space-y-6",children:[c.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["Active Alerts (",c.length,")"]}),c.filter(h=>h.severity==="critical"||h.severity==="error").length>0&&e.jsxs("div",{className:"flex items-center gap-1 text-status-critical text-sm",children:[e.jsx(R,{className:"w-4 h-4"}),"Attention Required"]})]}),e.jsx("div",{className:"space-y-3",children:c.map((h,g)=>e.jsx(p,{alert:h,index:g},h.id))})]}),u.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:["Recent Resolved (",u.length,")"]}),e.jsx("div",{className:"space-y-3",children:u.slice(0,5).map((h,g)=>e.jsx(p,{alert:h,index:g},h.id))}),u.length>5&&e.jsxs("p",{className:"text-text-secondary text-sm mt-3 text-center",children:["+",u.length-5," more resolved alerts"]})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Alert Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Total Alerts"}),e.jsx("div",{className:"text-xl font-bold text-text-primary",children:s.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Active"}),e.jsx("div",{className:"text-xl font-bold text-status-warning",children:c.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Critical"}),e.jsx("div",{className:"text-xl font-bold text-status-critical",children:s.filter(h=>h.severity==="critical"&&!h.resolved).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Resolved"}),e.jsx("div",{className:"text-xl font-bold text-status-operational",children:u.length})]})]})]})]})},Ps=({drone:s,isLive:t=!0,className:a=""})=>{var h;const[r,n]=i.useState("overview"),[l,o]=i.useState([]);if(i.useEffect(()=>{if(s&&t){const g={timestamp:Date.now(),battery:s.batteryLevel,altitude:s.position.alt,speed:s.speed,signalStrength:s.signalStrength};o(f=>[...f,g].slice(-50))}},[s,t]),!s)return e.jsx("div",{className:`h-full w-full flex items-center justify-center ${a}`,children:e.jsxs("div",{className:"text-center text-text-secondary",children:[e.jsx(Ne,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Drone Selected"}),e.jsx("p",{className:"text-sm",children:"Select a drone from the map or fleet list to view telemetry data."})]})});const c=g=>{const f=new Date(g),k=new Date().getTime()-f.getTime(),y=Math.floor(k/1e3);return y<60?`${y}s ago`:y<3600?`${Math.floor(y/60)}m ago`:`${Math.floor(y/3600)}h ago`},u=g=>{switch(g.toLowerCase()){case"active":case"in_flight":return"#238636";case"charging":case"returning":return"#d29922";case"maintenance":case"emergency":return"#da3633";case"idle":default:return"#8b949e"}},p=[{id:"overview",label:"Overview",icon:Ne},{id:"charts",label:"Charts",icon:V},{id:"alerts",label:"Alerts",icon:R,count:((h=s.alerts)==null?void 0:h.length)||0},{id:"system",label:"System",icon:je}];return e.jsxs("div",{className:`h-full w-full flex flex-col overflow-hidden ${a}`,children:[e.jsxs("div",{className:"flex-shrink-0 p-3 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:s.name}),e.jsx("p",{className:"text-text-secondary text-xs",children:s.id})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-status-operational rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Live"})]}),e.jsx("div",{className:"px-2 py-0.5 rounded text-xs font-medium border",style:{backgroundColor:u(s.status)+"20",color:u(s.status),borderColor:u(s.status)+"40"},children:s.status.toUpperCase()})]})]}),e.jsx("div",{className:"flex space-x-0.5",children:p.map(g=>e.jsxs("button",{onClick:()=>n(g.id),className:`px-2 py-1 rounded text-xs font-medium transition-all duration-200 flex items-center gap-1 ${r===g.id?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:[e.jsx(g.icon,{className:"w-3 h-3"}),g.label,g.count!==void 0&&g.count>0&&e.jsx("span",{className:"bg-status-critical text-white text-xs rounded-full px-1 py-0.5 min-w-[14px] text-center",children:g.count})]},g.id))})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto p-3",children:e.jsxs(P,{mode:"wait",children:[r==="overview"&&e.jsxs(D.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(se,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Battery"})]}),e.jsx(Ve,{level:s.batteryLevel,voltage:s.batteryVoltage,showLabel:!0,size:"sm"})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(be,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Signal"})]}),e.jsx(Is,{strength:s.signalStrength,quality:s.connectionQuality,showLabel:!0,size:"sm"})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(ae,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Altitude"})]}),e.jsx("div",{className:"text-lg font-bold text-text-primary",children:s.position.alt.toFixed(1)}),e.jsx("div",{className:"text-xs text-text-secondary",children:"meters"})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(V,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Speed"})]}),e.jsx("div",{className:"text-lg font-bold text-text-primary",children:s.speed.toFixed(1)}),e.jsx("div",{className:"text-xs text-text-secondary",children:"m/s"})]})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-3",children:[e.jsxs("h3",{className:"font-medium text-text-primary mb-2 flex items-center gap-1",children:[e.jsx(is,{className:"w-4 h-4"}),"Position & Orientation"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Latitude"}),e.jsxs("span",{className:"font-mono text-text-primary",children:[s.position.lat.toFixed(6),"Â°"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Longitude"}),e.jsxs("span",{className:"font-mono text-text-primary",children:[s.position.lng.toFixed(6),"Â°"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Heading"}),e.jsxs("span",{className:"font-mono text-text-primary",children:[s.heading.toFixed(1),"Â°"]})]})]})]}),s.currentMission&&e.jsxs("div",{className:"bg-dark-tertiary rounded p-3",children:[e.jsxs("h3",{className:"font-medium text-text-primary mb-2 flex items-center gap-1",children:[e.jsx(I,{className:"w-4 h-4"}),"Current Mission"]}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Mission"}),e.jsx("span",{className:"text-text-primary truncate ml-2",children:s.currentMission.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Progress"}),e.jsxs("span",{className:"text-text-primary",children:[s.currentMission.progress,"%"]})]}),s.currentMission.eta&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"ETA"}),e.jsx("span",{className:"text-text-primary",children:s.currentMission.eta})]}),e.jsx("div",{className:"w-full bg-dark-border rounded-full h-1.5 mt-2",children:e.jsx("div",{className:"bg-status-active h-1.5 rounded-full transition-all duration-300",style:{width:`${s.currentMission.progress}%`}})})]})]})]},"overview"),r==="charts"&&e.jsx(D.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:e.jsx(Os,{data:l,drone:s})},"charts"),r==="alerts"&&e.jsx(D.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:e.jsx(Fs,{alerts:s.alerts||[],droneId:s.id})},"alerts"),r==="system"&&e.jsxs(D.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"space-y-4",children:[e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"System Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Firmware"}),e.jsx("span",{className:"text-text-primary font-mono",children:s.firmware||"v1.12.3"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Hardware"}),e.jsx("span",{className:"text-text-primary",children:s.hardware||"Pixhawk 4"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Uptime"}),e.jsx("span",{className:"text-text-primary",children:s.uptime||"2h 34m"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Last Update"}),e.jsx("span",{className:"text-text-primary",children:c(s.lastUpdate)})]})]})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-text-primary mb-3 flex items-center gap-2",children:[e.jsx(ve,{className:"w-5 h-5"}),"Environmental"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Temperature"}),e.jsxs("div",{className:"font-mono text-text-primary",children:[s.temperature||28.5,"Â°C"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Humidity"}),e.jsxs("div",{className:"font-mono text-text-primary",children:[s.humidity||65,"%"]})]})]})]})]},"system")]})})})]})};var W=(s=>(s.CONNECTING="connecting",s.CONNECTED="connected",s.DISCONNECTED="disconnected",s.RECONNECTING="reconnecting",s.ERROR="error",s))(W||{});const Ws={url:"ws://localhost:3001/telemetry",reconnectInterval:3e3,maxReconnectAttempts:10,heartbeatInterval:3e4,connectionTimeout:1e4};class _s{constructor(t){L(this,"ws",null);L(this,"config");L(this,"connectionState","disconnected");L(this,"reconnectAttempts",0);L(this,"reconnectTimer",null);L(this,"heartbeatTimer",null);L(this,"connectionTimer",null);L(this,"onConnectionStateChange",null);L(this,"onMessage",null);L(this,"onDroneUpdate",null);L(this,"onMissionUpdate",null);L(this,"onFleetAlert",null);L(this,"stats",{messagesReceived:0,messagesProcessed:0,lastMessageTime:null,connectionUptime:null,reconnectCount:0});this.config={...Ws,...t}}connect(){if(this.connectionState==="connected"||this.connectionState==="connecting"){console.warn("WebSocket already connected or connecting");return}this.setConnectionState("connecting"),this.clearTimers();try{this.ws=new WebSocket(this.config.url),this.setupEventHandlers(),this.startConnectionTimeout()}catch(t){console.error("Failed to create WebSocket connection:",t),this.setConnectionState("error",t),this.scheduleReconnect()}}disconnect(){console.log("Disconnecting from telemetry service..."),this.clearTimers(),this.ws&&(this.ws.close(1e3,"Client disconnect"),this.ws=null),this.setConnectionState("disconnected"),this.reconnectAttempts=0}setConnectionStateCallback(t){this.onConnectionStateChange=t}onTelemetryMessage(t){this.onMessage=t}onDroneDataUpdate(t){this.onDroneUpdate=t}onMissionDataUpdate(t){this.onMissionUpdate=t}onFleetAlertReceived(t){this.onFleetAlert=t}getConnectionState(){return this.connectionState}getStatistics(){return{...this.stats,connectionState:this.connectionState,reconnectAttempts:this.reconnectAttempts,uptime:this.stats.connectionUptime?Date.now()-this.stats.connectionUptime.getTime():0}}isConnected(){return this.connectionState==="connected"}setupEventHandlers(){this.ws&&(this.ws.onopen=()=>{console.log("Connected to telemetry service"),this.clearConnectionTimeout(),this.setConnectionState("connected"),this.reconnectAttempts=0,this.stats.connectionUptime=new Date,this.stats.reconnectCount++,this.startHeartbeat()},this.ws.onmessage=t=>{try{const a=JSON.parse(t.data);this.handleMessage(a)}catch(a){console.error("Failed to parse telemetry message:",a,t.data)}},this.ws.onclose=t=>{console.log("WebSocket connection closed:",t.code,t.reason),this.clearTimers(),t.code!==1e3?(this.setConnectionState("disconnected"),this.scheduleReconnect()):this.setConnectionState("disconnected")},this.ws.onerror=t=>{console.error("WebSocket error:",t),this.setConnectionState("error",new Error("WebSocket connection error"))})}handleMessage(t){this.stats.messagesReceived++,this.stats.lastMessageTime=new Date,this.onMessage&&this.onMessage(t);try{switch(t.type){case"drone_update":const a=t;this.onDroneUpdate&&this.onDroneUpdate(a.data);break;case"mission_update":const r=t;this.onMissionUpdate&&this.onMissionUpdate(r.data);break;case"fleet_alert":const n=t;this.onFleetAlert&&this.onFleetAlert(n.data);break;case"heartbeat":console.debug("Heartbeat received from server");break;default:console.warn("Unknown message type:",t.type)}this.stats.messagesProcessed++}catch(a){console.error("Failed to process telemetry message:",a,t)}}setConnectionState(t,a){this.connectionState!==t&&(this.connectionState=t,console.log(`WebSocket state changed to: ${t}`),this.onConnectionStateChange&&this.onConnectionStateChange(t,a))}scheduleReconnect(){if(this.reconnectAttempts>=this.config.maxReconnectAttempts){console.error("Max reconnect attempts reached"),this.setConnectionState("error",new Error("Max reconnect attempts exceeded"));return}this.reconnectAttempts++,this.setConnectionState("reconnecting"),console.log(`Attempting to reconnect in ${this.config.reconnectInterval}ms (attempt ${this.reconnectAttempts}/${this.config.maxReconnectAttempts})`),this.reconnectTimer=setTimeout(()=>{this.connect()},this.config.reconnectInterval)}startHeartbeat(){this.heartbeatTimer=setInterval(()=>{var t;if(((t=this.ws)==null?void 0:t.readyState)===WebSocket.OPEN)try{this.ws.send(JSON.stringify({type:"ping",timestamp:new Date().toISOString()}))}catch(a){console.error("Failed to send heartbeat:",a)}},this.config.heartbeatInterval)}startConnectionTimeout(){this.connectionTimer=setTimeout(()=>{var t;this.connectionState==="connecting"&&(console.error("Connection timeout"),this.setConnectionState("error",new Error("Connection timeout")),(t=this.ws)==null||t.close(),this.scheduleReconnect())},this.config.connectionTimeout)}clearConnectionTimeout(){this.connectionTimer&&(clearTimeout(this.connectionTimer),this.connectionTimer=null)}clearTimers(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null),this.clearConnectionTimeout()}}const Y=new _s,Bs=({connectionState:s,error:t,className:a=""})=>{const n=(()=>{switch(s){case W.CONNECTED:return{icon:I,color:"#238636",bgColor:"#238636",text:"Connected",description:"Real-time telemetry active",pulse:!1};case W.CONNECTING:return{icon:G,color:"#d29922",bgColor:"#d29922",text:"Connecting",description:"Establishing connection...",pulse:!0};case W.RECONNECTING:return{icon:G,color:"#d29922",bgColor:"#d29922",text:"Reconnecting",description:"Attempting to reconnect...",pulse:!0};case W.ERROR:return{icon:R,color:"#da3633",bgColor:"#da3633",text:"Error",description:t||"Connection failed",pulse:!1};case W.DISCONNECTED:default:return{icon:Q,color:"#8b949e",bgColor:"#8b949e",text:"Disconnected",description:"No telemetry connection",pulse:!1}}})(),l=n.icon;return e.jsxs("div",{className:`flex items-center gap-3 ${a}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(P,{children:n.pulse&&e.jsx(D.div,{className:"absolute inset-0 rounded-full",style:{backgroundColor:n.color},initial:{scale:1,opacity:.3},animate:{scale:1.5,opacity:0},exit:{scale:1,opacity:.3},transition:{duration:1.5,repeat:1/0,repeatType:"loop"}})}),e.jsx(D.div,{className:"w-8 h-8 rounded-full border-2 flex items-center justify-center",style:{backgroundColor:n.bgColor+"20",borderColor:n.color},animate:n.pulse?{rotate:360}:{},transition:n.pulse?{duration:2,repeat:1/0,ease:"linear"}:{},children:e.jsx(l,{className:"w-4 h-4",style:{color:n.color}})})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",style:{color:n.color},children:n.text}),e.jsx("div",{className:"text-text-muted text-xs",children:n.description})]})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-1 text-xs text-text-secondary",children:[e.jsx(je,{className:"w-3 h-3"}),e.jsx("span",{children:"ws://localhost:3001/telemetry"})]}),(s===W.ERROR||t)&&e.jsx(D.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"hidden lg:block",children:e.jsxs("div",{className:"bg-dark-tertiary border border-red-800 rounded-lg p-2 max-w-xs",children:[e.jsx("div",{className:"text-xs text-red-300 font-medium mb-1",children:"Connection Error"}),e.jsx("div",{className:"text-xs text-text-secondary",children:t||"Unable to connect to telemetry service"}),e.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Check if the telemetry service is running on port 3001"})]})})]})},Us={},Me=s=>{let t;const a=new Set,r=(h,g)=>{const f=typeof h=="function"?h(t):h;if(!Object.is(f,t)){const x=t;t=g??(typeof f!="object"||f===null)?f:Object.assign({},t,f),a.forEach(k=>k(t,x))}},n=()=>t,u={setState:r,getState:n,getInitialState:()=>p,subscribe:h=>(a.add(h),()=>a.delete(h)),destroy:()=>{(Us?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),a.clear()}},p=t=s(r,n,u);return u},Qs=s=>s?Me(s):Me;var He={exports:{}},Ze={},Ge={exports:{}},Je={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ne=i;function qs(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var zs=typeof Object.is=="function"?Object.is:qs,Vs=ne.useState,Hs=ne.useEffect,Zs=ne.useLayoutEffect,Gs=ne.useDebugValue;function Js(s,t){var a=t(),r=Vs({inst:{value:a,getSnapshot:t}}),n=r[0].inst,l=r[1];return Zs(function(){n.value=a,n.getSnapshot=t,ue(n)&&l({inst:n})},[s,a,t]),Hs(function(){return ue(n)&&l({inst:n}),s(function(){ue(n)&&l({inst:n})})},[s]),Gs(a),a}function ue(s){var t=s.getSnapshot;s=s.value;try{var a=t();return!zs(s,a)}catch{return!0}}function Ys(s,t){return t()}var Ks=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Ys:Js;Je.useSyncExternalStore=ne.useSyncExternalStore!==void 0?ne.useSyncExternalStore:Ks;Ge.exports=Je;var Xs=Ge.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var me=i,ea=Xs;function ta(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var sa=typeof Object.is=="function"?Object.is:ta,aa=ea.useSyncExternalStore,ra=me.useRef,na=me.useEffect,ia=me.useMemo,la=me.useDebugValue;Ze.useSyncExternalStoreWithSelector=function(s,t,a,r,n){var l=ra(null);if(l.current===null){var o={hasValue:!1,value:null};l.current=o}else o=l.current;l=ia(function(){function u(x){if(!p){if(p=!0,h=x,x=r(x),n!==void 0&&o.hasValue){var k=o.value;if(n(k,x))return g=k}return g=x}if(k=g,sa(h,x))return k;var y=r(x);return n!==void 0&&n(k,y)?(h=x,k):(h=x,g=y)}var p=!1,h,g,f=a===void 0?null:a;return[function(){return u(t())},f===null?void 0:function(){return u(f())}]},[t,a,r,n]);var c=aa(s,l[0],l[1]);return na(function(){o.hasValue=!0,o.value=c},[c]),la(c),c};He.exports=Ze;var oa=He.exports;const ca=it(oa),Ye={},{useDebugValue:da}=pe,{useSyncExternalStoreWithSelector:ma}=ca;let De=!1;const xa=s=>s;function ua(s,t=xa,a){(Ye?"production":void 0)!=="production"&&a&&!De&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),De=!0);const r=ma(s.subscribe,s.getState,s.getServerState||s.getInitialState,t,a);return da(r),r}const ha=s=>{(Ye?"production":void 0)!=="production"&&typeof s!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof s=="function"?Qs(s):s,a=(r,n)=>ua(t,r,n);return Object.assign(a,t),a},Ke=s=>ha,ga=s=>(t,a,r)=>{const n=r.subscribe;return r.subscribe=(o,c,u)=>{let p=o;if(c){const h=(u==null?void 0:u.equalityFn)||Object.is;let g=o(r.getState());p=f=>{const x=o(f);if(!h(g,x)){const k=g;c(g=x,k)}},u!=null&&u.fireImmediately&&c(g,g)}return n(p)},s(t,a,r)},Xe=ga;class pa{constructor(){L(this,"separationDistance",50);L(this,"warningDistance",75);L(this,"activeAlerts",new Map);L(this,"avoidanceManeuvers",new Map);console.log("ðŸ¤ Coordination Service initialized with 50m separation")}calculateDistance(t,a){const n=t.lat*Math.PI/180,l=a.lat*Math.PI/180,o=(a.lat-t.lat)*Math.PI/180,c=(a.lng-t.lng)*Math.PI/180,u=Math.sin(o/2)*Math.sin(o/2)+Math.cos(n)*Math.cos(l)*Math.sin(c/2)*Math.sin(c/2),h=6371e3*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))),g=Math.abs(t.alt-a.alt);return Math.sqrt(h*h+g*g)}calculateBearing(t,a){const r=t.lat*Math.PI/180,n=a.lat*Math.PI/180,l=(a.lng-t.lng)*Math.PI/180,o=Math.sin(l)*Math.cos(n),c=Math.cos(r)*Math.sin(n)-Math.sin(r)*Math.cos(n)*Math.cos(l);return(Math.atan2(o,c)*180/Math.PI+360)%360}predictPosition(t,a){const n=t.speed*a,l=t.heading*Math.PI/180,o=6371e3,c=n*Math.cos(l)/o*(180/Math.PI),u=n*Math.sin(l)/o*(180/Math.PI)/Math.cos(t.position.lat*Math.PI/180);return{lat:t.position.lat+c,lng:t.position.lng+u,alt:t.position.alt}}checkCollisionRisks(t){const a=t.filter(l=>l.status==="active"||l.status==="in_flight"),r=[],n=Date.now();this.avoidanceManeuvers.forEach((l,o)=>{n>l.endTime&&this.avoidanceManeuvers.delete(o)});for(let l=0;l<a.length;l++)for(let o=l+1;o<a.length;o++){const c=a[l],u=a[o],p=this.calculateDistance(c.position,u.position),h=this.predictPosition(c,10),g=this.predictPosition(u,10),f=this.calculateDistance(h,g),x=Math.min(p,f),k=`${c.id}-${u.id}`;if(x<this.separationDistance){const y={id:k,type:"separation_violation",severity:"critical",droneIds:[c.id,u.id],distance:x,message:`CRITICAL: Drones ${c.name} and ${u.name} within ${x.toFixed(1)}m (minimum ${this.separationDistance}m)`,timestamp:new Date().toISOString(),resolved:!1,avoidanceAction:this.calculateAvoidanceAction(c,u,x)};r.push(y),this.activeAlerts.set(k,y)}else if(x<this.warningDistance){const y=this.activeAlerts.get(k);if(!y||y.type!=="collision_warning"){const d={id:k,type:"collision_warning",severity:"warning",droneIds:[c.id,u.id],distance:x,message:`Warning: Drones ${c.name} and ${u.name} approaching ${x.toFixed(1)}m separation`,timestamp:new Date().toISOString(),resolved:!1};r.push(d),this.activeAlerts.set(k,d)}}else{const y=this.activeAlerts.get(k);y&&!y.resolved&&(y.resolved=!0,this.activeAlerts.delete(k))}}return r}calculateAvoidanceAction(t,a,r){const n=t.position.alt-a.position.alt;let l,o,c;return Math.abs(n)<10?(l=t.id<a.id?t:a,o=(this.calculateBearing(t.position,a.position)-t.heading+360)%360<180?"turn_right":"turn_left",c=Math.max(30,60-r)):(l=n<0?t:a,o=n<0?"climb":"descend",c=Math.max(20,this.separationDistance-r+10)),{droneId:l.id,action:o,magnitude:c}}applyAvoidanceManeuver(t,a){if(!a)return!1;const r=Date.now(),n=15e3,l=t.heading;let o=!1;switch(a.action){case"turn_left":t.heading=(t.heading-a.magnitude+360)%360,o=!0;break;case"turn_right":t.heading=(t.heading+a.magnitude)%360,o=!0;break;case"climb":t.position.alt=Math.min(t.position.alt+a.magnitude,200),o=!0;break;case"descend":t.position.alt=Math.max(t.position.alt-a.magnitude,10),o=!0;break;case"slow_down":t.speed=Math.max(t.speed*.5,2),o=!0;break;case"hover":t.speed=0,o=!0;break}return o&&(this.avoidanceManeuvers.set(a.droneId,{action:a.action,endTime:r+n,originalHeading:l}),console.log(`ðŸš Avoidance maneuver applied to ${t.name}: ${a.action} (${a.magnitude})`)),o}getCoordinationStatus(){const t=Array.from(this.activeAlerts.values()).filter(r=>!r.resolved),a=Array.from(this.activeAlerts.values()).filter(r=>r.resolved).length;return{isActive:!0,separationDistance:this.separationDistance,activeWarnings:t,totalConflicts:this.activeAlerts.size,resolvedConflicts:a,lastUpdate:new Date().toISOString()}}setSeparationDistance(t){this.separationDistance=Math.max(20,Math.min(t,200)),this.warningDistance=this.separationDistance*1.5,console.log(`ðŸ¤ Coordination separation updated to ${this.separationDistance}m`)}resolveAlert(t){const a=this.activeAlerts.get(t);return a?(a.resolved=!0,this.activeAlerts.delete(t),!0):!1}getActiveManeuvers(){return new Map(this.avoidanceManeuvers)}}const K=new pa;class fa{constructor(){L(this,"stations",new Map);L(this,"globalQueue",[]);L(this,"chargingHistory",[]);this.initializeChargingStations(),console.log("ðŸ”‹ Charging Service initialized with queue management")}initializeChargingStations(){this.stations.set("station-001",{id:"station-001",name:"Base Station Alpha",status:"occupied",currentDrone:"drone-002",chargingRate:3.5,estimatedTimeRemaining:12,position:{lat:37.7849,lng:-122.4094,alt:2.1},lastMaintenance:new Date(Date.now()-5*24*60*60*1e3).toISOString(),totalChargingSessions:47,averageChargingTime:28}),this.stations.set("station-002",{id:"station-002",name:"Base Station Beta",status:"available",chargingRate:4.2,position:{lat:37.765,lng:-122.415,alt:2.5},lastMaintenance:new Date(Date.now()-2*24*60*60*1e3).toISOString(),totalChargingSessions:31,averageChargingTime:24}),this.stations.set("station-003",{id:"station-003",name:"Base Station Gamma",status:"available",chargingRate:3,position:{lat:37.755,lng:-122.425,alt:1.8},lastMaintenance:new Date(Date.now()-8*24*60*60*1e3).toISOString(),totalChargingSessions:23,averageChargingTime:32}),console.log(`ðŸ”‹ Initialized ${this.stations.size} charging stations`)}calculatePriority(t,a){let r=1;if(t.batteryLevel<10?r+=3:t.batteryLevel<20?r+=2:t.batteryLevel<30&&(r+=1),t.currentMission){const l=this.getMissionPriority(t);l==="critical"?r+=2:l==="high"&&(r+=1)}switch(a){case"emergency":r+=2;break;case"low_battery":r+=1;break;case"pre_mission":r+=1;break}return(t.totalFlightTime||0)>2e3&&(r+=1),Math.min(r,5)}getMissionPriority(t){if(!t.currentMission)return"low";const a=t.currentMission.name.toLowerCase();return a.includes("emergency")||a.includes("medical")?"critical":a.includes("security")||a.includes("patrol")?"high":a.includes("delivery")?"normal":"low"}addToQueue(t,a="low_battery",r=5){const n=this.globalQueue.findIndex(p=>p.droneId===t.id);if(n!==-1)return console.warn(`Drone ${t.id} already in charging queue`),this.globalQueue[n];const l=this.calculatePriority(t,a),o=this.calculateExpectedChargingTime(t.batteryLevel),c=this.getMissionPriority(t),u={id:`queue-${t.id}-${Date.now()}`,droneId:t.id,droneName:t.name,priority:l,batteryLevel:t.batteryLevel,estimatedArrival:r,queuePosition:0,requestedAt:new Date().toISOString(),expectedChargingTime:o,missionPriority:c,reason:a};return this.globalQueue.push(u),this.sortQueue(),console.log(`ðŸ”‹ Added ${t.name} to charging queue (Priority: ${l}, Battery: ${t.batteryLevel}%)`),u}sortQueue(){this.globalQueue.sort((t,a)=>a.priority!==t.priority?a.priority-t.priority:t.batteryLevel!==a.batteryLevel?t.batteryLevel-a.batteryLevel:new Date(t.requestedAt).getTime()-new Date(a.requestedAt).getTime()),this.globalQueue.forEach((t,a)=>{t.queuePosition=a+1})}calculateExpectedChargingTime(t,a=90){const r=Math.max(0,a-t);return Math.ceil(r/3.5)}findBestAvailableStation(){return Array.from(this.stations.values()).filter(a=>a.status==="available").sort((a,r)=>r.chargingRate-a.chargingRate)[0]||null}assignNextDrone(){if(this.globalQueue.length===0)return{assigned:!1};const t=this.findBestAvailableStation();if(!t)return{assigned:!1};const a=this.globalQueue.shift();return t.status="occupied",t.currentDrone=a.droneId,t.estimatedTimeRemaining=this.calculateExpectedChargingTime(a.batteryLevel),this.startChargingSession(a.droneId,t.id,a.batteryLevel),this.sortQueue(),console.log(`ðŸ”‹ Assigned ${a.droneName} to ${t.name} (Est: ${t.estimatedTimeRemaining}min)`),{assigned:!0,stationId:t.id,droneId:a.droneId}}startChargingSession(t,a,r){console.log(`ðŸ”‹ Started charging session: ${t} at ${a}`)}completeChargingSession(t,a){const r=this.stations.get(t);if(!r||r.status!=="occupied")return!1;const n=r.currentDrone,l=r.averageChargingTime;return this.chargingHistory.push({droneId:n,stationId:t,startTime:new Date(Date.now()-l*60*1e3).toISOString(),endTime:new Date().toISOString(),chargingTime:l,batteryStart:a-a*.7,batteryEnd:a}),r.status="available",r.currentDrone=void 0,r.estimatedTimeRemaining=void 0,r.totalChargingSessions++,console.log(`ðŸ”‹ Completed charging: ${n} at ${r.name} (${a}%)`),this.assignNextDrone(),!0}removeFromQueue(t){const a=this.globalQueue.findIndex(r=>r.droneId===t);return a===-1?!1:(this.globalQueue.splice(a,1),this.sortQueue(),console.log(`ðŸ”‹ Removed ${t} from charging queue`),!0)}getQueueStatus(t){return this.globalQueue.find(a=>a.droneId===t)||null}getChargingSchedules(){const t=[];return Array.from(this.stations.values()).forEach(a=>{const r=this.globalQueue.slice(),n=a.currentDrone?this.globalQueue.find(c=>c.droneId===a.currentDrone):void 0,l=r.reduce((c,u)=>c+u.expectedChargingTime,0),o=a.status==="available"?0:(a.estimatedTimeRemaining||0)+l;t.push({stationId:a.id,stationName:a.name,queue:r,currentlyCharging:n,estimatedWaitTime:o,totalQueueTime:l})}),t}getChargingStations(){return Array.from(this.stations.values())}getChargingStats(){const t=Array.from(this.stations.values()),a=t.filter(c=>c.status==="available").length,r=t.filter(c=>c.status==="occupied").length,n=t.filter(c=>c.status==="maintenance").length,l=t.reduce((c,u)=>c+u.totalChargingSessions,0),o=t.reduce((c,u)=>c+u.averageChargingTime,0)/t.length;return{totalStations:t.length,availableStations:a,occupiedStations:r,maintenanceStations:n,totalInQueue:this.globalQueue.length,averageWaitTime:this.calculateAverageWaitTime(),averageChargingTime:Math.round(o),dailyChargingSessions:l,peakUsageHour:14}}calculateAverageWaitTime(){if(this.globalQueue.length===0)return 0;const a=Array.from(this.stations.values()).filter(r=>r.status==="occupied").reduce((r,n)=>r+(n.estimatedTimeRemaining||0),0);return Math.round(a/Math.max(this.globalQueue.length,1))}updateChargingProgress(){Array.from(this.stations.values()).forEach(t=>{t.status==="occupied"&&t.estimatedTimeRemaining&&(t.estimatedTimeRemaining=Math.max(0,t.estimatedTimeRemaining-1),t.estimatedTimeRemaining<=0&&this.completeChargingSession(t.id,90))})}shouldAddToQueue(t){return this.getQueueStatus(t.id)||t.status==="charging"?!1:!!(t.batteryLevel<15||t.batteryLevel<25&&(t.status==="idle"||!t.currentMission)||t.batteryLevel<80&&t.currentMission&&t.currentMission.status==="pending")}processAutoQueue(t){t.forEach(r=>{var n;if(this.shouldAddToQueue(r)){let l="scheduled";r.batteryLevel<15?l="emergency":r.batteryLevel<25?l="low_battery":((n=r.currentMission)==null?void 0:n.status)==="pending"&&(l="pre_mission"),this.addToQueue(r,l)}});let a=!0;for(;a;)a=this.assignNextDrone().assigned}}const q=new fa,B=[{id:"drone-001",name:"Alpha-1",status:"in_flight",position:{lat:37.7749,lng:-122.4194,alt:120.5},batteryLevel:87,batteryVoltage:22.4,speed:12.3,heading:245,signalStrength:-45,connectionQuality:"excellent",lastUpdate:new Date().toISOString(),currentMission:{id:"mission-001",name:"Downtown Delivery Route",progress:65,eta:"14:30",status:"active"},alerts:[{id:"alert-001",severity:"warning",message:"Approaching restricted airspace",timestamp:new Date(Date.now()-3e5).toISOString(),category:"navigation"}],temperature:28.5,humidity:65,firmware:"v1.12.3",hardware:"Pixhawk 4 Mini",uptime:"2h 34m",totalFlightTime:847,totalMissions:23,lastMaintenance:new Date(Date.now()-7*24*60*60*1e3).toISOString()},{id:"drone-002",name:"Beta-2",status:"charging",position:{lat:37.7849,lng:-122.4094,alt:2.1},batteryLevel:23,batteryVoltage:18.2,speed:0,heading:0,signalStrength:-52,connectionQuality:"good",lastUpdate:new Date().toISOString(),alerts:[{id:"alert-002",severity:"info",message:"Charging in progress - 47 minutes remaining",timestamp:new Date(Date.now()-6e5).toISOString(),category:"system"}],temperature:32.1,humidity:68,firmware:"v1.12.3",hardware:"Pixhawk 4 Pro",uptime:"5h 12m",totalFlightTime:1203,totalMissions:31,lastMaintenance:new Date(Date.now()-3*24*60*60*1e3).toISOString()},{id:"drone-003",name:"Charlie-3",status:"in_flight",position:{lat:37.7649,lng:-122.4294,alt:89.2},batteryLevel:18,batteryVoltage:18.5,speed:8.7,heading:180,signalStrength:-67,connectionQuality:"good",lastUpdate:new Date().toISOString(),currentMission:{id:"mission-002",name:"Harbor Security Patrol",progress:38,eta:"15:45",status:"active"},alerts:[{id:"alert-battery-drone-003-low",severity:"critical",message:"Battery level 18.0% - Return to base immediately",timestamp:new Date(Date.now()-18e4).toISOString(),category:"battery"}],temperature:30.8,humidity:72,firmware:"v1.12.3",hardware:"Pixhawk 4 Mini",uptime:"1h 58m",totalFlightTime:592,totalMissions:18,lastMaintenance:new Date(Date.now()-14*24*60*60*1e3).toISOString()},{id:"drone-004",name:"Delta-4",status:"active",position:{lat:37.7549,lng:-122.4394,alt:45.8},batteryLevel:92,batteryVoltage:23.1,speed:6.2,heading:90,signalStrength:-38,connectionQuality:"excellent",lastUpdate:new Date().toISOString(),currentMission:{id:"mission-003",name:"Medical Supply Delivery",progress:15,eta:"16:20",status:"active"},temperature:26.3,humidity:58,firmware:"v1.12.3",hardware:"Pixhawk 4 Pro",uptime:"8h 45m",totalFlightTime:1847,totalMissions:45,lastMaintenance:new Date(Date.now()-2*24*60*60*1e3).toISOString()},{id:"drone-005",name:"Echo-5",status:"maintenance",position:{lat:37.7449,lng:-122.4494,alt:0},batteryLevel:78,batteryVoltage:21.8,speed:0,heading:0,signalStrength:-88,connectionQuality:"poor",lastUpdate:new Date(Date.now()-9e5).toISOString(),alerts:[{id:"alert-003",severity:"critical",message:"Motor #3 temperature exceeds safe limits",timestamp:new Date(Date.now()-12e5).toISOString(),category:"hardware"},{id:"alert-004",severity:"warning",message:"GPS signal degraded - position accuracy reduced",timestamp:new Date(Date.now()-8e5).toISOString(),category:"navigation"},{id:"alert-005",severity:"info",message:"Scheduled maintenance required",timestamp:new Date(Date.now()-6e5).toISOString(),category:"maintenance"}],temperature:52.1,humidity:55,firmware:"v1.12.2",hardware:"Pixhawk 4 Mini",uptime:"12h 22m",totalFlightTime:2341,totalMissions:67,lastMaintenance:new Date(Date.now()-21*24*60*60*1e3).toISOString()}],va=[{id:"mission-001",name:"Downtown Delivery",progress:65,eta:"14:30",status:"active",waypoints:[{id:"wp-001",position:{lat:37.7749,lng:-122.4194,alt:120},action:"pickup",completed:!0},{id:"wp-002",position:{lat:37.7849,lng:-122.4094,alt:100},action:"delivery",completed:!1}],assignedDrone:"drone-001",priority:1,createdAt:new Date(Date.now()-36e5).toISOString(),startedAt:new Date(Date.now()-18e5).toISOString()},{id:"mission-002",name:"Harbor Patrol",progress:38,eta:"15:45",status:"active",waypoints:[{id:"wp-003",position:{lat:37.7649,lng:-122.4294,alt:80},action:"survey",completed:!1}],assignedDrone:"drone-003",priority:2,createdAt:new Date(Date.now()-72e5).toISOString(),startedAt:new Date(Date.now()-27e5).toISOString()}],ya=[{id:"fleet-alert-001",severity:"critical",message:"Drone Echo-5 motor temperature critical",timestamp:new Date(Date.now()-12e5).toISOString(),droneId:"drone-005",droneName:"Echo-5",type:"system",priority:1,details:{temperature:45.2,threshold:40}},{id:"fleet-alert-002",severity:"warning",message:"Drone Alpha-1 approaching restricted airspace",timestamp:new Date(Date.now()-3e5).toISOString(),droneId:"drone-001",droneName:"Alpha-1",type:"safety",priority:2,details:{zone:"SFO_RESTRICTED",distance:150}}];class ba{constructor(){L(this,"updateInterval",null);L(this,"onDroneUpdate");L(this,"droneFlightPatterns",new Map);L(this,"emergencyStates",new Map);L(this,"coordinationAlerts",[]);this.initializeFlightPatterns()}initializeFlightPatterns(){this.droneFlightPatterns.set("drone-001",{type:"waypoint",waypoints:[{lat:37.7749,lng:-122.4194},{lat:37.7754,lng:-122.4189},{lat:37.7759,lng:-122.4194},{lat:37.7754,lng:-122.4199}],currentWaypoint:0,progress:0,speed:.015}),this.droneFlightPatterns.set("drone-002",{type:"stationary",center:{lat:37.7849,lng:-122.4094},radius:0,currentAngle:0,speed:0}),this.droneFlightPatterns.set("drone-003",{type:"waypoint",waypoints:[{lat:37.7649,lng:-122.4294},{lat:37.7669,lng:-122.4274},{lat:37.7649,lng:-122.4254},{lat:37.7629,lng:-122.4274}],currentWaypoint:0,progress:.3,speed:.012}),this.droneFlightPatterns.set("drone-004",{type:"waypoint",waypoints:[{lat:37.7744,lng:-122.4199},{lat:37.7754,lng:-122.4189},{lat:37.7764,lng:-122.4199},{lat:37.7754,lng:-122.4209}],currentWaypoint:0,progress:.15,speed:.018}),this.droneFlightPatterns.set("drone-005",{type:"stationary",center:{lat:37.7449,lng:-122.4494},radius:0,currentAngle:0,speed:0})}start(){console.log("ðŸ”§ Starting enhanced mock telemetry service for 5 drones"),console.log("ðŸ“ Flight patterns initialized: Circular patrol, Linear patrol, Waypoint mission"),this.updateInterval=setInterval(()=>{B.forEach((t,a)=>{this.updateDroneRealistic(t),setTimeout(()=>{this.onDroneUpdate&&this.onDroneUpdate({...t})},a*500)}),setTimeout(()=>{this.performCoordinationCheck(),this.performChargingManagement()},B.length*500+1e3)},8e3)}updateDroneRealistic(t){const a=this.droneFlightPatterns.get(t.id);a&&(this.updatePosition(t,a),this.updateTelemetry(t),this.updateMissionProgress(t),this.detectEmergencyStates(t),this.simulateAlerts(t),t.lastUpdate=new Date().toISOString())}updatePosition(t,a){switch(a.type){case"circular":a.currentAngle+=a.speed*.4,t.position.lat=a.center.lat+Math.cos(a.currentAngle)*a.radius,t.position.lng=a.center.lng+Math.sin(a.currentAngle)*a.radius,t.position.alt=80+Math.sin(a.currentAngle*2)*10,t.heading=(a.currentAngle*180/Math.PI+90)%360,t.speed=12+Math.random()*4;break;case"linear":const r=a;r.progress+=r.direction*r.speed*.3,(r.progress>=1||r.progress<=0)&&(r.direction*=-1,r.progress=Math.max(0,Math.min(1,r.progress))),t.position.lat=r.start.lat+(r.end.lat-r.start.lat)*r.progress,t.position.lng=r.start.lng+(r.end.lng-r.start.lng)*r.progress,t.position.alt=60+Math.sin(r.progress*Math.PI)*15;const n=r.end.lat-r.start.lat,l=r.end.lng-r.start.lng;t.heading=Math.atan2(l,n)*180/Math.PI*r.direction%360,t.speed=9+Math.random()*3;break;case"waypoint":const o=a;o.progress+=o.speed*.4,o.progress>=1&&(o.currentWaypoint=(o.currentWaypoint+1)%o.waypoints.length,o.progress=0);const c=o.waypoints[o.currentWaypoint],u=o.waypoints[(o.currentWaypoint+1)%o.waypoints.length];t.position.lat=c.lat+(u.lat-c.lat)*o.progress,t.position.lng=c.lng+(u.lng-c.lng)*o.progress,t.position.alt=45+Math.sin(o.progress*Math.PI)*10;const p=u.lat-c.lat,h=u.lng-c.lng;t.heading=Math.atan2(h,p)*180/Math.PI,t.speed=10+Math.random()*3;break;case"stationary":t.position.lat+=(Math.random()-.5)*5e-6,t.position.lng+=(Math.random()-.5)*5e-6,t.speed=0;break}}updateTelemetry(t){t.status==="active"||t.status==="in_flight"?(t.batteryLevel=Math.max(5,t.batteryLevel-.02-Math.random()*.01),t.batteryVoltage=18+t.batteryLevel/100*5.5):t.status==="charging"&&(t.batteryLevel=Math.min(100,t.batteryLevel+.1+Math.random()*.05),t.batteryVoltage=18+t.batteryLevel/100*5.5);const a=t.signalStrength;t.signalStrength=a+(Math.random()-.5)*2,t.signalStrength>-50?t.connectionQuality="excellent":t.signalStrength>-70?t.connectionQuality="good":t.signalStrength>-90?t.connectionQuality="poor":t.connectionQuality="very_poor";const r=(Math.random()-.5)*.5;t.temperature=(t.temperature||28)+r,(t.status==="active"||t.status==="in_flight")&&(t.temperature=Math.min(50,(t.temperature||28)+.02)),t.humidity=Math.max(40,Math.min(85,(t.humidity||60)+(Math.random()-.5)*1))}updateMissionProgress(t){if(t.currentMission&&(t.status==="active"||t.status==="in_flight")){t.currentMission.progress=Math.min(99,t.currentMission.progress+.1+Math.random()*.1);const a=100-t.currentMission.progress,r=Math.round(a*2),n=new Date(Date.now()+r*6e4);t.currentMission.eta=n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}}simulateAlerts(t){var r;if(t.alerts=t.alerts||[],!(Math.random()<.1)){t.alerts=t.alerts.filter(n=>Date.now()-new Date(n.timestamp).getTime()<6e5);return}if(t.batteryLevel<25&&!t.alerts.some(n=>n.category==="battery")){let n,l;t.batteryLevel<10?(n="critical",l=`Critical battery level ${t.batteryLevel.toFixed(1)}% - Land immediately!`):t.batteryLevel<15?(n="critical",l=`Battery level ${t.batteryLevel.toFixed(1)}% - Return to base immediately`):(n="warning",l=`Battery level ${t.batteryLevel.toFixed(1)}% - Consider returning to base`),t.alerts.unshift({id:`alert-battery-${t.id}-${Date.now()}`,severity:n,message:l,timestamp:new Date().toISOString(),category:"battery"})}t.batteryLevel>=30&&(t.alerts=t.alerts.filter(n=>n.category!=="battery")),(t.temperature||0)>40&&!t.alerts.some(n=>n.category==="system"&&n.message.includes("temperature"))&&t.alerts.unshift({id:`alert-temp-${t.id}-${Date.now()}`,severity:(t.temperature||0)>45?"critical":"warning",message:`Motor temperature elevated: ${(r=t.temperature)==null?void 0:r.toFixed(1)}Â°C`,timestamp:new Date().toISOString(),category:"hardware"}),(t.temperature||0)<=38&&(t.alerts=t.alerts.filter(n=>!(n.category==="hardware"&&n.message.includes("temperature")))),t.alerts.length>5&&(t.alerts=t.alerts.slice(0,5))}detectEmergencyStates(t){var n;const a=new Date().toISOString();let r=!1;if(t.batteryLevel<10&&!this.emergencyStates.has(`${t.id}-critical_battery`)){const l={id:`${t.id}-critical_battery-${Date.now()}`,droneId:t.id,type:"critical_battery",severity:"emergency",description:`Critical battery level ${t.batteryLevel.toFixed(1)}% - Immediate emergency landing required`,triggeredAt:a,resolved:!1,autoResponse:{action:"emergency_landing",triggered:!0,triggeredAt:a}};this.emergencyStates.set(`${t.id}-critical_battery`,l),t.emergencyState=l,t.status="emergency",r=!0}if(t.connectionQuality==="very_poor"&&t.signalStrength<-95&&!this.emergencyStates.get(`${t.id}-communication_loss`)){const o={id:`${t.id}-communication_loss-${Date.now()}`,droneId:t.id,type:"communication_loss",severity:"critical",description:`Communication loss detected - Signal strength ${t.signalStrength}dBm`,triggeredAt:a,resolved:!1,autoResponse:{action:"hover",triggered:!0,triggeredAt:a}};this.emergencyStates.set(`${t.id}-communication_loss`,o),t.emergencyState=o,t.status="emergency",r=!0}if((t.temperature||0)>50&&!this.emergencyStates.has(`${t.id}-system_failure`)){const l={id:`${t.id}-system_failure-${Date.now()}`,droneId:t.id,type:"system_failure",severity:"emergency",description:`System overheating detected - Temperature ${(n=t.temperature)==null?void 0:n.toFixed(1)}Â°C exceeds safe limits`,triggeredAt:a,resolved:!1,autoResponse:{action:"return_to_base",triggered:!0,triggeredAt:a}};this.emergencyStates.set(`${t.id}-system_failure`,l),t.emergencyState=l,t.status="emergency",r=!0}if(Math.random()<.001&&t.status==="in_flight"&&!this.emergencyStates.get(`${t.id}-collision_risk`)){const o={id:`${t.id}-collision_risk-${Date.now()}`,droneId:t.id,type:"collision_risk",severity:"critical",description:"Collision risk detected - Another aircraft in proximity",triggeredAt:a,resolved:!1,autoResponse:{action:"hover",triggered:!0,triggeredAt:a}};this.emergencyStates.set(`${t.id}-collision_risk`,o),t.emergencyState=o,t.status="emergency",r=!0}this.checkEmergencyResolution(t),r&&t.emergencyState&&this.generateEmergencyAlert(t,t.emergencyState)}checkEmergencyResolution(t){const a=[];this.emergencyStates.forEach((r,n)=>{var o;if(r.droneId!==t.id||r.resolved)return;let l=!1;switch(r.type){case"critical_battery":(t.status==="charging"||t.batteryLevel>15)&&(l=!0);break;case"communication_loss":t.connectionQuality!=="very_poor"&&t.signalStrength>-85&&(l=!0);break;case"system_failure":(t.temperature||0)<40&&(l=!0);break;case"collision_risk":Date.now()-new Date(r.triggeredAt).getTime()>3e4&&(l=!0);break}l&&(r.resolved=!0,r.resolvedAt=new Date().toISOString(),a.push(n),((o=t.emergencyState)==null?void 0:o.id)===r.id&&(t.emergencyState=void 0,t.status==="emergency"&&t.id!=="drone-005"&&(t.status=t.batteryLevel<30?"charging":"active")))}),a.forEach(r=>{this.emergencyStates.delete(r)})}generateEmergencyAlert(t,a){t.alerts=t.alerts||[],t.alerts.find(n=>n.category==="emergency"&&n.message.includes(a.type.replace("_"," ")))||t.alerts.unshift({id:`alert-emergency-${a.id}`,severity:(a.severity==="emergency","critical"),message:`EMERGENCY: ${a.description}`,timestamp:a.triggeredAt,category:"emergency"})}stop(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),console.log("ðŸ”§ Mock telemetry service stopped")}onDroneDataUpdate(t){this.onDroneUpdate=t}performCoordinationCheck(){try{const t=K.checkCollisionRisks(B);t.forEach(r=>{if(r.type==="separation_violation"&&r.avoidanceAction){const n=B.find(l=>l.id===r.avoidanceAction.droneId);n&&(K.applyAvoidanceManeuver(n,r.avoidanceAction),n.alerts=n.alerts||[],n.alerts.find(o=>o.category==="coordination"&&o.message.includes("avoidance"))||n.alerts.unshift({id:`coord-${r.id}-${Date.now()}`,severity:r.severity==="critical"?"critical":"warning",message:`Coordination: ${r.avoidanceAction.action.replace("_"," ")} maneuver (${r.distance.toFixed(1)}m separation)`,timestamp:r.timestamp,category:"coordination"}))}else r.type==="collision_warning"&&r.droneIds.forEach(n=>{const l=B.find(o=>o.id===n);l&&(l.alerts=l.alerts||[],l.alerts.find(c=>c.category==="coordination"&&c.message.includes("proximity"))||l.alerts.unshift({id:`coord-warning-${n}-${Date.now()}`,severity:"warning",message:`Coordination: Proximity warning - ${r.distance.toFixed(1)}m to other drone`,timestamp:r.timestamp,category:"coordination"}))})}),this.coordinationAlerts=t.filter(r=>!r.resolved);const a=K.getCoordinationStatus();a.activeWarnings.length>0&&console.log(`ðŸ¤ Coordination: ${a.activeWarnings.length} active warnings, ${a.resolvedConflicts} resolved`)}catch(t){console.error("Error during coordination check:",t)}}performChargingManagement(){try{q.updateChargingProgress(),q.processAutoQueue(B),this.updateDroneChargingStatuses();const t=q.getChargingStats();(t.totalInQueue>0||t.occupiedStations>0)&&console.log(`ðŸ”‹ Charging: ${t.occupiedStations}/${t.totalStations} stations occupied, ${t.totalInQueue} in queue`)}catch(t){console.error("Error during charging management:",t)}}updateDroneChargingStatuses(){B.forEach(t=>{const r=q.getChargingStations().find(n=>n.currentDrone===t.id);if(r){if(t.status!=="charging"){t.status="charging",t.alerts=t.alerts||[];const n=t.alerts.find(l=>l.category==="charging");n?n.message=`Charging at ${r.name} - ${r.estimatedTimeRemaining}min remaining`:t.alerts.unshift({id:`charging-${t.id}-${Date.now()}`,severity:"info",message:`Charging at ${r.name} - ${r.estimatedTimeRemaining}min remaining`,timestamp:new Date().toISOString(),category:"charging"})}if(t.batteryLevel<90){const n=r.chargingRate/60;t.batteryLevel=Math.min(90,t.batteryLevel+n*8),t.batteryVoltage=18+t.batteryLevel/100*5.5}t.position=r.position,t.speed=0}else{const n=q.getQueueStatus(t.id);if(n){t.alerts=t.alerts||[];const l=t.alerts.find(o=>o.category==="charging"&&o.message.includes("queue"));l?l.message=`Charging queue position ${n.queuePosition} (Priority: ${n.priority})`:t.alerts.unshift({id:`queue-${t.id}-${Date.now()}`,severity:n.priority>=4?"warning":"info",message:`Charging queue position ${n.queuePosition} (Priority: ${n.priority})`,timestamp:new Date().toISOString(),category:"charging"})}else t.alerts&&(t.alerts=t.alerts.filter(l=>l.category!=="charging")),t.status==="charging"&&t.batteryLevel>=85&&(t.status=t.currentMission?"active":"idle",t.alerts=t.alerts||[],t.alerts.unshift({id:`charged-${t.id}-${Date.now()}`,severity:"info",message:`Charging complete - Battery: ${Math.round(t.batteryLevel)}%`,timestamp:new Date().toISOString(),category:"system"}))}})}getCoordinationStatus(){return K.getCoordinationStatus()}getCoordinationAlerts(){return this.coordinationAlerts}getChargingStats(){return q.getChargingStats()}getChargingStations(){return q.getChargingStations()}getChargingSchedules(){return q.getChargingSchedules()}addDroneToChargingQueue(t,a="scheduled"){const r=B.find(n=>n.id===t);return r?q.addToQueue(r,a):null}removeDroneFromChargingQueue(t){return q.removeFromQueue(t)}triggerEmergencyResponse(t,a){const r=B.find(n=>n.id===t);return!r||!r.emergencyState?(console.warn(`Cannot trigger emergency response for ${t}: drone not found or no emergency state`),!1):r.emergencyState?(r.emergencyState.operatorOverride={action:a.replace("_"," "),triggeredBy:"operator",triggeredAt:new Date().toISOString()},r.alerts=r.alerts||[],r.alerts.unshift({id:`alert-response-${t}-${Date.now()}`,severity:"info",message:`Emergency response activated: ${a.replace("_"," ")}`,timestamp:new Date().toISOString(),category:"emergency"}),console.log(`ðŸš¨ Emergency response triggered for ${t}: ${a}`),!0):!1}resolveEmergency(t,a){const r=B.find(n=>n.id===t);return!r||!r.emergencyState?(console.warn(`Cannot resolve emergency for ${t}: drone not found or no emergency state`),!1):r.emergencyState?(r.emergencyState.resolved=!0,r.emergencyState.resolvedAt=new Date().toISOString(),r.status==="emergency"&&(r.status=r.batteryLevel<30?"charging":"active"),r.alerts=r.alerts||[],r.alerts.unshift({id:`alert-resolved-${t}-${Date.now()}`,severity:"info",message:`Emergency resolved: ${a}`,timestamp:new Date().toISOString(),category:"emergency"}),console.log(`âœ… Emergency resolved for ${t}: ${a}`),!0):!1}getEmergencyStats(){const t=Array.from(this.emergencyStates.values()).filter(n=>!n.resolved),a=Array.from(this.emergencyStates.values()).filter(n=>n.resolved),r=t.reduce((n,l)=>(n[l.type]=(n[l.type]||0)+1,n),{});return{active:t.length,resolved:a.length,total:this.emergencyStates.size,byType:r,criticalCount:t.filter(n=>n.severity==="emergency").length}}}const T=new ba;typeof window<"u"&&(window.emergencyResponse={trigger:(s,t)=>T.triggerEmergencyResponse(s,t),resolve:(s,t)=>T.resolveEmergency(s,t),stats:()=>T.getEmergencyStats()},window.coordination={status:()=>T.getCoordinationStatus(),alerts:()=>T.getCoordinationAlerts(),setSeparation:s=>K.setSeparationDistance(s),resolve:s=>K.resolveAlert(s),maneuvers:()=>Array.from(K.getActiveManeuvers().entries())},window.charging={stats:()=>T.getChargingStats(),stations:()=>T.getChargingStations(),schedules:()=>T.getChargingSchedules(),addToQueue:(s,t="scheduled")=>T.addDroneToChargingQueue(s,t),removeFromQueue:s=>T.removeDroneFromChargingQueue(s),forceCharge:s=>{T.addDroneToChargingQueue(s,"emergency"),console.log(`ðŸ”‹ Force charging ${s} with emergency priority`)}});const F=Ke()(Xe((s,t)=>({connectionState:W.DISCONNECTED,connectionError:null,lastUpdate:null,drones:{},missions:{},alerts:[],selectedDroneId:null,stats:{messagesReceived:0,messagesProcessed:0,connectionUptime:0,reconnectCount:0},setConnectionState:(a,r)=>{s({connectionState:a,connectionError:r||null})},updateDrone:a=>{s(r=>{const n=r.drones[a.id];let l=a.alerts||[];if(n&&n.alerts){const o=new Map(n.alerts.map(u=>[u.id,u.message])),c=new Map(l.map(u=>[u.id,u.message]));if(o.size===c.size){let u=!0;for(const[p,h]of o)if(!c.has(p)||c.get(p)!==h){u=!1;break}u&&(l=n.alerts)}}return{drones:{...r.drones,[a.id]:{...a,alerts:l,lastUpdate:new Date().toISOString()}},lastUpdate:new Date}})},updateMission:a=>{s(r=>({missions:{...r.missions,[a.id]:a},lastUpdate:new Date}))},addAlert:a=>{s(r=>({alerts:[a,...r.alerts.slice(0,99)],lastUpdate:new Date}))},dismissAlert:a=>{s(r=>({alerts:r.alerts.filter(n=>n.id!==a)}))},selectDrone:a=>{s({selectedDroneId:a})},updateStats:a=>{s({stats:a})},getDroneById:a=>t().drones[a],getActiveDrones:()=>{const{drones:a}=t();return Object.values(a).filter(r=>r.status==="active"||r.status==="in_flight")},getDronesWithIssues:()=>{const{drones:a}=t();return Object.values(a).filter(r=>r.status==="maintenance"||r.status==="emergency"||r.batteryLevel<20||r.signalStrength<-90||r.alerts&&r.alerts.length>0)},getIdleDrones:()=>{const{drones:a}=t();return Object.values(a).filter(r=>r.status==="idle")},getCriticalAlerts:()=>{const{alerts:a}=t();return a.filter(r=>r.severity==="critical")},getFleetSummary:()=>{const{drones:a}=t(),r=Object.values(a);if(r.length===0)return{total:0,active:0,idle:0,issues:0,charging:0,maintenance:0,avgBattery:0,avgSignal:0};const n=r.reduce((l,o)=>{switch(l.total++,o.status){case"active":case"in_flight":l.active++;break;case"idle":l.idle++;break;case"charging":l.charging++;break;case"maintenance":case"emergency":l.maintenance++;break}return(o.batteryLevel<20||o.signalStrength<-90||o.alerts&&o.alerts.length>0)&&l.issues++,l.totalBattery+=o.batteryLevel,l.totalSignal+=o.signalStrength,l},{total:0,active:0,idle:0,issues:0,charging:0,maintenance:0,totalBattery:0,totalSignal:0});return{total:n.total,active:n.active,idle:n.idle,issues:n.issues,charging:n.charging,maintenance:n.maintenance,avgBattery:Math.round(n.totalBattery/n.total),avgSignal:Math.round(n.totalSignal/n.total)}},connect:()=>{const a=t();Y.setConnectionStateCallback((n,l)=>{a.setConnectionState(n,l==null?void 0:l.message),(n===W.ERROR||n===W.DISCONNECTED)&&setTimeout(()=>{console.log("ðŸ”§ WebSocket connection failed, using mock data for development"),B.forEach(o=>a.updateDrone(o)),va.forEach(o=>a.updateMission(o)),ya.forEach(o=>a.addAlert(o)),T.onDroneDataUpdate(o=>{a.updateDrone(o)}),T.start()},1e3)}),Y.onDroneDataUpdate(n=>{a.updateDrone(n)}),Y.onMissionDataUpdate(n=>{a.updateMission(n)}),Y.onFleetAlertReceived(n=>{a.addAlert(n)}),setInterval(()=>{const n=Y.getStatistics();a.updateStats(n)},15e3),Y.connect()},disconnect:()=>{Y.disconnect(),s({connectionState:W.DISCONNECTED,connectionError:null})},isConnected:()=>t().connectionState===W.CONNECTED})));let $e=!1;const ja=()=>{if(!$e){$e=!0;const{connect:s}=F.getState();s(),F.subscribe(t=>t.connectionState,(t,a)=>{a&&t!==a&&console.log(`Fleet store connection state: ${a} â†’ ${t}`)}),F.subscribe(t=>Object.keys(t.drones).length,(t,a)=>{a!==void 0&&t!==a&&console.log(`Fleet store drone count: ${a} â†’ ${t}`)})}},wa=()=>{const s=F(a=>a.selectedDroneId),t=F(a=>a.getDroneById);return s&&t(s)||null},Na=()=>F(s=>({state:s.connectionState,error:s.connectionError,isConnected:s.isConnected(),lastUpdate:s.lastUpdate})),ka=({drones:s,className:t="",compact:a=!1})=>{const[r,n]=i.useState(!1),l=i.useMemo(()=>{const h=[],g=[];return s.forEach(f=>{f.emergencyState&&(f.emergencyState.resolved?g.push({drone:f,emergency:f.emergencyState}):h.push({drone:f,emergency:f.emergencyState}))}),{active:h.sort((f,x)=>new Date(x.emergency.triggeredAt).getTime()-new Date(f.emergency.triggeredAt).getTime()),resolved:g.sort((f,x)=>new Date(x.emergency.resolvedAt||x.emergency.triggeredAt).getTime()-new Date(f.emergency.resolvedAt||f.emergency.triggeredAt).getTime())}},[s]),o=h=>{switch(h){case"critical_battery":return It;case"communication_loss":return ys;case"system_failure":return ve;case"collision_risk":return R;case"geofence_violation":return X;default:return R}},c=(h,g)=>{if(g==="emergency")return"#f85149";switch(h){case"critical_battery":return"#da3633";case"communication_loss":return"#d29922";case"system_failure":return"#f85149";case"collision_risk":return"#f85149";case"geofence_violation":return"#da3633";default:return"#da3633"}},u=h=>{const g=Date.now(),f=new Date(h).getTime(),x=g-f,k=Math.floor(x/6e4),y=Math.floor(k/60),d=Math.floor(y/24);return d>0?`${d}d ago`:y>0?`${y}h ago`:`${k}m ago`},p=({drone:h,emergency:g,index:f,resolved:x=!1})=>{const k=o(g.type),y=c(g.type,g.severity);return e.jsx(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:f*.1},className:`
          border-l-4 rounded-lg p-4 transition-all
          ${x?"bg-slate-800/30 border-green-500/50 opacity-75":g.severity==="emergency"?"bg-red-900/20 border-red-500 animate-pulse":"bg-amber-900/20 border-amber-500"}
        `,style:{borderLeftColor:x?"#10b981":y},children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:x?e.jsx(I,{className:"w-5 h-5 text-green-400"}):e.jsx(k,{className:"w-5 h-5",style:{color:y}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-slate-200",children:h.name}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:(x?"#10b981":y)+"20",color:x?"#10b981":y},children:x?"Resolved":g.severity.toUpperCase()}),e.jsx("span",{className:"px-2 py-1 bg-slate-700 text-slate-300 rounded text-xs",children:g.type.replace("_"," ")})]}),e.jsx("p",{className:"text-slate-300 text-sm mb-2",children:g.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"w-3 h-3"}),e.jsx("span",{children:x&&g.resolvedAt?`Resolved ${u(g.resolvedAt)}`:`Triggered ${u(g.triggeredAt)}`})]}),g.autoResponse&&e.jsxs("div",{className:"flex items-center gap-1",children:[g.autoResponse.triggered?e.jsx(oe,{className:"w-3 h-3 text-blue-400"}):e.jsx(qe,{className:"w-3 h-3 text-slate-500"}),e.jsxs("span",{className:"text-blue-400",children:["Auto: ",g.autoResponse.action.replace("_"," ")]})]}),g.operatorOverride&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{className:"text-green-400",children:["Override: ",g.operatorOverride.action]})})]})]})]}),!x&&e.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[e.jsx("button",{className:"px-2 py-1 bg-blue-900/30 text-blue-400 hover:bg-blue-900/50 rounded text-xs transition-colors",title:"Acknowledge emergency",children:"Ack"}),e.jsx("button",{className:"p-1 text-slate-400 hover:text-slate-200 transition-colors",title:"Dismiss",children:e.jsx(H,{className:"w-4 h-4"})})]})]})})};return a?e.jsxs("div",{className:`bg-slate-900 border border-slate-700 rounded-lg p-4 ${t}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-lg font-medium text-slate-200 flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5"}),"Emergencies"]}),e.jsx("div",{className:"flex items-center gap-2 text-sm",children:l.active.length>0?e.jsxs("span",{className:"bg-red-500 text-white px-2 py-1 rounded-full text-xs",children:[l.active.length," Active"]}):e.jsx("span",{className:"text-green-400",children:"All Clear"})})]}),e.jsxs("div",{className:"space-y-2",children:[l.active.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(I,{className:"w-8 h-8 mx-auto text-green-400 mb-2"}),e.jsx("p",{className:"text-sm text-slate-400",children:"No active emergencies"})]}):l.active.slice(0,3).map(({drone:h,emergency:g},f)=>e.jsx(p,{drone:h,emergency:g,index:f},g.id)),l.active.length>3&&e.jsxs("p",{className:"text-xs text-slate-500 text-center py-1",children:["+",l.active.length-3," more emergencies"]})]})]}):e.jsxs("div",{className:`bg-slate-900 border border-slate-700 rounded-lg ${t}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-700",children:[e.jsxs("h2",{className:"text-xl font-semibold text-slate-200 flex items-center gap-3",children:[e.jsx(X,{className:"w-6 h-6"}),"Emergency Management"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-400",children:[l.active.length>0?e.jsxs("span",{className:"bg-red-500 text-white px-2 py-1 rounded-full",children:[l.active.length," Active"]}):e.jsx("span",{className:"text-green-400",children:"All Clear"}),e.jsxs("span",{children:[l.resolved.length," Resolved"]})]}),e.jsx("button",{onClick:()=>n(!r),className:`p-2 rounded-lg transition-colors ${r?"bg-green-500/10 text-green-400":"bg-slate-800 text-slate-400 hover:text-slate-200"}`,title:"Toggle resolved emergencies",children:e.jsx(I,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"p-6",children:e.jsx(P,{mode:"wait",children:r?e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-slate-200 mb-4",children:["Resolved Emergencies (",l.resolved.length,")"]}),l.resolved.length===0?e.jsx("div",{className:"text-center py-8 text-slate-500",children:"No resolved emergencies"}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:l.resolved.map(({drone:h,emergency:g},f)=>e.jsx(p,{drone:h,emergency:g,index:f,resolved:!0},g.id))})]},"resolved"):e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-slate-200 mb-4",children:["Active Emergencies (",l.active.length,")"]}),l.active.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(I,{className:"w-12 h-12 mx-auto text-green-400 mb-3"}),e.jsx("h4",{className:"text-lg font-semibold text-slate-200 mb-2",children:"No Active Emergencies"}),e.jsx("p",{className:"text-slate-400",children:"All drones are operating within normal parameters"})]}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:l.active.map(({drone:h,emergency:g},f)=>e.jsx(p,{drone:h,emergency:g,index:f},g.id))})]},"active")})})]})},Sa=({className:s="",compact:t=!1})=>{const a=s.includes("bg-transparent"),[r,n]=i.useState(null),[l,o]=i.useState([]),[c,u]=i.useState(!1);i.useEffect(()=>{const d=()=>{try{const m=T.getCoordinationStatus(),S=T.getCoordinationAlerts();n(m),o(S)}catch(m){console.error("Error fetching coordination data:",m)}};d();const b=setInterval(d,5e3);return()=>clearInterval(b)},[]);const{activeAlerts:p,resolvedAlerts:h}=i.useMemo(()=>{const d=l.filter(m=>!m.resolved),b=l.filter(m=>m.resolved);return{activeAlerts:d.sort((m,S)=>new Date(S.timestamp).getTime()-new Date(m.timestamp).getTime()),resolvedAlerts:b.sort((m,S)=>new Date(S.timestamp).getTime()-new Date(m.timestamp).getTime())}},[l]),g=d=>{switch(d){case"separation_violation":return R;case"collision_warning":return R;default:return ae}},f=d=>{switch(d){case"critical":return{color:"#f85149",bg:"#f85149"};case"warning":return{color:"#d29922",bg:"#d29922"};default:return{color:"#8b949e",bg:"#8b949e"}}},x=d=>{switch(d){case"climb":return _e;case"descend":return Pe;case"turn_left":return Mt;case"turn_right":return We;case"hover":return ye;case"slow_down":return oe;default:return G}},k=d=>{const b=Date.now(),m=new Date(d).getTime(),S=b-m,j=Math.floor(S/6e4),v=Math.floor(j/60);return v>0?`${v}h ago`:`${j}m ago`},y=({alert:d,index:b,resolved:m=!1})=>{const S=g(d.type),j=f(d.severity),v=d.avoidanceAction?x(d.avoidanceAction.action):null;return e.jsx(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:b*.1},className:`
          border-l-4 rounded-lg p-4 transition-all
          ${m?"bg-slate-800/30 border-green-500/50 opacity-75":d.severity==="critical"?"bg-red-900/20 border-red-500":"bg-amber-900/20 border-amber-500"}
        `,style:{borderLeftColor:m?"#10b981":j.color},children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:m?e.jsx(I,{className:"w-5 h-5 text-green-400"}):e.jsx(S,{className:"w-5 h-5",style:{color:j.color}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-medium text-slate-200",children:d.type.replace("_"," ").toUpperCase()}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:(m?"#10b981":j.color)+"20",color:m?"#10b981":j.color},children:m?"Resolved":d.severity.toUpperCase()}),e.jsxs("span",{className:"px-2 py-1 bg-slate-700 text-slate-300 rounded text-xs",children:[d.distance.toFixed(1),"m"]})]}),e.jsx("p",{className:"text-slate-300 text-sm mb-3",children:d.message}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"Drones:"}),d.droneIds.map(M=>e.jsx("span",{className:"px-2 py-1 bg-slate-700 text-slate-300 rounded text-xs font-mono",children:M},M))]}),d.avoidanceAction&&v&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(v,{className:"w-4 h-4 text-blue-400"}),e.jsxs("span",{className:"text-sm text-blue-400",children:["Action: ",d.avoidanceAction.action.replace("_"," "),"(",d.avoidanceAction.magnitude,"Â° | m)"]}),e.jsxs("span",{className:"text-xs text-slate-400",children:["â†’ ",d.avoidanceAction.droneId]})]}),e.jsx("div",{className:"flex items-center gap-4 text-xs text-slate-400",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"w-3 h-3"}),e.jsx("span",{children:k(d.timestamp)})]})})]})]})})})};return t?e.jsxs("div",{className:`bg-slate-900 border border-slate-700 rounded-lg p-4 ${s}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-lg font-medium text-slate-200 flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5"}),"Coordination"]}),e.jsx("div",{className:"flex items-center gap-2 text-sm",children:r&&r.isActive?e.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(te,{className:"w-4 h-4"}),"Active"]}):e.jsx("span",{className:"text-slate-500",children:"Inactive"})})]}),e.jsxs("div",{className:"space-y-2",children:[r&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-400",children:"Separation"}),e.jsxs("span",{className:"text-slate-200",children:[r.separationDistance,"m"]})]}),p.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(te,{className:"w-8 h-8 mx-auto text-green-400 mb-2"}),e.jsx("p",{className:"text-sm text-slate-400",children:"No conflicts"})]}):e.jsxs("div",{className:"space-y-2",children:[p.slice(0,2).map((d,b)=>e.jsx(y,{alert:d,index:b},d.id)),p.length>2&&e.jsxs("p",{className:"text-xs text-slate-500 text-center py-1",children:["+",p.length-2," more conflicts"]})]})]})]}):e.jsxs("div",{className:a?`${s} flex flex-col h-full`:`bg-slate-900 border border-slate-700 rounded-lg ${s}`,children:[e.jsxs("div",{className:`flex items-center justify-between ${a?"p-4 border-b border-dark-border flex-shrink-0":"p-6 border-b border-slate-700"}`,children:[e.jsxs("h2",{className:`${a?"text-lg font-semibold text-text-primary":"text-xl font-semibold text-slate-200"} flex items-center gap-3`,children:[e.jsx(G,{className:`${a?"w-5 h-5":"w-6 h-6"}`}),"Fleet Coordination"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center gap-4 text-sm text-slate-400",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${r.isActive?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{children:r.isActive?"Active":"Inactive"})]}),e.jsxs("span",{children:[r.separationDistance,"m separation"]}),e.jsxs("span",{children:[p.length," active conflicts"]}),e.jsxs("span",{children:[r.resolvedConflicts," resolved"]})]}):e.jsx("span",{children:"Loading..."})}),e.jsx("button",{onClick:()=>u(!c),className:`p-2 rounded-lg transition-colors ${c?"bg-green-500/10 text-green-400":"bg-slate-800 text-slate-400 hover:text-slate-200"}`,title:"Toggle resolved conflicts",children:e.jsx(I,{className:"w-5 h-5"})}),e.jsx("button",{className:"p-2 bg-slate-800 text-slate-400 hover:text-slate-200 rounded-lg transition-colors",title:"Configuration",children:e.jsx(Kt,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:`${a?"p-4 flex-1 overflow-auto":"p-6"}`,children:e.jsx(P,{mode:"wait",children:c?e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[e.jsxs("h3",{className:`text-lg font-medium mb-4 ${a?"text-text-primary":"text-slate-200"}`,children:["Resolved Conflicts (",h.length,")"]}),h.length===0?e.jsx("div",{className:`text-center py-8 ${a?"text-text-muted":"text-slate-500"}`,children:"No resolved conflicts yet"}):e.jsx("div",{className:`space-y-3 overflow-y-auto ${a?"max-h-64":"max-h-96"}`,children:h.map((d,b)=>e.jsx(y,{alert:d,index:b,resolved:!0},d.id))})]},"resolved"):e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-slate-200 mb-4",children:["Active Coordination (",p.length,")"]}),p.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(te,{className:"w-12 h-12 mx-auto text-green-400 mb-3"}),e.jsx("h4",{className:"text-lg font-semibold text-slate-200 mb-2",children:"No Active Conflicts"}),e.jsxs("p",{className:"text-slate-400",children:["All drones maintaining safe separation (â‰¥",r==null?void 0:r.separationDistance,"m)"]})]}):e.jsx("div",{className:`space-y-3 overflow-y-auto ${a?"max-h-64":"max-h-96"}`,children:p.map((d,b)=>e.jsx(y,{alert:d,index:b},d.id))})]},"active")})})]})},Ca=({className:s="",compact:t=!1})=>{const a=s.includes("bg-transparent"),[r,n]=i.useState(null),[l,o]=i.useState([]),[c,u]=i.useState([]),[p,h]=i.useState("overview");i.useEffect(()=>{const m=()=>{try{const j=T.getChargingStats(),v=T.getChargingStations(),M=T.getChargingSchedules();n(j),o(v),u(M)}catch(j){console.error("Error fetching charging data:",j)}};m();const S=setInterval(m,5e3);return()=>clearInterval(S)},[]);const g=i.useMemo(()=>{const m=[];return c.forEach(j=>{m.push(...j.queue)}),m.filter((j,v,M)=>M.findIndex(N=>N.droneId===j.droneId)===v).sort((j,v)=>j.queuePosition-v.queuePosition)},[c]),f=m=>{switch(m){case"available":return{color:"#10b981",bg:"#10b981",icon:I};case"occupied":return{color:"#d29922",bg:"#d29922",icon:z};case"maintenance":return{color:"#da3633",bg:"#da3633",icon:Ce};case"reserved":return{color:"#1f6feb",bg:"#1f6feb",icon:U};default:return{color:"#8b949e",bg:"#8b949e",icon:ye}}},x=m=>m>=5?"text-red-400 bg-red-900/20":m>=4?"text-orange-400 bg-orange-900/20":m>=3?"text-yellow-400 bg-yellow-900/20":m>=2?"text-blue-400 bg-blue-900/20":"text-gray-400 bg-gray-900/20",k=m=>{switch(m){case"emergency":return R;case"low_battery":return z;case"pre_mission":return oe;case"maintenance":return Ce;case"scheduled":return U;default:return le}},y=m=>{if(m<60)return`${m}m`;const S=Math.floor(m/60),j=m%60;return`${S}h ${j}m`},d=({item:m,index:S})=>{const j=k(m.reason);return e.jsx(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:S*.05},className:`${a?"bg-dark-tertiary border border-dark-border":"bg-slate-800 border border-slate-600"} rounded-lg p-4`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold ${x(m.priority)}`,children:m.queuePosition})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`font-medium ${a?"text-text-primary":"text-slate-200"}`,children:m.droneName}),e.jsxs("span",{className:`text-xs font-mono ${a?"text-text-secondary":"text-slate-400"}`,children:["(",m.droneId,")"]}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${x(m.priority)}`,children:["Priority ",m.priority]})]}),e.jsxs("div",{className:`flex items-center gap-4 text-sm mb-2 ${a?"text-text-secondary":"text-slate-400"}`,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsxs("span",{children:[m.batteryLevel.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"w-4 h-4"}),e.jsxs("span",{children:["ETA: ",y(m.estimatedArrival)]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{className:"capitalize",children:m.reason.replace("_"," ")})]})]}),e.jsxs("div",{className:`text-xs ${a?"text-text-muted":"text-slate-500"}`,children:["Expected charging time: ",y(m.expectedChargingTime)," â€¢ Requested: ",new Date(m.requestedAt).toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[e.jsx("button",{onClick:()=>{console.log(`Moving ${m.droneName} up in queue`)},className:`p-1 transition-colors ${a?"text-text-muted hover:text-green-400":"text-slate-500 hover:text-green-400"}`,title:"Move up in queue",children:e.jsx(_e,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{console.log(`Moving ${m.droneName} down in queue`)},className:`p-1 transition-colors ${a?"text-text-muted hover:text-yellow-400":"text-slate-500 hover:text-yellow-400"}`,title:"Move down in queue",children:e.jsx(Pe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{T.removeDroneFromChargingQueue(m.droneId)},className:`p-1 transition-colors ${a?"text-text-muted hover:text-red-400":"text-slate-500 hover:text-red-400"}`,title:"Remove from queue",children:e.jsx(H,{className:"w-4 h-4"})})]})]})})},b=({station:m,index:S})=>{const j=f(m.status),v=j.icon;return e.jsxs(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:S*.1},className:`${a?"bg-dark-tertiary border border-dark-border":"bg-slate-800 border border-slate-600"} rounded-lg p-4`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{backgroundColor:j.bg+"20"},children:e.jsx(v,{className:"w-5 h-5",style:{color:j.color}})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-medium ${a?"text-text-primary":"text-slate-200"}`,children:m.name}),e.jsxs("p",{className:`text-xs ${a?"text-text-secondary":"text-slate-400"}`,children:["ID: ",m.id]})]})]}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium capitalize",style:{backgroundColor:j.color+"20",color:j.color},children:m.status})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:`${a?"text-text-secondary":"text-slate-400"}`,children:"Charging Rate"}),e.jsxs("div",{className:`font-mono ${a?"text-text-primary":"text-slate-200"}`,children:[m.chargingRate,"%/min"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:`${a?"text-text-secondary":"text-slate-400"}`,children:"Sessions"}),e.jsx("div",{className:`font-mono ${a?"text-text-primary":"text-slate-200"}`,children:m.totalChargingSessions})]}),e.jsxs("div",{children:[e.jsx("span",{className:`${a?"text-text-secondary":"text-slate-400"}`,children:"Avg Time"}),e.jsx("div",{className:`font-mono ${a?"text-text-primary":"text-slate-200"}`,children:y(m.averageChargingTime)})]}),e.jsxs("div",{children:[e.jsx("span",{className:`${a?"text-text-secondary":"text-slate-400"}`,children:"Time Left"}),e.jsx("div",{className:`font-mono ${a?"text-text-primary":"text-slate-200"}`,children:m.estimatedTimeRemaining?y(m.estimatedTimeRemaining):"N/A"})]})]}),m.currentDrone&&e.jsx("div",{className:"mt-3 pt-3 border-t border-slate-600",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(z,{className:"w-4 h-4 text-yellow-400"}),e.jsx("span",{className:`${a?"text-text-secondary":"text-slate-300"}`,children:"Currently charging:"}),e.jsx("span",{className:`font-mono ${a?"text-text-primary":"text-slate-200"}`,children:m.currentDrone})]})}),e.jsxs("div",{className:`mt-3 text-xs ${a?"text-text-muted":"text-slate-500"}`,children:["Last maintenance: ",new Date(m.lastMaintenance).toLocaleDateString()]})]})};return t?e.jsxs("div",{className:`${a?s:`bg-slate-900 border border-slate-700 rounded-lg p-4 ${s}`}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:`text-lg font-medium flex items-center gap-2 ${a?"text-text-primary":"text-slate-200"}`,children:[e.jsx(z,{className:"w-5 h-5"}),"Charging"]}),e.jsx("div",{className:"flex items-center gap-2 text-sm",children:r&&e.jsxs("span",{className:`${a?"text-text-secondary":"text-slate-400"}`,children:[r.occupiedStations,"/",r.totalStations," â€¢ Queue: ",r.totalInQueue]})})]}),e.jsxs("div",{className:"space-y-2",children:[r&&e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:`${a?"text-text-secondary":"text-slate-400"}`,children:"Available"}),e.jsx("div",{className:"text-green-400 font-mono",children:r.availableStations})]}),e.jsxs("div",{children:[e.jsx("span",{className:`${a?"text-text-secondary":"text-slate-400"}`,children:"In Queue"}),e.jsx("div",{className:"text-orange-400 font-mono",children:r.totalInQueue})]})]}),g.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs font-medium text-slate-300",children:"Next in queue:"}),g.slice(0,2).map(m=>e.jsxs("div",{className:"text-xs text-slate-400 flex items-center justify-between",children:[e.jsxs("span",{children:[m.queuePosition,". ",m.droneName]}),e.jsxs("span",{children:[m.batteryLevel.toFixed(0),"%"]})]},m.id))]})]})]}):e.jsxs("div",{className:a?s:`bg-slate-900 border border-slate-700 rounded-lg ${s}`,children:[e.jsxs("div",{className:`flex items-center justify-between ${a?"p-4 border-b border-dark-border":"p-6 border-b border-slate-700"}`,children:[e.jsxs("h2",{className:`${a?"text-lg font-semibold text-text-primary":"text-xl font-semibold text-slate-200"} flex items-center gap-3`,children:[e.jsx(z,{className:`${a?"w-5 h-5":"w-6 h-6"}`}),"Charging Management"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`flex items-center gap-4 text-sm ${a?"text-text-secondary":"text-slate-400"}`,children:r&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:[r.occupiedStations,"/",r.totalStations," stations busy"]}),e.jsxs("span",{children:[r.totalInQueue," in queue"]}),e.jsxs("span",{children:["Avg wait: ",y(r.averageWaitTime)]})]})}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>h("overview"),className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${p==="overview"?a?"bg-dark-tertiary text-text-primary border border-dark-border":"bg-slate-700 text-slate-200":a?"text-text-secondary hover:text-text-primary hover:bg-dark-hover":"text-slate-400 hover:text-slate-200 hover:bg-slate-800"}`,children:"Overview"}),e.jsxs("button",{onClick:()=>h("queue"),className:`px-3 py-1.5 rounded text-sm font-medium transition-colors flex items-center gap-1 ${p==="queue"?a?"bg-dark-tertiary text-text-primary border border-dark-border":"bg-slate-700 text-slate-200":a?"text-text-secondary hover:text-text-primary hover:bg-dark-hover":"text-slate-400 hover:text-slate-200 hover:bg-slate-800"}`,children:[e.jsx(le,{className:"w-4 h-4"}),"Queue",g.length>0&&e.jsx("span",{className:"bg-orange-500 text-white text-xs rounded-full px-1.5 py-0.5 min-w-[18px] text-center",children:g.length})]}),e.jsx("button",{onClick:()=>h("stations"),className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${p==="stations"?a?"bg-dark-tertiary text-text-primary border border-dark-border":"bg-slate-700 text-slate-200":a?"text-text-secondary hover:text-text-primary hover:bg-dark-hover":"text-slate-400 hover:text-slate-200 hover:bg-slate-800"}`,children:"Stations"})]})]})]}),e.jsx("div",{className:`${a?"p-4 flex-1 overflow-auto":"p-6"}`,children:e.jsxs(P,{mode:"wait",children:[p==="overview"&&r&&e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:`${a?"bg-dark-tertiary border border-dark-border":"bg-slate-800 border border-slate-600"} rounded-lg p-4`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`text-sm ${a?"text-text-secondary":"text-slate-400"}`,children:"Available Stations"}),e.jsx(I,{className:"w-5 h-5 text-green-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-400",children:r.availableStations}),e.jsxs("div",{className:`text-xs ${a?"text-text-muted":"text-slate-500"}`,children:["of ",r.totalStations," total"]})]}),e.jsxs("div",{className:`${a?"bg-dark-tertiary border border-dark-border":"bg-slate-800 border border-slate-600"} rounded-lg p-4`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`text-sm ${a?"text-text-secondary":"text-slate-400"}`,children:"Queue Length"}),e.jsx(le,{className:"w-5 h-5 text-orange-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-orange-400",children:r.totalInQueue}),e.jsx("div",{className:`text-xs ${a?"text-text-muted":"text-slate-500"}`,children:"drones waiting"})]}),e.jsxs("div",{className:`${a?"bg-dark-tertiary border border-dark-border":"bg-slate-800 border border-slate-600"} rounded-lg p-4`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`text-sm ${a?"text-text-secondary":"text-slate-400"}`,children:"Avg Wait Time"}),e.jsx(U,{className:"w-5 h-5 text-blue-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:y(r.averageWaitTime)}),e.jsx("div",{className:`text-xs ${a?"text-text-muted":"text-slate-500"}`,children:"current estimate"})]}),e.jsxs("div",{className:`${a?"bg-dark-tertiary border border-dark-border":"bg-slate-800 border border-slate-600"} rounded-lg p-4`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`text-sm ${a?"text-text-secondary":"text-slate-400"}`,children:"Daily Sessions"}),e.jsx(z,{className:"w-5 h-5 text-yellow-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:r.dailyChargingSessions}),e.jsx("div",{className:`text-xs ${a?"text-text-muted":"text-slate-500"}`,children:"completed today"})]})]}),g.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-slate-200 mb-4",children:"Next in Queue"}),e.jsx("div",{className:"grid gap-3",children:g.slice(0,3).map((m,S)=>e.jsx(d,{item:m,index:S},m.id))}),g.length>3&&e.jsx("div",{className:"text-center mt-3",children:e.jsxs("button",{onClick:()=>h("queue"),className:`text-sm hover:text-blue-300 ${a?"text-status-active":"text-blue-400"}`,children:["View all ",g.length," items in queue â†’"]})})]})]},"overview"),p==="queue"&&e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[e.jsxs("h3",{className:`text-lg font-medium ${a?"text-text-primary":"text-slate-200"}`,children:["Charging Queue (",g.length,")"]}),g.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(le,{className:`w-12 h-12 mx-auto mb-3 ${a?"text-text-muted":"text-slate-500"}`}),e.jsx("h4",{className:`text-lg font-semibold mb-2 ${a?"text-text-secondary":"text-slate-300"}`,children:"No Drones in Queue"}),e.jsx("p",{className:`${a?"text-text-muted":"text-slate-500"}`,children:"All drones are either charged or currently charging"})]}):e.jsx("div",{className:`space-y-3 ${a?"max-h-64":"max-h-96"} overflow-y-auto`,children:g.map((m,S)=>e.jsx(d,{item:m,index:S},m.id))})]},"queue"),p==="stations"&&e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[e.jsxs("h3",{className:`text-lg font-medium ${a?"text-text-primary":"text-slate-200"}`,children:["Charging Stations (",l.length,")"]}),e.jsx("div",{className:"grid gap-4 lg:grid-cols-2",children:l.map((m,S)=>e.jsx(b,{station:m,index:S},m.id))})]},"stations")]})})]})},Ma=({className:s=""})=>{const t=F(v=>Object.values(v.drones)),[a,r]=i.useState({overall:"safe",lastCheck:Date.now(),criticalAlerts:0,warningAlerts:0,activeDrones:0,dronesAtRisk:0,totalAlerts:0}),[n,l]=i.useState([]),[o,c]=i.useState(!1),[u,p]=i.useState(!1),[h,g]=i.useState("overview");i.useEffect(()=>{const v=()=>{try{const N=new WebSocket("ws://localhost:3005/safety-ws");return N.onopen=()=>{console.log("Safety WebSocket connected"),c(!0),N.send(JSON.stringify({type:"subscribe",channels:["battery_alerts","safety_alerts","emergency_alerts","all_alerts"]})),N.send(JSON.stringify({type:"get_alerts"}))},N.onmessage=C=>{try{const E=JSON.parse(C.data);f(E)}catch(E){console.error("Failed to parse safety message:",E)}},N.onclose=()=>{console.log("Safety WebSocket disconnected"),c(!1),setTimeout(v,5e3)},N.onerror=C=>{console.error("Safety WebSocket error:",C),c(!1)},N}catch(N){return console.error("Failed to initialize safety connection:",N),c(!1),null}},M=v();return()=>{M&&M.close()}},[]);const f=v=>{switch(v.type){case"battery_alert":case"safety_alert":case"emergency_alert":l(M=>[v.data,...M.slice(0,19)]);break;case"system_safety_status":r(v.data.status);break;case"alerts_data":l(v.data.alerts||[]);break;case"alert_resolved":l(M=>M.filter(N=>N.id!==v.data.alertId));break}},x=v=>{switch(v){case"safe":return"text-green-400 bg-green-900/20";case"caution":return"text-yellow-400 bg-yellow-900/20";case"warning":return"text-orange-400 bg-orange-900/20";case"critical":return"text-red-400 bg-red-900/20";default:return"text-gray-400 bg-gray-900/20"}},k=v=>{switch(v){case"safe":return e.jsx(te,{className:"w-5 h-5"});case"caution":case"warning":return e.jsx(X,{className:"w-5 h-5"});case"critical":return e.jsx(R,{className:"w-5 h-5"});default:return e.jsx(te,{className:"w-5 h-5"})}},y=v=>{if(v.type==="battery")return e.jsx(z,{className:"w-4 h-4"});switch(v.severity){case"critical":return e.jsx(R,{className:"w-4 h-4"});case"warning":return e.jsx(X,{className:"w-4 h-4"});default:return e.jsx(Rt,{className:"w-4 h-4"})}},d=v=>{switch(v){case"critical":return"text-red-400 bg-red-900/20 border-red-500/30";case"warning":return"text-orange-400 bg-orange-900/20 border-orange-500/30";case"info":return"text-blue-400 bg-blue-900/20 border-blue-500/30";default:return"text-gray-400 bg-gray-900/20 border-gray-500/30"}},b=v=>{const M=new Date(v),C=new Date().getTime()-M.getTime();return C<6e4?"Just now":C<36e5?`${Math.floor(C/6e4)}m ago`:C<864e5?`${Math.floor(C/36e5)}h ago`:M.toLocaleDateString()},m=async v=>{try{console.log(`Acknowledging alert: ${v}`),l(M=>M.map(N=>N.id===v?{...N,acknowledged:!0}:N))}catch(M){console.error("Failed to acknowledge alert:",M)}},S=async v=>{try{console.log(`Resolving alert: ${v}`),l(M=>M.filter(N=>N.id!==v))}catch(M){console.error("Failed to resolve alert:",M)}},j=u?n:n.slice(0,5);return e.jsxs("div",{className:`bg-dark-secondary rounded-lg border border-dark-border flex flex-col h-full max-h-full overflow-hidden ${s}`,children:[e.jsxs("div",{className:"p-4 border-b border-dark-border flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Safety Monitor"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${o?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-xs text-text-secondary",children:o?"Connected":"Disconnected"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3 min-w-0",children:[e.jsx("button",{onClick:()=>g("overview"),className:`px-2 py-1.5 rounded text-xs font-medium transition-colors flex-shrink-0 ${h==="overview"?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:"Overview"}),e.jsxs("button",{onClick:()=>g("emergencies"),className:`px-2 py-1.5 rounded text-xs font-medium transition-colors flex items-center gap-1 flex-shrink-0 ${h==="emergencies"?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:[e.jsx(X,{className:"w-3 h-3"}),"Emergency",t.some(v=>v.emergencyState&&!v.emergencyState.resolved)&&e.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full px-1.5 py-0.5 min-w-[18px] text-center",children:t.filter(v=>v.emergencyState&&!v.emergencyState.resolved).length})]}),e.jsxs("button",{onClick:()=>g("coordination"),className:`px-2 py-1.5 rounded text-xs font-medium transition-colors flex items-center gap-1 flex-shrink-0 ${h==="coordination"?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:[e.jsx(G,{className:"w-3 h-3"}),"Coord"]}),e.jsxs("button",{onClick:()=>g("charging"),className:`px-2 py-1.5 rounded text-xs font-medium transition-colors flex items-center gap-1 flex-shrink-0 ${h==="charging"?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:[e.jsx(z,{className:"w-3 h-3"}),"Charge",t.filter(v=>v.status==="charging").length>0&&e.jsx("span",{className:"bg-yellow-500 text-white text-xs rounded-full px-1.5 py-0.5 min-w-[18px] text-center",children:t.filter(v=>v.status==="charging").length})]})]}),e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border ${x(a.overall)}`,children:[k(a.overall),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium capitalize",children:["System Status: ",a.overall]}),e.jsx("div",{className:"text-sm opacity-80",children:a.dronesAtRisk>0?`${a.dronesAtRisk} drone${a.dronesAtRisk>1?"s":""} at risk`:"All drones operating safely"})]}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:[a.totalAlerts," alerts"]}),e.jsxs("div",{className:"opacity-70",children:[a.criticalAlerts," critical"]})]})]})]}),e.jsx("div",{className:"p-4 border-b border-dark-border flex-shrink-0",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:a.activeDrones}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Active Drones"})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:a.criticalAlerts}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Critical Alerts"})]})]})}),e.jsx("div",{className:"flex-1 min-h-0 overflow-auto",children:h==="overview"?e.jsxs("div",{className:"flex flex-col min-h-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 pb-2 flex-shrink-0",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:"Recent Alerts"}),n.length>5&&e.jsx("button",{onClick:()=>p(!u),className:"text-xs text-status-active hover:text-status-active/80 transition-colors",children:u?"Show Less":`Show All (${n.length})`})]}),e.jsx("div",{className:"flex-1 px-4 pb-4 space-y-2 overflow-y-auto",children:e.jsx(P,{children:j.length>0?j.map(v=>e.jsx(D.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},className:`p-3 rounded-lg border ${d(v.severity)}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[y(v),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-medium uppercase tracking-wide",children:v.type.replace("_"," ")}),v.droneId&&e.jsx("span",{className:"text-xs text-text-secondary",children:v.droneId}),e.jsx("span",{className:"text-xs text-text-secondary ml-auto",children:b(v.timestamp)})]}),e.jsx("div",{className:"text-sm text-text-primary mb-2",children:v.message}),v.type==="battery"&&v.data&&e.jsxs("div",{className:"text-xs text-text-secondary mb-2",children:["Battery: ",v.data.batteryLevel,"%",v.data.batteryVoltage&&` (${v.data.batteryVoltage}V)`]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!v.acknowledged&&e.jsxs("button",{onClick:()=>m(v.id),className:"flex items-center gap-1 text-xs text-status-active hover:text-status-active/80 transition-colors",children:[e.jsx(I,{className:"w-3 h-3"}),"Acknowledge"]}),v.acknowledged&&!v.resolved&&e.jsxs("button",{onClick:()=>S(v.id),className:"flex items-center gap-1 text-xs text-green-400 hover:text-green-300 transition-colors",children:[e.jsx(Q,{className:"w-3 h-3"}),"Resolve"]}),v.acknowledged&&e.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-400",children:[e.jsx(I,{className:"w-3 h-3"}),"Acknowledged"]})]})]})]})},v.id)):e.jsxs("div",{className:"text-center py-8 text-text-secondary",children:[e.jsx(te,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("div",{className:"text-sm",children:"No active safety alerts"}),e.jsx("div",{className:"text-xs opacity-70 mt-1",children:"All systems operating normally"})]})})})]}):h==="emergencies"?e.jsx("div",{className:"h-full overflow-auto",children:e.jsx(ka,{drones:t,className:"h-full border-0 bg-transparent"})}):h==="coordination"?e.jsx("div",{className:"h-full overflow-auto",children:e.jsx(Sa,{className:"h-full border-0 bg-transparent"})}):e.jsx("div",{className:"h-full overflow-auto",children:e.jsx(Ca,{className:"h-full border-0 bg-transparent"})})}),e.jsx("div",{className:"px-4 py-2 border-t border-dark-border flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-1 text-xs text-text-secondary",children:[e.jsx(U,{className:"w-3 h-3"}),"Last update: ",b(new Date(a.lastCheck).toISOString())]})})]})},Da=({children:s,minHeight:t=200,maxHeight:a=800,initialHeight:r=400,onHeightChange:n,className:l="",disabled:o=!1})=>{const[c,u]=i.useState(r),[p,h]=i.useState(!1),g=i.useRef(null),f=i.useRef(0),x=i.useRef(0),k=i.useCallback(m=>{o||(m.preventDefault(),h(!0),f.current=m.clientY,x.current=c,document.body.style.cursor="ns-resize",document.body.style.userSelect="none")},[c,o]),y=i.useCallback(m=>{if(!p)return;const S=m.clientY-f.current,j=Math.min(Math.max(x.current+S,t),a);u(j),n==null||n(j)},[p,t,a,n]),d=i.useCallback(()=>{p&&(h(!1),document.body.style.cursor="",document.body.style.userSelect="")},[p]),b=i.useCallback(m=>{if(o)return;const S=m.shiftKey?50:10;let j=c;m.key==="ArrowUp"?(m.preventDefault(),j=Math.max(c-S,t)):m.key==="ArrowDown"?(m.preventDefault(),j=Math.min(c+S,a)):m.key==="Home"?(m.preventDefault(),j=t):m.key==="End"&&(m.preventDefault(),j=a),j!==c&&(u(j),n==null||n(j))},[c,t,a,o,n]);return i.useEffect(()=>{if(p)return document.addEventListener("mousemove",y),document.addEventListener("mouseup",d),()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",d)}},[p,y,d]),e.jsxs("div",{ref:g,className:`relative border border-dark-border rounded-lg bg-dark-secondary overflow-hidden ${l}`,style:{height:`${c}px`},children:[e.jsx("div",{className:"h-full w-full",children:s}),!o&&e.jsxs("div",{className:`
            absolute bottom-0 left-0 right-0 h-3 cursor-ns-resize
            hover:bg-status-active/20 transition-all duration-200
            ${p?"bg-status-active/30":"bg-transparent hover:bg-dark-hover/50"}
            group flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-status-active/50
          `,onMouseDown:k,onKeyDown:b,tabIndex:0,role:"separator","aria-orientation":"horizontal","aria-label":`Resize panel. Current height: ${c}px. Range: ${t}px to ${a}px. Use arrow keys to adjust, Shift+arrows for larger steps.`,title:`Drag to resize panel (${t}px - ${a}px). Keyboard: â†‘â†“ arrows, Shift+arrows for 50px steps, Home/End for min/max`,children:[e.jsx("div",{className:`
            w-12 h-1 rounded-full transition-all duration-200
            ${p?"bg-status-active shadow-lg":"bg-text-muted/40 group-hover:bg-status-active/70 group-hover:w-16"}
          `}),p&&e.jsxs("div",{className:`absolute -top-8 left-1/2 transform -translate-x-1/2 
                          bg-dark-tertiary text-text-primary text-xs px-2 py-1 rounded 
                          border border-dark-border shadow-lg whitespace-nowrap`,children:[c,"px"]})]})]})},et=({waypoints:s,onWaypointsChange:t,disabled:a=!1,className:r=""})=>{const[n,l]=i.useState(null),[o,c]=i.useState(!1),[u,p]=i.useState({position:{lat:37.7749,lng:-122.4194,alt:50},action:"navigation",hoverTime:0,notes:""}),h=[{value:"navigation",label:"Navigate",icon:"ðŸ§­",description:"Fly to location"},{value:"pickup",label:"Pickup",icon:"ðŸ“¦",description:"Pickup item"},{value:"delivery",label:"Delivery",icon:"ðŸšš",description:"Deliver item"},{value:"hover",label:"Hover",icon:"ðŸš",description:"Hover in place"},{value:"survey",label:"Survey",icon:"ðŸ”",description:"Survey area"},{value:"landing",label:"Land",icon:"ðŸ›¬",description:"Land drone"},{value:"takeoff",label:"Takeoff",icon:"ðŸ›«",description:"Takeoff drone"}],g=()=>{p({position:{lat:37.7749,lng:-122.4194,alt:50},action:"navigation",hoverTime:0,notes:""})},f=()=>{if(!u.position.lat||!u.position.lng)return;const j={id:`waypoint-${Date.now()}`,position:u.position,action:u.action,hoverTime:u.hoverTime||0,notes:u.notes||"",completed:!1};t([...s,j]),g(),c(!1)},x=j=>{const v=s[j];p({position:v.position,action:v.action,hoverTime:v.hoverTime,notes:v.notes}),l(j)},k=()=>{if(n===null)return;const j=[...s];j[n]={...j[n],position:u.position,action:u.action,hoverTime:u.hoverTime||0,notes:u.notes||""},t(j),l(null),g()},y=()=>{l(null),c(!1),g()},d=j=>{const v=s.filter((M,N)=>N!==j);t(v)},b=(j,v)=>{if(v==="up"&&j===0||v==="down"&&j===s.length-1)return;const M=[...s],N=v==="up"?j-1:j+1;[M[j],M[N]]=[M[N],M[j]],t(M)},m=j=>h.find(v=>v.value===j)||h[0],S=(j,v)=>{const N=j.lat*Math.PI/180,C=v.lat*Math.PI/180,E=(v.lat-j.lat)*Math.PI/180,w=(v.lng-j.lng)*Math.PI/180,$=Math.sin(E/2)*Math.sin(E/2)+Math.cos(N)*Math.cos(C)*Math.sin(w/2)*Math.sin(w/2),A=2*Math.atan2(Math.sqrt($),Math.sqrt(1-$));return Math.round(6371e3*A)};return e.jsxs("div",{className:`space-y-4 ${r}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Waypoints"}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[s.length," waypoint",s.length!==1?"s":"",s.length>1&&e.jsxs("span",{className:"ml-2",children:["Total distance: ~",s.reduce((j,v,M)=>M===0?j:j+S(s[M-1].position,v.position),0),"m"]})]})]}),!a&&e.jsxs("button",{onClick:()=>c(!0),disabled:o||n!==null,className:`flex items-center gap-2 px-3 py-2 bg-status-active hover:bg-status-active/80 
                     text-white rounded-lg text-sm font-medium transition-colors
                     disabled:opacity-50 disabled:cursor-not-allowed`,children:[e.jsx(re,{className:"w-4 h-4"}),"Add Waypoint"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(P,{children:s.map((j,v)=>e.jsx(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-dark-tertiary rounded-lg border border-dark-border",children:n===v?e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(Ae,{data:u,onChange:p,actionOptions:h}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs("button",{onClick:y,className:`flex items-center gap-1 px-3 py-2 text-text-secondary hover:text-text-primary 
                               transition-colors text-sm`,children:[e.jsx(H,{className:"w-4 h-4"}),"Cancel"]}),e.jsxs("button",{onClick:k,className:`flex items-center gap-1 px-3 py-2 bg-status-active hover:bg-status-active/80 
                               text-white rounded transition-colors text-sm`,children:[e.jsx(Ue,{className:"w-4 h-4"}),"Save"]})]})]}):e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-lg",children:m(j.action).icon}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-text-primary",children:[v+1,". ",m(j.action).label]}),e.jsx("p",{className:"text-sm text-text-secondary",children:m(j.action).description})]}),j.completed&&e.jsx("span",{className:`px-2 py-1 bg-status-operational/20 text-status-operational 
                                         text-xs font-medium rounded-full`,children:"âœ“ Completed"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Position:"}),e.jsxs("div",{className:"font-mono text-text-primary",children:[j.position.lat.toFixed(6),", ",j.position.lng.toFixed(6)]}),e.jsxs("div",{className:"font-mono text-text-secondary",children:["Alt: ",j.position.alt,"m"]})]}),e.jsxs("div",{children:[j.action==="hover"&&j.hoverTime&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Hover Time:"}),e.jsxs("div",{className:"text-text-primary",children:[j.hoverTime,"s"]})]}),v>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Distance:"}),e.jsxs("div",{className:"text-text-primary",children:["~",S(s[v-1].position,j.position),"m"]})]})]})]}),j.notes&&e.jsxs("div",{className:"mt-2 p-2 bg-dark-hover rounded text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:"Notes:"}),e.jsx("div",{className:"text-text-primary mt-1",children:j.notes})]})]}),!a&&!j.completed&&e.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[e.jsx("button",{onClick:()=>b(v,"up"),disabled:v===0,className:`p-1 text-text-secondary hover:text-text-primary transition-colors
                                   disabled:opacity-30 disabled:cursor-not-allowed`,title:"Move up",children:e.jsx(Ht,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>b(v,"down"),disabled:v===s.length-1,className:`p-1 text-text-secondary hover:text-text-primary transition-colors
                                   disabled:opacity-30 disabled:cursor-not-allowed`,title:"Move down",children:e.jsx(Bt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>x(v),disabled:n!==null||o,className:`p-1 text-text-secondary hover:text-status-warning transition-colors
                                   disabled:opacity-30 disabled:cursor-not-allowed`,title:"Edit waypoint",children:e.jsx(Qe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>d(v),disabled:n!==null||o,className:`p-1 text-text-secondary hover:text-status-critical transition-colors
                                   disabled:opacity-30 disabled:cursor-not-allowed`,title:"Delete waypoint",children:e.jsx(ze,{className:"w-4 h-4"})})]})]})})},j.id||v))}),e.jsx(P,{children:o&&e.jsxs(D.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-dark-tertiary rounded-lg border border-dark-border p-4",children:[e.jsxs("h4",{className:"text-text-primary font-medium mb-4 flex items-center gap-2",children:[e.jsx(ae,{className:"w-5 h-5"}),"Add New Waypoint"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ae,{data:u,onChange:p,actionOptions:h}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs("button",{onClick:y,className:`flex items-center gap-1 px-3 py-2 text-text-secondary hover:text-text-primary 
                             transition-colors text-sm`,children:[e.jsx(H,{className:"w-4 h-4"}),"Cancel"]}),e.jsxs("button",{onClick:f,disabled:!u.position.lat||!u.position.lng,className:`flex items-center gap-1 px-3 py-2 bg-status-active hover:bg-status-active/80 
                             text-white rounded transition-colors text-sm
                             disabled:opacity-50 disabled:cursor-not-allowed`,children:[e.jsx(re,{className:"w-4 h-4"}),"Add Waypoint"]})]})]})]})})]}),s.length===0&&e.jsxs("div",{className:"text-center py-8 text-text-secondary",children:[e.jsx(ae,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("h4",{className:"text-lg font-medium mb-2",children:"No waypoints added"}),e.jsx("p",{className:"text-sm mb-4",children:"Add waypoints to define the mission route"}),!a&&e.jsx("button",{onClick:()=>c(!0),className:`px-4 py-2 bg-status-active hover:bg-status-active/80 text-white rounded-lg
                       transition-colors text-sm font-medium`,children:"Add First Waypoint"})]})]})},Ae=({data:s,onChange:t,actionOptions:a})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Position"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("input",{type:"number",step:"0.000001",placeholder:"Latitude",value:s.position.lat,onChange:r=>t({...s,position:{...s.position,lat:parseFloat(r.target.value)||0}}),className:`w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm
                       text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active`}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Latitude"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",step:"0.000001",placeholder:"Longitude",value:s.position.lng,onChange:r=>t({...s,position:{...s.position,lng:parseFloat(r.target.value)||0}}),className:`w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm
                       text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active`}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Longitude"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",min:"0",max:"1000",placeholder:"Altitude",value:s.position.alt,onChange:r=>t({...s,position:{...s.position,alt:parseInt(r.target.value)||0}}),className:`w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm
                       text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active`}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Altitude (m)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Action"}),e.jsx("select",{value:s.action,onChange:r=>t({...s,action:r.target.value}),className:`w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm
                   text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active`,children:a.map(r=>e.jsxs("option",{value:r.value,children:[r.icon," ",r.label," - ",r.description]},r.value))})]}),s.action==="hover"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Hover Time (seconds)"}),e.jsx("input",{type:"number",min:"1",max:"3600",value:s.hoverTime||0,onChange:r=>t({...s,hoverTime:parseInt(r.target.value)||0}),className:`w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm
                     text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Notes (optional)"}),e.jsx("textarea",{rows:2,placeholder:"Additional notes about this waypoint...",value:s.notes||"",onChange:r=>t({...s,notes:r.target.value}),className:`w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm
                   text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active
                   resize-none`})]})]}),ie="http://localhost:3001/api",$a="ws://localhost:3001/ws";let _=null,ce=0;const Aa=5,O=Ke()(Xe((s,t)=>({missions:{},activeMissions:[],selectedMissionId:null,missionStats:null,wsConnected:!1,wsError:null,lastUpdate:null,loading:!1,creating:!1,updating:!1,deleting:!1,setMissions:a=>{const r={};a.forEach(n=>{r[n.id]=n}),s({missions:r,lastUpdate:new Date().toISOString()})},setActiveMissions:a=>s({activeMissions:a}),setMissionStats:a=>s({missionStats:a}),selectMission:a=>s({selectedMissionId:a}),createMission:async a=>{s({creating:!0});try{const r=await fetch(`${ie}/missions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!r.ok){const o=await r.json();throw new Error(o.message||"Failed to create mission")}const l=(await r.json()).data;return s(o=>({missions:{...o.missions,[l.id]:l},creating:!1,lastUpdate:new Date().toISOString()})),l}catch(r){throw s({creating:!1}),r}},updateMission:async(a,r)=>{s({updating:!0});try{const n=await fetch(`${ie}/missions/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){const c=await n.json();throw new Error(c.message||"Failed to update mission")}const o=(await n.json()).data;return s(c=>({missions:{...c.missions,[a]:o},updating:!1,lastUpdate:new Date().toISOString()})),o}catch(n){throw s({updating:!1}),n}},deleteMission:async a=>{s({deleting:!0});try{const r=await fetch(`${ie}/missions/${a}`,{method:"DELETE"});if(!r.ok){const n=await r.json();throw new Error(n.message||"Failed to delete mission")}s(n=>{const{[a]:l,...o}=n.missions;return{missions:o,selectedMissionId:n.selectedMissionId===a?null:n.selectedMissionId,activeMissions:n.activeMissions.filter(c=>c.id!==a),deleting:!1,lastUpdate:new Date().toISOString()}})}catch(r){throw s({deleting:!1}),r}},assignMissionToDrone:async(a,r)=>{try{const n=await fetch(`${ie}/missions/${a}/assign`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({droneId:r})});if(!n.ok){const c=await n.json();throw new Error(c.message||"Failed to assign mission")}const o=(await n.json()).data;s(c=>({missions:{...c.missions,[a]:o},lastUpdate:new Date().toISOString()}))}catch(n){throw n}},updateMissionProgress:async(a,r,n)=>{try{const l=await fetch(`${ie}/missions/${a}/progress`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({progress:r,currentWaypoint:n})});if(!l.ok){const o=await l.json();throw new Error(o.message||"Failed to update progress")}s(o=>{const c=o.missions[a];return c?{missions:{...o.missions,[a]:{...c,progress:r,currentWaypoint:n??c.currentWaypoint}},lastUpdate:new Date().toISOString()}:o})}catch(l){throw l}},setWsConnected:a=>s({wsConnected:a}),setWsError:a=>s({wsError:a}),handleMissionEvent:(a,r)=>{const n=t();switch(a){case"mission_created":s({missions:{...n.missions,[r.id]:r},lastUpdate:new Date().toISOString()});break;case"mission_updated":s({missions:{...n.missions,[r.id]:r},lastUpdate:new Date().toISOString()});break;case"mission_deleted":const{[r.id]:l,...o}=n.missions;s({missions:o,selectedMissionId:n.selectedMissionId===r.id?null:n.selectedMissionId,activeMissions:n.activeMissions.filter(u=>u.id!==r.id),lastUpdate:new Date().toISOString()});break;case"mission_assigned":n.missions[r.missionId]&&s({missions:{...n.missions,[r.missionId]:r.mission},lastUpdate:new Date().toISOString()});break;case"mission_progress":const c=n.missions[r.missionId];c&&s({missions:{...n.missions,[r.missionId]:{...c,progress:r.progress,currentWaypoint:r.currentWaypoint,status:r.status||c.status}},lastUpdate:new Date().toISOString()});break;default:console.log("Unknown mission event:",a,r)}},getMissionById:a=>t().missions[a],getMissionsByDrone:a=>Object.values(t().missions).filter(n=>n.assignedDrone===a),getMissionsByStatus:a=>Object.values(t().missions).filter(n=>n.status===a),clearMissions:()=>s({missions:{},activeMissions:[],selectedMissionId:null,missionStats:null,lastUpdate:null})}))),tt=()=>{if((_==null?void 0:_.readyState)!==WebSocket.OPEN)try{_=new WebSocket($a),_.onopen=()=>{console.log("Mission WebSocket connected"),O.getState().setWsConnected(!0),O.getState().setWsError(null),ce=0,_==null||_.send(JSON.stringify({type:"subscribe_missions",requestId:`sub-${Date.now()}`}))},_.onmessage=s=>{try{const t=JSON.parse(s.data),{type:a,data:r}=t;switch((a.startsWith("mission_")||a.startsWith("waypoint_"))&&O.getState().handleMissionEvent(a,r),a){case"mission_stats":O.getState().setMissionStats(r);break;case"active_missions":O.getState().setActiveMissions(r);break;default:console.log("Mission WebSocket message:",a,r)}}catch(t){console.error("Error parsing WebSocket message:",t)}},_.onclose=s=>{console.log("Mission WebSocket disconnected:",s.code,s.reason),O.getState().setWsConnected(!1),ce<Aa&&(ce++,setTimeout(tt,2e3*ce))},_.onerror=s=>{console.error("Mission WebSocket error:",s),O.getState().setWsError("WebSocket connection error")}}catch(s){console.error("Failed to create WebSocket connection:",s),O.getState().setWsError("Failed to connect to mission service")}},Ea=()=>{tt()},La=()=>{const{selectedMissionId:s,missions:t}=O();return s?t[s]:null},ge=({isOpen:s,onClose:t,onMissionCreated:a})=>{const{createMission:r,creating:n}=O(),[l,o]=i.useState({name:"",description:"",priority:5,waypoints:[]}),[c,u]=i.useState(null),p=[{value:1,label:"Very Low",color:"text-gray-400"},{value:2,label:"Low",color:"text-blue-400"},{value:3,label:"Low-Medium",color:"text-blue-300"},{value:4,label:"Medium-Low",color:"text-yellow-400"},{value:5,label:"Medium",color:"text-yellow-300"},{value:6,label:"Medium-High",color:"text-orange-400"},{value:7,label:"High",color:"text-orange-300"},{value:8,label:"High-Critical",color:"text-red-400"},{value:9,label:"Critical",color:"text-red-300"},{value:10,label:"Emergency",color:"text-red-200"}],h=()=>{o({name:"",description:"",priority:5,waypoints:[]}),u(null)},g=()=>{h(),t()},f=()=>{if(!l.name.trim())return u("Mission name is required"),!1;if(l.name.length>100)return u("Mission name must be less than 100 characters"),!1;if(l.waypoints.length===0)return u("At least one waypoint is required"),!1;if(l.waypoints.length>50)return u("Maximum 50 waypoints allowed"),!1;for(let b=0;b<l.waypoints.length;b++){const m=l.waypoints[b];if(!m.position.lat||!m.position.lng)return u(`Waypoint ${b+1}: Invalid coordinates`),!1;if(Math.abs(m.position.lat)>90)return u(`Waypoint ${b+1}: Invalid latitude (must be -90 to 90)`),!1;if(Math.abs(m.position.lng)>180)return u(`Waypoint ${b+1}: Invalid longitude (must be -180 to 180)`),!1;if(m.position.alt<0||m.position.alt>1e3)return u(`Waypoint ${b+1}: Invalid altitude (must be 0-1000m)`),!1;if(m.action==="hover"&&(!m.hoverTime||m.hoverTime<=0))return u(`Waypoint ${b+1}: Hover time required for hover action`),!1}return!0},x=async b=>{if(b.preventDefault(),u(null),!!f())try{const m=await r({name:l.name.trim(),description:l.description.trim(),priority:l.priority,waypoints:l.waypoints.map((S,j)=>({...S,sequence:j})),status:"pending"});a==null||a(m),g()}catch(m){u(m.message||"Failed to create mission")}},k=b=>p.find(m=>m.value===b)||p[4],y=()=>{if(l.waypoints.length<2)return 0;let b=0;const m=10;for(let S=1;S<l.waypoints.length;S++){const j=l.waypoints[S-1],v=l.waypoints[S],M=6371e3,N=j.position.lat*Math.PI/180,C=v.position.lat*Math.PI/180,E=(v.position.lat-j.position.lat)*Math.PI/180,w=(v.position.lng-j.position.lng)*Math.PI/180,$=Math.sin(E/2)*Math.sin(E/2)+Math.cos(N)*Math.cos(C)*Math.sin(w/2)*Math.sin(w/2),A=2*Math.atan2(Math.sqrt($),Math.sqrt(1-$)),Z=M*A;b+=Z/m,v.hoverTime&&(b+=v.hoverTime)}return Math.round(b)},d=b=>{const m=Math.floor(b/3600),S=Math.floor(b%3600/60),j=b%60;return m>0?`${m}h ${S}m ${j}s`:S>0?`${S}m ${j}s`:`${j}s`};return s?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[10001] p-4",children:e.jsxs(D.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:`bg-dark-secondary rounded-lg border border-dark-border shadow-xl
                   w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden`,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{className:"w-6 h-6 text-status-active"}),e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Create New Mission"})]}),e.jsx("button",{onClick:g,className:"p-2 hover:bg-dark-hover rounded-lg transition-colors",children:e.jsx(H,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsxs("form",{onSubmit:x,className:"flex flex-col flex-1 min-h-0",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 scrollbar-thin scrollbar-thumb-dark-border scrollbar-track-transparent",children:[c&&e.jsxs("div",{className:`flex items-center gap-2 p-3 bg-status-critical/10 border border-status-critical/20 
                            rounded-lg text-status-critical`,children:[e.jsx(R,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:c})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-text-primary",children:"Mission Details"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Mission Name *"}),e.jsx("input",{type:"text",required:!0,maxLength:100,placeholder:"e.g., Emergency Medical Delivery",value:l.name,onChange:b=>o({...l,name:b.target.value}),className:`w-full px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg
                             text-text-primary placeholder-text-secondary focus:outline-none 
                             focus:ring-2 focus:ring-status-active`}),e.jsxs("div",{className:"text-xs text-text-secondary mt-1",children:[l.name.length,"/100 characters"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Description"}),e.jsx("textarea",{rows:3,maxLength:1e3,placeholder:"Describe the mission objectives and requirements...",value:l.description,onChange:b=>o({...l,description:b.target.value}),className:`w-full px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg
                             text-text-primary placeholder-text-secondary focus:outline-none 
                             focus:ring-2 focus:ring-status-active resize-none`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Priority"}),e.jsx("select",{value:l.priority,onChange:b=>o({...l,priority:parseInt(b.target.value)}),className:`w-full px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg
                             text-text-primary focus:outline-none focus:ring-2 focus:ring-status-active`,children:p.map(b=>e.jsxs("option",{value:b.value,className:"bg-dark-tertiary",children:[b.value," - ",b.label]},b.value))}),e.jsx("div",{className:`text-xs mt-1 ${k(l.priority).color}`,children:k(l.priority).label})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-text-primary",children:"Mission Summary"}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Waypoints:"}),e.jsx("div",{className:"text-text-primary font-medium",children:l.waypoints.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Priority:"}),e.jsx("div",{className:`font-medium ${k(l.priority).color}`,children:k(l.priority).label})]})]}),l.waypoints.length>1&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:"Estimated Duration:"}),e.jsx("div",{className:"text-text-primary font-medium",children:d(y())})]}),e.jsxs("div",{className:"text-xs text-text-secondary",children:["Status: ",e.jsx("span",{className:"text-status-warning",children:"Pending Assignment"})]})]})]})]}),e.jsx("div",{children:e.jsx(et,{waypoints:l.waypoints,onWaypointsChange:b=>{o({...l,waypoints:b}),u(null)}})})]}),e.jsxs("div",{className:"flex-shrink-0 flex items-center justify-between p-6 border-t border-dark-border bg-dark-tertiary",children:[e.jsx("div",{className:"text-sm text-text-secondary",children:l.waypoints.length>0?e.jsxs("span",{children:["Mission ready to create with ",l.waypoints.length," waypoints"]}):e.jsx("span",{children:"Add waypoints to define the mission route"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:g,disabled:n,className:`px-4 py-2 text-text-secondary hover:text-text-primary transition-colors
                         disabled:opacity-50 disabled:cursor-not-allowed`,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:n||!l.name.trim()||l.waypoints.length===0,className:`flex items-center gap-2 px-6 py-2 bg-status-active hover:bg-status-active/80 
                         text-white rounded-lg font-medium transition-colors
                         disabled:opacity-50 disabled:cursor-not-allowed`,children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"w-4 h-4"}),"Create Mission"]})})]})]})]})]})}):null},st=({mission:s,isOpen:t,onClose:a,onAssigned:r})=>{var M;const n=F(N=>Object.values(N.drones)),{assignMissionToDrone:l,missions:o}=O(),[c,u]=i.useState(null),[p,h]=i.useState(!1),[g,f]=i.useState([]);i.useEffect(()=>{t&&x()},[t,s,n]);const x=()=>{const N=n.map(C=>{const E=[],w=[];let $=100;(C.status==="maintenance"||C.status==="emergency")&&(E.push(`Drone is in ${C.status} mode`),$-=100),C.status==="charging"&&(w.push("Drone is currently charging"),$-=20),C.batteryLevel<30?(E.push(`Low battery: ${C.batteryLevel}%`),$-=50):C.batteryLevel<50&&(w.push(`Medium battery: ${C.batteryLevel}%`),$-=20),C.signalStrength<50&&(w.push(`Weak signal: ${C.signalStrength}%`),$-=10);const A=Object.values(o).find(J=>J.assignedDrone===C.id&&["pending","active","paused"].includes(J.status));if(A&&(E.push(`Already assigned to: ${A.name}`),$-=80),s.waypoints&&s.waypoints.length>0){const J=s.waypoints[0],xe=k(C.position,J.position);xe>5e4&&(w.push(`Far from start: ${(xe/1e3).toFixed(1)}km`),$-=15)}s.priority>=8&&($+=10),C.totalFlightTime&&C.totalFlightTime>3600&&(w.push("Drone has been flying for extended time"),$-=5);const Z=$>0&&E.length===0;return{drone:C,compatible:Z,score:Math.max(0,$),issues:E,warnings:w}});N.sort((C,E)=>E.score-C.score),f(N)},k=(N,C)=>{const w=N.lat*Math.PI/180,$=C.lat*Math.PI/180,A=(C.lat-N.lat)*Math.PI/180,Z=(C.lng-N.lng)*Math.PI/180,J=Math.sin(A/2)*Math.sin(A/2)+Math.cos(w)*Math.cos($)*Math.sin(Z/2)*Math.sin(Z/2);return 6371e3*(2*Math.atan2(Math.sqrt(J),Math.sqrt(1-J)))},y=N=>{switch(N){case"active":case"in_flight":return"text-status-operational bg-status-operational/10";case"idle":return"text-status-active bg-status-active/10";case"charging":return"text-status-warning bg-status-warning/10";case"maintenance":case"emergency":return"text-status-critical bg-status-critical/10";default:return"text-text-secondary bg-text-secondary/10"}},d=N=>N>70?"text-status-operational":N>30?"text-status-warning":"text-status-critical",b=N=>N.compatible?N.score>=80?e.jsx(I,{className:"w-5 h-5 text-status-operational"}):N.score>=60?e.jsx(U,{className:"w-5 h-5 text-status-warning"}):e.jsx(R,{className:"w-5 h-5 text-status-warning"}):e.jsx(Q,{className:"w-5 h-5 text-status-critical"}),m=async()=>{if(c){h(!0);try{await l(s.id,c),r==null||r(s.id,c),a()}catch(N){console.error("Failed to assign mission:",N)}finally{h(!1)}}},S=N=>{if(!s.waypoints||s.waypoints.length===0)return null;const C=10;let E=0,w=N.drone.position;const $=k(w,s.waypoints[0].position);E+=$/C;for(let A=1;A<s.waypoints.length;A++){const Z=k(s.waypoints[A-1].position,s.waypoints[A].position);E+=Z/C,s.waypoints[A].hoverTime&&(E+=s.waypoints[A].hoverTime)}return E},j=N=>{const C=Math.floor(N/3600),E=Math.floor(N%3600/60);return C>0?`${C}h ${E}m`:`${E}m`};if(!t)return null;const v=g.find(N=>N.drone.id===c);return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[10001] p-4",children:e.jsxs(D.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:`bg-dark-secondary rounded-lg border border-dark-border shadow-xl
                   w-full max-w-4xl max-h-[90vh] overflow-hidden`,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Assign Mission to Drone"}),e.jsxs("p",{className:"text-text-secondary mt-1",children:["Mission: ",e.jsx("span",{className:"font-medium",children:s.name})]})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-dark-hover rounded-lg transition-colors",children:e.jsx(Q,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-1/2 border-r border-dark-border",children:[e.jsxs("div",{className:"p-4 border-b border-dark-border",children:[e.jsxs("h3",{className:"font-medium text-text-primary",children:["Available Drones (",g.length,")"]}),e.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Select a drone to assign this mission"})]}),e.jsx("div",{className:"overflow-y-auto max-h-[60vh] p-4 space-y-3",children:g.map(N=>e.jsxs(D.div,{className:`p-4 rounded-lg border cursor-pointer transition-all
                    ${c===N.drone.id?"border-status-active bg-status-active/5":"border-dark-border hover:border-dark-hover bg-dark-tertiary hover:bg-dark-hover"}
                    ${N.compatible?"":"opacity-50"}
                  `,onClick:()=>N.compatible&&u(N.drone.id),whileHover:N.compatible?{scale:1.02}:{},whileTap:N.compatible?{scale:.98}:{},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[b(N),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:N.drone.name}),e.jsx("p",{className:"text-sm text-text-secondary",children:N.drone.id})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${y(N.drone.status)}`,children:N.drone.status.toUpperCase()}),e.jsxs("div",{className:"text-sm font-medium text-text-primary",children:["Score: ",N.score,"/100"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:`w-4 h-4 ${d(N.drone.batteryLevel)}`}),e.jsxs("span",{className:d(N.drone.batteryLevel),children:[N.drone.batteryLevel,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(be,{className:"w-4 h-4 text-text-secondary"}),e.jsxs("span",{className:"text-text-primary",children:[N.drone.signalStrength,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ae,{className:"w-4 h-4 text-text-secondary"}),e.jsxs("span",{className:"text-text-primary text-xs",children:[N.drone.position.lat.toFixed(3),", ",N.drone.position.lng.toFixed(3)]})]})]}),N.issues.length>0&&e.jsx("div",{className:"mb-2",children:N.issues.map((C,E)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs text-status-critical",children:[e.jsx(Q,{className:"w-3 h-3"}),C]},E))}),N.warnings.length>0&&e.jsx("div",{className:"mb-2",children:N.warnings.map((C,E)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs text-status-warning",children:[e.jsx(R,{className:"w-3 h-3"}),C]},E))}),N.compatible&&e.jsxs("div",{className:"text-xs text-text-secondary",children:["Estimated flight time: ",j(S(N)||0)]})]},N.drone.id))})]}),e.jsx("div",{className:"w-1/2 flex flex-col",children:v?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 border-b border-dark-border",children:[e.jsx("h3",{className:"font-medium text-text-primary mb-2",children:"Assignment Preview"}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-dark-tertiary rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-text-primary",children:s.name}),e.jsx("div",{className:"text-xs text-text-secondary",children:"Mission"})]}),e.jsx(We,{className:"w-5 h-5 text-status-active"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-text-primary",children:v.drone.name}),e.jsx("div",{className:"text-xs text-text-secondary",children:"Drone"})]})]})]}),e.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Mission Details"}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Priority:"}),e.jsxs("span",{className:"text-text-primary font-medium",children:["Level ",s.priority]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Waypoints:"}),e.jsx("span",{className:"text-text-primary font-medium",children:((M=s.waypoints)==null?void 0:M.length)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Status:"}),e.jsx("span",{className:"text-status-warning font-medium",children:s.status.toUpperCase()})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Drone Readiness"}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Compatibility Score:"}),e.jsxs("span",{className:"text-text-primary font-medium",children:[v.score,"/100"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Battery Level:"}),e.jsxs("span",{className:`font-medium ${d(v.drone.batteryLevel)}`,children:[v.drone.batteryLevel,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Signal Strength:"}),e.jsxs("span",{className:"text-text-primary font-medium",children:[v.drone.signalStrength,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Current Status:"}),e.jsx("span",{className:"text-text-primary font-medium",children:v.drone.status.toUpperCase()})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Flight Estimate"}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Estimated Duration:"}),e.jsx("span",{className:"text-text-primary font-medium",children:j(S(v)||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Distance to Start:"}),e.jsx("span",{className:"text-text-primary font-medium",children:s.waypoints&&s.waypoints.length>0?`${(k(v.drone.position,s.waypoints[0].position)/1e3).toFixed(1)}km`:"N/A"})]})]})]}),(v.issues.length>0||v.warnings.length>0)&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Considerations"}),e.jsxs("div",{className:"space-y-2",children:[v.issues.map((N,C)=>e.jsxs("div",{className:"flex items-start gap-2 p-2 bg-status-critical/10 rounded text-sm",children:[e.jsx(Q,{className:"w-4 h-4 text-status-critical mt-0.5"}),e.jsx("span",{className:"text-status-critical",children:N})]},C)),v.warnings.map((N,C)=>e.jsxs("div",{className:"flex items-start gap-2 p-2 bg-status-warning/10 rounded text-sm",children:[e.jsx(R,{className:"w-4 h-4 text-status-warning mt-0.5"}),e.jsx("span",{className:"text-status-warning",children:N})]},C))]})]})]})}),e.jsx("div",{className:"p-4 border-t border-dark-border",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-text-secondary",children:v.compatible?"Ready to assign mission":"Cannot assign due to compatibility issues"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,disabled:p,className:`px-4 py-2 text-text-secondary hover:text-text-primary transition-colors
                                 disabled:opacity-50 disabled:cursor-not-allowed`,children:"Cancel"}),e.jsx("button",{onClick:m,disabled:!v.compatible||p,className:`flex items-center gap-2 px-6 py-2 bg-status-active hover:bg-status-active/80 
                                 text-white rounded-lg font-medium transition-colors
                                 disabled:opacity-50 disabled:cursor-not-allowed`,children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Assigning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"w-4 h-4"}),"Assign Mission"]})})]})]})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ee,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Select a Drone"}),e.jsx("p",{className:"text-text-secondary",children:"Choose a drone from the list to see assignment details"})]})})})]})]})})},Ra=({mission:s,onAssigned:t,className:a=""})=>{const r=F(d=>Object.values(d.drones)),{assignMissionToDrone:n,missions:l}=O(),[o,c]=i.useState(!1),[u,p]=i.useState(!1),h=()=>r.filter(d=>!(d.status==="maintenance"||d.status==="emergency"||d.batteryLevel<30||Object.values(l).some(m=>m.assignedDrone===d.id&&["pending","active","paused"].includes(m.status)))),g=()=>{var m;const d=h();if(d.length===0)return null;const b=d.map(S=>{let j=0;if(j+=Math.floor(S.batteryLevel*.3),j+=Math.floor(S.signalStrength*.2),S.status==="idle"?j+=30:S.status==="charging"?j+=20:(S.status==="active"||S.status==="in_flight")&&(j+=10),s.waypoints&&s.waypoints.length>0){const v=f(S.position,s.waypoints[0].position),M=Math.max(0,20-v/5e3);j+=M}return{drone:S,score:j}});return b.sort((S,j)=>j.score-S.score),((m=b[0])==null?void 0:m.drone)||null},f=(d,b)=>{const S=d.lat*Math.PI/180,j=b.lat*Math.PI/180,v=(b.lat-d.lat)*Math.PI/180,M=(b.lng-d.lng)*Math.PI/180,N=Math.sin(v/2)*Math.sin(v/2)+Math.cos(S)*Math.cos(j)*Math.sin(M/2)*Math.sin(M/2);return 6371e3*(2*Math.atan2(Math.sqrt(N),Math.sqrt(1-N)))},x=async d=>{c(!0);try{await n(s.id,d),t==null||t(s.id,d),p(!1)}catch(b){console.error("Failed to assign mission:",b)}finally{c(!1)}},k=h(),y=g();if(s.assignedDrone){const d=r.find(b=>b.id===s.assignedDrone);return e.jsxs("div",{className:`flex items-center gap-2 text-sm ${a}`,children:[e.jsx(I,{className:"w-4 h-4 text-status-operational"}),e.jsx("span",{className:"text-text-secondary",children:"Assigned to:"}),e.jsx("span",{className:"text-text-primary font-medium",children:(d==null?void 0:d.name)||s.assignedDrone})]})}return k.length===0?e.jsxs("div",{className:`flex items-center gap-2 text-sm text-status-critical ${a}`,children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:"No available drones"})]}):e.jsx("div",{className:`relative ${a}`,children:u?e.jsxs(D.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:`absolute top-0 left-0 z-10 bg-dark-secondary border border-dark-border 
                     rounded-lg shadow-lg p-3 min-w-80`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:"Choose Drone"}),e.jsx("button",{onClick:()=>p(!1),className:"text-text-secondary hover:text-text-primary",children:e.jsx(Q,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:k.map(d=>{const b=d.id===(y==null?void 0:y.id),m=d.batteryLevel<50||d.signalStrength<70;return e.jsxs("button",{onClick:()=>x(d.id),disabled:o,className:`w-full p-3 text-left border border-dark-border hover:border-dark-hover 
                           rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed
                           hover:bg-dark-hover`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-text-primary",children:d.name}),b&&e.jsx("span",{className:"px-2 py-0.5 bg-status-active text-white text-xs rounded-full",children:"Best Match"})]}),m&&e.jsx(R,{className:"w-4 h-4 text-status-warning"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs text-text-secondary",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Battery:"}),e.jsxs("div",{className:`font-medium ${d.batteryLevel>70?"text-status-operational":d.batteryLevel>30?"text-status-warning":"text-status-critical"}`,children:[d.batteryLevel,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Signal:"}),e.jsxs("div",{className:"text-text-primary font-medium",children:[d.signalStrength,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Status:"}),e.jsx("div",{className:"text-text-primary font-medium capitalize",children:d.status})]})]}),s.waypoints&&s.waypoints.length>0&&e.jsxs("div",{className:"mt-2 text-xs text-text-secondary",children:["Distance to start: ",(f(d.position,s.waypoints[0].position)/1e3).toFixed(1),"km"]})]},d.id)})})]}):e.jsx("div",{className:"flex items-center gap-2",children:y&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>x(y.id),disabled:o,className:`flex items-center gap-2 px-3 py-2 bg-status-active hover:bg-status-active/80 
                         text-white rounded-lg text-sm font-medium transition-colors
                         disabled:opacity-50 disabled:cursor-not-allowed`,children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Assigning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"w-4 h-4"}),"Auto-assign to ",y.name]})}),e.jsxs("button",{onClick:()=>p(!0),className:`px-3 py-2 border border-dark-border hover:border-dark-hover 
                         text-text-secondary hover:text-text-primary rounded-lg text-sm transition-colors`,children:["Choose Drone (",k.length," available)"]})]})})})},Ta=({className:s=""})=>{const{missions:t,missionStats:a,selectedMissionId:r,selectMission:n,deleteMission:l,updateMission:o}=O(),[c,u]=i.useState(!1),[p,h]=i.useState(null),[g,f]=i.useState(""),[x,k]=i.useState("all"),[y,d]=i.useState("all"),b=Object.values(t),m=b.filter(w=>{var $;return!(g&&!w.name.toLowerCase().includes(g.toLowerCase())&&!(($=w.description)!=null&&$.toLowerCase().includes(g.toLowerCase()))||x!=="all"&&w.status!==x||y!=="all"&&(y==="high"&&w.priority<7||y==="medium"&&(w.priority<4||w.priority>6)||y==="low"&&w.priority>3))}),S=[...m].sort((w,$)=>w.status==="active"&&$.status!=="active"?-1:$.status==="active"&&w.status!=="active"?1:w.priority!==$.priority?$.priority-w.priority:new Date($.createdAt).getTime()-new Date(w.createdAt).getTime()),j=w=>{switch(w){case"active":return"text-status-operational bg-status-operational/10 border-status-operational/20";case"completed":return"text-status-active bg-status-active/10 border-status-active/20";case"pending":return"text-status-warning bg-status-warning/10 border-status-warning/20";case"failed":return"text-status-critical bg-status-critical/10 border-status-critical/20";case"cancelled":return"text-text-secondary bg-text-secondary/10 border-text-secondary/20";case"paused":return"text-status-warning bg-status-warning/10 border-status-warning/20";default:return"text-text-secondary bg-text-secondary/10 border-text-secondary/20"}},v=w=>w>=8?"text-red-400":w>=6?"text-orange-400":w>=4?"text-yellow-400":"text-blue-400",M=async(w,$)=>{try{await o(w.id,{status:$})}catch(A){console.error("Failed to update mission status:",A)}},N=async w=>{if(window.confirm("Are you sure you want to delete this mission?"))try{await l(w)}catch($){console.error("Failed to delete mission:",$)}},C=w=>new Date(w).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),E=w=>{if(!w)return"N/A";const $=Math.floor(w/3600),A=Math.floor(w%3600/60);return $>0?`${$}h ${A}m`:`${A}m`};return e.jsxs("div",{className:`space-y-6 ${s}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Missions"}),e.jsxs("p",{className:"text-text-secondary mt-1",children:[b.length," total missions",a&&e.jsxs("span",{className:"ml-4",children:[a.active," active â€¢ ",a.completed," completed â€¢ ",a.pending," pending"]})]})]}),e.jsxs("button",{onClick:()=>u(!0),className:`flex items-center gap-2 px-4 py-2 bg-status-active hover:bg-status-active/80 
                   text-white rounded-lg font-medium transition-colors`,children:[e.jsx(re,{className:"w-5 h-5"}),"New Mission"]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-dark-secondary rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-secondary"}),e.jsx("input",{type:"text",placeholder:"Search missions...",value:g,onChange:w=>f(w.target.value),className:`w-full pl-10 pr-4 py-2 bg-dark-tertiary border border-dark-border rounded-lg
                     text-text-primary placeholder-text-secondary focus:outline-none 
                     focus:ring-2 focus:ring-status-active`})]}),e.jsxs("select",{value:x,onChange:w=>k(w.target.value),className:`px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg
                   text-text-primary focus:outline-none focus:ring-2 focus:ring-status-active`,children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"paused",children:"Paused"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsxs("select",{value:y,onChange:w=>d(w.target.value),className:`px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg
                   text-text-primary focus:outline-none focus:ring-2 focus:ring-status-active`,children:[e.jsx("option",{value:"all",children:"All Priority"}),e.jsx("option",{value:"high",children:"High (7-10)"}),e.jsx("option",{value:"medium",children:"Medium (4-6)"}),e.jsx("option",{value:"low",children:"Low (1-3)"})]}),e.jsxs("div",{className:"flex items-center text-text-secondary",children:[e.jsx(rs,{className:"w-4 h-4 mr-2"}),m.length," of ",b.length]})]}),e.jsx("div",{className:"space-y-3",children:e.jsx(P,{children:S.map(w=>{var $;return e.jsx(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`p-4 bg-dark-secondary rounded-lg border border-dark-border
                        hover:border-dark-hover transition-colors cursor-pointer
                        ${r===w.id?"ring-2 ring-status-active":""}`,onClick:()=>n(r===w.id?null:w.id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:w.name}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${j(w.status)}`,children:w.status.toUpperCase()}),e.jsxs("span",{className:`text-sm font-medium ${v(w.priority)}`,children:["Priority ",w.priority]})]}),w.description&&e.jsx("p",{className:"text-text-secondary text-sm mb-3 line-clamp-2",children:w.description}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Waypoints:"}),e.jsx("div",{className:"text-text-primary font-medium",children:(($=w.waypoints)==null?void 0:$.length)||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Progress:"}),e.jsxs("div",{className:"text-text-primary font-medium",children:[w.progress,"%",w.status==="active"&&e.jsx("div",{className:"w-full bg-dark-border rounded-full h-1.5 mt-1",children:e.jsx("div",{className:"bg-status-active h-1.5 rounded-full transition-all duration-300",style:{width:`${w.progress}%`}})})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:w.assignedDrone?"Assigned:":"Created:"}),e.jsx("div",{className:"text-text-primary font-medium",children:w.assignedDrone||C(w.createdAt)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Duration:"}),e.jsx("div",{className:"text-text-primary font-medium",children:w.actualDuration?E(w.actualDuration):w.estimatedDuration?`~${E(w.estimatedDuration)}`:"N/A"})]})]}),w.status==="pending"&&e.jsx("div",{className:"mt-4 pt-3 border-t border-dark-border",children:e.jsx(Ra,{mission:w,onAssigned:()=>{console.log("Mission assigned successfully")}})})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[w.status==="pending"&&e.jsx("button",{onClick:A=>{A.stopPropagation(),M(w,"active")},className:"p-2 text-status-operational hover:bg-status-operational/10 rounded-lg transition-colors",title:"Start mission",children:e.jsx(oe,{className:"w-4 h-4"})}),w.status==="active"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:A=>{A.stopPropagation(),M(w,"paused")},className:"p-2 text-status-warning hover:bg-status-warning/10 rounded-lg transition-colors",title:"Pause mission",children:e.jsx(ye,{className:"w-4 h-4"})}),e.jsx("button",{onClick:A=>{A.stopPropagation(),M(w,"cancelled")},className:"p-2 text-status-critical hover:bg-status-critical/10 rounded-lg transition-colors",title:"Stop mission",children:e.jsx(qe,{className:"w-4 h-4"})})]}),w.status==="paused"&&e.jsx("button",{onClick:A=>{A.stopPropagation(),M(w,"active")},className:"p-2 text-status-operational hover:bg-status-operational/10 rounded-lg transition-colors",title:"Resume mission",children:e.jsx(oe,{className:"w-4 h-4"})}),w.status==="pending"&&!w.assignedDrone&&e.jsx("button",{onClick:A=>{A.stopPropagation(),h(w)},className:`p-2 text-text-secondary hover:text-status-active hover:bg-status-active/10 
                               rounded-lg transition-colors`,title:"Assign to drone",children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx("button",{onClick:A=>{A.stopPropagation(),n(w.id)},className:`p-2 text-text-secondary hover:text-text-primary hover:bg-dark-hover 
                             rounded-lg transition-colors`,title:"View details",children:e.jsx(fe,{className:"w-4 h-4"})}),["pending","paused"].includes(w.status)&&e.jsx("button",{onClick:A=>{A.stopPropagation(),console.log("Edit mission:",w.id)},className:`p-2 text-text-secondary hover:text-status-warning hover:bg-status-warning/10 
                               rounded-lg transition-colors`,title:"Edit mission",children:e.jsx(Qe,{className:"w-4 h-4"})}),!["active"].includes(w.status)&&e.jsx("button",{onClick:A=>{A.stopPropagation(),N(w.id)},className:`p-2 text-text-secondary hover:text-status-critical hover:bg-status-critical/10 
                               rounded-lg transition-colors`,title:"Delete mission",children:e.jsx(ze,{className:"w-4 h-4"})})]})]})},w.id)})})}),S.length===0&&e.jsx("div",{className:"text-center py-12",children:g||x!=="all"||y!=="all"?e.jsxs("div",{children:[e.jsx(Se,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"No missions found"}),e.jsx("p",{className:"text-text-secondary mb-4",children:"No missions match your current filters"}),e.jsx("button",{onClick:()=>{f(""),k("all"),d("all")},className:`px-4 py-2 bg-dark-tertiary hover:bg-dark-hover text-text-primary 
                         rounded-lg transition-colors`,children:"Clear Filters"})]}):e.jsxs("div",{children:[e.jsx(re,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"No missions created"}),e.jsx("p",{className:"text-text-secondary mb-4",children:"Create your first mission to get started"}),e.jsx("button",{onClick:()=>u(!0),className:`px-6 py-2 bg-status-active hover:bg-status-active/80 text-white 
                         rounded-lg font-medium transition-colors`,children:"Create Mission"})]})}),e.jsx(ge,{isOpen:c,onClose:()=>u(!1),onMissionCreated:()=>{console.log("Mission created successfully")}}),p&&e.jsx(st,{mission:p,isOpen:!0,onClose:()=>h(null),onAssigned:()=>{h(null),console.log("Mission assigned successfully")}})]})},Ee=({className:s="",compact:t=!1})=>{var b;const{missions:a,activeMissions:r,missionStats:n,selectMission:l,assignMissionToDrone:o}=O(),c=F(m=>{const S=m.selectedDroneId;return S?m.drones[S]:null}),u=La(),[p,h]=i.useState(!1),[g,f]=i.useState(!1),x=c?Object.values(a).filter(m=>m.assignedDrone===c.id):[],k=m=>{switch(m){case"active":return"text-status-operational";case"completed":return"text-status-active";case"pending":return"text-status-warning";case"failed":return"text-status-critical";case"cancelled":return"text-text-secondary";case"paused":return"text-status-warning";default:return"text-text-secondary"}},y=async m=>{if(c)try{await o(m,c.id)}catch(S){console.error("Failed to assign mission:",S)}},d=m=>new Date(m).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return t?e.jsxs("div",{className:`bg-dark-secondary rounded-lg border border-dark-border p-4 ${s}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5"}),"Missions"]}),e.jsx("button",{onClick:()=>h(!0),className:"p-1 text-text-secondary hover:text-status-active transition-colors",children:e.jsx(re,{className:"w-4 h-4"})})]}),n&&e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4 text-sm",children:[e.jsxs("div",{className:"text-center p-2 bg-dark-tertiary rounded",children:[e.jsx("div",{className:"text-status-operational font-medium",children:n.active}),e.jsx("div",{className:"text-text-secondary text-xs",children:"Active"})]}),e.jsxs("div",{className:"text-center p-2 bg-dark-tertiary rounded",children:[e.jsx("div",{className:"text-status-warning font-medium",children:n.pending}),e.jsx("div",{className:"text-text-secondary text-xs",children:"Pending"})]}),e.jsxs("div",{className:"text-center p-2 bg-dark-tertiary rounded",children:[e.jsx("div",{className:"text-status-active font-medium",children:n.today}),e.jsx("div",{className:"text-text-secondary text-xs",children:"Today"})]})]}),e.jsx("div",{className:"space-y-2",children:r.slice(0,3).map(m=>e.jsx("div",{className:"p-2 bg-dark-tertiary rounded cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>l(m.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-text-primary text-sm truncate",children:m.name}),e.jsxs("div",{className:"text-xs text-text-secondary",children:[m.assignedDrone||"Unassigned"," â€¢ ",m.progress,"%"]})]}),e.jsx("div",{className:"w-8 h-1 bg-dark-border rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-status-active transition-all",style:{width:`${m.progress}%`}})})]})},m.id))}),r.length===0&&e.jsx("div",{className:"text-center text-text-secondary text-sm py-4",children:"No active missions"}),e.jsx(ge,{isOpen:p,onClose:()=>h(!1)})]}):e.jsxs("div",{className:`bg-dark-secondary rounded-lg border border-dark-border ${s}`,children:[e.jsxs("div",{className:"p-4 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h2",{className:"text-lg font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(V,{className:"w-6 h-6"}),"Mission Control"]}),e.jsxs("button",{onClick:()=>h(!0),className:`px-3 py-1 bg-status-active hover:bg-status-active/80 text-white 
                     rounded text-sm font-medium transition-colors flex items-center gap-1`,children:[e.jsx(re,{className:"w-4 h-4"}),"New"]})]}),n&&e.jsxs("div",{className:"grid grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-status-operational font-medium",children:n.active}),e.jsx("div",{className:"text-text-secondary text-xs",children:"Active"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-status-warning font-medium",children:n.pending}),e.jsx("div",{className:"text-text-secondary text-xs",children:"Pending"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-status-active font-medium",children:n.completed}),e.jsx("div",{className:"text-text-secondary text-xs",children:"Completed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-text-primary font-medium",children:n.today}),e.jsx("div",{className:"text-text-secondary text-xs",children:"Today"})]})]})]}),e.jsx("div",{className:"p-4 space-y-4",children:u?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:u.name}),e.jsx("p",{className:"text-sm text-text-secondary",children:u.description})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${k(u.status)}`,children:u.status.toUpperCase()})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:"Progress"}),e.jsxs("span",{className:"text-text-primary font-medium",children:[u.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-dark-border rounded-full h-2",children:e.jsx("div",{className:"bg-status-active h-2 rounded-full transition-all duration-300",style:{width:`${u.progress}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Priority:"}),e.jsxs("div",{className:"text-text-primary font-medium",children:["Level ",u.priority]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Waypoints:"}),e.jsx("div",{className:"text-text-primary font-medium",children:((b=u.waypoints)==null?void 0:b.length)||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Assigned:"}),e.jsx("div",{className:"text-text-primary font-medium",children:u.assignedDrone||"Unassigned"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Created:"}),e.jsx("div",{className:"text-text-primary font-medium",children:d(u.createdAt)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[u.waypoints&&u.waypoints.length>0&&e.jsxs("button",{onClick:()=>f(!g),className:`flex items-center gap-1 px-3 py-2 bg-dark-tertiary hover:bg-dark-hover 
                           text-text-primary rounded text-sm transition-colors`,children:[e.jsx(ae,{className:"w-4 h-4"}),g?"Hide":"Show"," Waypoints"]}),c&&u.status==="pending"&&!u.assignedDrone&&e.jsxs("button",{onClick:()=>y(u.id),className:`flex items-center gap-1 px-3 py-2 bg-status-active hover:bg-status-active/80 
                           text-white rounded text-sm transition-colors`,children:["Assign to ",c.name]})]}),e.jsx(P,{children:g&&u.waypoints&&e.jsx(D.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-dark-border pt-4",children:e.jsx(et,{waypoints:u.waypoints,onWaypointsChange:()=>{},disabled:!0})})})]}):c&&x.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-medium text-text-primary",children:[c.name," Missions (",x.length,")"]}),x.map(m=>{var S;return e.jsx("div",{className:"p-3 bg-dark-tertiary rounded-lg cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>l(m.id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:m.name}),e.jsx("p",{className:"text-sm text-text-secondary truncate",children:m.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-text-secondary",children:[e.jsxs("span",{children:["Priority ",m.priority]}),e.jsxs("span",{children:[((S=m.waypoints)==null?void 0:S.length)||0," waypoints"]}),e.jsxs("span",{children:[m.progress,"% complete"]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs ${k(m.status)}`,children:m.status}),e.jsx("button",{onClick:j=>{j.stopPropagation(),l(m.id)},className:"p-1 text-text-secondary hover:text-text-primary transition-colors",children:e.jsx(fe,{className:"w-4 h-4"})})]})]})},m.id)})]}):e.jsx("div",{className:"text-center py-8",children:c?e.jsxs("div",{children:[e.jsx(V,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"No missions assigned"}),e.jsxs("p",{className:"text-text-secondary mb-4",children:[c.name," has no missions assigned"]}),e.jsx("button",{onClick:()=>h(!0),className:`px-4 py-2 bg-status-active hover:bg-status-active/80 text-white 
                           rounded-lg font-medium transition-colors`,children:"Create Mission"})]}):e.jsxs("div",{children:[e.jsx(Be,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Mission Overview"}),e.jsx("p",{className:"text-text-secondary mb-4",children:"Select a drone to view its missions or create a new mission"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"p-3 bg-dark-tertiary rounded",children:[e.jsx("div",{className:"text-status-operational font-medium text-lg",children:r.length}),e.jsx("div",{className:"text-text-secondary",children:"Active Missions"})]}),e.jsxs("div",{className:"p-3 bg-dark-tertiary rounded",children:[e.jsx("div",{className:"text-text-primary font-medium text-lg",children:Object.keys(a).length}),e.jsx("div",{className:"text-text-secondary",children:"Total Missions"})]})]})]})})}),e.jsx(ge,{isOpen:p,onClose:()=>h(!1)})]})},Ia=({className:s=""})=>{const t=F(d=>Object.values(d.drones)),a=F(d=>d.drones),{missions:r,updateMission:n}=O(),[l,o]=i.useState(null),[c,u]=i.useState("all"),p=i.useMemo(()=>Object.values(r).filter(d=>["pending","active","paused"].includes(d.status)).map(d=>{const b=d.assignedDrone?a[d.assignedDrone]:null,m=[];let S="unassigned";return d.assignedDrone&&(b?(S="assigned",(b.status==="maintenance"||b.status==="emergency")&&(m.push(`Drone is in ${b.status} mode`),S="conflict"),b.batteryLevel<20?(m.push(`Critical battery: ${b.batteryLevel}%`),S="conflict"):b.batteryLevel<30&&m.push(`Low battery: ${b.batteryLevel}%`),b.signalStrength<30&&m.push(`Poor signal: ${b.signalStrength}%`)):(m.push("Assigned drone not found"),S="conflict")),{mission:d,drone:b,status:S,issues:m}}).sort((d,b)=>{if(d.mission.priority!==b.mission.priority)return b.mission.priority-d.mission.priority;if(d.status!==b.status){const m={conflict:0,unassigned:1,assigned:2};return m[d.status]-m[b.status]}return new Date(b.mission.createdAt).getTime()-new Date(d.mission.createdAt).getTime()}),[r,a]),h=p.filter(d=>{switch(c){case"assigned":return d.status==="assigned"&&d.issues.length===0;case"unassigned":return d.status==="unassigned";case"issues":return d.status==="conflict"||d.issues.length>0;default:return!0}}),g=d=>{switch(d.status){case"assigned":return d.issues.length>0?e.jsx(R,{className:"w-5 h-5 text-status-warning"}):e.jsx(I,{className:"w-5 h-5 text-status-operational"});case"conflict":return e.jsx(H,{className:"w-5 h-5 text-status-critical"});case"unassigned":default:return e.jsx(U,{className:"w-5 h-5 text-text-secondary"})}},f=d=>{switch(d.status){case"assigned":return d.issues.length>0?"border-status-warning bg-status-warning/5":"border-status-operational bg-status-operational/5";case"conflict":return"border-status-critical bg-status-critical/5";case"unassigned":default:return"border-text-secondary bg-text-secondary/5"}},x=async d=>{try{await n(d,{assignedDrone:void 0})}catch(b){console.error("Failed to unassign mission:",b)}},k=()=>t.filter(d=>["maintenance","emergency"].includes(d.status)||d.batteryLevel<30?!1:!Object.values(r).some(m=>m.assignedDrone===d.id&&["pending","active","paused"].includes(m.status))).length,y={total:p.length,assigned:p.filter(d=>d.status==="assigned"&&d.issues.length===0).length,unassigned:p.filter(d=>d.status==="unassigned").length,issues:p.filter(d=>d.status==="conflict"||d.issues.length>0).length,availableDrones:k()};return e.jsxs("div",{className:`space-y-6 ${s}`,children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Assignment Manager"}),e.jsxs("p",{className:"text-text-secondary mt-1",children:["Manage mission-to-drone assignments â€¢ ",y.availableDrones," drones available"]})]})}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-dark-secondary rounded-lg border border-dark-border p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:y.total}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Total Missions"})]}),e.jsxs("div",{className:"bg-dark-secondary rounded-lg border border-dark-border p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-status-operational",children:y.assigned}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Assigned"})]}),e.jsxs("div",{className:"bg-dark-secondary rounded-lg border border-dark-border p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-text-secondary",children:y.unassigned}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Unassigned"})]}),e.jsxs("div",{className:"bg-dark-secondary rounded-lg border border-dark-border p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-status-warning",children:y.issues}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Issues"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-dark-secondary rounded-lg border border-dark-border",children:[e.jsx("span",{className:"text-text-secondary font-medium",children:"Filter:"}),e.jsx("div",{className:"flex gap-2",children:[{value:"all",label:`All (${y.total})`},{value:"assigned",label:`Assigned (${y.assigned})`},{value:"unassigned",label:`Unassigned (${y.unassigned})`},{value:"issues",label:`Issues (${y.issues})`}].map(d=>e.jsx("button",{onClick:()=>u(d.value),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${c===d.value?"bg-status-active text-white":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:d.label},d.value))})]}),e.jsx("div",{className:"space-y-3",children:e.jsx(P,{children:h.map(d=>{var b;return e.jsx(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`p-6 rounded-lg border-2 transition-all ${f(d)}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[g(d),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:d.mission.name}),e.jsxs("p",{className:"text-sm text-text-secondary",children:["Priority ",d.mission.priority," â€¢ ",((b=d.mission.waypoints)==null?void 0:b.length)||0," waypoints"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Mission Status"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Status:"}),e.jsx("span",{className:"text-text-primary capitalize",children:d.mission.status})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Progress:"}),e.jsxs("span",{className:"text-text-primary",children:[d.mission.progress,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Created:"}),e.jsx("span",{className:"text-text-primary",children:new Date(d.mission.createdAt).toLocaleDateString()})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Assignment"}),e.jsx("div",{className:"space-y-1 text-sm",children:d.drone?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Assigned to:"}),e.jsx("span",{className:"text-text-primary font-medium",children:d.drone.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Drone Status:"}),e.jsx("span",{className:"text-text-primary capitalize",children:d.drone.status})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Battery:"}),e.jsxs("span",{className:`font-medium ${d.drone.batteryLevel>70?"text-status-operational":d.drone.batteryLevel>30?"text-status-warning":"text-status-critical"}`,children:[d.drone.batteryLevel,"%"]})]})]}):e.jsx("div",{className:"text-text-secondary",children:"No drone assigned"})})]})]}),d.issues.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"font-medium text-status-warning mb-2 flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4"}),"Issues"]}),e.jsx("div",{className:"space-y-1",children:d.issues.map((m,S)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("div",{className:"w-1 h-1 bg-status-warning rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{className:"text-status-warning",children:m})]},S))})]}),d.mission.description&&e.jsx("p",{className:"text-sm text-text-secondary line-clamp-2",children:d.mission.description})]}),e.jsx("div",{className:"flex flex-col gap-2 ml-6",children:d.status==="unassigned"?e.jsxs("button",{onClick:()=>o(d.mission),className:`flex items-center gap-2 px-4 py-2 bg-status-active hover:bg-status-active/80 
                               text-white rounded-lg text-sm font-medium transition-colors`,children:[e.jsx(ee,{className:"w-4 h-4"}),"Assign Drone"]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>o(d.mission),className:`flex items-center gap-2 px-4 py-2 bg-dark-tertiary hover:bg-dark-hover 
                                 text-text-primary rounded-lg text-sm font-medium transition-colors border border-dark-border`,children:[e.jsx(G,{className:"w-4 h-4"}),"Reassign"]}),e.jsxs("button",{onClick:()=>x(d.mission.id),className:`flex items-center gap-2 px-4 py-2 text-text-secondary hover:text-status-critical 
                                 hover:bg-status-critical/10 rounded-lg text-sm transition-colors`,children:[e.jsx(H,{className:"w-4 h-4"}),"Unassign"]})]})})]})},d.mission.id)})})}),h.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ee,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:c==="all"?"No missions to assign":`No ${c} missions`}),e.jsx("p",{className:"text-text-secondary mb-4",children:c==="all"?"Create missions to start managing assignments":"Change the filter to see other missions"}),c!=="all"&&e.jsx("button",{onClick:()=>u("all"),className:`px-4 py-2 bg-dark-tertiary hover:bg-dark-hover text-text-primary 
                       rounded-lg transition-colors`,children:"Show All Missions"})]}),l&&e.jsx(st,{mission:l,isOpen:!0,onClose:()=>o(null),onAssigned:()=>{o(null)}})]})},Le=({className:s="",onClose:t})=>{var c;const[a,r]=i.useState(!1),[n,l]=i.useState("panel"),o=[{mode:"panel",label:"Panel",icon:Be,description:"Compact mission overview"},{mode:"list",label:"List",icon:V,description:"All missions list"},{mode:"assignments",label:"Assignments",icon:ee,description:"Mission assignments"}];return a?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[10000] p-4",children:e.jsxs(D.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:`bg-dark-secondary rounded-lg border border-dark-border shadow-xl
                   w-full max-w-7xl max-h-[95vh] overflow-hidden flex flex-col`,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-text-primary flex items-center gap-3",children:[e.jsx(V,{className:"w-7 h-7 text-status-active"}),"Mission Control Center"]}),e.jsx("p",{className:"text-text-secondary mt-1",children:"Manage missions, assignments, and drone operations"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex bg-dark-tertiary rounded-lg p-1",children:o.map(u=>e.jsxs("button",{onClick:()=>l(u.mode),className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ${n===u.mode?"bg-status-active text-white":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,title:u.description,children:[e.jsx(u.icon,{className:"w-4 h-4"}),u.label]},u.mode))}),e.jsx("button",{onClick:()=>{t?t():r(!1)},className:"p-2 hover:bg-dark-hover rounded-lg transition-colors",children:e.jsx(H,{className:"w-5 h-5 text-text-secondary"})})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden p-6",children:e.jsxs(P,{mode:"wait",children:[n==="panel"&&e.jsx(D.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"h-full",children:e.jsx(Ee,{className:"h-full"})},"panel"),n==="list"&&e.jsx(D.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"h-full overflow-y-auto",children:e.jsx(Ta,{})},"list"),n==="assignments"&&e.jsx(D.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"h-full overflow-y-auto",children:e.jsx(Ia,{})},"assignments")]})}),e.jsx("div",{className:"p-6 border-t border-dark-border bg-dark-tertiary",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-text-secondary",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-status-operational rounded-full"}),e.jsx("span",{children:"Mission Service Connected"})]}),e.jsxs("div",{className:"text-text-secondary",children:["Last update: ",new Date().toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:["Current View: ",e.jsx("span",{className:"text-text-primary font-medium",children:(c=o.find(u=>u.mode===n))==null?void 0:c.label})]}),e.jsx("button",{onClick:()=>{t?t():r(!1)},className:"px-3 py-1 text-text-secondary hover:text-text-primary transition-colors",children:"Close"})]})]})})]})}):e.jsxs("div",{className:`${s}`,children:[e.jsx(Ee,{compact:!0}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsxs("button",{onClick:()=>r(!0),className:`flex items-center gap-2 px-4 py-2 bg-dark-tertiary hover:bg-dark-hover 
                     text-text-primary rounded-lg border border-dark-border transition-colors`,children:[e.jsx(Jt,{className:"w-4 h-4"}),"Mission Controls"]})})]})};function Oa(){const{state:s,isConnected:t,error:a}=Na(),r=F(y=>Object.values(y.drones)),n=F(y=>y.selectedDroneId),l=wa(),o=F(y=>y.selectDrone),[c,u]=i.useState(!1),[p,h]=i.useState(!1),[g,f]=i.useState(()=>{const y=localStorage.getItem("safetyPanelHeight");return y?parseInt(y,10):400});i.useEffect(()=>{ja(),Ea()},[]);const x=y=>{o(y)},k=(y,d)=>{console.log(`Action "${d}" requested for drone ${y}`)};return e.jsxs("div",{className:"min-h-screen bg-dark-primary text-text-primary flex",children:[e.jsxs("div",{className:`
        transition-all duration-300 ease-in-out bg-dark-secondary border-r border-dark-border
        ${c?"w-16":"w-80"}
        flex flex-col h-screen
      `,children:[e.jsxs("div",{className:"p-4 border-b border-dark-border flex items-center justify-between",children:[!c&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Fleet Control"}),e.jsx("p",{className:"text-text-secondary text-xs",children:"5 drones active"})]}),e.jsx("button",{onClick:()=>u(!c),className:"p-2 hover:bg-dark-hover rounded-lg transition-colors",title:c?"Expand sidebar":"Collapse sidebar",children:c?e.jsx(zt,{className:"w-5 h-5 text-text-secondary"}):e.jsx(Qt,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[!c&&e.jsx(Ts,{drones:r,selectedDroneId:n||void 0,onDroneSelect:x,onDroneAction:k,className:"h-full"}),c&&e.jsx("div",{className:"p-2 space-y-2 overflow-y-auto scrollbar-thin",children:r.map(y=>e.jsx("button",{onClick:()=>x(y.id),className:`
                    w-full p-2 rounded-lg border transition-all duration-200
                    ${y.id===n?"border-status-active bg-status-active/10":"border-dark-border hover:border-dark-hover hover:bg-dark-hover"}
                  `,title:`${y.name} - ${y.status}`,children:e.jsx("div",{className:"w-8 h-8 mx-auto rounded-full border flex items-center justify-center",style:{backgroundColor:y.status==="active"||y.status==="in_flight"?"#238636":y.status==="charging"?"#d29922":y.status==="maintenance"?"#da3633":"#8b949e",borderColor:y.status==="active"||y.status==="in_flight"?"#238636":y.status==="charging"?"#d29922":y.status==="maintenance"?"#da3633":"#8b949e"},children:e.jsx("span",{className:"text-xs font-bold text-white",children:y.name.split("-")[1]||y.name.charAt(0)})})},y.id))})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col h-screen",children:[e.jsx("header",{className:"bg-dark-secondary border-b border-dark-border px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Multi-Drone Fleet Management System"}),e.jsx("p",{className:"text-text-secondary text-sm",children:"Real-time fleet monitoring and control dashboard"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>h(!0),className:`flex items-center gap-2 px-4 py-2 bg-status-active hover:bg-status-active/80 
                         text-white rounded-lg font-medium transition-colors`,children:[e.jsx(V,{className:"w-5 h-5"}),"Mission Center"]}),e.jsx(Bs,{connectionState:s,isConnected:t,error:a||void 0})]})]})}),e.jsx("main",{className:"flex-1 p-4 overflow-hidden",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 h-full",children:[e.jsx("div",{className:"lg:col-span-2 h-full overflow-hidden",children:e.jsx(Es,{drones:r,selectedDroneId:n||void 0,onDroneSelect:x,className:"h-full w-full"})}),e.jsxs("div",{className:"lg:col-span-1 h-full overflow-y-auto overflow-x-hidden flex flex-col gap-4 pr-2 scrollbar-thin",children:[e.jsx("div",{className:"flex-shrink-0 h-[450px] border border-dark-border rounded-lg bg-dark-secondary overflow-hidden",children:e.jsx(Ps,{drone:l,isLive:t,className:"h-full w-full"})}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Da,{initialHeight:g,minHeight:250,maxHeight:600,onHeightChange:y=>{f(y),localStorage.setItem("safetyPanelHeight",y.toString())},className:"",children:e.jsx(Ma,{className:"h-full"})})}),e.jsx("div",{className:"flex-shrink-0 h-[500px] mb-4",children:e.jsx(Le,{})})]})]})})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",onClick:y=>{y.target===y.currentTarget&&h(!1)},children:e.jsx("div",{className:`bg-dark-secondary rounded-lg border border-dark-border shadow-2xl
                         w-full max-w-7xl max-h-[95vh] overflow-hidden relative z-[10000]`,onClick:y=>y.stopPropagation(),children:e.jsx(Le,{className:"h-full",onClose:()=>h(!1)})})})]})}he.createRoot(document.getElementById("root")).render(e.jsx(pe.StrictMode,{children:e.jsx(Oa,{})}));
//# sourceMappingURL=index-DFmly5BJ.js.map
