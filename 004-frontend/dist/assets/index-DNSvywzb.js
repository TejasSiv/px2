var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{r as s,a,R as r,g as n}from"./vendor-Cp0tO4JO.js";import{M as i,P as l,l as o,a as c,b as d,T as m,u as x}from"./maps-BehwxkbN.js";import{m as h,A as u}from"./ui-K_dSp0nM.js";import{R as g,L as p,C as v,X as y,Y as b,T as f,a as j,b as N}from"./charts-DQVqi81-.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var w={exports:{}},k={},S=s,C=Symbol.for("react.element"),M=Symbol.for("react.fragment"),D=Object.prototype.hasOwnProperty,A=S.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,E={key:!0,ref:!0,__self:!0,__source:!0};function L(e,t,s){var a,r={},n=null,i=null;for(a in void 0!==s&&(n=""+s),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(i=t.ref),t)D.call(t,a)&&!E.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:C,type:e,key:n,ref:i,props:r,_owner:A.current}}k.Fragment=M,k.jsx=L,k.jsxs=L,w.exports=k;var I=w.exports,$={},T=a;function O({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"}))}$.createRoot=T.createRoot,$.hydrateRoot=T.hydrateRoot;const R=s.forwardRef(O);function P({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const W=s.forwardRef(P);function _({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const F=s.forwardRef(_);function B({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const U=s.forwardRef(B);function Q({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}const q=s.forwardRef(Q);function z({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 10.5h.375c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125H21M3.75 18h15A2.25 2.25 0 0 0 21 15.75v-6a2.25 2.25 0 0 0-2.25-2.25h-15A2.25 2.25 0 0 0 1.5 9.75v6A2.25 2.25 0 0 0 3.75 18Z"}))}const H=s.forwardRef(z);function V({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const Z=s.forwardRef(V);function G({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.412 15.655 9.75 21.75l3.745-4.012M9.257 13.5H3.75l2.659-2.849m2.048-2.194L14.25 2.25 12 10.5h8.25l-4.707 5.043M8.457 8.457 3 3m5.457 5.457 7.086 7.086m0 0L21 21"}))}const J=s.forwardRef(G);function Y({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))}const K=s.forwardRef(Y);function X({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const ee=s.forwardRef(X);function te({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const se=s.forwardRef(te);function ae({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const re=s.forwardRef(ae);function ne({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const ie=s.forwardRef(ne);function le({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const oe=s.forwardRef(le);function ce({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}const de=s.forwardRef(ce);function me({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const xe=s.forwardRef(me);function he({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ue=s.forwardRef(he);function ge({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const pe=s.forwardRef(ge);function ve({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077 1.41-.513m14.095-5.13 1.41-.513M5.106 17.785l1.15-.964m11.49-9.642 1.149-.964M7.501 19.795l.75-1.3m7.5-12.99.75-1.3m-6.063 16.658.26-1.477m2.605-14.772.26-1.477m0 17.726-.26-1.477M10.698 4.614l-.26-1.477M16.5 19.794l-.75-1.299M7.5 4.205 12 12m6.894 5.785-1.149-.964M6.256 7.178l-1.15-.964m15.352 8.864-1.41-.513M4.954 9.435l-1.41-.514M12.002 12l-3.75 6.495"}))}const ye=s.forwardRef(ve);function be({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 0 0 2.25-2.25V6.75a2.25 2.25 0 0 0-2.25-2.25H6.75A2.25 2.25 0 0 0 4.5 6.75v10.5a2.25 2.25 0 0 0 2.25 2.25Zm.75-12h9v9h-9v-9Z"}))}const fe=s.forwardRef(be);function je({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const Ne=s.forwardRef(je);function we({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const ke=s.forwardRef(we);function Se({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.362 5.214A8.252 8.252 0 0 1 12 21 8.25 8.25 0 0 1 6.038 7.047 8.287 8.287 0 0 0 9 9.601a8.983 8.983 0 0 1 3.361-6.867 8.21 8.21 0 0 0 3 2.48Z"}),s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18a3.75 3.75 0 0 0 .495-7.468 5.99 5.99 0 0 0-1.925 3.547 5.975 5.975 0 0 1-2.133-1.001A3.75 3.75 0 0 0 12 18Z"}))}const Ce=s.forwardRef(Se);function Me({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const De=s.forwardRef(Me);function Ae({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"}))}const Ee=s.forwardRef(Ae);function Le({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const Ie=s.forwardRef(Le);function $e({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const Te=s.forwardRef($e);function Oe({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const Re=s.forwardRef(Oe);function Pe({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const We=s.forwardRef(Pe);function _e({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const Fe=s.forwardRef(_e);function Be({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))}const Ue=s.forwardRef(Be);function Qe({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const qe=s.forwardRef(Qe);function ze({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z"}))}const He=s.forwardRef(ze);function Ve({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}))}const Ze=s.forwardRef(Ve);function Ge({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const Je=s.forwardRef(Ge);function Ye({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m0-10.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.25-8.25-3.286Zm0 13.036h.008v.008H12v-.008Z"}))}const Ke=s.forwardRef(Ye);function Xe({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3 3 8.735 8.735m0 0a.374.374 0 1 1 .53.53m-.53-.53.53.53m0 0L21 21M14.652 9.348a3.75 3.75 0 0 1 0 5.304m2.121-7.425a6.75 6.75 0 0 1 0 9.546m2.121-11.667c3.808 3.807 3.808 9.98 0 13.788m-9.546-4.242a3.733 3.733 0 0 1-1.06-2.122m-1.061 4.243a6.75 6.75 0 0 1-1.625-6.929m-.496 9.05c-3.068-3.067-3.664-7.67-1.79-11.334M12 12h.008v.008H12V12Z"}))}const et=s.forwardRef(Xe);function tt({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.348 14.652a3.75 3.75 0 0 1 0-5.304m5.304 0a3.75 3.75 0 0 1 0 5.304m-7.425 2.121a6.75 6.75 0 0 1 0-9.546m9.546 0a6.75 6.75 0 0 1 0 9.546M5.106 18.894c-3.808-3.807-3.808-9.98 0-13.788m13.788 0c3.808 3.807 3.808 9.98 0 13.788M12 12h.008v.008H12V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const st=s.forwardRef(tt);function at({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"}))}const rt=s.forwardRef(at);function nt({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const it=s.forwardRef(nt);function lt({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const ot=s.forwardRef(lt);function ct({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z"}))}const dt=s.forwardRef(ct);function mt({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17 17.25 21A2.652 2.652 0 0 0 21 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 1 1-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 0 0 4.486-6.336l-3.276 3.277a3.004 3.004 0 0 1-2.25-2.25l3.276-3.276a4.5 4.5 0 0 0-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437 1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008Z"}))}const xt=s.forwardRef(mt);function ht({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ut=s.forwardRef(ht);function gt({title:e,titleId:t,...a},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const pt=s.forwardRef(gt),vt=({drone:e,isSelected:t,onSelect:s,getBatteryColor:a,getStatusColor:r})=>{const n=(c=e.signalStrength)>-50?{level:"Excellent",color:"#238636"}:c>-70?{level:"Good",color:"#d29922"}:c>-90?{level:"Poor",color:"#da3633"}:{level:"Very Poor",color:"#f85149"};var c;return e.position.lat&&e.position.lng?I.jsx(i,{position:[e.position.lat,e.position.lng],icon:(()=>{const s=r(e.status),n=a(e.batteryLevel),i=e.batteryLevel<30;return o.divIcon({html:`\n        <div class="relative">\n          \x3c!-- Pulse animation for selected drone --\x3e\n          ${t?'\n            <div class="absolute inset-0 animate-ping">\n              <div class="w-6 h-6 bg-blue-400 rounded-full opacity-30"></div>\n            </div>\n          ':""}\n          \n          \x3c!-- Low battery warning pulse --\x3e\n          ${i?'\n            <div class="absolute inset-0 animate-pulse">\n              <div class="w-6 h-6 bg-red-400 rounded-full opacity-40"></div>\n            </div>\n          ':""}\n          \n          \x3c!-- Main drone icon --\x3e\n          <div class="relative w-6 h-6 rounded-full border-2 flex items-center justify-center transform transition-transform hover:scale-110"\n               style="background-color: #161b22; border-color: ${s}">\n            \x3c!-- Drone symbol --\x3e\n            <svg class="w-3 h-3" style="color: ${s}" fill="currentColor" viewBox="0 0 24 24">\n              <path d="M12 2l3.5 3.5h-7L12 2zM5.5 8.5L2 12l3.5 3.5V8.5zM18.5 8.5v7L22 12l-3.5-3.5zM8.5 18.5L12 22l3.5-3.5h-7z"/>\n              <circle cx="12" cy="12" r="2"/>\n            </svg>\n          </div>\n          \n          \x3c!-- Battery indicator --\x3e\n          <div class="absolute -bottom-1 -right-1 w-3 h-1.5 rounded-sm border"\n               style="background-color: ${n}; border-color: #30363d">\n          </div>\n          \n          \x3c!-- Status indicator dot --\x3e\n          <div class="absolute -top-1 -right-1 w-2 h-2 rounded-full"\n               style="background-color: ${s}">\n          </div>\n        </div>\n      `,className:"drone-marker",iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]})})(),eventHandlers:{click:s},children:I.jsx(l,{className:"drone-popup",maxWidth:320,minWidth:280,children:I.jsxs("div",{className:"bg-dark-secondary text-text-primary p-4 rounded-lg border border-dark-border",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3",children:[I.jsxs("div",{children:[I.jsx("h3",{className:"font-semibold text-lg",children:e.name}),I.jsx("p",{className:"text-text-secondary text-sm",children:e.id})]}),I.jsx("div",{className:"text-right",children:I.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium",style:{backgroundColor:r(e.status)+"20",color:r(e.status)},children:e.status.toUpperCase()})})]}),I.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[I.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[I.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[I.jsx(H,{className:"w-4 h-4 text-text-secondary"}),I.jsx("span",{className:"text-xs text-text-secondary",children:"Battery"})]}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"flex-1 bg-dark-border rounded-full h-1.5",children:I.jsx("div",{className:"h-full rounded-full transition-all duration-300",style:{width:`${e.batteryLevel}%`,backgroundColor:a(e.batteryLevel)}})}),I.jsxs("span",{className:"text-sm font-mono",children:[e.batteryLevel,"%"]})]})]}),I.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[I.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[I.jsx(st,{className:"w-4 h-4 text-text-secondary"}),I.jsx("span",{className:"text-xs text-text-secondary",children:"Signal"})]}),I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-xs",style:{color:n.color},children:n.level}),I.jsxs("span",{className:"text-sm font-mono text-text-secondary",children:[e.signalStrength,"dBm"]})]})]})]}),I.jsxs("div",{className:"space-y-2 text-sm",children:[I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Altitude"}),I.jsxs("span",{className:"font-mono",children:[e.position.alt.toFixed(1),"m"]})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Speed"}),I.jsxs("span",{className:"font-mono",children:[e.speed.toFixed(1)," m/s"]})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Heading"}),I.jsxs("span",{className:"font-mono",children:[e.heading.toFixed(0),"Â°"]})]})]}),e.currentMission&&I.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-border",children:[I.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[I.jsx("div",{className:"w-2 h-2 rounded-full bg-status-active"}),I.jsx("span",{className:"text-sm font-medium",children:"Active Mission"})]}),I.jsxs("div",{className:"text-sm space-y-1",children:[I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Mission"}),I.jsx("span",{children:e.currentMission.name})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Progress"}),I.jsxs("span",{children:[e.currentMission.progress,"%"]})]}),e.currentMission.eta&&I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"ETA"}),I.jsx("span",{children:e.currentMission.eta})]})]})]}),e.alerts&&e.alerts.length>0&&I.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-border",children:[I.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[I.jsx(Ne,{className:"w-4 h-4 text-status-warning"}),I.jsxs("span",{className:"text-sm font-medium text-status-warning",children:[e.alerts.length," Alert",e.alerts.length>1?"s":""]})]}),I.jsxs("div",{className:"space-y-1",children:[e.alerts.slice(0,2).map((e,t)=>I.jsx("div",{className:"text-xs p-2 bg-dark-primary rounded border-l-2",style:{borderLeftColor:"critical"===e.severity?"#da3633":"#d29922"},children:e.message},t)),e.alerts.length>2&&I.jsxs("p",{className:"text-xs text-text-secondary",children:["+",e.alerts.length-2," more alerts"]})]})]}),I.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-border text-xs text-text-muted",children:["Last updated: ",(e=>{const t=new Date(e),s=(new Date).getTime()-t.getTime(),a=Math.floor(s/1e3);return a<60?`${a}s ago`:a<3600?`${Math.floor(a/60)}m ago`:`${Math.floor(a/3600)}h ago`})(e.lastUpdate)]})]})})}):null},yt=({mission:e})=>{const t=(t,s)=>{const a=t.completed||s<(e.currentWaypoint||0),r=s===(e.currentWaypoint||0);return o.divIcon({html:`\n        <div class="relative">\n          <div class="w-4 h-4 rounded-full border-2 flex items-center justify-center text-xs font-bold"\n               style="background-color: ${a?"#238636":r?"#1f6feb":"#161b22"}; \n                      border-color: ${a?"#238636":r?"#1f6feb":"#8b949e"};\n                      color: #f0f6fc">\n            ${s+1}\n          </div>\n          ${r?'\n            <div class="absolute inset-0 animate-ping">\n              <div class="w-4 h-4 bg-blue-400 rounded-full opacity-30"></div>\n            </div>\n          ':""}\n        </div>\n      `,className:"waypoint-marker",iconSize:[16,16],iconAnchor:[8,8],popupAnchor:[0,-8]})},s=e=>{switch(e.toLowerCase()){case"pickup":return"ðŸ“¦";case"delivery":return"ðŸšš";case"hover":return"â¸ï¸";case"survey":return"ðŸ“·";default:return"ðŸ“"}};if(!e.waypoints||0===e.waypoints.length)return null;const a=e.waypoints.filter(e=>e.position.lat&&e.position.lng).map(e=>[e.position.lat,e.position.lng]);if(0===a.length)return null;const r=(e=>{switch(e.toLowerCase()){case"active":case"in_progress":return"#1f6feb";case"completed":return"#238636";case"failed":case"cancelled":return"#da3633";default:return"#8b949e"}})(e.status);return I.jsxs(I.Fragment,{children:[I.jsx(c,{positions:a,pathOptions:{color:r,weight:3,opacity:.8,dashArray:"pending"===e.status?"10, 5":void 0}}),e.waypoints.map((a,r)=>a.position.lat&&a.position.lng?I.jsx(i,{position:[a.position.lat,a.position.lng],icon:t(a,r),children:I.jsx(l,{className:"waypoint-popup",maxWidth:250,children:I.jsxs("div",{className:"bg-dark-secondary text-text-primary p-3 rounded-lg border border-dark-border",children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsxs("h4",{className:"font-semibold",children:["Waypoint ",r+1]}),I.jsx("span",{className:"text-lg",children:s(a.action)})]}),I.jsxs("div",{className:"space-y-2 text-sm",children:[I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Action"}),I.jsx("span",{className:"capitalize",children:a.action})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Altitude"}),I.jsxs("span",{className:"font-mono",children:[a.position.alt,"m"]})]}),a.hoverTime&&I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Hover Time"}),I.jsxs("span",{className:"font-mono",children:[a.hoverTime,"s"]})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Status"}),I.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium "+(a.completed||r<(e.currentWaypoint||0)?"bg-green-900/30 text-green-400":r===(e.currentWaypoint||0)?"bg-blue-900/30 text-blue-400":"bg-gray-900/30 text-gray-400"),children:a.completed||r<(e.currentWaypoint||0)?"Completed":r===(e.currentWaypoint||0)?"Current":"Pending"})]})]}),a.notes&&I.jsx("div",{className:"mt-2 pt-2 border-t border-dark-border",children:I.jsx("p",{className:"text-xs text-text-secondary",children:a.notes})})]})})},`${e.id}-wp-${r}`):null)]})},bt=()=>{const e=x();return s.useEffect(()=>{const t=setTimeout(()=>{e.invalidateSize()},100);return()=>clearTimeout(t)},[e]),null},ft=({drones:e,missions:t=[],selectedDroneId:a,onDroneSelect:r,className:n=""})=>{const[i,l]=s.useState([37.7749,-122.4194]),[o,c]=s.useState(12),x=s.useRef(null);s.useEffect(()=>{if(e.length>0){const t=e.filter(e=>e.position.lat&&e.position.lng);if(t.length>0){const e=t.reduce((e,t)=>e+t.position.lat,0)/t.length,s=t.reduce((e,t)=>e+t.position.lng,0)/t.length;l([e,s])}}},[e]),s.useEffect(()=>{const e=new ResizeObserver(()=>{setTimeout(()=>{window.dispatchEvent(new Event("resize"))},100)});return x.current&&e.observe(x.current),()=>{e.disconnect()}},[]);const u=e=>e>70?"#238636":e>30?"#d29922":e>15?"#da3633":"#f85149",g=e=>{switch(e.toLowerCase()){case"active":case"in_flight":return"#238636";case"charging":case"returning":return"#d29922";case"maintenance":case"emergency":return"#da3633";default:return"#8b949e"}};return I.jsxs("div",{ref:x,className:`fleet-map-container relative h-full w-full bg-dark-primary rounded-lg overflow-hidden border border-dark-border ${n}`,children:[I.jsxs(h.div,{className:"absolute top-4 left-4 z-[1000] bg-dark-secondary/90 backdrop-blur-sm rounded-lg p-3 shadow-lg border border-dark-border",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},children:[I.jsx("h3",{className:"text-text-primary font-semibold mb-2",children:"Fleet Overview"}),I.jsxs("div",{className:"flex gap-4 text-sm",children:[I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("div",{className:"w-2 h-2 rounded-full bg-status-operational"}),I.jsxs("span",{className:"text-text-secondary",children:[e.filter(e=>"active"===e.status||"in_flight"===e.status).length," Active"]})]}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("div",{className:"w-2 h-2 rounded-full bg-status-warning"}),I.jsxs("span",{className:"text-text-secondary",children:[e.filter(e=>"charging"===e.status||"idle"===e.status).length," Standby"]})]}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("div",{className:"w-2 h-2 rounded-full bg-status-critical"}),I.jsxs("span",{className:"text-text-secondary",children:[e.filter(e=>"maintenance"===e.status||"emergency"===e.status).length," Issues"]})]})]})]}),I.jsx(h.div,{className:"absolute top-4 right-4 z-[1000] bg-dark-secondary/90 backdrop-blur-sm rounded-lg p-2 shadow-lg border border-dark-border",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},children:I.jsxs("div",{className:"flex flex-col gap-2",children:[I.jsx("button",{className:"px-3 py-1 text-xs bg-dark-tertiary hover:bg-dark-hover text-text-primary rounded border border-dark-border transition-colors",onClick:()=>c(Math.min(o+1,18)),children:"Zoom In"}),I.jsx("button",{className:"px-3 py-1 text-xs bg-dark-tertiary hover:bg-dark-hover text-text-primary rounded border border-dark-border transition-colors",onClick:()=>c(Math.max(o-1,1)),children:"Zoom Out"}),I.jsx("button",{className:"px-3 py-1 text-xs bg-dark-tertiary hover:bg-dark-hover text-text-primary rounded border border-dark-border transition-colors",onClick:()=>{if(e.length>0){const t=e.filter(e=>e.position.lat&&e.position.lng);if(t.length>0){const e=t.reduce((e,t)=>e+t.position.lat,0)/t.length,s=t.reduce((e,t)=>e+t.position.lng,0)/t.length;l([e,s]),c(12)}}},children:"Center Fleet"})]})}),I.jsx("div",{className:"absolute inset-0 w-full h-full",children:I.jsxs(d,{center:i,zoom:o,style:{height:"100%",width:"100%",minHeight:"400px"},zoomControl:!1,attributionControl:!1,className:"leaflet-container bg-dark-primary",children:[I.jsx(bt,{}),I.jsx(m,{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors Â© <a href="https://carto.com/attributions">CARTO</a>'}),t.map(e=>I.jsx(yt,{mission:e},e.id)),e.map(e=>I.jsx(vt,{drone:e,isSelected:e.id===a,onSelect:()=>r(e.id),getBatteryColor:u,getStatusColor:g},e.id))]})}),I.jsxs(h.div,{className:"absolute bottom-4 left-4 z-[1000] bg-dark-secondary/90 backdrop-blur-sm rounded-lg p-3 shadow-lg border border-dark-border",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[I.jsx("h4",{className:"text-text-primary font-medium text-sm mb-2",children:"Legend"}),I.jsxs("div",{className:"space-y-1 text-xs",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"w-3 h-3 rounded-full bg-status-operational border border-dark-border"}),I.jsx("span",{className:"text-text-secondary",children:"Active Drone"})]}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"w-3 h-3 rounded-full bg-status-warning border border-dark-border"}),I.jsx("span",{className:"text-text-secondary",children:"Standby/Charging"})]}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"w-3 h-3 rounded-full bg-status-critical border border-dark-border"}),I.jsx("span",{className:"text-text-secondary",children:"Issue/Maintenance"})]}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"w-3 h-0.5 bg-status-active"}),I.jsx("span",{className:"text-text-secondary",children:"Mission Path"})]})]})]})]})},jt=({level:e,voltage:t,size:s="md",showLabel:a=!1,showVoltage:r=!1,className:n=""})=>{const i=()=>{switch(s){case"sm":return"text-xs";case"lg":return"text-base";default:return"text-sm"}},l=(o=e)>70?"#238636":o>30?"#d29922":o>15?"#da3633":"#f85149";var o;const c=e<30,d=e<15;return I.jsxs("div",{className:`flex items-center gap-2 ${n}`,children:[I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsxs("div",{className:"relative",children:[I.jsxs("div",{className:`${(()=>{switch(s){case"sm":return"w-12";case"lg":return"w-20";default:return"w-16"}})()} ${(()=>{switch(s){case"sm":return"h-6";case"lg":return"h-10";default:return"h-8"}})()} border-2 rounded-sm relative overflow-hidden`,style:{borderColor:l},children:[I.jsx(h.div,{className:"h-full rounded-sm",style:{backgroundColor:l},initial:{width:0},animate:{width:`${Math.max(e,0)}%`},transition:{duration:.5,ease:"easeOut"}}),d&&I.jsx(h.div,{className:"absolute inset-0 bg-red-500",animate:{opacity:[.3,.7,.3]},transition:{duration:1,repeat:1/0}})]}),I.jsx("div",{className:"absolute -right-1 top-1/2 transform -translate-y-1/2 w-1 bg-current rounded-r-sm "+("sm"===s?"h-2":"lg"===s?"h-4":"h-3"),style:{color:l}}),c&&I.jsx("div",{className:"absolute -top-1 -right-1",children:I.jsx(K,{className:("sm"===s?"w-3 h-3":"w-4 h-4")+" text-red-500"})})]}),a&&I.jsxs("span",{className:`font-mono font-semibold ${i()}`,style:{color:l},children:[e.toFixed(0),"%"]})]}),r&&t&&I.jsx("div",{className:`text-text-secondary ${i()}`,children:I.jsxs("span",{className:"font-mono",children:[t.toFixed(1),"V"]})}),a&&"sm"!==s&&I.jsx("div",{className:`${i()} text-text-secondary`,children:d?"Critical":c?"Low":e>80?"Excellent":"Good"})]})},Nt=({drone:e,isSelected:t,onSelect:s,onAction:a,index:r})=>{const n=(e=>{switch(e.toLowerCase()){case"active":case"in_flight":return{color:"#238636",bgColor:"#238636",label:"Active",icon:se};case"charging":return{color:"#d29922",bgColor:"#d29922",label:"Charging",icon:H};case"maintenance":return{color:"#da3633",bgColor:"#da3633",label:"Maintenance",icon:Ne};case"emergency":return{color:"#f85149",bgColor:"#f85149",label:"Emergency",icon:Ke};default:return{color:"#8b949e",bgColor:"#8b949e",label:"Idle",icon:ue}}})(e.status),i=n.icon;return I.jsxs(h.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,delay:.05*r},onClick:s,className:`\n        relative bg-dark-tertiary rounded-lg p-3 border cursor-pointer transition-all duration-200 hover:bg-dark-hover w-full\n        ${t?"border-status-active shadow-glow":"border-dark-border hover:border-dark-hover"}\n      `,children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[I.jsxs("div",{className:"flex-shrink-0 relative",children:[I.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center border",style:{backgroundColor:n.bgColor+"20",borderColor:n.color},children:I.jsx(i,{className:"w-4 h-4",style:{color:n.color}})}),e.alerts&&e.alerts.length>0&&I.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-status-warning rounded-full flex items-center justify-center",children:I.jsx("span",{className:"text-xs font-bold text-white text-[10px]",children:e.alerts.length})})]}),I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("h3",{className:"font-medium text-text-primary text-sm truncate",children:e.name}),I.jsx("span",{className:"text-text-secondary text-xs font-mono",children:e.id})]}),I.jsx("div",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium mt-1",style:{backgroundColor:n.color+"20",color:n.color},children:n.label})]})]}),I.jsx("button",{onClick:e=>((e,t)=>{t.stopPropagation(),s()})(0,e),className:"p-1.5 rounded hover:bg-dark-secondary transition-colors flex-shrink-0",title:"View Details",style:{color:"#1f6feb"},children:I.jsx(ke,{className:"w-4 h-4"})})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-text-secondary text-xs",children:"Battery"}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("div",{className:"w-16",children:I.jsx(jt,{level:e.batteryLevel,voltage:e.batteryVoltage,inFlight:["active","in_flight"].includes(e.status),status:e.status,size:"sm",showVoltage:!1})}),I.jsxs("span",{className:"text-xs text-text-primary font-mono",children:[Math.round(e.batteryLevel),"%"]})]})]}),I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-text-secondary text-xs",children:"Signal"}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"flex items-end gap-0.5",children:[0,1,2,3].map(t=>I.jsx("div",{className:"w-0.5 rounded-sm "+(0===t?"h-2":1===t?"h-3":"h-4"),style:{backgroundColor:e.signalStrength>-50-20*t?"#238636":"#30363d"}},t))}),I.jsxs("span",{className:"text-xs font-mono text-text-secondary truncate",children:[Math.round(e.signalStrength),"dBm"]})]})]}),e.emergencyState&&!e.emergencyState.resolved&&I.jsxs("div",{className:"flex items-center justify-between bg-red-900/20 border border-red-500/30 rounded p-1.5",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx(Ce,{className:"w-3 h-3 text-red-400 flex-shrink-0"}),I.jsx("span",{className:"text-xs font-medium text-red-400",children:"EMERGENCY"})]}),I.jsx("div",{className:"flex items-center gap-1",children:I.jsx("span",{className:"text-xs text-red-300 truncate max-w-20",title:e.emergencyState.description,children:e.emergencyState.type.replace("_"," ").toUpperCase()})})]}),e.alerts?.some(e=>"coordination"===e.category)&&I.jsxs("div",{className:"flex items-center justify-between bg-blue-900/20 border border-blue-500/30 rounded p-1.5",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx(F,{className:"w-3 h-3 text-blue-400 flex-shrink-0"}),I.jsx("span",{className:"text-xs font-medium text-blue-400",children:"COORDINATION"})]}),I.jsx("div",{className:"flex items-center gap-1",children:I.jsx("span",{className:"text-xs text-blue-300 truncate max-w-24",children:e.alerts.find(e=>"coordination"===e.category)?.message.includes("avoidance")?"MANEUVER":"WARNING"})})]}),e.alerts?.some(e=>"charging"===e.category)&&I.jsxs("div",{className:"flex items-center justify-between bg-yellow-900/20 border border-yellow-500/30 rounded p-1.5",children:[I.jsxs("div",{className:"flex items-center gap-2",children:["charging"===e.status?I.jsx(H,{className:"w-3 h-3 text-yellow-400 flex-shrink-0"}):I.jsx(He,{className:"w-3 h-3 text-yellow-400 flex-shrink-0"}),I.jsx("span",{className:"text-xs font-medium text-yellow-400",children:"charging"===e.status?"CHARGING":"QUEUED"})]}),I.jsx("div",{className:"flex items-center gap-1",children:I.jsx("span",{className:"text-xs text-yellow-300 truncate max-w-24",children:"charging"===e.status?e.alerts.find(e=>"charging"===e.category)?.message.match(/\d+min/)?.[0]||"ACTIVE":`POS ${e.alerts.find(e=>"charging"===e.category)?.message.match(/position (\d+)/)?.[1]||"?"}`})})]}),I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-text-secondary text-xs",children:e.currentMission?"Mission":"Altitude"}),e.currentMission?I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("div",{className:"w-1.5 h-1.5 bg-status-active rounded-full"}),I.jsxs("span",{className:"text-xs text-text-primary font-medium",children:[Math.round(e.currentMission.progress),"%"]})]}):I.jsxs("span",{className:"text-xs text-text-primary font-mono",children:[Math.round(e.position.alt),"m"]})]})]}),I.jsxs("div",{className:"flex items-center justify-between mt-2 pt-2 border-t border-dark-border text-xs",children:[I.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[I.jsxs("span",{className:"text-text-secondary whitespace-nowrap",children:[Math.round(10*e.speed)/10,"m/s"]}),e.alerts&&e.alerts.length>0&&I.jsxs("span",{className:"text-status-warning whitespace-nowrap",children:[e.alerts.length," alerts"]})]}),I.jsx("span",{className:"text-text-muted text-right whitespace-nowrap flex-shrink-0",children:(e=>{const t=new Date(e),s=(new Date).getTime()-t.getTime(),a=Math.floor(s/1e3);return a<60?`${a}s ago`:a<3600?`${Math.floor(a/60)}m ago`:`${Math.floor(a/3600)}h ago`})(e.lastUpdate)})]})]})},wt=({stats:e})=>{const t=[{label:"Total Drones",value:e.total,color:"#8b949e",icon:null},{label:"Active",value:e.active,color:"#238636",icon:se},{label:"Avg Battery",value:`${e.avgBattery.toFixed(0)}%`,color:(s=e.avgBattery,s>70?"#238636":s>30?"#d29922":"#da3633"),icon:H},{label:"Alerts",value:e.alerts,color:e.alerts>0?"#d29922":"#8b949e",icon:Ne,highlight:e.alerts>0}];var s;return I.jsx("div",{className:"grid grid-cols-4 gap-4",children:t.map((e,t)=>I.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*t},className:"text-center p-3 rounded-lg "+(e.highlight?"bg-dark-tertiary border border-status-warning/30":"bg-dark-tertiary"),children:[e.icon&&I.jsx("div",{className:"flex justify-center mb-1",children:I.jsx(e.icon,{className:"w-4 h-4",style:{color:e.color}})}),I.jsx("div",{className:"text-xl font-bold",style:{color:e.color},children:e.value}),I.jsx("div",{className:"text-xs text-text-secondary",children:e.label})]},e.label))})},kt=({drones:e,selectedDroneId:t,onDroneSelect:a,onDroneAction:r,className:n=""})=>{const[i,l]=s.useState("all"),[o,c]=s.useState("status"),d={total:e.length,active:e.filter(e=>"active"===e.status||"in_flight"===e.status).length,charging:e.filter(e=>"charging"===e.status).length,maintenance:e.filter(e=>"maintenance"===e.status||"emergency"===e.status).length,idle:e.filter(e=>"idle"===e.status).length,lowBattery:e.filter(e=>e.batteryLevel<30).length,alerts:e.reduce((e,t)=>e+(t.alerts?.length||0),0),avgBattery:e.length>0?e.reduce((e,t)=>e+t.batteryLevel,0)/e.length:0},m=e.filter(e=>{switch(i){case"active":return"active"===e.status||"in_flight"===e.status;case"issues":return"maintenance"===e.status||"emergency"===e.status||e.alerts&&e.alerts.length>0;case"idle":return"idle"===e.status||"charging"===e.status;default:return!0}}).sort((e,t)=>{switch(o){case"name":return e.name.localeCompare(t.name);case"battery":return t.batteryLevel-e.batteryLevel;case"status":const s={emergency:0,maintenance:1,active:2,in_flight:2,charging:3,idle:4};return(s[e.status]||5)-(s[t.status]||5);case"lastUpdate":return new Date(t.lastUpdate).getTime()-new Date(e.lastUpdate).getTime();default:return 0}}),x=[{value:"all",label:`All (${d.total})`,count:d.total},{value:"active",label:`Active (${d.active})`,count:d.active},{value:"issues",label:`Issues (${d.maintenance})`,count:d.maintenance},{value:"idle",label:`Idle (${d.idle+d.charging})`,count:d.idle+d.charging}],h=[{id:"1",type:"mission_complete",drone:"DRN001",message:"Delivery mission completed successfully",timestamp:new Date(Date.now()-3e5)},{id:"2",type:"battery_low",drone:"DRN003",message:"Battery level below 25%",timestamp:new Date(Date.now()-6e5)},{id:"3",type:"charging_start",drone:"DRN002",message:"Started charging at Station Alpha",timestamp:new Date(Date.now()-9e5)},{id:"4",type:"mission_start",drone:"DRN004",message:"Started emergency medical delivery",timestamp:new Date(Date.now()-12e5)},{id:"5",type:"maintenance",drone:"DRN005",message:"Scheduled maintenance completed",timestamp:new Date(Date.now()-18e5)}];return I.jsxs("div",{className:`h-full flex flex-col ${n}`,children:[I.jsx("div",{className:"p-4 border-b border-dark-border",children:I.jsx(wt,{stats:d})}),I.jsx("div",{className:"p-4 border-b border-dark-border",children:I.jsxs("div",{className:"flex flex-col gap-3",children:[I.jsx("div",{className:"grid grid-cols-2 gap-1",children:x.map(e=>I.jsx("button",{onClick:()=>l(e.value),className:"px-2 py-1 rounded text-xs font-medium transition-all duration-200 "+(i===e.value?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"),children:e.label},e.value))}),I.jsxs("select",{value:o,onChange:e=>c(e.target.value),className:"w-full px-2 py-1 bg-dark-tertiary text-text-primary rounded border border-dark-border text-xs focus:outline-none focus:ring-1 focus:ring-status-active",children:[I.jsx("option",{value:"status",children:"Sort by Status"}),I.jsx("option",{value:"name",children:"Sort by Name"}),I.jsx("option",{value:"battery",children:"Sort by Battery"}),I.jsx("option",{value:"lastUpdate",children:"Sort by Update"})]})]})}),I.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin",children:I.jsxs("div",{className:"p-2 space-y-3",children:[I.jsx(u,{mode:"popLayout",children:m.map((e,s)=>I.jsx(Nt,{drone:e,isSelected:e.id===t,onSelect:()=>a(e.id),onAction:r,index:s},e.id))}),0===m.length&&I.jsxs("div",{className:"text-center py-8 text-text-secondary",children:[I.jsx(ut,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),I.jsx("p",{className:"text-sm",children:"No drones match filter"}),I.jsx("button",{onClick:()=>l("all"),className:"mt-2 px-2 py-1 bg-dark-tertiary text-text-primary rounded text-xs hover:bg-dark-hover transition-colors",children:"Show All"})]})]})}),I.jsx("div",{className:"border-t border-dark-border",children:I.jsxs("div",{className:"p-3",children:[I.jsx("h4",{className:"text-sm font-medium text-text-primary mb-2",children:"Recent Activity"}),I.jsx("div",{className:"space-y-1",children:h.slice(0,3).map(e=>I.jsxs("div",{className:"text-xs text-text-secondary",children:[I.jsxs("span",{className:"font-medium",children:[e.drone,":"]})," ",e.message]},e.id))})]})})]})},St=({strength:e,quality:t,size:s="md",showLabel:a=!1,showStrength:r=!1,className:n=""})=>{const i=e=>{switch(s){case"sm":return 0===e?"h-2":1===e?"h-3":2===e?"h-4":"h-5";case"lg":return 0===e?"h-4":1===e?"h-6":2===e?"h-8":"h-10";default:return 0===e?"h-3":1===e?"h-4":2===e?"h-5":"h-6"}},l=()=>{switch(s){case"sm":default:return"w-0.5";case"lg":return"w-1"}},o=()=>{switch(s){case"sm":return"text-xs";case"lg":return"text-base";default:return"text-sm"}},c=(d=e)>-50?{level:"Excellent",color:"#238636",bars:4}:d>-70?{level:"Good",color:"#d29922",bars:3}:d>-85?{level:"Fair",color:"#d29922",bars:2}:d>-95?{level:"Poor",color:"#da3633",bars:1}:{level:"Very Poor",color:"#f85149",bars:0};var d;const m=(t?{excellent:{level:"Excellent",color:"#238636",bars:4},good:{level:"Good",color:"#238636",bars:3},poor:{level:"Poor",color:"#da3633",bars:2},very_poor:{level:"Very Poor",color:"#f85149",bars:1}}[t]:null)||c;return I.jsxs("div",{className:`flex items-center gap-2 ${n}`,children:[I.jsx("div",{className:"flex items-end gap-0.5",children:[0,1,2,3].map(e=>I.jsx(h.div,{className:`${l()} ${i(e)} rounded-sm`,style:{backgroundColor:e<m.bars?m.color:"#30363d"},initial:{scaleY:0},animate:{scaleY:1},transition:{duration:.3,delay:.1*e}},e))}),a&&I.jsx("span",{className:`font-medium ${o()}`,style:{color:m.color},children:m.level}),r&&I.jsx("div",{className:`text-text-secondary ${o()}`,children:I.jsxs("span",{className:"font-mono",children:[e,"dBm"]})}),0===m.bars&&I.jsxs("div",{className:"relative",children:[I.jsx(dt,{className:("sm"===s?"w-3 h-3":"w-4 h-4")+" text-red-500"}),I.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:I.jsx("div",{className:"w-0.5 h-full bg-red-500 rotate-45"})})]})]})},Ct=({data:e})=>{const[t,a]=s.useState("battery"),r=[{id:"battery",label:"Battery Level",color:"#238636",unit:"%",min:0,max:100,criticalLevel:20},{id:"altitude",label:"Altitude",color:"#1f6feb",unit:"m",min:0,max:Math.max(150,Math.max(...e.map(e=>e.altitude||0))+20)},{id:"speed",label:"Ground Speed",color:"#d29922",unit:"m/s",min:0,max:Math.max(20,Math.max(...e.map(e=>e.speed||0))+5)},{id:"signal",label:"Signal Strength",color:"#8957e5",unit:"dBm",min:-100,max:-30,criticalLevel:-90}],n=r.find(e=>e.id===t),i=({active:e,payload:t,label:s})=>e&&t&&t.length?I.jsxs("div",{className:"bg-dark-secondary border border-dark-border rounded-lg p-3 shadow-lg",children:[I.jsx("p",{className:"text-text-secondary text-sm",children:`Time: ${s}`}),I.jsx("p",{className:"text-text-primary font-semibold",children:`${n.label}: ${t[0].value.toFixed(1)}${n.unit}`})]}):null;if(0===e.length)return I.jsxs("div",{className:"text-center text-text-secondary py-8",children:[I.jsx("div",{className:"text-4xl mb-2",children:"ðŸ“ˆ"}),I.jsx("p",{children:"No telemetry data available"}),I.jsx("p",{className:"text-sm",children:"Charts will appear once data starts flowing"})]});const l=e.map(e=>({...e,time:new Date(e.timestamp).toLocaleTimeString("en-US",{hour12:!1,minute:"2-digit",second:"2-digit"})}));return I.jsxs("div",{className:"space-y-4",children:[I.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(e=>I.jsx("button",{onClick:()=>a(e.id),className:"px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 "+(t===e.id?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"),children:I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),e.label]})},e.id))}),I.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-dark-tertiary rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsxs("h3",{className:"text-text-primary font-semibold",children:[n.label," Over Time"]}),I.jsxs("div",{className:"text-text-secondary text-sm",children:["Last ",l.length," data points"]})]}),I.jsx("div",{className:"h-64",children:I.jsx(g,{width:"100%",height:"100%",children:I.jsxs(p,{data:l,margin:{top:5,right:30,left:20,bottom:5},children:[I.jsx(v,{strokeDasharray:"3 3",stroke:"#30363d"}),I.jsx(y,{dataKey:"time",stroke:"#8b949e",fontSize:12,interval:"preserveStartEnd"}),I.jsx(b,{stroke:"#8b949e",fontSize:12,domain:[n.min,n.max]}),I.jsx(f,{content:I.jsx(i,{})}),void 0!==n.criticalLevel&&I.jsx(j,{y:n.criticalLevel,stroke:"#da3633",strokeDasharray:"5 5",label:{value:"Critical",position:"top",fill:"#da3633",fontSize:10}}),I.jsx(N,{type:"monotone",dataKey:t,stroke:n.color,strokeWidth:2,dot:{fill:n.color,strokeWidth:2,r:3},activeDot:{r:5,stroke:n.color,strokeWidth:2},connectNulls:!1})]})})}),I.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-border",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Current Value:"}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("span",{className:"text-2xl font-bold text-text-primary",children:l.length>0&&l[l.length-1][t]?.toFixed(1)||"N/A"}),I.jsx("span",{className:"text-text-secondary",children:n.unit})]})]}),l.length>1&&I.jsxs("div",{className:"flex items-center justify-between mt-2",children:[I.jsx("span",{className:"text-text-secondary",children:"Trend:"}),(()=>{const e=l[l.length-1][t]-l[l.length-2][t],s=e>0,a=e<0;return I.jsxs("div",{className:"flex items-center gap-1 text-sm "+(s?"text-green-400":a?"text-red-400":"text-text-secondary"),children:[I.jsx("span",{children:s?"â†—":a?"â†˜":"â†’"}),I.jsxs("span",{children:[Math.abs(e).toFixed(2)," ",n.unit]})]})})()]})]})]},t),I.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:["min","max","avg","current"].map(e=>{let s,a;const r=l.map(e=>e[t]).filter(e=>null!=e);switch(e){case"min":s=r.length>0?Math.min(...r):0,a="Minimum";break;case"max":s=r.length>0?Math.max(...r):0,a="Maximum";break;case"avg":s=r.length>0?r.reduce((e,t)=>e+t,0)/r.length:0,a="Average";break;case"current":s=r.length>0?r[r.length-1]:0,a="Current";break;default:s=0,a=""}return I.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3",children:[I.jsx("div",{className:"text-text-secondary text-sm",children:a}),I.jsx("div",{className:"text-xl font-bold text-text-primary",children:s.toFixed(1)}),I.jsx("div",{className:"text-xs text-text-secondary",children:n.unit})]},e)})})]})},Mt=({alerts:e,droneId:t,onAcknowledge:a,onResolve:n,onDismiss:i})=>{const l=e=>{const t=new Date(e),s=(new Date).getTime()-t.getTime(),a=Math.floor(s/1e3),r=Math.floor(a/60),n=Math.floor(r/60);return a<60?`${a}s ago`:r<60?`${r}m ago`:n<24?`${n}h ago`:t.toLocaleDateString()},{activeAlerts:o,resolvedAlerts:c}=s.useMemo(()=>{const t=[...e].sort((e,t)=>{const s={critical:4,error:3,warning:2,info:1},a=(s[t.severity]||0)-(s[e.severity]||0);return 0!==a?a:new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()});return{activeAlerts:t.filter(e=>!e.resolved),resolvedAlerts:t.filter(e=>e.resolved)}},[e]);if(0===e.length)return I.jsxs("div",{className:"text-center py-8",children:[I.jsx(se,{className:"w-12 h-12 mx-auto text-status-operational mb-3"}),I.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"No Active Alerts"}),I.jsx("p",{className:"text-text-secondary",children:"All systems are operating normally"})]});const d=r.memo(({alert:e,index:s})=>{const r=(e=>{switch(e){case"critical":return{color:"#f85149",bgColor:"#da3633",icon:ut,label:"Critical"};case"error":return{color:"#da3633",bgColor:"#da3633",icon:ut,label:"Error"};case"warning":return{color:"#d29922",bgColor:"#d29922",icon:Ne,label:"Warning"};case"info":return{color:"#1f6feb",bgColor:"#1f6feb",icon:Ie,label:"Info"};default:return{color:"#8b949e",bgColor:"#8b949e",icon:Ie,label:"Unknown"}}})(e.severity),o=r.icon;return I.jsx(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2,delay:Math.min(.05*s,.3)},className:`bg-dark-tertiary rounded-lg border-l-4 p-4 ${e.acknowledged?"opacity-75":""} ${e.resolved?"opacity-50":""}`,style:{borderLeftColor:r.color},children:I.jsxs("div",{className:"flex items-start justify-between",children:[I.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[I.jsx("div",{className:"flex-shrink-0 mt-0.5",children:I.jsx(o,{className:"w-5 h-5",style:{color:r.color}})}),I.jsxs("div",{className:"flex-1",children:[I.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[I.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium",style:{backgroundColor:r.bgColor+"20",color:r.color},children:r.label}),e.category&&I.jsx("span",{className:"px-2 py-1 bg-dark-border text-text-secondary rounded text-xs",children:e.category}),e.acknowledged&&I.jsx("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-400 rounded text-xs",children:"Acknowledged"}),e.resolved&&I.jsx("span",{className:"px-2 py-1 bg-green-900/30 text-green-400 rounded text-xs",children:"Resolved"})]}),I.jsx("p",{className:"text-text-primary text-sm mb-2",children:e.message}),I.jsxs("div",{className:"flex items-center gap-4 text-xs text-text-secondary",children:[I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx(ue,{className:"w-3 h-3"}),l(e.timestamp)]}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("span",{children:"Drone:"}),I.jsx("span",{className:"font-mono",children:t})]})]})]})]}),I.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[!e.resolved&&!e.acknowledged&&a&&I.jsx("button",{onClick:()=>a(e.id),className:"px-2 py-1 bg-blue-900/30 text-blue-400 hover:bg-blue-900/50 rounded text-xs transition-colors",title:"Acknowledge alert",children:"Ack"}),e.acknowledged&&!e.resolved&&n&&I.jsx("button",{onClick:()=>n(e.id),className:"px-2 py-1 bg-green-900/30 text-green-400 hover:bg-green-900/50 rounded text-xs transition-colors",title:"Mark as resolved",children:"Resolve"}),i&&I.jsx("button",{onClick:()=>i(e.id),className:"p-1 text-text-secondary hover:text-text-primary transition-colors",title:"Dismiss alert",children:I.jsx(pt,{className:"w-4 h-4"})})]})]})})});return I.jsxs("div",{className:"space-y-6",children:[o.length>0&&I.jsxs("div",{children:[I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["Active Alerts (",o.length,")"]}),o.filter(e=>"critical"===e.severity||"error"===e.severity).length>0&&I.jsxs("div",{className:"flex items-center gap-1 text-status-critical text-sm",children:[I.jsx(Ne,{className:"w-4 h-4"}),"Attention Required"]})]}),I.jsx("div",{className:"space-y-3",children:o.map((e,t)=>I.jsx(d,{alert:e,index:t},e.id))})]}),c.length>0&&I.jsxs("div",{children:[I.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:["Recent Resolved (",c.length,")"]}),I.jsx("div",{className:"space-y-3",children:c.slice(0,5).map((e,t)=>I.jsx(d,{alert:e,index:t},e.id))}),c.length>5&&I.jsxs("p",{className:"text-text-secondary text-sm mt-3 text-center",children:["+",c.length-5," more resolved alerts"]})]}),I.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4",children:[I.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Alert Summary"}),I.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Total Alerts"}),I.jsx("div",{className:"text-xl font-bold text-text-primary",children:e.length})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Active"}),I.jsx("div",{className:"text-xl font-bold text-status-warning",children:o.length})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Critical"}),I.jsx("div",{className:"text-xl font-bold text-status-critical",children:e.filter(e=>"critical"===e.severity&&!e.resolved).length})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Resolved"}),I.jsx("div",{className:"text-xl font-bold text-status-operational",children:c.length})]})]})]})]})},Dt=({drone:e,isLive:t=!0,className:a=""})=>{const[r,n]=s.useState("overview"),[i,l]=s.useState([]);if(s.useEffect(()=>{if(e&&t){const t={timestamp:Date.now(),battery:e.batteryLevel,altitude:e.position.alt,speed:e.speed,signalStrength:e.signalStrength};l(e=>[...e,t].slice(-50))}},[e,t]),!e)return I.jsx("div",{className:`h-full w-full flex items-center justify-center ${a}`,children:I.jsxs("div",{className:"text-center text-text-secondary",children:[I.jsx(fe,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),I.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Drone Selected"}),I.jsx("p",{className:"text-sm",children:"Select a drone from the map or fleet list to view telemetry data."})]})});const o=e=>{switch(e.toLowerCase()){case"active":case"in_flight":return"#238636";case"charging":case"returning":return"#d29922";case"maintenance":case"emergency":return"#da3633";default:return"#8b949e"}},c=[{id:"overview",label:"Overview",icon:fe},{id:"charts",label:"Charts",icon:Ze},{id:"alerts",label:"Alerts",icon:Ne,count:e.alerts?.length||0},{id:"system",label:"System",icon:dt}];return I.jsxs("div",{className:`h-full w-full flex flex-col overflow-hidden ${a}`,children:[I.jsxs("div",{className:"flex-shrink-0 p-3 border-b border-dark-border",children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsxs("div",{children:[I.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:e.name}),I.jsx("p",{className:"text-text-secondary text-xs",children:e.id})]}),I.jsxs("div",{className:"flex items-center gap-2",children:[t&&I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("div",{className:"w-2 h-2 bg-status-operational rounded-full animate-pulse"}),I.jsx("span",{className:"text-xs text-text-secondary",children:"Live"})]}),I.jsx("div",{className:"px-2 py-0.5 rounded text-xs font-medium border",style:{backgroundColor:o(e.status)+"20",color:o(e.status),borderColor:o(e.status)+"40"},children:e.status.toUpperCase()})]})]}),I.jsx("div",{className:"flex space-x-0.5",children:c.map(e=>I.jsxs("button",{onClick:()=>n(e.id),className:"px-2 py-1 rounded text-xs font-medium transition-all duration-200 flex items-center gap-1 "+(r===e.id?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"),children:[I.jsx(e.icon,{className:"w-3 h-3"}),e.label,void 0!==e.count&&e.count>0&&I.jsx("span",{className:"bg-status-critical text-white text-xs rounded-full px-1 py-0.5 min-w-[14px] text-center",children:e.count})]},e.id))})]}),I.jsx("div",{className:"flex-1 overflow-hidden",children:I.jsx("div",{className:"h-full overflow-y-auto p-3",children:I.jsxs(u,{mode:"wait",children:["overview"===r&&I.jsxs(h.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"space-y-4",children:[I.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[I.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[I.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[I.jsx(H,{className:"w-4 h-4 text-text-secondary"}),I.jsx("span",{className:"text-xs text-text-secondary",children:"Battery"})]}),I.jsx(jt,{level:e.batteryLevel,voltage:e.batteryVoltage,showLabel:!0,size:"sm"})]}),I.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[I.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[I.jsx(st,{className:"w-4 h-4 text-text-secondary"}),I.jsx("span",{className:"text-xs text-text-secondary",children:"Signal"})]}),I.jsx(St,{strength:e.signalStrength,quality:e.connectionQuality,showLabel:!0,size:"sm"})]}),I.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[I.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[I.jsx(Re,{className:"w-4 h-4 text-text-secondary"}),I.jsx("span",{className:"text-xs text-text-secondary",children:"Altitude"})]}),I.jsx("div",{className:"text-lg font-bold text-text-primary",children:e.position.alt.toFixed(1)}),I.jsx("div",{className:"text-xs text-text-secondary",children:"meters"})]}),I.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[I.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[I.jsx(Ze,{className:"w-4 h-4 text-text-secondary"}),I.jsx("span",{className:"text-xs text-text-secondary",children:"Speed"})]}),I.jsx("div",{className:"text-lg font-bold text-text-primary",children:e.speed.toFixed(1)}),I.jsx("div",{className:"text-xs text-text-secondary",children:"m/s"})]})]}),I.jsxs("div",{className:"bg-dark-tertiary rounded p-3",children:[I.jsxs("h3",{className:"font-medium text-text-primary mb-2 flex items-center gap-1",children:[I.jsx(Ee,{className:"w-4 h-4"}),"Position & Orientation"]}),I.jsxs("div",{className:"grid grid-cols-1 gap-2 text-xs",children:[I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Latitude"}),I.jsxs("span",{className:"font-mono text-text-primary",children:[e.position.lat.toFixed(6),"Â°"]})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Longitude"}),I.jsxs("span",{className:"font-mono text-text-primary",children:[e.position.lng.toFixed(6),"Â°"]})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Heading"}),I.jsxs("span",{className:"font-mono text-text-primary",children:[e.heading.toFixed(1),"Â°"]})]})]})]}),e.currentMission&&I.jsxs("div",{className:"bg-dark-tertiary rounded p-3",children:[I.jsxs("h3",{className:"font-medium text-text-primary mb-2 flex items-center gap-1",children:[I.jsx(se,{className:"w-4 h-4"}),"Current Mission"]}),I.jsxs("div",{className:"space-y-1 text-xs",children:[I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Mission"}),I.jsx("span",{className:"text-text-primary truncate ml-2",children:e.currentMission.name})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Progress"}),I.jsxs("span",{className:"text-text-primary",children:[e.currentMission.progress,"%"]})]}),e.currentMission.eta&&I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"ETA"}),I.jsx("span",{className:"text-text-primary",children:e.currentMission.eta})]}),I.jsx("div",{className:"w-full bg-dark-border rounded-full h-1.5 mt-2",children:I.jsx("div",{className:"bg-status-active h-1.5 rounded-full transition-all duration-300",style:{width:`${e.currentMission.progress}%`}})})]})]})]},"overview"),"charts"===r&&I.jsx(h.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:I.jsx(Ct,{data:i,drone:e})},"charts"),"alerts"===r&&I.jsx(h.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:I.jsx(Mt,{alerts:e.alerts||[],droneId:e.id})},"alerts"),"system"===r&&I.jsxs(h.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"space-y-4",children:[I.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4",children:[I.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"System Information"}),I.jsxs("div",{className:"space-y-2 text-sm",children:[I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Firmware"}),I.jsx("span",{className:"text-text-primary font-mono",children:e.firmware||"v1.12.3"})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Hardware"}),I.jsx("span",{className:"text-text-primary",children:e.hardware||"Pixhawk 4"})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Uptime"}),I.jsx("span",{className:"text-text-primary",children:e.uptime||"2h 34m"})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Last Update"}),I.jsx("span",{className:"text-text-primary",children:(e=>{const t=new Date(e),s=(new Date).getTime()-t.getTime(),a=Math.floor(s/1e3);return a<60?`${a}s ago`:a<3600?`${Math.floor(a/60)}m ago`:`${Math.floor(a/3600)}h ago`})(e.lastUpdate)})]})]})]}),I.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4",children:[I.jsxs("h3",{className:"font-semibold text-text-primary mb-3 flex items-center gap-2",children:[I.jsx(Ce,{className:"w-5 h-5"}),"Environmental"]}),I.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Temperature"}),I.jsxs("div",{className:"font-mono text-text-primary",children:[e.temperature||28.5,"Â°C"]})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Humidity"}),I.jsxs("div",{className:"font-mono text-text-primary",children:[e.humidity||65,"%"]})]})]})]})]},"system")]})})})]})};var At=(e=>(e.CONNECTING="connecting",e.CONNECTED="connected",e.DISCONNECTED="disconnected",e.RECONNECTING="reconnecting",e.ERROR="error",e))(At||{});const Et={url:"ws://localhost:3001/telemetry",reconnectInterval:3e3,maxReconnectAttempts:10,heartbeatInterval:3e4,connectionTimeout:1e4};const Lt=new class{constructor(e){t(this,"ws",null),t(this,"config"),t(this,"connectionState","disconnected"),t(this,"reconnectAttempts",0),t(this,"reconnectTimer",null),t(this,"heartbeatTimer",null),t(this,"connectionTimer",null),t(this,"onConnectionStateChange",null),t(this,"onMessage",null),t(this,"onDroneUpdate",null),t(this,"onMissionUpdate",null),t(this,"onFleetAlert",null),t(this,"stats",{messagesReceived:0,messagesProcessed:0,lastMessageTime:null,connectionUptime:null,reconnectCount:0}),this.config={...Et,...e}}connect(){if("connected"!==this.connectionState&&"connecting"!==this.connectionState){this.setConnectionState("connecting"),this.clearTimers();try{this.ws=new WebSocket(this.config.url),this.setupEventHandlers(),this.startConnectionTimeout()}catch(e){console.error("Failed to create WebSocket connection:",e),this.setConnectionState("error",e),this.scheduleReconnect()}}else console.warn("WebSocket already connected or connecting")}disconnect(){console.log("Disconnecting from telemetry service..."),this.clearTimers(),this.ws&&(this.ws.close(1e3,"Client disconnect"),this.ws=null),this.setConnectionState("disconnected"),this.reconnectAttempts=0}setConnectionStateCallback(e){this.onConnectionStateChange=e}onTelemetryMessage(e){this.onMessage=e}onDroneDataUpdate(e){this.onDroneUpdate=e}onMissionDataUpdate(e){this.onMissionUpdate=e}onFleetAlertReceived(e){this.onFleetAlert=e}getConnectionState(){return this.connectionState}getStatistics(){return{...this.stats,connectionState:this.connectionState,reconnectAttempts:this.reconnectAttempts,uptime:this.stats.connectionUptime?Date.now()-this.stats.connectionUptime.getTime():0}}isConnected(){return"connected"===this.connectionState}setupEventHandlers(){this.ws&&(this.ws.onopen=()=>{console.log("Connected to telemetry service"),this.clearConnectionTimeout(),this.setConnectionState("connected"),this.reconnectAttempts=0,this.stats.connectionUptime=new Date,this.stats.reconnectCount++,this.startHeartbeat()},this.ws.onmessage=e=>{try{const t=JSON.parse(e.data);this.handleMessage(t)}catch(t){console.error("Failed to parse telemetry message:",t,e.data)}},this.ws.onclose=e=>{console.log("WebSocket connection closed:",e.code,e.reason),this.clearTimers(),1e3!==e.code?(this.setConnectionState("disconnected"),this.scheduleReconnect()):this.setConnectionState("disconnected")},this.ws.onerror=e=>{console.error("WebSocket error:",e),this.setConnectionState("error",new Error("WebSocket connection error"))})}handleMessage(e){this.stats.messagesReceived++,this.stats.lastMessageTime=new Date,this.onMessage&&this.onMessage(e);try{switch(e.type){case"drone_update":const t=e;this.onDroneUpdate&&this.onDroneUpdate(t.data);break;case"mission_update":const s=e;this.onMissionUpdate&&this.onMissionUpdate(s.data);break;case"fleet_alert":const a=e;this.onFleetAlert&&this.onFleetAlert(a.data);break;case"heartbeat":console.debug("Heartbeat received from server");break;default:console.warn("Unknown message type:",e.type)}this.stats.messagesProcessed++}catch(t){console.error("Failed to process telemetry message:",t,e)}}setConnectionState(e,t){this.connectionState!==e&&(this.connectionState=e,console.log(`WebSocket state changed to: ${e}`),this.onConnectionStateChange&&this.onConnectionStateChange(e,t))}scheduleReconnect(){if(this.reconnectAttempts>=this.config.maxReconnectAttempts)return console.error("Max reconnect attempts reached"),void this.setConnectionState("error",new Error("Max reconnect attempts exceeded"));this.reconnectAttempts++,this.setConnectionState("reconnecting"),console.log(`Attempting to reconnect in ${this.config.reconnectInterval}ms (attempt ${this.reconnectAttempts}/${this.config.maxReconnectAttempts})`),this.reconnectTimer=setTimeout(()=>{this.connect()},this.config.reconnectInterval)}startHeartbeat(){this.heartbeatTimer=setInterval(()=>{if(this.ws?.readyState===WebSocket.OPEN)try{this.ws.send(JSON.stringify({type:"ping",timestamp:(new Date).toISOString()}))}catch(e){console.error("Failed to send heartbeat:",e)}},this.config.heartbeatInterval)}startConnectionTimeout(){this.connectionTimer=setTimeout(()=>{"connecting"===this.connectionState&&(console.error("Connection timeout"),this.setConnectionState("error",new Error("Connection timeout")),this.ws?.close(),this.scheduleReconnect())},this.config.connectionTimeout)}clearConnectionTimeout(){this.connectionTimer&&(clearTimeout(this.connectionTimer),this.connectionTimer=null)}clearTimers(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null),this.clearConnectionTimeout()}},It=({connectionState:e,error:t,className:s=""})=>{const a=(()=>{switch(e){case At.CONNECTED:return{icon:se,color:"#238636",bgColor:"#238636",text:"Connected",description:"Real-time telemetry active",pulse:!1};case At.CONNECTING:return{icon:F,color:"#d29922",bgColor:"#d29922",text:"Connecting",description:"Establishing connection...",pulse:!0};case At.RECONNECTING:return{icon:F,color:"#d29922",bgColor:"#d29922",text:"Reconnecting",description:"Attempting to reconnect...",pulse:!0};case At.ERROR:return{icon:Ne,color:"#da3633",bgColor:"#da3633",text:"Error",description:t||"Connection failed",pulse:!1};case At.DISCONNECTED:default:return{icon:ut,color:"#8b949e",bgColor:"#8b949e",text:"Disconnected",description:"No telemetry connection",pulse:!1}}})(),r=a.icon;return I.jsxs("div",{className:`flex items-center gap-3 ${s}`,children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsxs("div",{className:"relative",children:[I.jsx(u,{children:a.pulse&&I.jsx(h.div,{className:"absolute inset-0 rounded-full",style:{backgroundColor:a.color},initial:{scale:1,opacity:.3},animate:{scale:1.5,opacity:0},exit:{scale:1,opacity:.3},transition:{duration:1.5,repeat:1/0,repeatType:"loop"}})}),I.jsx(h.div,{className:"w-8 h-8 rounded-full border-2 flex items-center justify-center",style:{backgroundColor:a.bgColor+"20",borderColor:a.color},animate:a.pulse?{rotate:360}:{},transition:a.pulse?{duration:2,repeat:1/0,ease:"linear"}:{},children:I.jsx(r,{className:"w-4 h-4",style:{color:a.color}})})]}),I.jsxs("div",{className:"text-sm",children:[I.jsx("div",{className:"font-medium",style:{color:a.color},children:a.text}),I.jsx("div",{className:"text-text-muted text-xs",children:a.description})]})]}),I.jsxs("div",{className:"hidden md:flex items-center gap-1 text-xs text-text-secondary",children:[I.jsx(dt,{className:"w-3 h-3"}),I.jsx("span",{children:"ws://localhost:3001/telemetry"})]}),(e===At.ERROR||t)&&I.jsx(h.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"hidden lg:block",children:I.jsxs("div",{className:"bg-dark-tertiary border border-red-800 rounded-lg p-2 max-w-xs",children:[I.jsx("div",{className:"text-xs text-red-300 font-medium mb-1",children:"Connection Error"}),I.jsx("div",{className:"text-xs text-text-secondary",children:t||"Unable to connect to telemetry service"}),I.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Check if the telemetry service is running on port 3001"})]})})]})},$t={},Tt=e=>{let t;const s=new Set,a=(e,a)=>{const r="function"==typeof e?e(t):e;if(!Object.is(r,t)){const e=t;t=(null!=a?a:"object"!=typeof r||null===r)?r:Object.assign({},t,r),s.forEach(s=>s(t,e))}},r=()=>t,n={setState:a,getState:r,getInitialState:()=>i,subscribe:e=>(s.add(e),()=>s.delete(e)),destroy:()=>{"production"!==($t?"production":void 0)&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},i=t=e(a,r,n);return n};var Ot={exports:{}},Rt={},Pt={exports:{}},Wt={},_t=s;var Ft="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Bt=_t.useState,Ut=_t.useEffect,Qt=_t.useLayoutEffect,qt=_t.useDebugValue;function zt(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!Ft(e,s)}catch(a){return!0}}var Ht="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),a=Bt({inst:{value:s,getSnapshot:t}}),r=a[0].inst,n=a[1];return Qt(function(){r.value=s,r.getSnapshot=t,zt(r)&&n({inst:r})},[e,s,t]),Ut(function(){return zt(r)&&n({inst:r}),e(function(){zt(r)&&n({inst:r})})},[e]),qt(s),s};Wt.useSyncExternalStore=void 0!==_t.useSyncExternalStore?_t.useSyncExternalStore:Ht,Pt.exports=Wt;var Vt=Pt.exports,Zt=s,Gt=Vt;
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jt="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Yt=Gt.useSyncExternalStore,Kt=Zt.useRef,Xt=Zt.useEffect,es=Zt.useMemo,ts=Zt.useDebugValue;Rt.useSyncExternalStoreWithSelector=function(e,t,s,a,r){var n=Kt(null);if(null===n.current){var i={hasValue:!1,value:null};n.current=i}else i=n.current;n=es(function(){function e(e){if(!o){if(o=!0,n=e,e=a(e),void 0!==r&&i.hasValue){var t=i.value;if(r(t,e))return l=t}return l=e}if(t=l,Jt(n,e))return t;var s=a(e);return void 0!==r&&r(t,s)?(n=e,t):(n=e,l=s)}var n,l,o=!1,c=void 0===s?null:s;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,s,a,r]);var l=Yt(e,n[0],n[1]);return Xt(function(){i.hasValue=!0,i.value=l},[l]),ts(l),l},Ot.exports=Rt;const ss=n(Ot.exports),as={},{useDebugValue:rs}=r,{useSyncExternalStoreWithSelector:ns}=ss;let is=!1;const ls=e=>e;const os=e=>{"production"!==(as?"production":void 0)&&"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"==typeof e?(e=>e?Tt(e):Tt)(e):e,s=(e,s)=>function(e,t=ls,s){"production"!==(as?"production":void 0)&&s&&!is&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),is=!0);const a=ns(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return rs(a),a}(t,e,s);return Object.assign(s,t),s},cs=e=>os,ds=e=>(t,s,a)=>{const r=a.subscribe;a.subscribe=(e,t,s)=>{let n=e;if(t){const r=(null==s?void 0:s.equalityFn)||Object.is;let i=e(a.getState());n=s=>{const a=e(s);if(!r(i,a)){const e=i;t(i=a,e)}},(null==s?void 0:s.fireImmediately)&&t(i,i)}return r(n)};return e(t,s,a)};const ms=new class{constructor(){t(this,"separationDistance",50),t(this,"warningDistance",75),t(this,"activeAlerts",new Map),t(this,"avoidanceManeuvers",new Map),console.log("ðŸ¤ Coordination Service initialized with 50m separation")}calculateDistance(e,t){const s=e.lat*Math.PI/180,a=t.lat*Math.PI/180,r=(t.lat-e.lat)*Math.PI/180,n=(t.lng-e.lng)*Math.PI/180,i=Math.sin(r/2)*Math.sin(r/2)+Math.cos(s)*Math.cos(a)*Math.sin(n/2)*Math.sin(n/2),l=6371e3*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))),o=Math.abs(e.alt-t.alt);return Math.sqrt(l*l+o*o)}calculateBearing(e,t){const s=e.lat*Math.PI/180,a=t.lat*Math.PI/180,r=(t.lng-e.lng)*Math.PI/180,n=Math.sin(r)*Math.cos(a),i=Math.cos(s)*Math.sin(a)-Math.sin(s)*Math.cos(a)*Math.cos(r);return(180*Math.atan2(n,i)/Math.PI+360)%360}predictPosition(e,t){const s=e.speed*t,a=e.heading*Math.PI/180,r=6371e3,n=s*Math.cos(a)/r*(180/Math.PI),i=s*Math.sin(a)/r*(180/Math.PI)/Math.cos(e.position.lat*Math.PI/180);return{lat:e.position.lat+n,lng:e.position.lng+i,alt:e.position.alt}}checkCollisionRisks(e){const t=e.filter(e=>"active"===e.status||"in_flight"===e.status),s=[],a=Date.now();this.avoidanceManeuvers.forEach((e,t)=>{a>e.endTime&&this.avoidanceManeuvers.delete(t)});for(let r=0;r<t.length;r++)for(let e=r+1;e<t.length;e++){const a=t[r],n=t[e],i=this.calculateDistance(a.position,n.position),l=this.predictPosition(a,10),o=this.predictPosition(n,10),c=this.calculateDistance(l,o),d=Math.min(i,c),m=`${a.id}-${n.id}`;if(d<this.separationDistance){const e={id:m,type:"separation_violation",severity:"critical",droneIds:[a.id,n.id],distance:d,message:`CRITICAL: Drones ${a.name} and ${n.name} within ${d.toFixed(1)}m (minimum ${this.separationDistance}m)`,timestamp:(new Date).toISOString(),resolved:!1,avoidanceAction:this.calculateAvoidanceAction(a,n,d)};s.push(e),this.activeAlerts.set(m,e)}else if(d<this.warningDistance){const e=this.activeAlerts.get(m);if(!e||"collision_warning"!==e.type){const e={id:m,type:"collision_warning",severity:"warning",droneIds:[a.id,n.id],distance:d,message:`Warning: Drones ${a.name} and ${n.name} approaching ${d.toFixed(1)}m separation`,timestamp:(new Date).toISOString(),resolved:!1};s.push(e),this.activeAlerts.set(m,e)}}else{const e=this.activeAlerts.get(m);e&&!e.resolved&&(e.resolved=!0,this.activeAlerts.delete(m))}}return s}calculateAvoidanceAction(e,t,s){const a=e.position.alt-t.position.alt;let r,n,i;if(Math.abs(a)<10){r=e.id<t.id?e:t;n=(this.calculateBearing(e.position,t.position)-e.heading+360)%360<180?"turn_right":"turn_left",i=Math.max(30,60-s)}else r=a<0?e:t,n=a<0?"climb":"descend",i=Math.max(20,this.separationDistance-s+10);return{droneId:r.id,action:n,magnitude:i}}applyAvoidanceManeuver(e,t){if(!t)return!1;const s=Date.now(),a=e.heading;let r=!1;switch(t.action){case"turn_left":e.heading=(e.heading-t.magnitude+360)%360,r=!0;break;case"turn_right":e.heading=(e.heading+t.magnitude)%360,r=!0;break;case"climb":e.position.alt=Math.min(e.position.alt+t.magnitude,200),r=!0;break;case"descend":e.position.alt=Math.max(e.position.alt-t.magnitude,10),r=!0;break;case"slow_down":e.speed=Math.max(.5*e.speed,2),r=!0;break;case"hover":e.speed=0,r=!0}return r&&(this.avoidanceManeuvers.set(t.droneId,{action:t.action,endTime:s+15e3,originalHeading:a}),console.log(`ðŸš Avoidance maneuver applied to ${e.name}: ${t.action} (${t.magnitude})`)),r}getCoordinationStatus(){const e=Array.from(this.activeAlerts.values()).filter(e=>!e.resolved),t=Array.from(this.activeAlerts.values()).filter(e=>e.resolved).length;return{isActive:!0,separationDistance:this.separationDistance,activeWarnings:e,totalConflicts:this.activeAlerts.size,resolvedConflicts:t,lastUpdate:(new Date).toISOString()}}setSeparationDistance(e){this.separationDistance=Math.max(20,Math.min(e,200)),this.warningDistance=1.5*this.separationDistance,console.log(`ðŸ¤ Coordination separation updated to ${this.separationDistance}m`)}resolveAlert(e){const t=this.activeAlerts.get(e);return!!t&&(t.resolved=!0,this.activeAlerts.delete(e),!0)}getActiveManeuvers(){return new Map(this.avoidanceManeuvers)}};const xs=new class{constructor(){t(this,"stations",new Map),t(this,"globalQueue",[]),t(this,"chargingHistory",[]),this.initializeChargingStations(),console.log("ðŸ”‹ Charging Service initialized with queue management")}initializeChargingStations(){this.stations.set("station-001",{id:"station-001",name:"Base Station Alpha",status:"occupied",currentDrone:"drone-002",chargingRate:3.5,estimatedTimeRemaining:12,position:{lat:37.7849,lng:-122.4094,alt:2.1},lastMaintenance:new Date(Date.now()-432e6).toISOString(),totalChargingSessions:47,averageChargingTime:28}),this.stations.set("station-002",{id:"station-002",name:"Base Station Beta",status:"available",chargingRate:4.2,position:{lat:37.765,lng:-122.415,alt:2.5},lastMaintenance:new Date(Date.now()-1728e5).toISOString(),totalChargingSessions:31,averageChargingTime:24}),this.stations.set("station-003",{id:"station-003",name:"Base Station Gamma",status:"available",chargingRate:3,position:{lat:37.755,lng:-122.425,alt:1.8},lastMaintenance:new Date(Date.now()-6912e5).toISOString(),totalChargingSessions:23,averageChargingTime:32}),console.log(`ðŸ”‹ Initialized ${this.stations.size} charging stations`)}calculatePriority(e,t){let s=1;if(e.batteryLevel<10?s+=3:e.batteryLevel<20?s+=2:e.batteryLevel<30&&(s+=1),e.currentMission){const t=this.getMissionPriority(e);"critical"===t?s+=2:"high"===t&&(s+=1)}switch(t){case"emergency":s+=2;break;case"low_battery":case"pre_mission":s+=1}return(e.totalFlightTime||0)>2e3&&(s+=1),Math.min(s,5)}getMissionPriority(e){if(!e.currentMission)return"low";const t=e.currentMission.name.toLowerCase();return t.includes("emergency")||t.includes("medical")?"critical":t.includes("security")||t.includes("patrol")?"high":t.includes("delivery")?"normal":"low"}addToQueue(e,t="low_battery",s=5){const a=this.globalQueue.findIndex(t=>t.droneId===e.id);if(-1!==a)return console.warn(`Drone ${e.id} already in charging queue`),this.globalQueue[a];const r=this.calculatePriority(e,t),n=this.calculateExpectedChargingTime(e.batteryLevel),i=this.getMissionPriority(e),l={id:`queue-${e.id}-${Date.now()}`,droneId:e.id,droneName:e.name,priority:r,batteryLevel:e.batteryLevel,estimatedArrival:s,queuePosition:0,requestedAt:(new Date).toISOString(),expectedChargingTime:n,missionPriority:i,reason:t};return this.globalQueue.push(l),this.sortQueue(),console.log(`ðŸ”‹ Added ${e.name} to charging queue (Priority: ${r}, Battery: ${e.batteryLevel}%)`),l}sortQueue(){this.globalQueue.sort((e,t)=>t.priority!==e.priority?t.priority-e.priority:e.batteryLevel!==t.batteryLevel?e.batteryLevel-t.batteryLevel:new Date(e.requestedAt).getTime()-new Date(t.requestedAt).getTime()),this.globalQueue.forEach((e,t)=>{e.queuePosition=t+1})}calculateExpectedChargingTime(e,t=90){const s=Math.max(0,t-e);return Math.ceil(s/3.5)}findBestAvailableStation(){return Array.from(this.stations.values()).filter(e=>"available"===e.status).sort((e,t)=>t.chargingRate-e.chargingRate)[0]||null}assignNextDrone(){if(0===this.globalQueue.length)return{assigned:!1};const e=this.findBestAvailableStation();if(!e)return{assigned:!1};const t=this.globalQueue.shift();return e.status="occupied",e.currentDrone=t.droneId,e.estimatedTimeRemaining=this.calculateExpectedChargingTime(t.batteryLevel),this.startChargingSession(t.droneId,e.id,t.batteryLevel),this.sortQueue(),console.log(`ðŸ”‹ Assigned ${t.droneName} to ${e.name} (Est: ${e.estimatedTimeRemaining}min)`),{assigned:!0,stationId:e.id,droneId:t.droneId}}startChargingSession(e,t,s){console.log(`ðŸ”‹ Started charging session: ${e} at ${t}`)}completeChargingSession(e,t){const s=this.stations.get(e);if(!s||"occupied"!==s.status)return!1;const a=s.currentDrone,r=s.averageChargingTime;return this.chargingHistory.push({droneId:a,stationId:e,startTime:new Date(Date.now()-60*r*1e3).toISOString(),endTime:(new Date).toISOString(),chargingTime:r,batteryStart:t-.7*t,batteryEnd:t}),s.status="available",s.currentDrone=void 0,s.estimatedTimeRemaining=void 0,s.totalChargingSessions++,console.log(`ðŸ”‹ Completed charging: ${a} at ${s.name} (${t}%)`),this.assignNextDrone(),!0}removeFromQueue(e){const t=this.globalQueue.findIndex(t=>t.droneId===e);return-1!==t&&(this.globalQueue.splice(t,1),this.sortQueue(),console.log(`ðŸ”‹ Removed ${e} from charging queue`),!0)}getQueueStatus(e){return this.globalQueue.find(t=>t.droneId===e)||null}getChargingSchedules(){const e=[];return Array.from(this.stations.values()).forEach(t=>{const s=this.globalQueue.slice(),a=t.currentDrone?this.globalQueue.find(e=>e.droneId===t.currentDrone):void 0,r=s.reduce((e,t)=>e+t.expectedChargingTime,0),n="available"===t.status?0:(t.estimatedTimeRemaining||0)+r;e.push({stationId:t.id,stationName:t.name,queue:s,currentlyCharging:a,estimatedWaitTime:n,totalQueueTime:r})}),e}getChargingStations(){return Array.from(this.stations.values())}getChargingStats(){const e=Array.from(this.stations.values()),t=e.filter(e=>"available"===e.status).length,s=e.filter(e=>"occupied"===e.status).length,a=e.filter(e=>"maintenance"===e.status).length,r=e.reduce((e,t)=>e+t.totalChargingSessions,0),n=e.reduce((e,t)=>e+t.averageChargingTime,0)/e.length;return{totalStations:e.length,availableStations:t,occupiedStations:s,maintenanceStations:a,totalInQueue:this.globalQueue.length,averageWaitTime:this.calculateAverageWaitTime(),averageChargingTime:Math.round(n),dailyChargingSessions:r,peakUsageHour:14}}calculateAverageWaitTime(){if(0===this.globalQueue.length)return 0;const e=Array.from(this.stations.values()).filter(e=>"occupied"===e.status).reduce((e,t)=>e+(t.estimatedTimeRemaining||0),0);return Math.round(e/Math.max(this.globalQueue.length,1))}updateChargingProgress(){Array.from(this.stations.values()).forEach(e=>{"occupied"===e.status&&e.estimatedTimeRemaining&&(e.estimatedTimeRemaining=Math.max(0,e.estimatedTimeRemaining-1),e.estimatedTimeRemaining<=0&&this.completeChargingSession(e.id,90))})}shouldAddToQueue(e){return!this.getQueueStatus(e.id)&&("charging"!==e.status&&(e.batteryLevel<15||(e.batteryLevel<25&&("idle"===e.status||!e.currentMission)||!!(e.batteryLevel<80&&e.currentMission&&"pending"===e.currentMission.status))))}processAutoQueue(e){e.forEach(e=>{if(this.shouldAddToQueue(e)){let t="scheduled";e.batteryLevel<15?t="emergency":e.batteryLevel<25?t="low_battery":"pending"===e.currentMission?.status&&(t="pre_mission"),this.addToQueue(e,t)}});let t=!0;for(;t;){t=this.assignNextDrone().assigned}}},hs=[{id:"drone-001",name:"Alpha-1",status:"in_flight",position:{lat:37.7749,lng:-122.4194,alt:120.5},batteryLevel:87,batteryVoltage:22.4,speed:12.3,heading:245,signalStrength:-45,connectionQuality:"excellent",lastUpdate:(new Date).toISOString(),currentMission:{id:"mission-001",name:"Downtown Delivery Route",progress:65,eta:"14:30",status:"active"},alerts:[{id:"alert-001",severity:"warning",message:"Approaching restricted airspace",timestamp:new Date(Date.now()-3e5).toISOString(),category:"navigation"}],temperature:28.5,humidity:65,firmware:"v1.12.3",hardware:"Pixhawk 4 Mini",uptime:"2h 34m",totalFlightTime:847,totalMissions:23,lastMaintenance:new Date(Date.now()-6048e5).toISOString()},{id:"drone-002",name:"Beta-2",status:"charging",position:{lat:37.7849,lng:-122.4094,alt:2.1},batteryLevel:23,batteryVoltage:18.2,speed:0,heading:0,signalStrength:-52,connectionQuality:"good",lastUpdate:(new Date).toISOString(),alerts:[{id:"alert-002",severity:"info",message:"Charging in progress - 47 minutes remaining",timestamp:new Date(Date.now()-6e5).toISOString(),category:"system"}],temperature:32.1,humidity:68,firmware:"v1.12.3",hardware:"Pixhawk 4 Pro",uptime:"5h 12m",totalFlightTime:1203,totalMissions:31,lastMaintenance:new Date(Date.now()-2592e5).toISOString()},{id:"drone-003",name:"Charlie-3",status:"in_flight",position:{lat:37.7649,lng:-122.4294,alt:89.2},batteryLevel:18,batteryVoltage:18.5,speed:8.7,heading:180,signalStrength:-67,connectionQuality:"good",lastUpdate:(new Date).toISOString(),currentMission:{id:"mission-002",name:"Harbor Security Patrol",progress:38,eta:"15:45",status:"active"},alerts:[{id:"alert-battery-drone-003-low",severity:"critical",message:"Battery level 18.0% - Return to base immediately",timestamp:new Date(Date.now()-18e4).toISOString(),category:"battery"}],temperature:30.8,humidity:72,firmware:"v1.12.3",hardware:"Pixhawk 4 Mini",uptime:"1h 58m",totalFlightTime:592,totalMissions:18,lastMaintenance:new Date(Date.now()-12096e5).toISOString()},{id:"drone-004",name:"Delta-4",status:"active",position:{lat:37.7549,lng:-122.4394,alt:45.8},batteryLevel:92,batteryVoltage:23.1,speed:6.2,heading:90,signalStrength:-38,connectionQuality:"excellent",lastUpdate:(new Date).toISOString(),currentMission:{id:"mission-003",name:"Medical Supply Delivery",progress:15,eta:"16:20",status:"active"},temperature:26.3,humidity:58,firmware:"v1.12.3",hardware:"Pixhawk 4 Pro",uptime:"8h 45m",totalFlightTime:1847,totalMissions:45,lastMaintenance:new Date(Date.now()-1728e5).toISOString()},{id:"drone-005",name:"Echo-5",status:"maintenance",position:{lat:37.7449,lng:-122.4494,alt:0},batteryLevel:78,batteryVoltage:21.8,speed:0,heading:0,signalStrength:-88,connectionQuality:"poor",lastUpdate:new Date(Date.now()-9e5).toISOString(),alerts:[{id:"alert-003",severity:"critical",message:"Motor #3 temperature exceeds safe limits",timestamp:new Date(Date.now()-12e5).toISOString(),category:"hardware"},{id:"alert-004",severity:"warning",message:"GPS signal degraded - position accuracy reduced",timestamp:new Date(Date.now()-8e5).toISOString(),category:"navigation"},{id:"alert-005",severity:"info",message:"Scheduled maintenance required",timestamp:new Date(Date.now()-6e5).toISOString(),category:"maintenance"}],temperature:52.1,humidity:55,firmware:"v1.12.2",hardware:"Pixhawk 4 Mini",uptime:"12h 22m",totalFlightTime:2341,totalMissions:67,lastMaintenance:new Date(Date.now()-18144e5).toISOString()}],us=[{id:"mission-001",name:"Downtown Delivery",progress:65,eta:"14:30",status:"active",waypoints:[{id:"wp-001",position:{lat:37.7749,lng:-122.4194,alt:120},action:"pickup",completed:!0},{id:"wp-002",position:{lat:37.7849,lng:-122.4094,alt:100},action:"delivery",completed:!1}],assignedDrone:"drone-001",priority:1,createdAt:new Date(Date.now()-36e5).toISOString(),startedAt:new Date(Date.now()-18e5).toISOString()},{id:"mission-002",name:"Harbor Patrol",progress:38,eta:"15:45",status:"active",waypoints:[{id:"wp-003",position:{lat:37.7649,lng:-122.4294,alt:80},action:"survey",completed:!1}],assignedDrone:"drone-003",priority:2,createdAt:new Date(Date.now()-72e5).toISOString(),startedAt:new Date(Date.now()-27e5).toISOString()}],gs=[{id:"fleet-alert-001",severity:"critical",message:"Drone Echo-5 motor temperature critical",timestamp:new Date(Date.now()-12e5).toISOString(),droneId:"drone-005",droneName:"Echo-5",type:"system",priority:1,details:{temperature:45.2,threshold:40}},{id:"fleet-alert-002",severity:"warning",message:"Drone Alpha-1 approaching restricted airspace",timestamp:new Date(Date.now()-3e5).toISOString(),droneId:"drone-001",droneName:"Alpha-1",type:"safety",priority:2,details:{zone:"SFO_RESTRICTED",distance:150}}];const ps=new class{constructor(){t(this,"updateInterval",null),t(this,"onDroneUpdate"),t(this,"droneFlightPatterns",new Map),t(this,"emergencyStates",new Map),t(this,"coordinationAlerts",[]),this.initializeFlightPatterns()}initializeFlightPatterns(){this.droneFlightPatterns.set("drone-001",{type:"waypoint",waypoints:[{lat:37.7749,lng:-122.4194},{lat:37.7754,lng:-122.4189},{lat:37.7759,lng:-122.4194},{lat:37.7754,lng:-122.4199}],currentWaypoint:0,progress:0,speed:.015}),this.droneFlightPatterns.set("drone-002",{type:"stationary",center:{lat:37.7849,lng:-122.4094},radius:0,currentAngle:0,speed:0}),this.droneFlightPatterns.set("drone-003",{type:"waypoint",waypoints:[{lat:37.7649,lng:-122.4294},{lat:37.7669,lng:-122.4274},{lat:37.7649,lng:-122.4254},{lat:37.7629,lng:-122.4274}],currentWaypoint:0,progress:.3,speed:.012}),this.droneFlightPatterns.set("drone-004",{type:"waypoint",waypoints:[{lat:37.7744,lng:-122.4199},{lat:37.7754,lng:-122.4189},{lat:37.7764,lng:-122.4199},{lat:37.7754,lng:-122.4209}],currentWaypoint:0,progress:.15,speed:.018}),this.droneFlightPatterns.set("drone-005",{type:"stationary",center:{lat:37.7449,lng:-122.4494},radius:0,currentAngle:0,speed:0})}start(){console.log("ðŸ”§ Starting enhanced mock telemetry service for 5 drones"),console.log("ðŸ“ Flight patterns initialized: Circular patrol, Linear patrol, Waypoint mission"),this.updateInterval=setInterval(()=>{hs.forEach((e,t)=>{this.updateDroneRealistic(e),setTimeout(()=>{this.onDroneUpdate&&this.onDroneUpdate({...e})},500*t)}),setTimeout(()=>{this.performCoordinationCheck(),this.performChargingManagement()},500*hs.length+1e3)},8e3)}updateDroneRealistic(e){const t=this.droneFlightPatterns.get(e.id);t&&(this.updatePosition(e,t),this.updateTelemetry(e),this.updateMissionProgress(e),this.detectEmergencyStates(e),this.simulateAlerts(e),e.lastUpdate=(new Date).toISOString())}updatePosition(e,t){switch(t.type){case"circular":t.currentAngle+=.4*t.speed,e.position.lat=t.center.lat+Math.cos(t.currentAngle)*t.radius,e.position.lng=t.center.lng+Math.sin(t.currentAngle)*t.radius,e.position.alt=80+10*Math.sin(2*t.currentAngle),e.heading=(180*t.currentAngle/Math.PI+90)%360,e.speed=12+4*Math.random();break;case"linear":const s=t;s.progress+=s.direction*s.speed*.3,(s.progress>=1||s.progress<=0)&&(s.direction*=-1,s.progress=Math.max(0,Math.min(1,s.progress))),e.position.lat=s.start.lat+(s.end.lat-s.start.lat)*s.progress,e.position.lng=s.start.lng+(s.end.lng-s.start.lng)*s.progress,e.position.alt=60+15*Math.sin(s.progress*Math.PI);const a=s.end.lat-s.start.lat,r=s.end.lng-s.start.lng;e.heading=180*Math.atan2(r,a)/Math.PI*s.direction%360,e.speed=9+3*Math.random();break;case"waypoint":const n=t;n.progress+=.4*n.speed,n.progress>=1&&(n.currentWaypoint=(n.currentWaypoint+1)%n.waypoints.length,n.progress=0);const i=n.waypoints[n.currentWaypoint],l=n.waypoints[(n.currentWaypoint+1)%n.waypoints.length];e.position.lat=i.lat+(l.lat-i.lat)*n.progress,e.position.lng=i.lng+(l.lng-i.lng)*n.progress,e.position.alt=45+10*Math.sin(n.progress*Math.PI);const o=l.lat-i.lat,c=l.lng-i.lng;e.heading=180*Math.atan2(c,o)/Math.PI,e.speed=10+3*Math.random();break;case"stationary":e.position.lat+=5e-6*(Math.random()-.5),e.position.lng+=5e-6*(Math.random()-.5),e.speed=0}}updateTelemetry(e){"active"===e.status||"in_flight"===e.status?(e.batteryLevel=Math.max(5,e.batteryLevel-.02-.01*Math.random()),e.batteryVoltage=18+e.batteryLevel/100*5.5):"charging"===e.status&&(e.batteryLevel=Math.min(100,e.batteryLevel+.1+.05*Math.random()),e.batteryVoltage=18+e.batteryLevel/100*5.5);const t=e.signalStrength;e.signalStrength=t+2*(Math.random()-.5),e.signalStrength>-50?e.connectionQuality="excellent":e.signalStrength>-70?e.connectionQuality="good":e.signalStrength>-90?e.connectionQuality="poor":e.connectionQuality="very_poor";const s=.5*(Math.random()-.5);e.temperature=(e.temperature||28)+s,"active"!==e.status&&"in_flight"!==e.status||(e.temperature=Math.min(50,(e.temperature||28)+.02)),e.humidity=Math.max(40,Math.min(85,(e.humidity||60)+1*(Math.random()-.5)))}updateMissionProgress(e){if(e.currentMission&&("active"===e.status||"in_flight"===e.status)){e.currentMission.progress=Math.min(99,e.currentMission.progress+.1+.1*Math.random());const t=100-e.currentMission.progress,s=Math.round(2*t),a=new Date(Date.now()+6e4*s);e.currentMission.eta=a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}}simulateAlerts(e){e.alerts=e.alerts||[];if(Math.random()<.1){if(e.batteryLevel<25&&!e.alerts.some(e=>"battery"===e.category)){let t,s;e.batteryLevel<10?(t="critical",s=`Critical battery level ${e.batteryLevel.toFixed(1)}% - Land immediately!`):e.batteryLevel<15?(t="critical",s=`Battery level ${e.batteryLevel.toFixed(1)}% - Return to base immediately`):(t="warning",s=`Battery level ${e.batteryLevel.toFixed(1)}% - Consider returning to base`),e.alerts.unshift({id:`alert-battery-${e.id}-${Date.now()}`,severity:t,message:s,timestamp:(new Date).toISOString(),category:"battery"})}e.batteryLevel>=30&&(e.alerts=e.alerts.filter(e=>"battery"!==e.category)),(e.temperature||0)>40&&!e.alerts.some(e=>"system"===e.category&&e.message.includes("temperature"))&&e.alerts.unshift({id:`alert-temp-${e.id}-${Date.now()}`,severity:(e.temperature||0)>45?"critical":"warning",message:`Motor temperature elevated: ${e.temperature?.toFixed(1)}Â°C`,timestamp:(new Date).toISOString(),category:"hardware"}),(e.temperature||0)<=38&&(e.alerts=e.alerts.filter(e=>!("hardware"===e.category&&e.message.includes("temperature")))),e.alerts.length>5&&(e.alerts=e.alerts.slice(0,5))}else e.alerts=e.alerts.filter(e=>Date.now()-new Date(e.timestamp).getTime()<6e5)}detectEmergencyStates(e){const t=(new Date).toISOString();let s=!1;if(e.batteryLevel<10&&!this.emergencyStates.has(`${e.id}-critical_battery`)){const a={id:`${e.id}-critical_battery-${Date.now()}`,droneId:e.id,type:"critical_battery",severity:"emergency",description:`Critical battery level ${e.batteryLevel.toFixed(1)}% - Immediate emergency landing required`,triggeredAt:t,resolved:!1,autoResponse:{action:"emergency_landing",triggered:!0,triggeredAt:t}};this.emergencyStates.set(`${e.id}-critical_battery`,a),e.emergencyState=a,e.status="emergency",s=!0}if("very_poor"===e.connectionQuality&&e.signalStrength<-95){if(!this.emergencyStates.get(`${e.id}-communication_loss`)){const a={id:`${e.id}-communication_loss-${Date.now()}`,droneId:e.id,type:"communication_loss",severity:"critical",description:`Communication loss detected - Signal strength ${e.signalStrength}dBm`,triggeredAt:t,resolved:!1,autoResponse:{action:"hover",triggered:!0,triggeredAt:t}};this.emergencyStates.set(`${e.id}-communication_loss`,a),e.emergencyState=a,e.status="emergency",s=!0}}if((e.temperature||0)>50&&!this.emergencyStates.has(`${e.id}-system_failure`)){const a={id:`${e.id}-system_failure-${Date.now()}`,droneId:e.id,type:"system_failure",severity:"emergency",description:`System overheating detected - Temperature ${e.temperature?.toFixed(1)}Â°C exceeds safe limits`,triggeredAt:t,resolved:!1,autoResponse:{action:"return_to_base",triggered:!0,triggeredAt:t}};this.emergencyStates.set(`${e.id}-system_failure`,a),e.emergencyState=a,e.status="emergency",s=!0}if(Math.random()<.001&&"in_flight"===e.status){if(!this.emergencyStates.get(`${e.id}-collision_risk`)){const a={id:`${e.id}-collision_risk-${Date.now()}`,droneId:e.id,type:"collision_risk",severity:"critical",description:"Collision risk detected - Another aircraft in proximity",triggeredAt:t,resolved:!1,autoResponse:{action:"hover",triggered:!0,triggeredAt:t}};this.emergencyStates.set(`${e.id}-collision_risk`,a),e.emergencyState=a,e.status="emergency",s=!0}}this.checkEmergencyResolution(e),s&&e.emergencyState&&this.generateEmergencyAlert(e,e.emergencyState)}checkEmergencyResolution(e){const t=[];this.emergencyStates.forEach((s,a)=>{if(s.droneId!==e.id||s.resolved)return;let r=!1;switch(s.type){case"critical_battery":("charging"===e.status||e.batteryLevel>15)&&(r=!0);break;case"communication_loss":"very_poor"!==e.connectionQuality&&e.signalStrength>-85&&(r=!0);break;case"system_failure":(e.temperature||0)<40&&(r=!0);break;case"collision_risk":Date.now()-new Date(s.triggeredAt).getTime()>3e4&&(r=!0)}r&&(s.resolved=!0,s.resolvedAt=(new Date).toISOString(),t.push(a),e.emergencyState?.id===s.id&&(e.emergencyState=void 0,"emergency"===e.status&&"drone-005"!==e.id&&(e.status=e.batteryLevel<30?"charging":"active")))}),t.forEach(e=>{this.emergencyStates.delete(e)})}generateEmergencyAlert(e,t){e.alerts=e.alerts||[];e.alerts.find(e=>"emergency"===e.category&&e.message.includes(t.type.replace("_"," ")))||e.alerts.unshift({id:`alert-emergency-${t.id}`,severity:(t.severity,"critical"),message:`EMERGENCY: ${t.description}`,timestamp:t.triggeredAt,category:"emergency"})}stop(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),console.log("ðŸ”§ Mock telemetry service stopped")}onDroneDataUpdate(e){this.onDroneUpdate=e}performCoordinationCheck(){try{const e=ms.checkCollisionRisks(hs);e.forEach(e=>{if("separation_violation"===e.type&&e.avoidanceAction){const t=hs.find(t=>t.id===e.avoidanceAction.droneId);if(t){ms.applyAvoidanceManeuver(t,e.avoidanceAction),t.alerts=t.alerts||[];t.alerts.find(e=>"coordination"===e.category&&e.message.includes("avoidance"))||t.alerts.unshift({id:`coord-${e.id}-${Date.now()}`,severity:"critical"===e.severity?"critical":"warning",message:`Coordination: ${e.avoidanceAction.action.replace("_"," ")} maneuver (${e.distance.toFixed(1)}m separation)`,timestamp:e.timestamp,category:"coordination"})}}else"collision_warning"===e.type&&e.droneIds.forEach(t=>{const s=hs.find(e=>e.id===t);if(s){s.alerts=s.alerts||[];s.alerts.find(e=>"coordination"===e.category&&e.message.includes("proximity"))||s.alerts.unshift({id:`coord-warning-${t}-${Date.now()}`,severity:"warning",message:`Coordination: Proximity warning - ${e.distance.toFixed(1)}m to other drone`,timestamp:e.timestamp,category:"coordination"})}})}),this.coordinationAlerts=e.filter(e=>!e.resolved);const t=ms.getCoordinationStatus();t.activeWarnings.length>0&&console.log(`ðŸ¤ Coordination: ${t.activeWarnings.length} active warnings, ${t.resolvedConflicts} resolved`)}catch(e){console.error("Error during coordination check:",e)}}performChargingManagement(){try{xs.updateChargingProgress(),xs.processAutoQueue(hs),this.updateDroneChargingStatuses();const e=xs.getChargingStats();(e.totalInQueue>0||e.occupiedStations>0)&&console.log(`ðŸ”‹ Charging: ${e.occupiedStations}/${e.totalStations} stations occupied, ${e.totalInQueue} in queue`)}catch(e){console.error("Error during charging management:",e)}}updateDroneChargingStatuses(){hs.forEach(e=>{const t=xs.getChargingStations().find(t=>t.currentDrone===e.id);if(t){if("charging"!==e.status){e.status="charging",e.alerts=e.alerts||[];const s=e.alerts.find(e=>"charging"===e.category);s?s.message=`Charging at ${t.name} - ${t.estimatedTimeRemaining}min remaining`:e.alerts.unshift({id:`charging-${e.id}-${Date.now()}`,severity:"info",message:`Charging at ${t.name} - ${t.estimatedTimeRemaining}min remaining`,timestamp:(new Date).toISOString(),category:"charging"})}if(e.batteryLevel<90){const s=t.chargingRate/60;e.batteryLevel=Math.min(90,e.batteryLevel+8*s),e.batteryVoltage=18+e.batteryLevel/100*5.5}e.position=t.position,e.speed=0}else{const t=xs.getQueueStatus(e.id);if(t){e.alerts=e.alerts||[];const s=e.alerts.find(e=>"charging"===e.category&&e.message.includes("queue"));s?s.message=`Charging queue position ${t.queuePosition} (Priority: ${t.priority})`:e.alerts.unshift({id:`queue-${e.id}-${Date.now()}`,severity:t.priority>=4?"warning":"info",message:`Charging queue position ${t.queuePosition} (Priority: ${t.priority})`,timestamp:(new Date).toISOString(),category:"charging"})}else e.alerts&&(e.alerts=e.alerts.filter(e=>"charging"!==e.category)),"charging"===e.status&&e.batteryLevel>=85&&(e.status=e.currentMission?"active":"idle",e.alerts=e.alerts||[],e.alerts.unshift({id:`charged-${e.id}-${Date.now()}`,severity:"info",message:`Charging complete - Battery: ${Math.round(e.batteryLevel)}%`,timestamp:(new Date).toISOString(),category:"system"}))}})}getCoordinationStatus(){return ms.getCoordinationStatus()}getCoordinationAlerts(){return this.coordinationAlerts}getChargingStats(){return xs.getChargingStats()}getChargingStations(){return xs.getChargingStations()}getChargingSchedules(){return xs.getChargingSchedules()}addDroneToChargingQueue(e,t="scheduled"){const s=hs.find(t=>t.id===e);return s?xs.addToQueue(s,t):null}removeDroneFromChargingQueue(e){return xs.removeFromQueue(e)}triggerEmergencyResponse(e,t){const s=hs.find(t=>t.id===e);return s&&s.emergencyState?!!s.emergencyState&&(s.emergencyState.operatorOverride={action:t.replace("_"," "),triggeredBy:"operator",triggeredAt:(new Date).toISOString()},s.alerts=s.alerts||[],s.alerts.unshift({id:`alert-response-${e}-${Date.now()}`,severity:"info",message:`Emergency response activated: ${t.replace("_"," ")}`,timestamp:(new Date).toISOString(),category:"emergency"}),console.log(`ðŸš¨ Emergency response triggered for ${e}: ${t}`),!0):(console.warn(`Cannot trigger emergency response for ${e}: drone not found or no emergency state`),!1)}resolveEmergency(e,t){const s=hs.find(t=>t.id===e);return s&&s.emergencyState?!!s.emergencyState&&(s.emergencyState.resolved=!0,s.emergencyState.resolvedAt=(new Date).toISOString(),"emergency"===s.status&&(s.status=s.batteryLevel<30?"charging":"active"),s.alerts=s.alerts||[],s.alerts.unshift({id:`alert-resolved-${e}-${Date.now()}`,severity:"info",message:`Emergency resolved: ${t}`,timestamp:(new Date).toISOString(),category:"emergency"}),console.log(`âœ… Emergency resolved for ${e}: ${t}`),!0):(console.warn(`Cannot resolve emergency for ${e}: drone not found or no emergency state`),!1)}getEmergencyStats(){const e=Array.from(this.emergencyStates.values()).filter(e=>!e.resolved),t=Array.from(this.emergencyStates.values()).filter(e=>e.resolved),s=e.reduce((e,t)=>(e[t.type]=(e[t.type]||0)+1,e),{});return{active:e.length,resolved:t.length,total:this.emergencyStates.size,byType:s,criticalCount:e.filter(e=>"emergency"===e.severity).length}}};"undefined"!=typeof window&&(window.emergencyResponse={trigger:(e,t)=>ps.triggerEmergencyResponse(e,t),resolve:(e,t)=>ps.resolveEmergency(e,t),stats:()=>ps.getEmergencyStats()},window.coordination={status:()=>ps.getCoordinationStatus(),alerts:()=>ps.getCoordinationAlerts(),setSeparation:e=>ms.setSeparationDistance(e),resolve:e=>ms.resolveAlert(e),maneuvers:()=>Array.from(ms.getActiveManeuvers().entries())},window.charging={stats:()=>ps.getChargingStats(),stations:()=>ps.getChargingStations(),schedules:()=>ps.getChargingSchedules(),addToQueue:(e,t="scheduled")=>ps.addDroneToChargingQueue(e,t),removeFromQueue:e=>ps.removeDroneFromChargingQueue(e),forceCharge:e=>{ps.addDroneToChargingQueue(e,"emergency"),console.log(`ðŸ”‹ Force charging ${e} with emergency priority`)}});const vs=cs()(ds((e,t)=>({connectionState:At.DISCONNECTED,connectionError:null,lastUpdate:null,drones:{},missions:{},alerts:[],selectedDroneId:null,stats:{messagesReceived:0,messagesProcessed:0,connectionUptime:0,reconnectCount:0},setConnectionState:(t,s)=>{e({connectionState:t,connectionError:s||null})},updateDrone:t=>{e(e=>{const s=e.drones[t.id];let a=t.alerts||[];if(s&&s.alerts){const e=new Map(s.alerts.map(e=>[e.id,e.message])),t=new Map(a.map(e=>[e.id,e.message]));if(e.size===t.size){let r=!0;for(const[s,a]of e)if(!t.has(s)||t.get(s)!==a){r=!1;break}r&&(a=s.alerts)}}return{drones:{...e.drones,[t.id]:{...t,alerts:a,lastUpdate:(new Date).toISOString()}},lastUpdate:new Date}})},updateMission:t=>{e(e=>({missions:{...e.missions,[t.id]:t},lastUpdate:new Date}))},addAlert:t=>{e(e=>({alerts:[t,...e.alerts.slice(0,99)],lastUpdate:new Date}))},dismissAlert:t=>{e(e=>({alerts:e.alerts.filter(e=>e.id!==t)}))},selectDrone:t=>{e({selectedDroneId:t})},updateStats:t=>{e({stats:t})},getDroneById:e=>t().drones[e],getActiveDrones:()=>{const{drones:e}=t();return Object.values(e).filter(e=>"active"===e.status||"in_flight"===e.status)},getDronesWithIssues:()=>{const{drones:e}=t();return Object.values(e).filter(e=>"maintenance"===e.status||"emergency"===e.status||e.batteryLevel<20||e.signalStrength<-90||e.alerts&&e.alerts.length>0)},getIdleDrones:()=>{const{drones:e}=t();return Object.values(e).filter(e=>"idle"===e.status)},getCriticalAlerts:()=>{const{alerts:e}=t();return e.filter(e=>"critical"===e.severity)},getFleetSummary:()=>{const{drones:e}=t(),s=Object.values(e);if(0===s.length)return{total:0,active:0,idle:0,issues:0,charging:0,maintenance:0,avgBattery:0,avgSignal:0};const a=s.reduce((e,t)=>{switch(e.total++,t.status){case"active":case"in_flight":e.active++;break;case"idle":e.idle++;break;case"charging":e.charging++;break;case"maintenance":case"emergency":e.maintenance++}return(t.batteryLevel<20||t.signalStrength<-90||t.alerts&&t.alerts.length>0)&&e.issues++,e.totalBattery+=t.batteryLevel,e.totalSignal+=t.signalStrength,e},{total:0,active:0,idle:0,issues:0,charging:0,maintenance:0,totalBattery:0,totalSignal:0});return{total:a.total,active:a.active,idle:a.idle,issues:a.issues,charging:a.charging,maintenance:a.maintenance,avgBattery:Math.round(a.totalBattery/a.total),avgSignal:Math.round(a.totalSignal/a.total)}},connect:()=>{const e=t();Lt.setConnectionStateCallback((t,s)=>{e.setConnectionState(t,s?.message),t!==At.ERROR&&t!==At.DISCONNECTED||setTimeout(()=>{console.log("ðŸ”§ WebSocket connection failed, using mock data for development"),hs.forEach(t=>e.updateDrone(t)),us.forEach(t=>e.updateMission(t)),gs.forEach(t=>e.addAlert(t)),ps.onDroneDataUpdate(t=>{e.updateDrone(t)}),ps.start()},1e3)}),Lt.onDroneDataUpdate(t=>{e.updateDrone(t)}),Lt.onMissionDataUpdate(t=>{e.updateMission(t)}),Lt.onFleetAlertReceived(t=>{e.addAlert(t)});setInterval(()=>{const t=Lt.getStatistics();e.updateStats(t)},15e3),Lt.connect()},disconnect:()=>{Lt.disconnect(),e({connectionState:At.DISCONNECTED,connectionError:null})},isConnected:()=>t().connectionState===At.CONNECTED})));let ys=!1;const bs=({drones:e,className:t="",compact:a=!1})=>{const[r,n]=s.useState(!1),i=s.useMemo(()=>{const t=[],s=[];return e.forEach(e=>{e.emergencyState&&(e.emergencyState.resolved?s.push({drone:e,emergency:e.emergencyState}):t.push({drone:e,emergency:e.emergencyState}))}),{active:t.sort((e,t)=>new Date(t.emergency.triggeredAt).getTime()-new Date(e.emergency.triggeredAt).getTime()),resolved:s.sort((e,t)=>new Date(t.emergency.resolvedAt||t.emergency.triggeredAt).getTime()-new Date(e.emergency.resolvedAt||e.emergency.triggeredAt).getTime())}},[e]),l=e=>{const t=Date.now()-new Date(e).getTime(),s=Math.floor(t/6e4),a=Math.floor(s/60),r=Math.floor(a/24);return r>0?`${r}d ago`:a>0?`${a}h ago`:`${s}m ago`},o=({drone:e,emergency:t,index:s,resolved:a=!1})=>{const r=(e=>{switch(e){case"critical_battery":return J;case"communication_loss":return et;case"system_failure":return Ce;case"collision_risk":default:return Ne;case"geofence_violation":return Ke}})(t.type),n=((e,t)=>{if("emergency"===t)return"#f85149";switch(e){case"critical_battery":case"geofence_violation":default:return"#da3633";case"communication_loss":return"#d29922";case"system_failure":case"collision_risk":return"#f85149"}})(t.type,t.severity);return I.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*s},className:`\n          border-l-4 rounded-lg p-4 transition-all\n          ${a?"bg-slate-800/30 border-green-500/50 opacity-75":"emergency"===t.severity?"bg-red-900/20 border-red-500 animate-pulse":"bg-amber-900/20 border-amber-500"}\n        `,style:{borderLeftColor:a?"#10b981":n},children:I.jsxs("div",{className:"flex items-start justify-between",children:[I.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[I.jsx("div",{className:"flex-shrink-0 mt-0.5",children:a?I.jsx(se,{className:"w-5 h-5 text-green-400"}):I.jsx(r,{className:"w-5 h-5",style:{color:n}})}),I.jsxs("div",{className:"flex-1",children:[I.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[I.jsx("span",{className:"font-medium text-slate-200",children:e.name}),I.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:(a?"#10b981":n)+"20",color:a?"#10b981":n},children:a?"Resolved":t.severity.toUpperCase()}),I.jsx("span",{className:"px-2 py-1 bg-slate-700 text-slate-300 rounded text-xs",children:t.type.replace("_"," ")})]}),I.jsx("p",{className:"text-slate-300 text-sm mb-2",children:t.description}),I.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-400",children:[I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx(ue,{className:"w-3 h-3"}),I.jsx("span",{children:a&&t.resolvedAt?`Resolved ${l(t.resolvedAt)}`:`Triggered ${l(t.triggeredAt)}`})]}),t.autoResponse&&I.jsxs("div",{className:"flex items-center gap-1",children:[t.autoResponse.triggered?I.jsx(Ue,{className:"w-3 h-3 text-blue-400"}):I.jsx(rt,{className:"w-3 h-3 text-slate-500"}),I.jsxs("span",{className:"text-blue-400",children:["Auto: ",t.autoResponse.action.replace("_"," ")]})]}),t.operatorOverride&&I.jsx("div",{className:"flex items-center gap-1",children:I.jsxs("span",{className:"text-green-400",children:["Override: ",t.operatorOverride.action]})})]})]})]}),!a&&I.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[I.jsx("button",{className:"px-2 py-1 bg-blue-900/30 text-blue-400 hover:bg-blue-900/50 rounded text-xs transition-colors",title:"Acknowledge emergency",children:"Ack"}),I.jsx("button",{className:"p-1 text-slate-400 hover:text-slate-200 transition-colors",title:"Dismiss",children:I.jsx(pt,{className:"w-4 h-4"})})]})]})})};return a?I.jsxs("div",{className:`bg-slate-900 border border-slate-700 rounded-lg p-4 ${t}`,children:[I.jsxs("div",{className:"flex items-center justify-between mb-3",children:[I.jsxs("h3",{className:"text-lg font-medium text-slate-200 flex items-center gap-2",children:[I.jsx(Ke,{className:"w-5 h-5"}),"Emergencies"]}),I.jsx("div",{className:"flex items-center gap-2 text-sm",children:i.active.length>0?I.jsxs("span",{className:"bg-red-500 text-white px-2 py-1 rounded-full text-xs",children:[i.active.length," Active"]}):I.jsx("span",{className:"text-green-400",children:"All Clear"})})]}),I.jsxs("div",{className:"space-y-2",children:[0===i.active.length?I.jsxs("div",{className:"text-center py-4",children:[I.jsx(se,{className:"w-8 h-8 mx-auto text-green-400 mb-2"}),I.jsx("p",{className:"text-sm text-slate-400",children:"No active emergencies"})]}):i.active.slice(0,3).map(({drone:e,emergency:t},s)=>I.jsx(o,{drone:e,emergency:t,index:s},t.id)),i.active.length>3&&I.jsxs("p",{className:"text-xs text-slate-500 text-center py-1",children:["+",i.active.length-3," more emergencies"]})]})]}):I.jsxs("div",{className:`bg-slate-900 border border-slate-700 rounded-lg ${t}`,children:[I.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-700",children:[I.jsxs("h2",{className:"text-xl font-semibold text-slate-200 flex items-center gap-3",children:[I.jsx(Ke,{className:"w-6 h-6"}),"Emergency Management"]}),I.jsxs("div",{className:"flex items-center gap-3",children:[I.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-400",children:[i.active.length>0?I.jsxs("span",{className:"bg-red-500 text-white px-2 py-1 rounded-full",children:[i.active.length," Active"]}):I.jsx("span",{className:"text-green-400",children:"All Clear"}),I.jsxs("span",{children:[i.resolved.length," Resolved"]})]}),I.jsx("button",{onClick:()=>n(!r),className:"p-2 rounded-lg transition-colors "+(r?"bg-green-500/10 text-green-400":"bg-slate-800 text-slate-400 hover:text-slate-200"),title:"Toggle resolved emergencies",children:I.jsx(se,{className:"w-5 h-5"})})]})]}),I.jsx("div",{className:"p-6",children:I.jsx(u,{mode:"wait",children:r?I.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[I.jsxs("h3",{className:"text-lg font-medium text-slate-200 mb-4",children:["Resolved Emergencies (",i.resolved.length,")"]}),0===i.resolved.length?I.jsx("div",{className:"text-center py-8 text-slate-500",children:"No resolved emergencies"}):I.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:i.resolved.map(({drone:e,emergency:t},s)=>I.jsx(o,{drone:e,emergency:t,index:s,resolved:!0},t.id))})]},"resolved"):I.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[I.jsxs("h3",{className:"text-lg font-medium text-slate-200 mb-4",children:["Active Emergencies (",i.active.length,")"]}),0===i.active.length?I.jsxs("div",{className:"text-center py-8",children:[I.jsx(se,{className:"w-12 h-12 mx-auto text-green-400 mb-3"}),I.jsx("h4",{className:"text-lg font-semibold text-slate-200 mb-2",children:"No Active Emergencies"}),I.jsx("p",{className:"text-slate-400",children:"All drones are operating within normal parameters"})]}):I.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:i.active.map(({drone:e,emergency:t},s)=>I.jsx(o,{drone:e,emergency:t,index:s},t.id))})]},"active")})})]})},fs=({className:e="",compact:t=!1})=>{const a=e.includes("bg-transparent"),[r,n]=s.useState(null),[i,l]=s.useState([]),[o,c]=s.useState(!1);s.useEffect(()=>{const e=()=>{try{const e=ps.getCoordinationStatus(),t=ps.getCoordinationAlerts();n(e),l(t)}catch(e){console.error("Error fetching coordination data:",e)}};e();const t=setInterval(e,5e3);return()=>clearInterval(t)},[]);const{activeAlerts:d,resolvedAlerts:m}=s.useMemo(()=>{const e=i.filter(e=>!e.resolved),t=i.filter(e=>e.resolved);return{activeAlerts:e.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()),resolvedAlerts:t.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime())}},[i]),x=e=>{const t=Date.now()-new Date(e).getTime(),s=Math.floor(t/6e4),a=Math.floor(s/60);return a>0?`${a}h ago`:`${s}m ago`},g=({alert:e,index:t,resolved:s=!1})=>{const a=(e=>{switch(e){case"separation_violation":case"collision_warning":return Ne;default:return Re}})(e.type),r=(e=>{switch(e){case"critical":return{color:"#f85149",bg:"#f85149"};case"warning":return{color:"#d29922",bg:"#d29922"};default:return{color:"#8b949e",bg:"#8b949e"}}})(e.severity),n=e.avoidanceAction?(e=>{switch(e){case"climb":return q;case"descend":return R;case"turn_left":return W;case"turn_right":return U;case"hover":return We;case"slow_down":return Ue;default:return F}})(e.avoidanceAction.action):null;return I.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*t},className:`\n          border-l-4 rounded-lg p-4 transition-all\n          ${s?"bg-slate-800/30 border-green-500/50 opacity-75":"critical"===e.severity?"bg-red-900/20 border-red-500":"bg-amber-900/20 border-amber-500"}\n        `,style:{borderLeftColor:s?"#10b981":r.color},children:I.jsx("div",{className:"flex items-start justify-between",children:I.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[I.jsx("div",{className:"flex-shrink-0 mt-0.5",children:s?I.jsx(se,{className:"w-5 h-5 text-green-400"}):I.jsx(a,{className:"w-5 h-5",style:{color:r.color}})}),I.jsxs("div",{className:"flex-1",children:[I.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[I.jsx("span",{className:"font-medium text-slate-200",children:e.type.replace("_"," ").toUpperCase()}),I.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium",style:{backgroundColor:(s?"#10b981":r.color)+"20",color:s?"#10b981":r.color},children:s?"Resolved":e.severity.toUpperCase()}),I.jsxs("span",{className:"px-2 py-1 bg-slate-700 text-slate-300 rounded text-xs",children:[e.distance.toFixed(1),"m"]})]}),I.jsx("p",{className:"text-slate-300 text-sm mb-3",children:e.message}),I.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[I.jsx("span",{className:"text-xs text-slate-400",children:"Drones:"}),e.droneIds.map(e=>I.jsx("span",{className:"px-2 py-1 bg-slate-700 text-slate-300 rounded text-xs font-mono",children:e},e))]}),e.avoidanceAction&&n&&I.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[I.jsx(n,{className:"w-4 h-4 text-blue-400"}),I.jsxs("span",{className:"text-sm text-blue-400",children:["Action: ",e.avoidanceAction.action.replace("_"," "),"(",e.avoidanceAction.magnitude,"Â° | m)"]}),I.jsxs("span",{className:"text-xs text-slate-400",children:["â†’ ",e.avoidanceAction.droneId]})]}),I.jsx("div",{className:"flex items-center gap-4 text-xs text-slate-400",children:I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx(ue,{className:"w-3 h-3"}),I.jsx("span",{children:x(e.timestamp)})]})})]})]})})})};return t?I.jsxs("div",{className:`bg-slate-900 border border-slate-700 rounded-lg p-4 ${e}`,children:[I.jsxs("div",{className:"flex items-center justify-between mb-3",children:[I.jsxs("h3",{className:"text-lg font-medium text-slate-200 flex items-center gap-2",children:[I.jsx(F,{className:"w-5 h-5"}),"Coordination"]}),I.jsx("div",{className:"flex items-center gap-2 text-sm",children:r&&r.isActive?I.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[I.jsx(Je,{className:"w-4 h-4"}),"Active"]}):I.jsx("span",{className:"text-slate-500",children:"Inactive"})})]}),I.jsxs("div",{className:"space-y-2",children:[r&&I.jsxs("div",{className:"flex items-center justify-between text-sm",children:[I.jsx("span",{className:"text-slate-400",children:"Separation"}),I.jsxs("span",{className:"text-slate-200",children:[r.separationDistance,"m"]})]}),0===d.length?I.jsxs("div",{className:"text-center py-4",children:[I.jsx(Je,{className:"w-8 h-8 mx-auto text-green-400 mb-2"}),I.jsx("p",{className:"text-sm text-slate-400",children:"No conflicts"})]}):I.jsxs("div",{className:"space-y-2",children:[d.slice(0,2).map((e,t)=>I.jsx(g,{alert:e,index:t},e.id)),d.length>2&&I.jsxs("p",{className:"text-xs text-slate-500 text-center py-1",children:["+",d.length-2," more conflicts"]})]})]})]}):I.jsxs("div",{className:a?`${e} flex flex-col h-full`:`bg-slate-900 border border-slate-700 rounded-lg ${e}`,children:[I.jsxs("div",{className:"flex items-center justify-between "+(a?"p-4 border-b border-dark-border flex-shrink-0":"p-6 border-b border-slate-700"),children:[I.jsxs("h2",{className:(a?"text-lg font-semibold text-text-primary":"text-xl font-semibold text-slate-200")+" flex items-center gap-3",children:[I.jsx(F,{className:""+(a?"w-5 h-5":"w-6 h-6")}),"Fleet Coordination"]}),I.jsxs("div",{className:"flex items-center gap-3",children:[I.jsx("div",{className:"flex items-center gap-4 text-sm text-slate-400",children:r?I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx("div",{className:"w-2 h-2 rounded-full "+(r.isActive?"bg-green-400":"bg-red-400")}),I.jsx("span",{children:r.isActive?"Active":"Inactive"})]}),I.jsxs("span",{children:[r.separationDistance,"m separation"]}),I.jsxs("span",{children:[d.length," active conflicts"]}),I.jsxs("span",{children:[r.resolvedConflicts," resolved"]})]}):I.jsx("span",{children:"Loading..."})}),I.jsx("button",{onClick:()=>c(!o),className:"p-2 rounded-lg transition-colors "+(o?"bg-green-500/10 text-green-400":"bg-slate-800 text-slate-400 hover:text-slate-200"),title:"Toggle resolved conflicts",children:I.jsx(se,{className:"w-5 h-5"})}),I.jsx("button",{className:"p-2 bg-slate-800 text-slate-400 hover:text-slate-200 rounded-lg transition-colors",title:"Configuration",children:I.jsx(ye,{className:"w-5 h-5"})})]})]}),I.jsx("div",{className:""+(a?"p-4 flex-1 overflow-auto":"p-6"),children:I.jsx(u,{mode:"wait",children:o?I.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[I.jsxs("h3",{className:"text-lg font-medium mb-4 "+(a?"text-text-primary":"text-slate-200"),children:["Resolved Conflicts (",m.length,")"]}),0===m.length?I.jsx("div",{className:"text-center py-8 "+(a?"text-text-muted":"text-slate-500"),children:"No resolved conflicts yet"}):I.jsx("div",{className:"space-y-3 overflow-y-auto "+(a?"max-h-64":"max-h-96"),children:m.map((e,t)=>I.jsx(g,{alert:e,index:t,resolved:!0},e.id))})]},"resolved"):I.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[I.jsxs("h3",{className:"text-lg font-medium text-slate-200 mb-4",children:["Active Coordination (",d.length,")"]}),0===d.length?I.jsxs("div",{className:"text-center py-8",children:[I.jsx(Je,{className:"w-12 h-12 mx-auto text-green-400 mb-3"}),I.jsx("h4",{className:"text-lg font-semibold text-slate-200 mb-2",children:"No Active Conflicts"}),I.jsxs("p",{className:"text-slate-400",children:["All drones maintaining safe separation (â‰¥",r?.separationDistance,"m)"]})]}):I.jsx("div",{className:"space-y-3 overflow-y-auto "+(a?"max-h-64":"max-h-96"),children:d.map((e,t)=>I.jsx(g,{alert:e,index:t},e.id))})]},"active")})})]})},js=({className:e="",compact:t=!1})=>{const a=e.includes("bg-transparent"),[r,n]=s.useState(null),[i,l]=s.useState([]),[o,c]=s.useState([]),[d,m]=s.useState("overview");s.useEffect(()=>{const e=()=>{try{const e=ps.getChargingStats(),t=ps.getChargingStations(),s=ps.getChargingSchedules();n(e),l(t),c(s)}catch(e){console.error("Error fetching charging data:",e)}};e();const t=setInterval(e,5e3);return()=>clearInterval(t)},[]);const x=s.useMemo(()=>{const e=[];o.forEach(t=>{e.push(...t.queue)});return e.filter((e,t,s)=>s.findIndex(t=>t.droneId===e.droneId)===t).sort((e,t)=>e.queuePosition-t.queuePosition)},[o]),g=e=>e>=5?"text-red-400 bg-red-900/20":e>=4?"text-orange-400 bg-orange-900/20":e>=3?"text-yellow-400 bg-yellow-900/20":e>=2?"text-blue-400 bg-blue-900/20":"text-gray-400 bg-gray-900/20",p=e=>{if(e<60)return`${e}m`;return`${Math.floor(e/60)}h ${e%60}m`},v=({item:e,index:t})=>{const s=(e=>{switch(e){case"emergency":return Ne;case"low_battery":return K;case"pre_mission":return Ue;case"maintenance":return xt;case"scheduled":return ue;default:return He}})(e.reason);return I.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.05*t},className:(a?"bg-dark-tertiary border border-dark-border":"bg-slate-800 border border-slate-600")+" rounded-lg p-4",children:I.jsxs("div",{className:"flex items-start justify-between",children:[I.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[I.jsx("div",{className:"flex-shrink-0",children:I.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold ${g(e.priority)}`,children:e.queuePosition})}),I.jsxs("div",{className:"flex-1",children:[I.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[I.jsx("span",{className:"font-medium "+(a?"text-text-primary":"text-slate-200"),children:e.droneName}),I.jsxs("span",{className:"text-xs font-mono "+(a?"text-text-secondary":"text-slate-400"),children:["(",e.droneId,")"]}),I.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${g(e.priority)}`,children:["Priority ",e.priority]})]}),I.jsxs("div",{className:"flex items-center gap-4 text-sm mb-2 "+(a?"text-text-secondary":"text-slate-400"),children:[I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx(K,{className:"w-4 h-4"}),I.jsxs("span",{children:[e.batteryLevel.toFixed(1),"%"]})]}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx(ue,{className:"w-4 h-4"}),I.jsxs("span",{children:["ETA: ",p(e.estimatedArrival)]})]}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx(s,{className:"w-4 h-4"}),I.jsx("span",{className:"capitalize",children:e.reason.replace("_"," ")})]})]}),I.jsxs("div",{className:"text-xs "+(a?"text-text-muted":"text-slate-500"),children:["Expected charging time: ",p(e.expectedChargingTime)," â€¢ Requested: ",new Date(e.requestedAt).toLocaleTimeString()]})]})]}),I.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[I.jsx("button",{onClick:()=>{console.log(`Moving ${e.droneName} up in queue`)},className:"p-1 transition-colors "+(a?"text-text-muted hover:text-green-400":"text-slate-500 hover:text-green-400"),title:"Move up in queue",children:I.jsx(q,{className:"w-4 h-4"})}),I.jsx("button",{onClick:()=>{console.log(`Moving ${e.droneName} down in queue`)},className:"p-1 transition-colors "+(a?"text-text-muted hover:text-yellow-400":"text-slate-500 hover:text-yellow-400"),title:"Move down in queue",children:I.jsx(R,{className:"w-4 h-4"})}),I.jsx("button",{onClick:()=>{ps.removeDroneFromChargingQueue(e.droneId)},className:"p-1 transition-colors "+(a?"text-text-muted hover:text-red-400":"text-slate-500 hover:text-red-400"),title:"Remove from queue",children:I.jsx(pt,{className:"w-4 h-4"})})]})]})})},y=({station:e,index:t})=>{const s=(e=>{switch(e){case"available":return{color:"#10b981",bg:"#10b981",icon:se};case"occupied":return{color:"#d29922",bg:"#d29922",icon:K};case"maintenance":return{color:"#da3633",bg:"#da3633",icon:xt};case"reserved":return{color:"#1f6feb",bg:"#1f6feb",icon:ue};default:return{color:"#8b949e",bg:"#8b949e",icon:We}}})(e.status),r=s.icon;return I.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*t},className:(a?"bg-dark-tertiary border border-dark-border":"bg-slate-800 border border-slate-600")+" rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-start justify-between mb-3",children:[I.jsxs("div",{className:"flex items-center gap-3",children:[I.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{backgroundColor:s.bg+"20"},children:I.jsx(r,{className:"w-5 h-5",style:{color:s.color}})}),I.jsxs("div",{children:[I.jsx("h3",{className:"font-medium "+(a?"text-text-primary":"text-slate-200"),children:e.name}),I.jsxs("p",{className:"text-xs "+(a?"text-text-secondary":"text-slate-400"),children:["ID: ",e.id]})]})]}),I.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium capitalize",style:{backgroundColor:s.color+"20",color:s.color},children:e.status})]}),I.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[I.jsxs("div",{children:[I.jsx("span",{className:""+(a?"text-text-secondary":"text-slate-400"),children:"Charging Rate"}),I.jsxs("div",{className:"font-mono "+(a?"text-text-primary":"text-slate-200"),children:[e.chargingRate,"%/min"]})]}),I.jsxs("div",{children:[I.jsx("span",{className:""+(a?"text-text-secondary":"text-slate-400"),children:"Sessions"}),I.jsx("div",{className:"font-mono "+(a?"text-text-primary":"text-slate-200"),children:e.totalChargingSessions})]}),I.jsxs("div",{children:[I.jsx("span",{className:""+(a?"text-text-secondary":"text-slate-400"),children:"Avg Time"}),I.jsx("div",{className:"font-mono "+(a?"text-text-primary":"text-slate-200"),children:p(e.averageChargingTime)})]}),I.jsxs("div",{children:[I.jsx("span",{className:""+(a?"text-text-secondary":"text-slate-400"),children:"Time Left"}),I.jsx("div",{className:"font-mono "+(a?"text-text-primary":"text-slate-200"),children:e.estimatedTimeRemaining?p(e.estimatedTimeRemaining):"N/A"})]})]}),e.currentDrone&&I.jsx("div",{className:"mt-3 pt-3 border-t border-slate-600",children:I.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[I.jsx(K,{className:"w-4 h-4 text-yellow-400"}),I.jsx("span",{className:""+(a?"text-text-secondary":"text-slate-300"),children:"Currently charging:"}),I.jsx("span",{className:"font-mono "+(a?"text-text-primary":"text-slate-200"),children:e.currentDrone})]})}),I.jsxs("div",{className:"mt-3 text-xs "+(a?"text-text-muted":"text-slate-500"),children:["Last maintenance: ",new Date(e.lastMaintenance).toLocaleDateString()]})]})};return t?I.jsxs("div",{className:`${a?e:`bg-slate-900 border border-slate-700 rounded-lg p-4 ${e}`}`,children:[I.jsxs("div",{className:"flex items-center justify-between mb-3",children:[I.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2 "+(a?"text-text-primary":"text-slate-200"),children:[I.jsx(K,{className:"w-5 h-5"}),"Charging"]}),I.jsx("div",{className:"flex items-center gap-2 text-sm",children:r&&I.jsxs("span",{className:""+(a?"text-text-secondary":"text-slate-400"),children:[r.occupiedStations,"/",r.totalStations," â€¢ Queue: ",r.totalInQueue]})})]}),I.jsxs("div",{className:"space-y-2",children:[r&&I.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[I.jsxs("div",{children:[I.jsx("span",{className:""+(a?"text-text-secondary":"text-slate-400"),children:"Available"}),I.jsx("div",{className:"text-green-400 font-mono",children:r.availableStations})]}),I.jsxs("div",{children:[I.jsx("span",{className:""+(a?"text-text-secondary":"text-slate-400"),children:"In Queue"}),I.jsx("div",{className:"text-orange-400 font-mono",children:r.totalInQueue})]})]}),x.length>0&&I.jsxs("div",{className:"space-y-1",children:[I.jsx("div",{className:"text-xs font-medium text-slate-300",children:"Next in queue:"}),x.slice(0,2).map(e=>I.jsxs("div",{className:"text-xs text-slate-400 flex items-center justify-between",children:[I.jsxs("span",{children:[e.queuePosition,". ",e.droneName]}),I.jsxs("span",{children:[e.batteryLevel.toFixed(0),"%"]})]},e.id))]})]})]}):I.jsxs("div",{className:a?e:`bg-slate-900 border border-slate-700 rounded-lg ${e}`,children:[I.jsxs("div",{className:"flex items-center justify-between "+(a?"p-4 border-b border-dark-border":"p-6 border-b border-slate-700"),children:[I.jsxs("h2",{className:(a?"text-lg font-semibold text-text-primary":"text-xl font-semibold text-slate-200")+" flex items-center gap-3",children:[I.jsx(K,{className:""+(a?"w-5 h-5":"w-6 h-6")}),"Charging Management"]}),I.jsxs("div",{className:"flex items-center gap-3",children:[I.jsx("div",{className:"flex items-center gap-4 text-sm "+(a?"text-text-secondary":"text-slate-400"),children:r&&I.jsxs(I.Fragment,{children:[I.jsxs("span",{children:[r.occupiedStations,"/",r.totalStations," stations busy"]}),I.jsxs("span",{children:[r.totalInQueue," in queue"]}),I.jsxs("span",{children:["Avg wait: ",p(r.averageWaitTime)]})]})}),I.jsxs("div",{className:"flex space-x-1",children:[I.jsx("button",{onClick:()=>m("overview"),className:"px-3 py-1.5 rounded text-sm font-medium transition-colors "+("overview"===d?a?"bg-dark-tertiary text-text-primary border border-dark-border":"bg-slate-700 text-slate-200":a?"text-text-secondary hover:text-text-primary hover:bg-dark-hover":"text-slate-400 hover:text-slate-200 hover:bg-slate-800"),children:"Overview"}),I.jsxs("button",{onClick:()=>m("queue"),className:"px-3 py-1.5 rounded text-sm font-medium transition-colors flex items-center gap-1 "+("queue"===d?a?"bg-dark-tertiary text-text-primary border border-dark-border":"bg-slate-700 text-slate-200":a?"text-text-secondary hover:text-text-primary hover:bg-dark-hover":"text-slate-400 hover:text-slate-200 hover:bg-slate-800"),children:[I.jsx(He,{className:"w-4 h-4"}),"Queue",x.length>0&&I.jsx("span",{className:"bg-orange-500 text-white text-xs rounded-full px-1.5 py-0.5 min-w-[18px] text-center",children:x.length})]}),I.jsx("button",{onClick:()=>m("stations"),className:"px-3 py-1.5 rounded text-sm font-medium transition-colors "+("stations"===d?a?"bg-dark-tertiary text-text-primary border border-dark-border":"bg-slate-700 text-slate-200":a?"text-text-secondary hover:text-text-primary hover:bg-dark-hover":"text-slate-400 hover:text-slate-200 hover:bg-slate-800"),children:"Stations"})]})]})]}),I.jsx("div",{className:""+(a?"p-4 flex-1 overflow-auto":"p-6"),children:I.jsxs(u,{mode:"wait",children:["overview"===d&&r&&I.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-6",children:[I.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[I.jsxs("div",{className:(a?"bg-dark-tertiary border border-dark-border":"bg-slate-800 border border-slate-600")+" rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsx("span",{className:"text-sm "+(a?"text-text-secondary":"text-slate-400"),children:"Available Stations"}),I.jsx(se,{className:"w-5 h-5 text-green-400"})]}),I.jsx("div",{className:"text-2xl font-bold text-green-400",children:r.availableStations}),I.jsxs("div",{className:"text-xs "+(a?"text-text-muted":"text-slate-500"),children:["of ",r.totalStations," total"]})]}),I.jsxs("div",{className:(a?"bg-dark-tertiary border border-dark-border":"bg-slate-800 border border-slate-600")+" rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsx("span",{className:"text-sm "+(a?"text-text-secondary":"text-slate-400"),children:"Queue Length"}),I.jsx(He,{className:"w-5 h-5 text-orange-400"})]}),I.jsx("div",{className:"text-2xl font-bold text-orange-400",children:r.totalInQueue}),I.jsx("div",{className:"text-xs "+(a?"text-text-muted":"text-slate-500"),children:"drones waiting"})]}),I.jsxs("div",{className:(a?"bg-dark-tertiary border border-dark-border":"bg-slate-800 border border-slate-600")+" rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsx("span",{className:"text-sm "+(a?"text-text-secondary":"text-slate-400"),children:"Avg Wait Time"}),I.jsx(ue,{className:"w-5 h-5 text-blue-400"})]}),I.jsx("div",{className:"text-2xl font-bold text-blue-400",children:p(r.averageWaitTime)}),I.jsx("div",{className:"text-xs "+(a?"text-text-muted":"text-slate-500"),children:"current estimate"})]}),I.jsxs("div",{className:(a?"bg-dark-tertiary border border-dark-border":"bg-slate-800 border border-slate-600")+" rounded-lg p-4",children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsx("span",{className:"text-sm "+(a?"text-text-secondary":"text-slate-400"),children:"Daily Sessions"}),I.jsx(K,{className:"w-5 h-5 text-yellow-400"})]}),I.jsx("div",{className:"text-2xl font-bold text-yellow-400",children:r.dailyChargingSessions}),I.jsx("div",{className:"text-xs "+(a?"text-text-muted":"text-slate-500"),children:"completed today"})]})]}),x.length>0&&I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-medium text-slate-200 mb-4",children:"Next in Queue"}),I.jsx("div",{className:"grid gap-3",children:x.slice(0,3).map((e,t)=>I.jsx(v,{item:e,index:t},e.id))}),x.length>3&&I.jsx("div",{className:"text-center mt-3",children:I.jsxs("button",{onClick:()=>m("queue"),className:"text-sm hover:text-blue-300 "+(a?"text-status-active":"text-blue-400"),children:["View all ",x.length," items in queue â†’"]})})]})]},"overview"),"queue"===d&&I.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[I.jsxs("h3",{className:"text-lg font-medium "+(a?"text-text-primary":"text-slate-200"),children:["Charging Queue (",x.length,")"]}),0===x.length?I.jsxs("div",{className:"text-center py-8",children:[I.jsx(He,{className:"w-12 h-12 mx-auto mb-3 "+(a?"text-text-muted":"text-slate-500")}),I.jsx("h4",{className:"text-lg font-semibold mb-2 "+(a?"text-text-secondary":"text-slate-300"),children:"No Drones in Queue"}),I.jsx("p",{className:""+(a?"text-text-muted":"text-slate-500"),children:"All drones are either charged or currently charging"})]}):I.jsx("div",{className:`space-y-3 ${a?"max-h-64":"max-h-96"} overflow-y-auto`,children:x.map((e,t)=>I.jsx(v,{item:e,index:t},e.id))})]},"queue"),"stations"===d&&I.jsxs(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"space-y-4",children:[I.jsxs("h3",{className:"text-lg font-medium "+(a?"text-text-primary":"text-slate-200"),children:["Charging Stations (",i.length,")"]}),I.jsx("div",{className:"grid gap-4 lg:grid-cols-2",children:i.map((e,t)=>I.jsx(y,{station:e,index:t},e.id))})]},"stations")]})})]})},Ns=({className:e=""})=>{const t=vs(e=>Object.values(e.drones)),[a,r]=s.useState({overall:"safe",lastCheck:Date.now(),criticalAlerts:0,warningAlerts:0,activeDrones:0,dronesAtRisk:0,totalAlerts:0}),[n,i]=s.useState([]),[l,o]=s.useState(!1),[c,d]=s.useState(!1),[m,x]=s.useState("overview");s.useEffect(()=>{const e=()=>{try{const t=new WebSocket("ws://localhost:3005/safety-ws");return t.onopen=()=>{console.log("Safety WebSocket connected"),o(!0),t.send(JSON.stringify({type:"subscribe",channels:["battery_alerts","safety_alerts","emergency_alerts","all_alerts"]})),t.send(JSON.stringify({type:"get_alerts"}))},t.onmessage=e=>{try{const t=JSON.parse(e.data);g(t)}catch(t){console.error("Failed to parse safety message:",t)}},t.onclose=()=>{console.log("Safety WebSocket disconnected"),o(!1),setTimeout(e,5e3)},t.onerror=e=>{console.error("Safety WebSocket error:",e),o(!1)},t}catch(t){return console.error("Failed to initialize safety connection:",t),o(!1),null}},t=e();return()=>{t&&t.close()}},[]);const g=e=>{switch(e.type){case"battery_alert":case"safety_alert":case"emergency_alert":i(t=>[e.data,...t.slice(0,19)]);break;case"system_safety_status":r(e.data.status);break;case"alerts_data":i(e.data.alerts||[]);break;case"alert_resolved":i(t=>t.filter(t=>t.id!==e.data.alertId))}},p=e=>{if("battery"===e.type)return I.jsx(K,{className:"w-4 h-4"});switch(e.severity){case"critical":return I.jsx(Ne,{className:"w-4 h-4"});case"warning":return I.jsx(Ke,{className:"w-4 h-4"});default:return I.jsx(Z,{className:"w-4 h-4"})}},v=e=>{switch(e){case"critical":return"text-red-400 bg-red-900/20 border-red-500/30";case"warning":return"text-orange-400 bg-orange-900/20 border-orange-500/30";case"info":return"text-blue-400 bg-blue-900/20 border-blue-500/30";default:return"text-gray-400 bg-gray-900/20 border-gray-500/30"}},y=e=>{const t=new Date(e),s=(new Date).getTime()-t.getTime();return s<6e4?"Just now":s<36e5?`${Math.floor(s/6e4)}m ago`:s<864e5?`${Math.floor(s/36e5)}h ago`:t.toLocaleDateString()},b=c?n:n.slice(0,5);return I.jsxs("div",{className:`bg-dark-secondary rounded-lg border border-dark-border flex flex-col h-full max-h-full overflow-hidden ${e}`,children:[I.jsxs("div",{className:"p-4 border-b border-dark-border flex-shrink-0",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3",children:[I.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Safety Monitor"}),I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"w-2 h-2 rounded-full "+(l?"bg-green-400":"bg-red-400")}),I.jsx("span",{className:"text-xs text-text-secondary",children:l?"Connected":"Disconnected"})]})]}),I.jsxs("div",{className:"flex flex-wrap gap-1 mb-3 min-w-0",children:[I.jsx("button",{onClick:()=>x("overview"),className:"px-2 py-1.5 rounded text-xs font-medium transition-colors flex-shrink-0 "+("overview"===m?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"),children:"Overview"}),I.jsxs("button",{onClick:()=>x("emergencies"),className:"px-2 py-1.5 rounded text-xs font-medium transition-colors flex items-center gap-1 flex-shrink-0 "+("emergencies"===m?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"),children:[I.jsx(Ke,{className:"w-3 h-3"}),"Emergency",t.some(e=>e.emergencyState&&!e.emergencyState.resolved)&&I.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full px-1.5 py-0.5 min-w-[18px] text-center",children:t.filter(e=>e.emergencyState&&!e.emergencyState.resolved).length})]}),I.jsxs("button",{onClick:()=>x("coordination"),className:"px-2 py-1.5 rounded text-xs font-medium transition-colors flex items-center gap-1 flex-shrink-0 "+("coordination"===m?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"),children:[I.jsx(F,{className:"w-3 h-3"}),"Coord"]}),I.jsxs("button",{onClick:()=>x("charging"),className:"px-2 py-1.5 rounded text-xs font-medium transition-colors flex items-center gap-1 flex-shrink-0 "+("charging"===m?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"),children:[I.jsx(K,{className:"w-3 h-3"}),"Charge",t.filter(e=>"charging"===e.status).length>0&&I.jsx("span",{className:"bg-yellow-500 text-white text-xs rounded-full px-1.5 py-0.5 min-w-[18px] text-center",children:t.filter(e=>"charging"===e.status).length})]})]}),I.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border ${(e=>{switch(e){case"safe":return"text-green-400 bg-green-900/20";case"caution":return"text-yellow-400 bg-yellow-900/20";case"warning":return"text-orange-400 bg-orange-900/20";case"critical":return"text-red-400 bg-red-900/20";default:return"text-gray-400 bg-gray-900/20"}})(a.overall)}`,children:[(e=>{switch(e){case"safe":default:return I.jsx(Je,{className:"w-5 h-5"});case"caution":case"warning":return I.jsx(Ke,{className:"w-5 h-5"});case"critical":return I.jsx(Ne,{className:"w-5 h-5"})}})(a.overall),I.jsxs("div",{className:"flex-1",children:[I.jsxs("div",{className:"font-medium capitalize",children:["System Status: ",a.overall]}),I.jsx("div",{className:"text-sm opacity-80",children:a.dronesAtRisk>0?`${a.dronesAtRisk} drone${a.dronesAtRisk>1?"s":""} at risk`:"All drones operating safely"})]}),I.jsxs("div",{className:"text-right text-sm",children:[I.jsxs("div",{children:[a.totalAlerts," alerts"]}),I.jsxs("div",{className:"opacity-70",children:[a.criticalAlerts," critical"]})]})]})]}),I.jsx("div",{className:"p-4 border-b border-dark-border flex-shrink-0",children:I.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[I.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3",children:[I.jsx("div",{className:"text-2xl font-bold text-text-primary",children:a.activeDrones}),I.jsx("div",{className:"text-sm text-text-secondary",children:"Active Drones"})]}),I.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3",children:[I.jsx("div",{className:"text-2xl font-bold text-red-400",children:a.criticalAlerts}),I.jsx("div",{className:"text-sm text-text-secondary",children:"Critical Alerts"})]})]})}),I.jsx("div",{className:"flex-1 min-h-0 overflow-auto",children:"overview"===m?I.jsxs("div",{className:"flex flex-col min-h-full",children:[I.jsxs("div",{className:"flex items-center justify-between p-4 pb-2 flex-shrink-0",children:[I.jsx("h4",{className:"font-medium text-text-primary",children:"Recent Alerts"}),n.length>5&&I.jsx("button",{onClick:()=>d(!c),className:"text-xs text-status-active hover:text-status-active/80 transition-colors",children:c?"Show Less":`Show All (${n.length})`})]}),I.jsx("div",{className:"flex-1 px-4 pb-4 space-y-2 overflow-y-auto",children:I.jsx(u,{children:b.length>0?b.map(e=>I.jsx(h.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},className:`p-3 rounded-lg border ${v(e.severity)}`,children:I.jsxs("div",{className:"flex items-start gap-2",children:[p(e),I.jsxs("div",{className:"flex-1 min-w-0",children:[I.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[I.jsx("span",{className:"text-xs font-medium uppercase tracking-wide",children:e.type.replace("_"," ")}),e.droneId&&I.jsx("span",{className:"text-xs text-text-secondary",children:e.droneId}),I.jsx("span",{className:"text-xs text-text-secondary ml-auto",children:y(e.timestamp)})]}),I.jsx("div",{className:"text-sm text-text-primary mb-2",children:e.message}),"battery"===e.type&&e.data&&I.jsxs("div",{className:"text-xs text-text-secondary mb-2",children:["Battery: ",e.data.batteryLevel,"%",e.data.batteryVoltage&&` (${e.data.batteryVoltage}V)`]}),I.jsxs("div",{className:"flex items-center gap-2",children:[!e.acknowledged&&I.jsxs("button",{onClick:()=>(async e=>{try{console.log(`Acknowledging alert: ${e}`),i(t=>t.map(t=>t.id===e?{...t,acknowledged:!0}:t))}catch(t){console.error("Failed to acknowledge alert:",t)}})(e.id),className:"flex items-center gap-1 text-xs text-status-active hover:text-status-active/80 transition-colors",children:[I.jsx(se,{className:"w-3 h-3"}),"Acknowledge"]}),e.acknowledged&&!e.resolved&&I.jsxs("button",{onClick:()=>(async e=>{try{console.log(`Resolving alert: ${e}`),i(t=>t.filter(t=>t.id!==e))}catch(t){console.error("Failed to resolve alert:",t)}})(e.id),className:"flex items-center gap-1 text-xs text-green-400 hover:text-green-300 transition-colors",children:[I.jsx(ut,{className:"w-3 h-3"}),"Resolve"]}),e.acknowledged&&I.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-400",children:[I.jsx(se,{className:"w-3 h-3"}),"Acknowledged"]})]})]})]})},e.id)):I.jsxs("div",{className:"text-center py-8 text-text-secondary",children:[I.jsx(Je,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),I.jsx("div",{className:"text-sm",children:"No active safety alerts"}),I.jsx("div",{className:"text-xs opacity-70 mt-1",children:"All systems operating normally"})]})})})]}):"emergencies"===m?I.jsx("div",{className:"h-full overflow-auto",children:I.jsx(bs,{drones:t,className:"h-full border-0 bg-transparent"})}):"coordination"===m?I.jsx("div",{className:"h-full overflow-auto",children:I.jsx(fs,{className:"h-full border-0 bg-transparent"})}):I.jsx("div",{className:"h-full overflow-auto",children:I.jsx(js,{className:"h-full border-0 bg-transparent"})})}),I.jsx("div",{className:"px-4 py-2 border-t border-dark-border flex-shrink-0",children:I.jsxs("div",{className:"flex items-center gap-1 text-xs text-text-secondary",children:[I.jsx(ue,{className:"w-3 h-3"}),"Last update: ",y(new Date(a.lastCheck).toISOString())]})})]})},ws=({children:e,minHeight:t=200,maxHeight:a=800,initialHeight:r=400,onHeightChange:n,className:i="",disabled:l=!1})=>{const[o,c]=s.useState(r),[d,m]=s.useState(!1),[x,h]=s.useState(!1),u=s.useRef(null),g=s.useRef(0),p=s.useRef(0),v=s.useCallback(e=>{l||(e.preventDefault(),m(!0),g.current=e.clientY,p.current=o,document.body.style.cursor="ns-resize",document.body.style.userSelect="none")},[o,l]),y=s.useCallback(e=>{if(!d)return;const s=e.clientY-g.current,r=Math.min(Math.max(p.current+s,t),a);c(r),n?.(r)},[d,t,a,n]),b=s.useCallback(()=>{d&&(m(!1),document.body.style.cursor="",document.body.style.userSelect="")},[d]),f=s.useCallback(e=>{if(l)return;const s=e.shiftKey?50:10;let r=o;"ArrowUp"===e.key?(e.preventDefault(),r=Math.max(o-s,t)):"ArrowDown"===e.key?(e.preventDefault(),r=Math.min(o+s,a)):"Home"===e.key?(e.preventDefault(),r=t):"End"===e.key&&(e.preventDefault(),r=a),r!==o&&(c(r),n?.(r))},[o,t,a,l,n]);return s.useEffect(()=>{if(d)return document.addEventListener("mousemove",y),document.addEventListener("mouseup",b),()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b)}},[d,y,b]),s.useEffect(()=>{const e=setTimeout(()=>h(!0),1e3),t=setTimeout(()=>h(!1),4e3);return()=>{clearTimeout(e),clearTimeout(t)}},[]),I.jsxs("div",{ref:u,className:`relative border border-dark-border rounded-lg bg-dark-secondary overflow-hidden ${i}`,style:{height:`${o}px`},children:[I.jsx("div",{className:"h-full w-full",children:e}),!l&&I.jsxs("div",{className:`\n            absolute bottom-0 left-0 right-0 h-3 cursor-ns-resize\n            hover:bg-status-active/20 transition-all duration-200\n            ${d?"bg-status-active/30":x?"bg-status-active/10":"bg-transparent hover:bg-dark-hover/50"}\n            group flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-status-active/50\n          `,onMouseDown:v,onKeyDown:f,tabIndex:0,role:"separator","aria-orientation":"horizontal","aria-label":`Resize panel. Current height: ${o}px. Range: ${t}px to ${a}px. Use arrow keys to adjust, Shift+arrows for larger steps.`,title:`Drag to resize panel (${t}px - ${a}px). Keyboard: â†‘â†“ arrows, Shift+arrows for 50px steps, Home/End for min/max`,children:[I.jsx("div",{className:`\n            h-1 rounded-full transition-all duration-200 relative\n            ${d?"w-16 bg-status-active shadow-lg":"w-12 bg-text-muted/40 group-hover:bg-status-active/70 group-hover:w-16"}\n          `,children:I.jsx("div",{className:`\n              absolute inset-0 flex items-center justify-center gap-0.5 transition-opacity\n              ${d?"opacity-0":"opacity-100 group-hover:opacity-0"}\n            `,children:[0,1,2].map(e=>I.jsx("div",{className:"w-0.5 h-0.5 bg-current rounded-full"},e))})}),d&&I.jsxs("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 \n                          bg-dark-tertiary text-text-primary text-xs px-2 py-1 rounded \n                          border border-dark-border shadow-lg whitespace-nowrap",children:[o,"px"]})]})]})},ks=({waypoints:e,onWaypointsChange:t,disabled:a=!1,className:r=""})=>{const[n,i]=s.useState(null),[l,o]=s.useState(!1),[c,d]=s.useState({position:{lat:37.7749,lng:-122.4194,alt:50},action:"navigation",hoverTime:0,notes:""}),m=[{value:"navigation",label:"Navigate",icon:"ðŸ§­",description:"Fly to location"},{value:"pickup",label:"Pickup",icon:"ðŸ“¦",description:"Pickup item"},{value:"delivery",label:"Delivery",icon:"ðŸšš",description:"Deliver item"},{value:"hover",label:"Hover",icon:"ðŸš",description:"Hover in place"},{value:"survey",label:"Survey",icon:"ðŸ”",description:"Survey area"},{value:"landing",label:"Land",icon:"ðŸ›¬",description:"Land drone"},{value:"takeoff",label:"Takeoff",icon:"ðŸ›«",description:"Takeoff drone"}],x=()=>{d({position:{lat:37.7749,lng:-122.4194,alt:50},action:"navigation",hoverTime:0,notes:""})},g=()=>{if(null===n)return;const s=[...e];s[n]={...s[n],position:c.position,action:c.action,hoverTime:c.hoverTime||0,notes:c.notes||""},t(s),i(null),x()},p=()=>{i(null),o(!1),x()},v=(s,a)=>{if("up"===a&&0===s)return;if("down"===a&&s===e.length-1)return;const r=[...e],n="up"===a?s-1:s+1;[r[s],r[n]]=[r[n],r[s]],t(r)},y=e=>m.find(t=>t.value===e)||m[0],b=(e,t)=>{const s=e.lat*Math.PI/180,a=t.lat*Math.PI/180,r=(t.lat-e.lat)*Math.PI/180,n=(t.lng-e.lng)*Math.PI/180,i=Math.sin(r/2)*Math.sin(r/2)+Math.cos(s)*Math.cos(a)*Math.sin(n/2)*Math.sin(n/2),l=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i));return Math.round(6371e3*l)};return I.jsxs("div",{className:`space-y-4 ${r}`,children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Waypoints"}),I.jsxs("p",{className:"text-sm text-text-secondary",children:[e.length," waypoint",1!==e.length?"s":"",e.length>1&&I.jsxs("span",{className:"ml-2",children:["Total distance: ~",e.reduce((t,s,a)=>0===a?t:t+b(e[a-1].position,s.position),0),"m"]})]})]}),!a&&I.jsxs("button",{onClick:()=>o(!0),disabled:l||null!==n,className:"flex items-center gap-2 px-3 py-2 bg-status-active hover:bg-status-active/80 \n                     text-white rounded-lg text-sm font-medium transition-colors\n                     disabled:opacity-50 disabled:cursor-not-allowed",children:[I.jsx(qe,{className:"w-4 h-4"}),"Add Waypoint"]})]}),I.jsxs("div",{className:"space-y-3",children:[I.jsx(u,{children:e.map((s,r)=>I.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-dark-tertiary rounded-lg border border-dark-border",children:n===r?I.jsxs("div",{className:"p-4 space-y-4",children:[I.jsx(Ss,{data:c,onChange:d,actionOptions:m}),I.jsxs("div",{className:"flex justify-end gap-2",children:[I.jsxs("button",{onClick:p,className:"flex items-center gap-1 px-3 py-2 text-text-secondary hover:text-text-primary \n                               transition-colors text-sm",children:[I.jsx(pt,{className:"w-4 h-4"}),"Cancel"]}),I.jsxs("button",{onClick:g,className:"flex items-center gap-1 px-3 py-2 bg-status-active hover:bg-status-active/80 \n                               text-white rounded transition-colors text-sm",children:[I.jsx(re,{className:"w-4 h-4"}),"Save"]})]})]}):I.jsx("div",{className:"p-4",children:I.jsxs("div",{className:"flex items-start justify-between",children:[I.jsxs("div",{className:"flex-1",children:[I.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[I.jsx("span",{className:"text-lg",children:y(s.action).icon}),I.jsxs("div",{children:[I.jsxs("h4",{className:"font-medium text-text-primary",children:[r+1,". ",y(s.action).label]}),I.jsx("p",{className:"text-sm text-text-secondary",children:y(s.action).description})]}),s.completed&&I.jsx("span",{className:"px-2 py-1 bg-status-operational/20 text-status-operational \n                                         text-xs font-medium rounded-full",children:"âœ“ Completed"})]}),I.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Position:"}),I.jsxs("div",{className:"font-mono text-text-primary",children:[s.position.lat.toFixed(6),", ",s.position.lng.toFixed(6)]}),I.jsxs("div",{className:"font-mono text-text-secondary",children:["Alt: ",s.position.alt,"m"]})]}),I.jsxs("div",{children:["hover"===s.action&&s.hoverTime&&I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Hover Time:"}),I.jsxs("div",{className:"text-text-primary",children:[s.hoverTime,"s"]})]}),r>0&&I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Distance:"}),I.jsxs("div",{className:"text-text-primary",children:["~",b(e[r-1].position,s.position),"m"]})]})]})]}),s.notes&&I.jsxs("div",{className:"mt-2 p-2 bg-dark-hover rounded text-sm",children:[I.jsx("span",{className:"text-text-secondary",children:"Notes:"}),I.jsx("div",{className:"text-text-primary mt-1",children:s.notes})]})]}),!a&&!s.completed&&I.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[I.jsx("button",{onClick:()=>v(r,"up"),disabled:0===r,className:"p-1 text-text-secondary hover:text-text-primary transition-colors\n                                   disabled:opacity-30 disabled:cursor-not-allowed",title:"Move up",children:I.jsx(xe,{className:"w-4 h-4"})}),I.jsx("button",{onClick:()=>v(r,"down"),disabled:r===e.length-1,className:"p-1 text-text-secondary hover:text-text-primary transition-colors\n                                   disabled:opacity-30 disabled:cursor-not-allowed",title:"Move down",children:I.jsx(ie,{className:"w-4 h-4"})}),I.jsx("button",{onClick:()=>(t=>{const s=e[t];d({position:s.position,action:s.action,hoverTime:s.hoverTime,notes:s.notes}),i(t)})(r),disabled:null!==n||l,className:"p-1 text-text-secondary hover:text-status-warning transition-colors\n                                   disabled:opacity-30 disabled:cursor-not-allowed",title:"Edit waypoint",children:I.jsx(Fe,{className:"w-4 h-4"})}),I.jsx("button",{onClick:()=>(s=>{const a=e.filter((e,t)=>t!==s);t(a)})(r),disabled:null!==n||l,className:"p-1 text-text-secondary hover:text-status-critical transition-colors\n                                   disabled:opacity-30 disabled:cursor-not-allowed",title:"Delete waypoint",children:I.jsx(it,{className:"w-4 h-4"})})]})]})})},s.id||r))}),I.jsx(u,{children:l&&I.jsxs(h.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-dark-tertiary rounded-lg border border-dark-border p-4",children:[I.jsxs("h4",{className:"text-text-primary font-medium mb-4 flex items-center gap-2",children:[I.jsx(Re,{className:"w-5 h-5"}),"Add New Waypoint"]}),I.jsxs("div",{className:"space-y-4",children:[I.jsx(Ss,{data:c,onChange:d,actionOptions:m}),I.jsxs("div",{className:"flex justify-end gap-2",children:[I.jsxs("button",{onClick:p,className:"flex items-center gap-1 px-3 py-2 text-text-secondary hover:text-text-primary \n                             transition-colors text-sm",children:[I.jsx(pt,{className:"w-4 h-4"}),"Cancel"]}),I.jsxs("button",{onClick:()=>{if(!c.position.lat||!c.position.lng)return;const s={id:`waypoint-${Date.now()}`,position:c.position,action:c.action,hoverTime:c.hoverTime||0,notes:c.notes||"",completed:!1};t([...e,s]),x(),o(!1)},disabled:!c.position.lat||!c.position.lng,className:"flex items-center gap-1 px-3 py-2 bg-status-active hover:bg-status-active/80 \n                             text-white rounded transition-colors text-sm\n                             disabled:opacity-50 disabled:cursor-not-allowed",children:[I.jsx(qe,{className:"w-4 h-4"}),"Add Waypoint"]})]})]})]})})]}),0===e.length&&I.jsxs("div",{className:"text-center py-8 text-text-secondary",children:[I.jsx(Re,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),I.jsx("h4",{className:"text-lg font-medium mb-2",children:"No waypoints added"}),I.jsx("p",{className:"text-sm mb-4",children:"Add waypoints to define the mission route"}),!a&&I.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-status-active hover:bg-status-active/80 text-white rounded-lg\n                       transition-colors text-sm font-medium",children:"Add First Waypoint"})]})]})},Ss=({data:e,onChange:t,actionOptions:s})=>I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Position"}),I.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[I.jsxs("div",{children:[I.jsx("input",{type:"number",step:"0.000001",placeholder:"Latitude",value:e.position.lat,onChange:s=>t({...e,position:{...e.position,lat:parseFloat(s.target.value)||0}}),className:"w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm\n                       text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active"}),I.jsx("span",{className:"text-xs text-text-secondary",children:"Latitude"})]}),I.jsxs("div",{children:[I.jsx("input",{type:"number",step:"0.000001",placeholder:"Longitude",value:e.position.lng,onChange:s=>t({...e,position:{...e.position,lng:parseFloat(s.target.value)||0}}),className:"w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm\n                       text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active"}),I.jsx("span",{className:"text-xs text-text-secondary",children:"Longitude"})]}),I.jsxs("div",{children:[I.jsx("input",{type:"number",min:"0",max:"1000",placeholder:"Altitude",value:e.position.alt,onChange:s=>t({...e,position:{...e.position,alt:parseInt(s.target.value)||0}}),className:"w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm\n                       text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active"}),I.jsx("span",{className:"text-xs text-text-secondary",children:"Altitude (m)"})]})]})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Action"}),I.jsx("select",{value:e.action,onChange:s=>t({...e,action:s.target.value}),className:"w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm\n                   text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active",children:s.map(e=>I.jsxs("option",{value:e.value,children:[e.icon," ",e.label," - ",e.description]},e.value))})]}),"hover"===e.action&&I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Hover Time (seconds)"}),I.jsx("input",{type:"number",min:"1",max:"3600",value:e.hoverTime||0,onChange:s=>t({...e,hoverTime:parseInt(s.target.value)||0}),className:"w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm\n                     text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active"})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Notes (optional)"}),I.jsx("textarea",{rows:2,placeholder:"Additional notes about this waypoint...",value:e.notes||"",onChange:s=>t({...e,notes:s.target.value}),className:"w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm\n                   text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active\n                   resize-none"})]})]}),Cs="http://localhost:3001/api";let Ms=null,Ds=0;const As=cs()(ds((e,t)=>({missions:{},activeMissions:[],selectedMissionId:null,missionStats:null,wsConnected:!1,wsError:null,lastUpdate:null,loading:!1,creating:!1,updating:!1,deleting:!1,setMissions:t=>{const s={};t.forEach(e=>{s[e.id]=e}),e({missions:s,lastUpdate:(new Date).toISOString()})},setActiveMissions:t=>e({activeMissions:t}),setMissionStats:t=>e({missionStats:t}),selectMission:t=>e({selectedMissionId:t}),createMission:async t=>{e({creating:!0});try{const s=await fetch(`${Cs}/missions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok){const e=await s.json();throw new Error(e.message||"Failed to create mission")}const a=(await s.json()).data;return e(e=>({missions:{...e.missions,[a.id]:a},creating:!1,lastUpdate:(new Date).toISOString()})),a}catch(s){throw e({creating:!1}),s}},updateMission:async(t,s)=>{e({updating:!0});try{const a=await fetch(`${Cs}/missions/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok){const e=await a.json();throw new Error(e.message||"Failed to update mission")}const r=(await a.json()).data;return e(e=>({missions:{...e.missions,[t]:r},updating:!1,lastUpdate:(new Date).toISOString()})),r}catch(a){throw e({updating:!1}),a}},deleteMission:async t=>{e({deleting:!0});try{const s=await fetch(`${Cs}/missions/${t}`,{method:"DELETE"});if(!s.ok){const e=await s.json();throw new Error(e.message||"Failed to delete mission")}e(e=>{const{[t]:s,...a}=e.missions;return{missions:a,selectedMissionId:e.selectedMissionId===t?null:e.selectedMissionId,activeMissions:e.activeMissions.filter(e=>e.id!==t),deleting:!1,lastUpdate:(new Date).toISOString()}})}catch(s){throw e({deleting:!1}),s}},assignMissionToDrone:async(t,s)=>{try{const a=await fetch(`${Cs}/missions/${t}/assign`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({droneId:s})});if(!a.ok){const e=await a.json();throw new Error(e.message||"Failed to assign mission")}const r=(await a.json()).data;e(e=>({missions:{...e.missions,[t]:r},lastUpdate:(new Date).toISOString()}))}catch(a){throw a}},updateMissionProgress:async(t,s,a)=>{try{const r=await fetch(`${Cs}/missions/${t}/progress`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({progress:s,currentWaypoint:a})});if(!r.ok){const e=await r.json();throw new Error(e.message||"Failed to update progress")}e(e=>{const r=e.missions[t];return r?{missions:{...e.missions,[t]:{...r,progress:s,currentWaypoint:a??r.currentWaypoint}},lastUpdate:(new Date).toISOString()}:e})}catch(r){throw r}},setWsConnected:t=>e({wsConnected:t}),setWsError:t=>e({wsError:t}),handleMissionEvent:(s,a)=>{const r=t();switch(s){case"mission_created":e({missions:{...r.missions,[a.id]:a},lastUpdate:(new Date).toISOString()});break;case"mission_updated":e({missions:{...r.missions,[a.id]:a},lastUpdate:(new Date).toISOString()});break;case"mission_deleted":const{[a.id]:t,...n}=r.missions;e({missions:n,selectedMissionId:r.selectedMissionId===a.id?null:r.selectedMissionId,activeMissions:r.activeMissions.filter(e=>e.id!==a.id),lastUpdate:(new Date).toISOString()});break;case"mission_assigned":r.missions[a.missionId]&&e({missions:{...r.missions,[a.missionId]:a.mission},lastUpdate:(new Date).toISOString()});break;case"mission_progress":const i=r.missions[a.missionId];i&&e({missions:{...r.missions,[a.missionId]:{...i,progress:a.progress,currentWaypoint:a.currentWaypoint,status:a.status||i.status}},lastUpdate:(new Date).toISOString()});break;default:console.log("Unknown mission event:",s,a)}},getMissionById:e=>t().missions[e],getMissionsByDrone:e=>Object.values(t().missions).filter(t=>t.assignedDrone===e),getMissionsByStatus:e=>Object.values(t().missions).filter(t=>t.status===e),clearMissions:()=>e({missions:{},activeMissions:[],selectedMissionId:null,missionStats:null,lastUpdate:null})}))),Es=()=>{if(Ms?.readyState!==WebSocket.OPEN)try{Ms=new WebSocket("ws://localhost:3001/ws"),Ms.onopen=()=>{console.log("Mission WebSocket connected"),As.getState().setWsConnected(!0),As.getState().setWsError(null),Ds=0,Ms?.send(JSON.stringify({type:"subscribe_missions",requestId:`sub-${Date.now()}`}))},Ms.onmessage=e=>{try{const t=JSON.parse(e.data),{type:s,data:a}=t;switch((s.startsWith("mission_")||s.startsWith("waypoint_"))&&As.getState().handleMissionEvent(s,a),s){case"mission_stats":As.getState().setMissionStats(a);break;case"active_missions":As.getState().setActiveMissions(a);break;default:console.log("Mission WebSocket message:",s,a)}}catch(t){console.error("Error parsing WebSocket message:",t)}},Ms.onclose=e=>{console.log("Mission WebSocket disconnected:",e.code,e.reason),As.getState().setWsConnected(!1),Ds<5&&(Ds++,setTimeout(Es,2e3*Ds))},Ms.onerror=e=>{console.error("Mission WebSocket error:",e),As.getState().setWsError("WebSocket connection error")}}catch(e){console.error("Failed to create WebSocket connection:",e),As.getState().setWsError("Failed to connect to mission service")}},Ls=({isOpen:e,onClose:t,onMissionCreated:a})=>{const{createMission:r,creating:n}=As(),[i,l]=s.useState({name:"",description:"",priority:5,waypoints:[]}),[o,c]=s.useState(null),d=[{value:1,label:"Very Low",color:"text-gray-400"},{value:2,label:"Low",color:"text-blue-400"},{value:3,label:"Low-Medium",color:"text-blue-300"},{value:4,label:"Medium-Low",color:"text-yellow-400"},{value:5,label:"Medium",color:"text-yellow-300"},{value:6,label:"Medium-High",color:"text-orange-400"},{value:7,label:"High",color:"text-orange-300"},{value:8,label:"High-Critical",color:"text-red-400"},{value:9,label:"Critical",color:"text-red-300"},{value:10,label:"Emergency",color:"text-red-200"}],m=()=>{l({name:"",description:"",priority:5,waypoints:[]}),c(null),t()},x=e=>d.find(t=>t.value===e)||d[4];return e?I.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[10001] p-4",children:I.jsxs(h.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-dark-secondary rounded-lg border border-dark-border shadow-xl\n                   w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[I.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[I.jsxs("div",{className:"flex items-center gap-3",children:[I.jsx(Ze,{className:"w-6 h-6 text-status-active"}),I.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Create New Mission"})]}),I.jsx("button",{onClick:m,className:"p-2 hover:bg-dark-hover rounded-lg transition-colors",children:I.jsx(pt,{className:"w-5 h-5 text-text-secondary"})})]}),I.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),c(null),(()=>{if(!i.name.trim())return c("Mission name is required"),!1;if(i.name.length>100)return c("Mission name must be less than 100 characters"),!1;if(0===i.waypoints.length)return c("At least one waypoint is required"),!1;if(i.waypoints.length>50)return c("Maximum 50 waypoints allowed"),!1;for(let e=0;e<i.waypoints.length;e++){const t=i.waypoints[e];if(!t.position.lat||!t.position.lng)return c(`Waypoint ${e+1}: Invalid coordinates`),!1;if(Math.abs(t.position.lat)>90)return c(`Waypoint ${e+1}: Invalid latitude (must be -90 to 90)`),!1;if(Math.abs(t.position.lng)>180)return c(`Waypoint ${e+1}: Invalid longitude (must be -180 to 180)`),!1;if(t.position.alt<0||t.position.alt>1e3)return c(`Waypoint ${e+1}: Invalid altitude (must be 0-1000m)`),!1;if("hover"===t.action&&(!t.hoverTime||t.hoverTime<=0))return c(`Waypoint ${e+1}: Hover time required for hover action`),!1}return!0})())try{const e=await r({name:i.name.trim(),description:i.description.trim(),priority:i.priority,waypoints:i.waypoints.map((e,t)=>({...e,sequence:t})),status:"pending"});a?.(e),m()}catch(t){c(t.message||"Failed to create mission")}},className:"flex flex-col flex-1 min-h-0",children:[I.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 scrollbar-thin scrollbar-thumb-dark-border scrollbar-track-transparent",children:[o&&I.jsxs("div",{className:"flex items-center gap-2 p-3 bg-status-critical/10 border border-status-critical/20 \n                            rounded-lg text-status-critical",children:[I.jsx(Ne,{className:"w-5 h-5 flex-shrink-0"}),I.jsx("span",{className:"text-sm",children:o})]}),I.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[I.jsxs("div",{className:"space-y-4",children:[I.jsx("h3",{className:"text-lg font-medium text-text-primary",children:"Mission Details"}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Mission Name *"}),I.jsx("input",{type:"text",required:!0,maxLength:100,placeholder:"e.g., Emergency Medical Delivery",value:i.name,onChange:e=>l({...i,name:e.target.value}),className:"w-full px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg\n                             text-text-primary placeholder-text-secondary focus:outline-none \n                             focus:ring-2 focus:ring-status-active"}),I.jsxs("div",{className:"text-xs text-text-secondary mt-1",children:[i.name.length,"/100 characters"]})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Description"}),I.jsx("textarea",{rows:3,maxLength:1e3,placeholder:"Describe the mission objectives and requirements...",value:i.description,onChange:e=>l({...i,description:e.target.value}),className:"w-full px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg\n                             text-text-primary placeholder-text-secondary focus:outline-none \n                             focus:ring-2 focus:ring-status-active resize-none"})]}),I.jsxs("div",{children:[I.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Priority"}),I.jsx("select",{value:i.priority,onChange:e=>l({...i,priority:parseInt(e.target.value)}),className:"w-full px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg\n                             text-text-primary focus:outline-none focus:ring-2 focus:ring-status-active",children:d.map(e=>I.jsxs("option",{value:e.value,className:"bg-dark-tertiary",children:[e.value," - ",e.label]},e.value))}),I.jsx("div",{className:`text-xs mt-1 ${x(i.priority).color}`,children:x(i.priority).label})]})]}),I.jsxs("div",{className:"space-y-4",children:[I.jsx("h3",{className:"text-lg font-medium text-text-primary",children:"Mission Summary"}),I.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4 space-y-3",children:[I.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Waypoints:"}),I.jsx("div",{className:"text-text-primary font-medium",children:i.waypoints.length})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Priority:"}),I.jsx("div",{className:`font-medium ${x(i.priority).color}`,children:x(i.priority).label})]})]}),i.waypoints.length>1&&I.jsxs("div",{className:"text-sm",children:[I.jsx("span",{className:"text-text-secondary",children:"Estimated Duration:"}),I.jsx("div",{className:"text-text-primary font-medium",children:(e=>{const t=Math.floor(e/3600),s=Math.floor(e%3600/60),a=e%60;return t>0?`${t}h ${s}m ${a}s`:s>0?`${s}m ${a}s`:`${a}s`})((()=>{if(i.waypoints.length<2)return 0;let e=0;for(let t=1;t<i.waypoints.length;t++){const s=i.waypoints[t-1],a=i.waypoints[t],r=6371e3,n=s.position.lat*Math.PI/180,l=a.position.lat*Math.PI/180,o=(a.position.lat-s.position.lat)*Math.PI/180,c=(a.position.lng-s.position.lng)*Math.PI/180,d=Math.sin(o/2)*Math.sin(o/2)+Math.cos(n)*Math.cos(l)*Math.sin(c/2)*Math.sin(c/2);e+=r*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))/10,a.hoverTime&&(e+=a.hoverTime)}return Math.round(e)})())})]}),I.jsxs("div",{className:"text-xs text-text-secondary",children:["Status: ",I.jsx("span",{className:"text-status-warning",children:"Pending Assignment"})]})]})]})]}),I.jsx("div",{children:I.jsx(ks,{waypoints:i.waypoints,onWaypointsChange:e=>{l({...i,waypoints:e}),c(null)}})})]}),I.jsxs("div",{className:"flex-shrink-0 flex items-center justify-between p-6 border-t border-dark-border bg-dark-tertiary",children:[I.jsx("div",{className:"text-sm text-text-secondary",children:i.waypoints.length>0?I.jsxs("span",{children:["Mission ready to create with ",i.waypoints.length," waypoints"]}):I.jsx("span",{children:"Add waypoints to define the mission route"})}),I.jsxs("div",{className:"flex gap-3",children:[I.jsx("button",{type:"button",onClick:m,disabled:n,className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors\n                         disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),I.jsx("button",{type:"submit",disabled:n||!i.name.trim()||0===i.waypoints.length,className:"flex items-center gap-2 px-6 py-2 bg-status-active hover:bg-status-active/80 \n                         text-white rounded-lg font-medium transition-colors\n                         disabled:opacity-50 disabled:cursor-not-allowed",children:n?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Creating..."]}):I.jsxs(I.Fragment,{children:[I.jsx(re,{className:"w-4 h-4"}),"Create Mission"]})})]})]})]})]})}):null},Is=({mission:e,isOpen:t,onClose:a,onAssigned:r})=>{const n=vs(e=>Object.values(e.drones)),{assignMissionToDrone:i,missions:l}=As(),[o,c]=s.useState(null),[d,m]=s.useState(!1),[x,u]=s.useState([]);s.useEffect(()=>{t&&g()},[t,e,n]);const g=()=>{const t=n.map(t=>{const s=[],a=[];let r=100;"maintenance"!==t.status&&"emergency"!==t.status||(s.push(`Drone is in ${t.status} mode`),r-=100),"charging"===t.status&&(a.push("Drone is currently charging"),r-=20),t.batteryLevel<30?(s.push(`Low battery: ${t.batteryLevel}%`),r-=50):t.batteryLevel<50&&(a.push(`Medium battery: ${t.batteryLevel}%`),r-=20),t.signalStrength<50&&(a.push(`Weak signal: ${t.signalStrength}%`),r-=10);const n=Object.values(l).find(e=>e.assignedDrone===t.id&&["pending","active","paused"].includes(e.status));if(n&&(s.push(`Already assigned to: ${n.name}`),r-=80),e.waypoints&&e.waypoints.length>0){const s=e.waypoints[0],n=p(t.position,s.position);n>5e4&&(a.push(`Far from start: ${(n/1e3).toFixed(1)}km`),r-=15)}e.priority>=8&&(r+=10),t.totalFlightTime&&t.totalFlightTime>3600&&(a.push("Drone has been flying for extended time"),r-=5);const i=r>0&&0===s.length;return{drone:t,compatible:i,score:Math.max(0,r),issues:s,warnings:a}});t.sort((e,t)=>t.score-e.score),u(t)},p=(e,t)=>{const s=e.lat*Math.PI/180,a=t.lat*Math.PI/180,r=(t.lat-e.lat)*Math.PI/180,n=(t.lng-e.lng)*Math.PI/180,i=Math.sin(r/2)*Math.sin(r/2)+Math.cos(s)*Math.cos(a)*Math.sin(n/2)*Math.sin(n/2);return 6371e3*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))},v=e=>{switch(e){case"active":case"in_flight":return"text-status-operational bg-status-operational/10";case"idle":return"text-status-active bg-status-active/10";case"charging":return"text-status-warning bg-status-warning/10";case"maintenance":case"emergency":return"text-status-critical bg-status-critical/10";default:return"text-text-secondary bg-text-secondary/10"}},y=e=>e>70?"text-status-operational":e>30?"text-status-warning":"text-status-critical",b=e=>e.compatible?e.score>=80?I.jsx(se,{className:"w-5 h-5 text-status-operational"}):e.score>=60?I.jsx(ue,{className:"w-5 h-5 text-status-warning"}):I.jsx(Ne,{className:"w-5 h-5 text-status-warning"}):I.jsx(ut,{className:"w-5 h-5 text-status-critical"}),f=t=>{if(!e.waypoints||0===e.waypoints.length)return null;let s=0,a=t.drone.position;s+=p(a,e.waypoints[0].position)/10;for(let r=1;r<e.waypoints.length;r++){s+=p(e.waypoints[r-1].position,e.waypoints[r].position)/10,e.waypoints[r].hoverTime&&(s+=e.waypoints[r].hoverTime)}return s},j=e=>{const t=Math.floor(e/3600),s=Math.floor(e%3600/60);return t>0?`${t}h ${s}m`:`${s}m`};if(!t)return null;const N=x.find(e=>e.drone.id===o);return I.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[10001] p-4",children:I.jsxs(h.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-dark-secondary rounded-lg border border-dark-border shadow-xl\n                   w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[I.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[I.jsxs("div",{children:[I.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Assign Mission to Drone"}),I.jsxs("p",{className:"text-text-secondary mt-1",children:["Mission: ",I.jsx("span",{className:"font-medium",children:e.name})]})]}),I.jsx("button",{onClick:a,className:"p-2 hover:bg-dark-hover rounded-lg transition-colors",children:I.jsx(ut,{className:"w-5 h-5 text-text-secondary"})})]}),I.jsxs("div",{className:"flex h-full",children:[I.jsxs("div",{className:"w-1/2 border-r border-dark-border",children:[I.jsxs("div",{className:"p-4 border-b border-dark-border",children:[I.jsxs("h3",{className:"font-medium text-text-primary",children:["Available Drones (",x.length,")"]}),I.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Select a drone to assign this mission"})]}),I.jsx("div",{className:"overflow-y-auto max-h-[60vh] p-4 space-y-3",children:x.map(e=>I.jsxs(h.div,{className:`p-4 rounded-lg border cursor-pointer transition-all\n                    ${o===e.drone.id?"border-status-active bg-status-active/5":"border-dark-border hover:border-dark-hover bg-dark-tertiary hover:bg-dark-hover"}\n                    ${e.compatible?"":"opacity-50"}\n                  `,onClick:()=>e.compatible&&c(e.drone.id),whileHover:e.compatible?{scale:1.02}:{},whileTap:e.compatible?{scale:.98}:{},children:[I.jsxs("div",{className:"flex items-start justify-between mb-3",children:[I.jsxs("div",{className:"flex items-center gap-3",children:[b(e),I.jsxs("div",{children:[I.jsx("h4",{className:"font-medium text-text-primary",children:e.drone.name}),I.jsx("p",{className:"text-sm text-text-secondary",children:e.drone.id})]})]}),I.jsxs("div",{className:"flex flex-col items-end gap-1",children:[I.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${v(e.drone.status)}`,children:e.drone.status.toUpperCase()}),I.jsxs("div",{className:"text-sm font-medium text-text-primary",children:["Score: ",e.score,"/100"]})]})]}),I.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3 text-sm",children:[I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx(H,{className:`w-4 h-4 ${y(e.drone.batteryLevel)}`}),I.jsxs("span",{className:y(e.drone.batteryLevel),children:[e.drone.batteryLevel,"%"]})]}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx(st,{className:"w-4 h-4 text-text-secondary"}),I.jsxs("span",{className:"text-text-primary",children:[e.drone.signalStrength,"%"]})]}),I.jsxs("div",{className:"flex items-center gap-1",children:[I.jsx(Re,{className:"w-4 h-4 text-text-secondary"}),I.jsxs("span",{className:"text-text-primary text-xs",children:[e.drone.position.lat.toFixed(3),", ",e.drone.position.lng.toFixed(3)]})]})]}),e.issues.length>0&&I.jsx("div",{className:"mb-2",children:e.issues.map((e,t)=>I.jsxs("div",{className:"flex items-center gap-2 text-xs text-status-critical",children:[I.jsx(ut,{className:"w-3 h-3"}),e]},t))}),e.warnings.length>0&&I.jsx("div",{className:"mb-2",children:e.warnings.map((e,t)=>I.jsxs("div",{className:"flex items-center gap-2 text-xs text-status-warning",children:[I.jsx(Ne,{className:"w-3 h-3"}),e]},t))}),e.compatible&&I.jsxs("div",{className:"text-xs text-text-secondary",children:["Estimated flight time: ",j(f(e)||0)]})]},e.drone.id))})]}),I.jsx("div",{className:"w-1/2 flex flex-col",children:N?I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"p-4 border-b border-dark-border",children:[I.jsx("h3",{className:"font-medium text-text-primary mb-2",children:"Assignment Preview"}),I.jsxs("div",{className:"flex items-center gap-3 p-3 bg-dark-tertiary rounded-lg",children:[I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"font-medium text-text-primary",children:e.name}),I.jsx("div",{className:"text-xs text-text-secondary",children:"Mission"})]}),I.jsx(U,{className:"w-5 h-5 text-status-active"}),I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"font-medium text-text-primary",children:N.drone.name}),I.jsx("div",{className:"text-xs text-text-secondary",children:"Drone"})]})]})]}),I.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{children:[I.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Mission Details"}),I.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3 space-y-2 text-sm",children:[I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Priority:"}),I.jsxs("span",{className:"text-text-primary font-medium",children:["Level ",e.priority]})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Waypoints:"}),I.jsx("span",{className:"text-text-primary font-medium",children:e.waypoints?.length||0})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Status:"}),I.jsx("span",{className:"text-status-warning font-medium",children:e.status.toUpperCase()})]})]})]}),I.jsxs("div",{children:[I.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Drone Readiness"}),I.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3 space-y-2 text-sm",children:[I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Compatibility Score:"}),I.jsxs("span",{className:"text-text-primary font-medium",children:[N.score,"/100"]})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Battery Level:"}),I.jsxs("span",{className:`font-medium ${y(N.drone.batteryLevel)}`,children:[N.drone.batteryLevel,"%"]})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Signal Strength:"}),I.jsxs("span",{className:"text-text-primary font-medium",children:[N.drone.signalStrength,"%"]})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Current Status:"}),I.jsx("span",{className:"text-text-primary font-medium",children:N.drone.status.toUpperCase()})]})]})]}),I.jsxs("div",{children:[I.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Flight Estimate"}),I.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3 space-y-2 text-sm",children:[I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Estimated Duration:"}),I.jsx("span",{className:"text-text-primary font-medium",children:j(f(N)||0)})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Distance to Start:"}),I.jsx("span",{className:"text-text-primary font-medium",children:e.waypoints&&e.waypoints.length>0?`${(p(N.drone.position,e.waypoints[0].position)/1e3).toFixed(1)}km`:"N/A"})]})]})]}),(N.issues.length>0||N.warnings.length>0)&&I.jsxs("div",{children:[I.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Considerations"}),I.jsxs("div",{className:"space-y-2",children:[N.issues.map((e,t)=>I.jsxs("div",{className:"flex items-start gap-2 p-2 bg-status-critical/10 rounded text-sm",children:[I.jsx(ut,{className:"w-4 h-4 text-status-critical mt-0.5"}),I.jsx("span",{className:"text-status-critical",children:e})]},t)),N.warnings.map((e,t)=>I.jsxs("div",{className:"flex items-start gap-2 p-2 bg-status-warning/10 rounded text-sm",children:[I.jsx(Ne,{className:"w-4 h-4 text-status-warning mt-0.5"}),I.jsx("span",{className:"text-status-warning",children:e})]},t))]})]})]})}),I.jsx("div",{className:"p-4 border-t border-dark-border",children:I.jsxs("div",{className:"flex justify-between items-center",children:[I.jsx("div",{className:"text-sm text-text-secondary",children:N.compatible?"Ready to assign mission":"Cannot assign due to compatibility issues"}),I.jsxs("div",{className:"flex gap-3",children:[I.jsx("button",{onClick:a,disabled:d,className:"px-4 py-2 text-text-secondary hover:text-text-primary transition-colors\n                                 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),I.jsx("button",{onClick:async()=>{if(o){m(!0);try{await i(e.id,o),r?.(e.id,o),a()}catch(t){console.error("Failed to assign mission:",t)}finally{m(!1)}}},disabled:!N.compatible||d,className:"flex items-center gap-2 px-6 py-2 bg-status-active hover:bg-status-active/80 \n                                 text-white rounded-lg font-medium transition-colors\n                                 disabled:opacity-50 disabled:cursor-not-allowed",children:d?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Assigning..."]}):I.jsxs(I.Fragment,{children:[I.jsx(ot,{className:"w-4 h-4"}),"Assign Mission"]})})]})]})})]}):I.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:I.jsxs("div",{className:"text-center",children:[I.jsx(ot,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),I.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Select a Drone"}),I.jsx("p",{className:"text-text-secondary",children:"Choose a drone from the list to see assignment details"})]})})})]})]})})},$s=({mission:e,onAssigned:t,className:a=""})=>{const r=vs(e=>Object.values(e.drones)),{assignMissionToDrone:n,missions:i}=As(),[l,o]=s.useState(!1),[c,d]=s.useState(!1),m=()=>r.filter(e=>{if("maintenance"===e.status||"emergency"===e.status)return!1;if(e.batteryLevel<30)return!1;return!Object.values(i).some(t=>t.assignedDrone===e.id&&["pending","active","paused"].includes(t.status))}),x=(e,t)=>{const s=e.lat*Math.PI/180,a=t.lat*Math.PI/180,r=(t.lat-e.lat)*Math.PI/180,n=(t.lng-e.lng)*Math.PI/180,i=Math.sin(r/2)*Math.sin(r/2)+Math.cos(s)*Math.cos(a)*Math.sin(n/2)*Math.sin(n/2);return 6371e3*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))},u=async s=>{o(!0);try{await n(e.id,s),t?.(e.id,s),d(!1)}catch(a){console.error("Failed to assign mission:",a)}finally{o(!1)}},g=m(),p=(()=>{const t=m();if(0===t.length)return null;const s=t.map(t=>{let s=0;if(s+=Math.floor(.3*t.batteryLevel),s+=Math.floor(.2*t.signalStrength),"idle"===t.status?s+=30:"charging"===t.status?s+=20:"active"!==t.status&&"in_flight"!==t.status||(s+=10),e.waypoints&&e.waypoints.length>0){const a=x(t.position,e.waypoints[0].position);s+=Math.max(0,20-a/5e3)}return{drone:t,score:s}});return s.sort((e,t)=>t.score-e.score),s[0]?.drone||null})();if(e.assignedDrone){const t=r.find(t=>t.id===e.assignedDrone);return I.jsxs("div",{className:`flex items-center gap-2 text-sm ${a}`,children:[I.jsx(se,{className:"w-4 h-4 text-status-operational"}),I.jsx("span",{className:"text-text-secondary",children:"Assigned to:"}),I.jsx("span",{className:"text-text-primary font-medium",children:t?.name||e.assignedDrone})]})}return 0===g.length?I.jsxs("div",{className:`flex items-center gap-2 text-sm text-status-critical ${a}`,children:[I.jsx(ut,{className:"w-4 h-4"}),I.jsx("span",{children:"No available drones"})]}):I.jsx("div",{className:`relative ${a}`,children:c?I.jsxs(h.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"absolute top-0 left-0 z-10 bg-dark-secondary border border-dark-border \n                     rounded-lg shadow-lg p-3 min-w-80",children:[I.jsxs("div",{className:"flex items-center justify-between mb-3",children:[I.jsx("h4",{className:"font-medium text-text-primary",children:"Choose Drone"}),I.jsx("button",{onClick:()=>d(!1),className:"text-text-secondary hover:text-text-primary",children:I.jsx(ut,{className:"w-4 h-4"})})]}),I.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:g.map(t=>{const s=t.id===p?.id,a=t.batteryLevel<50||t.signalStrength<70;return I.jsxs("button",{onClick:()=>u(t.id),disabled:l,className:"w-full p-3 text-left border border-dark-border hover:border-dark-hover \n                           rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed\n                           hover:bg-dark-hover",children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("span",{className:"font-medium text-text-primary",children:t.name}),s&&I.jsx("span",{className:"px-2 py-0.5 bg-status-active text-white text-xs rounded-full",children:"Best Match"})]}),a&&I.jsx(Ne,{className:"w-4 h-4 text-status-warning"})]}),I.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs text-text-secondary",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Battery:"}),I.jsxs("div",{className:"font-medium "+(t.batteryLevel>70?"text-status-operational":t.batteryLevel>30?"text-status-warning":"text-status-critical"),children:[t.batteryLevel,"%"]})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Signal:"}),I.jsxs("div",{className:"text-text-primary font-medium",children:[t.signalStrength,"%"]})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Status:"}),I.jsx("div",{className:"text-text-primary font-medium capitalize",children:t.status})]})]}),e.waypoints&&e.waypoints.length>0&&I.jsxs("div",{className:"mt-2 text-xs text-text-secondary",children:["Distance to start: ",(x(t.position,e.waypoints[0].position)/1e3).toFixed(1),"km"]})]},t.id)})})]}):I.jsx("div",{className:"flex items-center gap-2",children:p&&I.jsxs(I.Fragment,{children:[I.jsx("button",{onClick:()=>u(p.id),disabled:l,className:"flex items-center gap-2 px-3 py-2 bg-status-active hover:bg-status-active/80 \n                         text-white rounded-lg text-sm font-medium transition-colors\n                         disabled:opacity-50 disabled:cursor-not-allowed",children:l?I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Assigning..."]}):I.jsxs(I.Fragment,{children:[I.jsx(ot,{className:"w-4 h-4"}),"Auto-assign to ",p.name]})}),I.jsxs("button",{onClick:()=>d(!0),className:"px-3 py-2 border border-dark-border hover:border-dark-hover \n                         text-text-secondary hover:text-text-primary rounded-lg text-sm transition-colors",children:["Choose Drone (",g.length," available)"]})]})})})},Ts=({className:e=""})=>{const{missions:t,missionStats:a,selectedMissionId:r,selectMission:n,deleteMission:i,updateMission:l}=As(),[o,c]=s.useState(!1),[d,m]=s.useState(null),[x,g]=s.useState(""),[p,v]=s.useState("all"),[y,b]=s.useState("all"),f=Object.values(t),j=f.filter(e=>{if(x&&!e.name.toLowerCase().includes(x.toLowerCase())&&!e.description?.toLowerCase().includes(x.toLowerCase()))return!1;if("all"!==p&&e.status!==p)return!1;if("all"!==y){if("high"===y&&e.priority<7)return!1;if("medium"===y&&(e.priority<4||e.priority>6))return!1;if("low"===y&&e.priority>3)return!1}return!0}),N=[...j].sort((e,t)=>"active"===e.status&&"active"!==t.status?-1:"active"===t.status&&"active"!==e.status?1:e.priority!==t.priority?t.priority-e.priority:new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),w=e=>{switch(e){case"active":return"text-status-operational bg-status-operational/10 border-status-operational/20";case"completed":return"text-status-active bg-status-active/10 border-status-active/20";case"pending":case"paused":return"text-status-warning bg-status-warning/10 border-status-warning/20";case"failed":return"text-status-critical bg-status-critical/10 border-status-critical/20";default:return"text-text-secondary bg-text-secondary/10 border-text-secondary/20"}},k=async(e,t)=>{try{await l(e.id,{status:t})}catch(s){console.error("Failed to update mission status:",s)}},S=e=>{if(!e)return"N/A";const t=Math.floor(e/3600),s=Math.floor(e%3600/60);return t>0?`${t}h ${s}m`:`${s}m`};return I.jsxs("div",{className:`space-y-6 ${e}`,children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Missions"}),I.jsxs("p",{className:"text-text-secondary mt-1",children:[f.length," total missions",a&&I.jsxs("span",{className:"ml-4",children:[a.active," active â€¢ ",a.completed," completed â€¢ ",a.pending," pending"]})]})]}),I.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 px-4 py-2 bg-status-active hover:bg-status-active/80 \n                   text-white rounded-lg font-medium transition-colors",children:[I.jsx(qe,{className:"w-5 h-5"}),"New Mission"]})]}),I.jsxs("div",{className:"flex items-center gap-4 p-4 bg-dark-secondary rounded-lg border border-dark-border",children:[I.jsxs("div",{className:"relative flex-1",children:[I.jsx(Te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-secondary"}),I.jsx("input",{type:"text",placeholder:"Search missions...",value:x,onChange:e=>g(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-dark-tertiary border border-dark-border rounded-lg\n                     text-text-primary placeholder-text-secondary focus:outline-none \n                     focus:ring-2 focus:ring-status-active"})]}),I.jsxs("select",{value:p,onChange:e=>v(e.target.value),className:"px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg\n                   text-text-primary focus:outline-none focus:ring-2 focus:ring-status-active",children:[I.jsx("option",{value:"all",children:"All Status"}),I.jsx("option",{value:"active",children:"Active"}),I.jsx("option",{value:"pending",children:"Pending"}),I.jsx("option",{value:"completed",children:"Completed"}),I.jsx("option",{value:"paused",children:"Paused"}),I.jsx("option",{value:"failed",children:"Failed"}),I.jsx("option",{value:"cancelled",children:"Cancelled"})]}),I.jsxs("select",{value:y,onChange:e=>b(e.target.value),className:"px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg\n                   text-text-primary focus:outline-none focus:ring-2 focus:ring-status-active",children:[I.jsx("option",{value:"all",children:"All Priority"}),I.jsx("option",{value:"high",children:"High (7-10)"}),I.jsx("option",{value:"medium",children:"Medium (4-6)"}),I.jsx("option",{value:"low",children:"Low (1-3)"})]}),I.jsxs("div",{className:"flex items-center text-text-secondary",children:[I.jsx(De,{className:"w-4 h-4 mr-2"}),j.length," of ",f.length]})]}),I.jsx("div",{className:"space-y-3",children:I.jsx(u,{children:N.map(e=>{return I.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"p-4 bg-dark-secondary rounded-lg border border-dark-border\n                        hover:border-dark-hover transition-colors cursor-pointer\n                        "+(r===e.id?"ring-2 ring-status-active":""),onClick:()=>n(r===e.id?null:e.id),children:I.jsxs("div",{className:"flex items-start justify-between",children:[I.jsxs("div",{className:"flex-1",children:[I.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[I.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:e.name}),I.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${w(e.status)}`,children:e.status.toUpperCase()}),I.jsxs("span",{className:"text-sm font-medium "+(s=e.priority,s>=8?"text-red-400":s>=6?"text-orange-400":s>=4?"text-yellow-400":"text-blue-400"),children:["Priority ",e.priority]})]}),e.description&&I.jsx("p",{className:"text-text-secondary text-sm mb-3 line-clamp-2",children:e.description}),I.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Waypoints:"}),I.jsx("div",{className:"text-text-primary font-medium",children:e.waypoints?.length||0})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Progress:"}),I.jsxs("div",{className:"text-text-primary font-medium",children:[e.progress,"%","active"===e.status&&I.jsx("div",{className:"w-full bg-dark-border rounded-full h-1.5 mt-1",children:I.jsx("div",{className:"bg-status-active h-1.5 rounded-full transition-all duration-300",style:{width:`${e.progress}%`}})})]})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:e.assignedDrone?"Assigned:":"Created:"}),I.jsx("div",{className:"text-text-primary font-medium",children:e.assignedDrone||(t=e.createdAt,new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Duration:"}),I.jsx("div",{className:"text-text-primary font-medium",children:e.actualDuration?S(e.actualDuration):e.estimatedDuration?`~${S(e.estimatedDuration)}`:"N/A"})]})]}),"pending"===e.status&&I.jsx("div",{className:"mt-4 pt-3 border-t border-dark-border",children:I.jsx($s,{mission:e,onAssigned:()=>{console.log("Mission assigned successfully")}})})]}),I.jsxs("div",{className:"flex items-center gap-2 ml-4",children:["pending"===e.status&&I.jsx("button",{onClick:t=>{t.stopPropagation(),k(e,"active")},className:"p-2 text-status-operational hover:bg-status-operational/10 rounded-lg transition-colors",title:"Start mission",children:I.jsx(Ue,{className:"w-4 h-4"})}),"active"===e.status&&I.jsxs(I.Fragment,{children:[I.jsx("button",{onClick:t=>{t.stopPropagation(),k(e,"paused")},className:"p-2 text-status-warning hover:bg-status-warning/10 rounded-lg transition-colors",title:"Pause mission",children:I.jsx(We,{className:"w-4 h-4"})}),I.jsx("button",{onClick:t=>{t.stopPropagation(),k(e,"cancelled")},className:"p-2 text-status-critical hover:bg-status-critical/10 rounded-lg transition-colors",title:"Stop mission",children:I.jsx(rt,{className:"w-4 h-4"})})]}),"paused"===e.status&&I.jsx("button",{onClick:t=>{t.stopPropagation(),k(e,"active")},className:"p-2 text-status-operational hover:bg-status-operational/10 rounded-lg transition-colors",title:"Resume mission",children:I.jsx(Ue,{className:"w-4 h-4"})}),"pending"===e.status&&!e.assignedDrone&&I.jsx("button",{onClick:t=>{t.stopPropagation(),m(e)},className:"p-2 text-text-secondary hover:text-status-active hover:bg-status-active/10 \n                               rounded-lg transition-colors",title:"Assign to drone",children:I.jsx(ot,{className:"w-4 h-4"})}),I.jsx("button",{onClick:t=>{t.stopPropagation(),n(e.id)},className:"p-2 text-text-secondary hover:text-text-primary hover:bg-dark-hover \n                             rounded-lg transition-colors",title:"View details",children:I.jsx(ke,{className:"w-4 h-4"})}),["pending","paused"].includes(e.status)&&I.jsx("button",{onClick:t=>{t.stopPropagation(),console.log("Edit mission:",e.id)},className:"p-2 text-text-secondary hover:text-status-warning hover:bg-status-warning/10 \n                               rounded-lg transition-colors",title:"Edit mission",children:I.jsx(Fe,{className:"w-4 h-4"})}),!["active"].includes(e.status)&&I.jsx("button",{onClick:t=>{t.stopPropagation(),(async e=>{if(window.confirm("Are you sure you want to delete this mission?"))try{await i(e)}catch(t){console.error("Failed to delete mission:",t)}})(e.id)},className:"p-2 text-text-secondary hover:text-status-critical hover:bg-status-critical/10 \n                               rounded-lg transition-colors",title:"Delete mission",children:I.jsx(it,{className:"w-4 h-4"})})]})]})},e.id);var t,s})})}),0===N.length&&I.jsx("div",{className:"text-center py-12",children:x||"all"!==p||"all"!==y?I.jsxs("div",{children:[I.jsx(Te,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),I.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"No missions found"}),I.jsx("p",{className:"text-text-secondary mb-4",children:"No missions match your current filters"}),I.jsx("button",{onClick:()=>{g(""),v("all"),b("all")},className:"px-4 py-2 bg-dark-tertiary hover:bg-dark-hover text-text-primary \n                         rounded-lg transition-colors",children:"Clear Filters"})]}):I.jsxs("div",{children:[I.jsx(qe,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),I.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"No missions created"}),I.jsx("p",{className:"text-text-secondary mb-4",children:"Create your first mission to get started"}),I.jsx("button",{onClick:()=>c(!0),className:"px-6 py-2 bg-status-active hover:bg-status-active/80 text-white \n                         rounded-lg font-medium transition-colors",children:"Create Mission"})]})}),I.jsx(Ls,{isOpen:o,onClose:()=>c(!1),onMissionCreated:()=>{console.log("Mission created successfully")}}),d&&I.jsx(Is,{mission:d,isOpen:!0,onClose:()=>m(null),onAssigned:()=>{m(null),console.log("Mission assigned successfully")}})]})},Os=({className:e="",compact:t=!1})=>{const{missions:a,activeMissions:r,missionStats:n,selectMission:i,assignMissionToDrone:l}=As(),o=vs(e=>{const t=e.selectedDroneId;return t?e.drones[t]:null}),c=(()=>{const{selectedMissionId:e,missions:t}=As();return e?t[e]:null})(),[d,m]=s.useState(!1),[x,g]=s.useState(!1),p=o?Object.values(a).filter(e=>e.assignedDrone===o.id):[],v=e=>{switch(e){case"active":return"text-status-operational";case"completed":return"text-status-active";case"pending":case"paused":return"text-status-warning";case"failed":return"text-status-critical";default:return"text-text-secondary"}};return t?I.jsxs("div",{className:`bg-dark-secondary rounded-lg border border-dark-border p-4 ${e}`,children:[I.jsxs("div",{className:"flex items-center justify-between mb-4",children:[I.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[I.jsx(Ze,{className:"w-5 h-5"}),"Missions"]}),I.jsx("button",{onClick:()=>m(!0),className:"p-1 text-text-secondary hover:text-status-active transition-colors",children:I.jsx(qe,{className:"w-4 h-4"})})]}),n&&I.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4 text-sm",children:[I.jsxs("div",{className:"text-center p-2 bg-dark-tertiary rounded",children:[I.jsx("div",{className:"text-status-operational font-medium",children:n.active}),I.jsx("div",{className:"text-text-secondary text-xs",children:"Active"})]}),I.jsxs("div",{className:"text-center p-2 bg-dark-tertiary rounded",children:[I.jsx("div",{className:"text-status-warning font-medium",children:n.pending}),I.jsx("div",{className:"text-text-secondary text-xs",children:"Pending"})]}),I.jsxs("div",{className:"text-center p-2 bg-dark-tertiary rounded",children:[I.jsx("div",{className:"text-status-active font-medium",children:n.today}),I.jsx("div",{className:"text-text-secondary text-xs",children:"Today"})]})]}),I.jsx("div",{className:"space-y-2",children:r.slice(0,3).map(e=>I.jsx("div",{className:"p-2 bg-dark-tertiary rounded cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>i(e.id),children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex-1",children:[I.jsx("div",{className:"font-medium text-text-primary text-sm truncate",children:e.name}),I.jsxs("div",{className:"text-xs text-text-secondary",children:[e.assignedDrone||"Unassigned"," â€¢ ",e.progress,"%"]})]}),I.jsx("div",{className:"w-8 h-1 bg-dark-border rounded-full overflow-hidden",children:I.jsx("div",{className:"h-full bg-status-active transition-all",style:{width:`${e.progress}%`}})})]})},e.id))}),0===r.length&&I.jsx("div",{className:"text-center text-text-secondary text-sm py-4",children:"No active missions"}),I.jsx(Ls,{isOpen:d,onClose:()=>m(!1)})]}):I.jsxs("div",{className:`bg-dark-secondary rounded-lg border border-dark-border ${e}`,children:[I.jsxs("div",{className:"p-4 border-b border-dark-border",children:[I.jsxs("div",{className:"flex items-center justify-between mb-2",children:[I.jsxs("h2",{className:"text-lg font-semibold text-text-primary flex items-center gap-2",children:[I.jsx(Ze,{className:"w-6 h-6"}),"Mission Control"]}),I.jsxs("button",{onClick:()=>m(!0),className:"px-3 py-1 bg-status-active hover:bg-status-active/80 text-white \n                     rounded text-sm font-medium transition-colors flex items-center gap-1",children:[I.jsx(qe,{className:"w-4 h-4"}),"New"]})]}),n&&I.jsxs("div",{className:"grid grid-cols-4 gap-3 text-sm",children:[I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"text-status-operational font-medium",children:n.active}),I.jsx("div",{className:"text-text-secondary text-xs",children:"Active"})]}),I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"text-status-warning font-medium",children:n.pending}),I.jsx("div",{className:"text-text-secondary text-xs",children:"Pending"})]}),I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"text-status-active font-medium",children:n.completed}),I.jsx("div",{className:"text-text-secondary text-xs",children:"Completed"})]}),I.jsxs("div",{className:"text-center",children:[I.jsx("div",{className:"text-text-primary font-medium",children:n.today}),I.jsx("div",{className:"text-text-secondary text-xs",children:"Today"})]})]})]}),I.jsx("div",{className:"p-4 space-y-4",children:c?I.jsxs("div",{className:"space-y-4",children:[I.jsxs("div",{className:"flex items-start justify-between",children:[I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:c.name}),I.jsx("p",{className:"text-sm text-text-secondary",children:c.description})]}),I.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${v(c.status)}`,children:c.status.toUpperCase()})]}),I.jsxs("div",{className:"space-y-2",children:[I.jsxs("div",{className:"flex justify-between text-sm",children:[I.jsx("span",{className:"text-text-secondary",children:"Progress"}),I.jsxs("span",{className:"text-text-primary font-medium",children:[c.progress,"%"]})]}),I.jsx("div",{className:"w-full bg-dark-border rounded-full h-2",children:I.jsx("div",{className:"bg-status-active h-2 rounded-full transition-all duration-300",style:{width:`${c.progress}%`}})})]}),I.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Priority:"}),I.jsxs("div",{className:"text-text-primary font-medium",children:["Level ",c.priority]})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Waypoints:"}),I.jsx("div",{className:"text-text-primary font-medium",children:c.waypoints?.length||0})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Assigned:"}),I.jsx("div",{className:"text-text-primary font-medium",children:c.assignedDrone||"Unassigned"})]}),I.jsxs("div",{children:[I.jsx("span",{className:"text-text-secondary",children:"Created:"}),I.jsx("div",{className:"text-text-primary font-medium",children:(y=c.createdAt,new Date(y).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))})]})]}),I.jsxs("div",{className:"flex gap-2",children:[c.waypoints&&c.waypoints.length>0&&I.jsxs("button",{onClick:()=>g(!x),className:"flex items-center gap-1 px-3 py-2 bg-dark-tertiary hover:bg-dark-hover \n                           text-text-primary rounded text-sm transition-colors",children:[I.jsx(Re,{className:"w-4 h-4"}),x?"Hide":"Show"," Waypoints"]}),o&&"pending"===c.status&&!c.assignedDrone&&I.jsxs("button",{onClick:()=>(async e=>{if(o)try{await l(e,o.id)}catch(t){console.error("Failed to assign mission:",t)}})(c.id),className:"flex items-center gap-1 px-3 py-2 bg-status-active hover:bg-status-active/80 \n                           text-white rounded text-sm transition-colors",children:["Assign to ",o.name]})]}),I.jsx(u,{children:x&&c.waypoints&&I.jsx(h.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-dark-border pt-4",children:I.jsx(ks,{waypoints:c.waypoints,onWaypointsChange:()=>{},disabled:!0})})})]}):o&&p.length>0?I.jsxs("div",{className:"space-y-3",children:[I.jsxs("h3",{className:"font-medium text-text-primary",children:[o.name," Missions (",p.length,")"]}),p.map(e=>I.jsx("div",{className:"p-3 bg-dark-tertiary rounded-lg cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>i(e.id),children:I.jsxs("div",{className:"flex items-start justify-between",children:[I.jsxs("div",{className:"flex-1",children:[I.jsx("h4",{className:"font-medium text-text-primary",children:e.name}),I.jsx("p",{className:"text-sm text-text-secondary truncate",children:e.description}),I.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-text-secondary",children:[I.jsxs("span",{children:["Priority ",e.priority]}),I.jsxs("span",{children:[e.waypoints?.length||0," waypoints"]}),I.jsxs("span",{children:[e.progress,"% complete"]})]})]}),I.jsxs("div",{className:"flex flex-col items-end gap-1",children:[I.jsx("span",{className:`px-2 py-1 rounded text-xs ${v(e.status)}`,children:e.status}),I.jsx("button",{onClick:t=>{t.stopPropagation(),i(e.id)},className:"p-1 text-text-secondary hover:text-text-primary transition-colors",children:I.jsx(ke,{className:"w-4 h-4"})})]})]})},e.id))]}):I.jsx("div",{className:"text-center py-8",children:o?I.jsxs("div",{children:[I.jsx(Ze,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),I.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"No missions assigned"}),I.jsxs("p",{className:"text-text-secondary mb-4",children:[o.name," has no missions assigned"]}),I.jsx("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-status-active hover:bg-status-active/80 text-white \n                           rounded-lg font-medium transition-colors",children:"Create Mission"})]}):I.jsxs("div",{children:[I.jsx(ee,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),I.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Mission Overview"}),I.jsx("p",{className:"text-text-secondary mb-4",children:"Select a drone to view its missions or create a new mission"}),I.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[I.jsxs("div",{className:"p-3 bg-dark-tertiary rounded",children:[I.jsx("div",{className:"text-status-operational font-medium text-lg",children:r.length}),I.jsx("div",{className:"text-text-secondary",children:"Active Missions"})]}),I.jsxs("div",{className:"p-3 bg-dark-tertiary rounded",children:[I.jsx("div",{className:"text-text-primary font-medium text-lg",children:Object.keys(a).length}),I.jsx("div",{className:"text-text-secondary",children:"Total Missions"})]})]})]})})}),I.jsx(Ls,{isOpen:d,onClose:()=>m(!1)})]});var y},Rs=({className:e=""})=>{const t=vs(e=>Object.values(e.drones)),a=vs(e=>e.drones),{missions:r,updateMission:n}=As(),[i,l]=s.useState(null),[o,c]=s.useState("all"),d=s.useMemo(()=>Object.values(r).filter(e=>["pending","active","paused"].includes(e.status)).map(e=>{const t=e.assignedDrone?a[e.assignedDrone]:null,s=[];let r="unassigned";return e.assignedDrone&&(t?(r="assigned","maintenance"!==t.status&&"emergency"!==t.status||(s.push(`Drone is in ${t.status} mode`),r="conflict"),t.batteryLevel<20?(s.push(`Critical battery: ${t.batteryLevel}%`),r="conflict"):t.batteryLevel<30&&s.push(`Low battery: ${t.batteryLevel}%`),t.signalStrength<30&&s.push(`Poor signal: ${t.signalStrength}%`)):(s.push("Assigned drone not found"),r="conflict")),{mission:e,drone:t,status:r,issues:s}}).sort((e,t)=>{if(e.mission.priority!==t.mission.priority)return t.mission.priority-e.mission.priority;if(e.status!==t.status){const s={conflict:0,unassigned:1,assigned:2};return s[e.status]-s[t.status]}return new Date(t.mission.createdAt).getTime()-new Date(e.mission.createdAt).getTime()}),[r,a]),m=d.filter(e=>{switch(o){case"assigned":return"assigned"===e.status&&0===e.issues.length;case"unassigned":return"unassigned"===e.status;case"issues":return"conflict"===e.status||e.issues.length>0;default:return!0}}),x=e=>{switch(e.status){case"assigned":return e.issues.length>0?I.jsx(Ne,{className:"w-5 h-5 text-status-warning"}):I.jsx(se,{className:"w-5 h-5 text-status-operational"});case"conflict":return I.jsx(pt,{className:"w-5 h-5 text-status-critical"});default:return I.jsx(ue,{className:"w-5 h-5 text-text-secondary"})}},g=e=>{switch(e.status){case"assigned":return e.issues.length>0?"border-status-warning bg-status-warning/5":"border-status-operational bg-status-operational/5";case"conflict":return"border-status-critical bg-status-critical/5";default:return"border-text-secondary bg-text-secondary/5"}},p={total:d.length,assigned:d.filter(e=>"assigned"===e.status&&0===e.issues.length).length,unassigned:d.filter(e=>"unassigned"===e.status).length,issues:d.filter(e=>"conflict"===e.status||e.issues.length>0).length,availableDrones:t.filter(e=>!["maintenance","emergency"].includes(e.status)&&(!(e.batteryLevel<30)&&!Object.values(r).some(t=>t.assignedDrone===e.id&&["pending","active","paused"].includes(t.status)))).length};return I.jsxs("div",{className:`space-y-6 ${e}`,children:[I.jsx("div",{className:"flex items-center justify-between",children:I.jsxs("div",{children:[I.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Assignment Manager"}),I.jsxs("p",{className:"text-text-secondary mt-1",children:["Manage mission-to-drone assignments â€¢ ",p.availableDrones," drones available"]})]})}),I.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[I.jsxs("div",{className:"bg-dark-secondary rounded-lg border border-dark-border p-4 text-center",children:[I.jsx("div",{className:"text-2xl font-bold text-text-primary",children:p.total}),I.jsx("div",{className:"text-sm text-text-secondary",children:"Total Missions"})]}),I.jsxs("div",{className:"bg-dark-secondary rounded-lg border border-dark-border p-4 text-center",children:[I.jsx("div",{className:"text-2xl font-bold text-status-operational",children:p.assigned}),I.jsx("div",{className:"text-sm text-text-secondary",children:"Assigned"})]}),I.jsxs("div",{className:"bg-dark-secondary rounded-lg border border-dark-border p-4 text-center",children:[I.jsx("div",{className:"text-2xl font-bold text-text-secondary",children:p.unassigned}),I.jsx("div",{className:"text-sm text-text-secondary",children:"Unassigned"})]}),I.jsxs("div",{className:"bg-dark-secondary rounded-lg border border-dark-border p-4 text-center",children:[I.jsx("div",{className:"text-2xl font-bold text-status-warning",children:p.issues}),I.jsx("div",{className:"text-sm text-text-secondary",children:"Issues"})]})]}),I.jsxs("div",{className:"flex items-center gap-4 p-4 bg-dark-secondary rounded-lg border border-dark-border",children:[I.jsx("span",{className:"text-text-secondary font-medium",children:"Filter:"}),I.jsx("div",{className:"flex gap-2",children:[{value:"all",label:`All (${p.total})`},{value:"assigned",label:`Assigned (${p.assigned})`},{value:"unassigned",label:`Unassigned (${p.unassigned})`},{value:"issues",label:`Issues (${p.issues})`}].map(e=>I.jsx("button",{onClick:()=>c(e.value),className:"px-3 py-2 rounded-lg text-sm font-medium transition-colors "+(o===e.value?"bg-status-active text-white":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"),children:e.label},e.value))})]}),I.jsx("div",{className:"space-y-3",children:I.jsx(u,{children:m.map(e=>I.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`p-6 rounded-lg border-2 transition-all ${g(e)}`,children:I.jsxs("div",{className:"flex items-start justify-between",children:[I.jsxs("div",{className:"flex-1",children:[I.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[x(e),I.jsxs("div",{children:[I.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:e.mission.name}),I.jsxs("p",{className:"text-sm text-text-secondary",children:["Priority ",e.mission.priority," â€¢ ",e.mission.waypoints?.length||0," waypoints"]})]})]}),I.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-4",children:[I.jsxs("div",{children:[I.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Mission Status"}),I.jsxs("div",{className:"space-y-1 text-sm",children:[I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Status:"}),I.jsx("span",{className:"text-text-primary capitalize",children:e.mission.status})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Progress:"}),I.jsxs("span",{className:"text-text-primary",children:[e.mission.progress,"%"]})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Created:"}),I.jsx("span",{className:"text-text-primary",children:new Date(e.mission.createdAt).toLocaleDateString()})]})]})]}),I.jsxs("div",{children:[I.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Assignment"}),I.jsx("div",{className:"space-y-1 text-sm",children:e.drone?I.jsxs(I.Fragment,{children:[I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Assigned to:"}),I.jsx("span",{className:"text-text-primary font-medium",children:e.drone.name})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Drone Status:"}),I.jsx("span",{className:"text-text-primary capitalize",children:e.drone.status})]}),I.jsxs("div",{className:"flex justify-between",children:[I.jsx("span",{className:"text-text-secondary",children:"Battery:"}),I.jsxs("span",{className:"font-medium "+(e.drone.batteryLevel>70?"text-status-operational":e.drone.batteryLevel>30?"text-status-warning":"text-status-critical"),children:[e.drone.batteryLevel,"%"]})]})]}):I.jsx("div",{className:"text-text-secondary",children:"No drone assigned"})})]})]}),e.issues.length>0&&I.jsxs("div",{className:"mb-4",children:[I.jsxs("h4",{className:"font-medium text-status-warning mb-2 flex items-center gap-2",children:[I.jsx(Ne,{className:"w-4 h-4"}),"Issues"]}),I.jsx("div",{className:"space-y-1",children:e.issues.map((e,t)=>I.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[I.jsx("div",{className:"w-1 h-1 bg-status-warning rounded-full mt-2 flex-shrink-0"}),I.jsx("span",{className:"text-status-warning",children:e})]},t))})]}),e.mission.description&&I.jsx("p",{className:"text-sm text-text-secondary line-clamp-2",children:e.mission.description})]}),I.jsx("div",{className:"flex flex-col gap-2 ml-6",children:"unassigned"===e.status?I.jsxs("button",{onClick:()=>l(e.mission),className:"flex items-center gap-2 px-4 py-2 bg-status-active hover:bg-status-active/80 \n                               text-white rounded-lg text-sm font-medium transition-colors",children:[I.jsx(ot,{className:"w-4 h-4"}),"Assign Drone"]}):I.jsxs(I.Fragment,{children:[I.jsxs("button",{onClick:()=>l(e.mission),className:"flex items-center gap-2 px-4 py-2 bg-dark-tertiary hover:bg-dark-hover \n                                 text-text-primary rounded-lg text-sm font-medium transition-colors border border-dark-border",children:[I.jsx(F,{className:"w-4 h-4"}),"Reassign"]}),I.jsxs("button",{onClick:()=>(async e=>{try{await n(e,{assignedDrone:void 0})}catch(t){console.error("Failed to unassign mission:",t)}})(e.mission.id),className:"flex items-center gap-2 px-4 py-2 text-text-secondary hover:text-status-critical \n                                 hover:bg-status-critical/10 rounded-lg text-sm transition-colors",children:[I.jsx(pt,{className:"w-4 h-4"}),"Unassign"]})]})})]})},e.mission.id))})}),0===m.length&&I.jsxs("div",{className:"text-center py-12",children:[I.jsx(ot,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),I.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"all"===o?"No missions to assign":`No ${o} missions`}),I.jsx("p",{className:"text-text-secondary mb-4",children:"all"===o?"Create missions to start managing assignments":"Change the filter to see other missions"}),"all"!==o&&I.jsx("button",{onClick:()=>c("all"),className:"px-4 py-2 bg-dark-tertiary hover:bg-dark-hover text-text-primary \n                       rounded-lg transition-colors",children:"Show All Missions"})]}),i&&I.jsx(Is,{mission:i,isOpen:!0,onClose:()=>l(null),onAssigned:()=>{l(null)}})]})},Ps=({className:e="",onClose:t})=>{const[a,r]=s.useState(!1),[n,i]=s.useState("panel"),l=[{mode:"panel",label:"Panel",icon:ee,description:"Compact mission overview"},{mode:"list",label:"List",icon:Ze,description:"All missions list"},{mode:"assignments",label:"Assignments",icon:ot,description:"Mission assignments"}];return a?I.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[10000] p-4",children:I.jsxs(h.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-dark-secondary rounded-lg border border-dark-border shadow-xl\n                   w-full max-w-7xl max-h-[95vh] overflow-hidden flex flex-col",children:[I.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[I.jsxs("div",{children:[I.jsxs("h2",{className:"text-2xl font-bold text-text-primary flex items-center gap-3",children:[I.jsx(Ze,{className:"w-7 h-7 text-status-active"}),"Mission Control Center"]}),I.jsx("p",{className:"text-text-secondary mt-1",children:"Manage missions, assignments, and drone operations"})]}),I.jsxs("div",{className:"flex items-center gap-4",children:[I.jsx("div",{className:"flex bg-dark-tertiary rounded-lg p-1",children:l.map(e=>I.jsxs("button",{onClick:()=>i(e.mode),className:"flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors "+(n===e.mode?"bg-status-active text-white":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"),title:e.description,children:[I.jsx(e.icon,{className:"w-4 h-4"}),e.label]},e.mode))}),I.jsx("button",{onClick:()=>{t?t():r(!1)},className:"p-2 hover:bg-dark-hover rounded-lg transition-colors",children:I.jsx(pt,{className:"w-5 h-5 text-text-secondary"})})]})]}),I.jsx("div",{className:"flex-1 overflow-hidden p-6",children:I.jsxs(u,{mode:"wait",children:["panel"===n&&I.jsx(h.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"h-full",children:I.jsx(Os,{className:"h-full"})},"panel"),"list"===n&&I.jsx(h.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"h-full overflow-y-auto",children:I.jsx(Ts,{})},"list"),"assignments"===n&&I.jsx(h.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"h-full overflow-y-auto",children:I.jsx(Rs,{})},"assignments")]})}),I.jsx("div",{className:"p-6 border-t border-dark-border bg-dark-tertiary",children:I.jsxs("div",{className:"flex items-center justify-between text-sm text-text-secondary",children:[I.jsxs("div",{className:"flex items-center gap-4",children:[I.jsxs("div",{className:"flex items-center gap-2",children:[I.jsx("div",{className:"w-2 h-2 bg-status-operational rounded-full"}),I.jsx("span",{children:"Mission Service Connected"})]}),I.jsxs("div",{className:"text-text-secondary",children:["Last update: ",(new Date).toLocaleTimeString()]})]}),I.jsxs("div",{className:"flex items-center gap-4",children:[I.jsxs("span",{children:["Current View: ",I.jsx("span",{className:"text-text-primary font-medium",children:l.find(e=>e.mode===n)?.label})]}),I.jsx("button",{onClick:()=>{t?t():r(!1)},className:"px-3 py-1 text-text-secondary hover:text-text-primary transition-colors",children:"Close"})]})]})})]})}):I.jsxs("div",{className:`${e}`,children:[I.jsx(Os,{compact:!0}),I.jsx("div",{className:"mt-4 flex justify-center",children:I.jsxs("button",{onClick:()=>r(!0),className:"flex items-center gap-2 px-4 py-2 bg-dark-tertiary hover:bg-dark-hover \n                     text-text-primary rounded-lg border border-dark-border transition-colors",children:[I.jsx(pe,{className:"w-4 h-4"}),"Mission Controls"]})})]})};function Ws(){const{state:e,isConnected:t,error:a}=vs(e=>({state:e.connectionState,error:e.connectionError,isConnected:e.isConnected(),lastUpdate:e.lastUpdate})),r=vs(e=>Object.values(e.drones)),n=vs(e=>e.selectedDroneId),i=(()=>{const e=vs(e=>e.selectedDroneId),t=vs(e=>e.getDroneById);return e&&t(e)||null})(),l=vs(e=>e.selectDrone),[o,c]=s.useState(!1),[d,m]=s.useState(!1),[x,h]=s.useState(()=>{const e=localStorage.getItem("safetyPanelHeight");return e?parseInt(e,10):400});s.useEffect(()=>{(()=>{if(!ys){ys=!0;const{connect:e}=vs.getState();e(),vs.subscribe(e=>e.connectionState,(e,t)=>{t&&e!==t&&console.log(`Fleet store connection state: ${t} â†’ ${e}`)}),vs.subscribe(e=>Object.keys(e.drones).length,(e,t)=>{void 0!==t&&e!==t&&console.log(`Fleet store drone count: ${t} â†’ ${e}`)})}})(),Es()},[]);const u=e=>{l(e)};return I.jsxs("div",{className:"min-h-screen bg-dark-primary text-text-primary flex",children:[I.jsxs("div",{className:`\n        transition-all duration-300 ease-in-out bg-dark-secondary border-r border-dark-border\n        ${o?"w-16":"w-80"}\n        flex flex-col h-screen\n      `,children:[I.jsxs("div",{className:"p-4 border-b border-dark-border flex items-center justify-between",children:[!o&&I.jsxs("div",{children:[I.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Fleet Control"}),I.jsx("p",{className:"text-text-secondary text-xs",children:"5 drones active"})]}),I.jsx("button",{onClick:()=>c(!o),className:"p-2 hover:bg-dark-hover rounded-lg transition-colors",title:o?"Expand sidebar":"Collapse sidebar",children:o?I.jsx(de,{className:"w-5 h-5 text-text-secondary"}):I.jsx(oe,{className:"w-5 h-5 text-text-secondary"})})]}),I.jsxs("div",{className:"flex-1 overflow-hidden",children:[!o&&I.jsx(kt,{drones:r,selectedDroneId:n||void 0,onDroneSelect:u,onDroneAction:(e,t)=>{console.log(`Action "${t}" requested for drone ${e}`)},className:"h-full"}),o&&I.jsx("div",{className:"p-2 space-y-2 overflow-y-auto scrollbar-thin",children:r.map(e=>I.jsx("button",{onClick:()=>u(e.id),className:`\n                    w-full p-2 rounded-lg border transition-all duration-200\n                    ${e.id===n?"border-status-active bg-status-active/10":"border-dark-border hover:border-dark-hover hover:bg-dark-hover"}\n                  `,title:`${e.name} - ${e.status}`,children:I.jsx("div",{className:"w-8 h-8 mx-auto rounded-full border flex items-center justify-center",style:{backgroundColor:"active"===e.status||"in_flight"===e.status?"#238636":"charging"===e.status?"#d29922":"maintenance"===e.status?"#da3633":"#8b949e",borderColor:"active"===e.status||"in_flight"===e.status?"#238636":"charging"===e.status?"#d29922":"maintenance"===e.status?"#da3633":"#8b949e"},children:I.jsx("span",{className:"text-xs font-bold text-white",children:e.name.split("-")[1]||e.name.charAt(0)})})},e.id))})]})]}),I.jsxs("div",{className:"flex-1 flex flex-col h-screen",children:[I.jsx("header",{className:"bg-dark-secondary border-b border-dark-border px-6 py-4",children:I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{children:[I.jsx("h1",{className:"text-xl font-bold",children:"Multi-Drone Fleet Management System"}),I.jsx("p",{className:"text-text-secondary text-sm",children:"Real-time fleet monitoring and control dashboard"})]}),I.jsxs("div",{className:"flex items-center gap-4",children:[I.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-4 py-2 bg-status-active hover:bg-status-active/80 \n                         text-white rounded-lg font-medium transition-colors",children:[I.jsx(Ze,{className:"w-5 h-5"}),"Mission Center"]}),I.jsx(It,{connectionState:e,isConnected:t,error:a||void 0})]})]})}),I.jsx("main",{className:"flex-1 p-4 overflow-hidden",children:I.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 h-full",children:[I.jsx("div",{className:"lg:col-span-2 h-full overflow-hidden",children:I.jsx(ft,{drones:r,selectedDroneId:n||void 0,onDroneSelect:u,className:"h-full w-full"})}),I.jsxs("div",{className:"lg:col-span-1 h-full overflow-y-auto overflow-x-hidden flex flex-col gap-4 pr-2 scrollbar-thin",children:[I.jsx("div",{className:"flex-shrink-0 h-[450px] border border-dark-border rounded-lg bg-dark-secondary overflow-hidden",children:I.jsx(Dt,{drone:i,isLive:t,className:"h-full w-full"})}),I.jsx("div",{className:"flex-shrink-0",children:I.jsx(ws,{initialHeight:x,minHeight:250,maxHeight:600,onHeightChange:e=>{h(e),localStorage.setItem("safetyPanelHeight",e.toString())},className:"",children:I.jsx(Ns,{className:"h-full"})})}),I.jsx("div",{className:"flex-shrink-0 h-[500px] mb-4",children:I.jsx(Ps,{})})]})]})})]}),d&&I.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",onClick:e=>{e.target===e.currentTarget&&m(!1)},children:I.jsx("div",{className:"bg-dark-secondary rounded-lg border border-dark-border shadow-2xl\n                         w-full max-w-7xl max-h-[95vh] overflow-hidden relative z-[10000]",onClick:e=>e.stopPropagation(),children:I.jsx(Ps,{className:"h-full",onClose:()=>m(!1)})})})]})}$.createRoot(document.getElementById("root")).render(I.jsx(r.StrictMode,{children:I.jsx(Ws,{})}));
