var qe=Object.defineProperty;var Qe=(t,s,a)=>s in t?qe(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var $=(t,s,a)=>Qe(t,typeof s!="symbol"?s+"":s,a);import{r as i,a as Ge,g as Je,R as ke}from"./vendor-DJ1oPbzn.js";import{M as Se,P as Me,l as Ce,a as Ye,b as Xe,T as Ke,u as et}from"./maps-DYzuhxqw.js";import{m as E,A as P}from"./ui-Bb994duZ.js";import{R as tt,L as st,C as at,X as rt,Y as nt,T as it,a as lt,b as ot}from"./charts-WATkrfCP.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const o of c.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(n){if(n.ep)return;n.ep=!0;const c=a(n);fetch(n.href,c)}})();var De={exports:{}},ee={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ct=i,dt=Symbol.for("react.element"),xt=Symbol.for("react.fragment"),mt=Object.prototype.hasOwnProperty,ut=ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ht={key:!0,ref:!0,__self:!0,__source:!0};function Ee(t,s,a){var r,n={},c=null,o=null;a!==void 0&&(c=""+a),s.key!==void 0&&(c=""+s.key),s.ref!==void 0&&(o=s.ref);for(r in s)mt.call(s,r)&&!ht.hasOwnProperty(r)&&(n[r]=s[r]);if(t&&t.defaultProps)for(r in s=t.defaultProps,s)n[r]===void 0&&(n[r]=s[r]);return{$$typeof:dt,type:t,key:c,ref:o,props:n,_owner:ut.current}}ee.Fragment=xt;ee.jsx=Ee;ee.jsxs=Ee;De.exports=ee;var e=De.exports,ne={},xe=Ge;ne.createRoot=xe.createRoot,ne.hydrateRoot=xe.hydrateRoot;function pt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const ie=i.forwardRef(pt);function gt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const ft=i.forwardRef(gt);function vt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 10.5h.375c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125H21M3.75 18h15A2.25 2.25 0 0 0 21 15.75v-6a2.25 2.25 0 0 0-2.25-2.25h-15A2.25 2.25 0 0 0 1.5 9.75v6A2.25 2.25 0 0 0 3.75 18Z"}))}const Y=i.forwardRef(vt);function yt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"}))}const bt=i.forwardRef(yt);function jt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))}const Le=i.forwardRef(jt);function wt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const Ae=i.forwardRef(wt);function Nt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const _=i.forwardRef(Nt);function kt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const $e=i.forwardRef(kt);function St({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const Mt=i.forwardRef(St);function Ct({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const Dt=i.forwardRef(Ct);function Et({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}const Lt=i.forwardRef(Et);function At({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const $t=i.forwardRef(At);function Rt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const X=i.forwardRef(Rt);function Tt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const Ft=i.forwardRef(Tt);function Ot({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 0 0 2.25-2.25V6.75a2.25 2.25 0 0 0-2.25-2.25H6.75A2.25 2.25 0 0 0 4.5 6.75v10.5a2.25 2.25 0 0 0 2.25 2.25Zm.75-12h9v9h-9v-9Z"}))}const me=i.forwardRef(Ot);function It({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const R=i.forwardRef(It);function Wt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const oe=i.forwardRef(Wt);function Pt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.362 5.214A8.252 8.252 0 0 1 12 21 8.25 8.25 0 0 1 6.038 7.047 8.287 8.287 0 0 0 9 9.601a8.983 8.983 0 0 1 3.361-6.867 8.21 8.21 0 0 0 3 2.48Z"}),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18a3.75 3.75 0 0 0 .495-7.468 5.99 5.99 0 0 0-1.925 3.547 5.975 5.975 0 0 1-2.133-1.001A3.75 3.75 0 0 0 12 18Z"}))}const _t=i.forwardRef(Pt);function Bt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}const Ut=i.forwardRef(Bt);function zt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"}))}const Vt=i.forwardRef(zt);function Ht({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const ue=i.forwardRef(Ht);function Zt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const he=i.forwardRef(Zt);function qt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const J=i.forwardRef(qt);function Qt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25v13.5m-7.5-13.5v13.5"}))}const Gt=i.forwardRef(Qt);function Jt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const Re=i.forwardRef(Jt);function Yt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"}))}const pe=i.forwardRef(Yt);function Xt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const q=i.forwardRef(Xt);function Kt({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}))}const B=i.forwardRef(Kt);function es({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const ae=i.forwardRef(es);function ts({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m0-10.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.25-8.25-3.286Zm0 13.036h.008v.008H12v-.008Z"}))}const ge=i.forwardRef(ts);function ss({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.348 14.652a3.75 3.75 0 0 1 0-5.304m5.304 0a3.75 3.75 0 0 1 0 5.304m-7.425 2.121a6.75 6.75 0 0 1 0-9.546m9.546 0a6.75 6.75 0 0 1 0 9.546M5.106 18.894c-3.808-3.807-3.808-9.98 0-13.788m13.788 0c3.808 3.807 3.808 9.98 0 13.788M12 12h.008v.008H12V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const ce=i.forwardRef(ss);function as({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"}))}const rs=i.forwardRef(as);function ns({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const Te=i.forwardRef(ns);function is({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const H=i.forwardRef(is);function ls({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z"}))}const de=i.forwardRef(ls);function os({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const W=i.forwardRef(os);function cs({title:t,titleId:s,...a},r){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Z=i.forwardRef(cs),ds=({drone:t,isSelected:s,onSelect:a,getBatteryColor:r,getStatusColor:n})=>{const c=()=>{const p=n(t.status),f=r(t.batteryLevel),m=t.batteryLevel<30;return Ce.divIcon({html:`
        <div class="relative">
          <!-- Pulse animation for selected drone -->
          ${s?`
            <div class="absolute inset-0 animate-ping">
              <div class="w-6 h-6 bg-blue-400 rounded-full opacity-30"></div>
            </div>
          `:""}
          
          <!-- Low battery warning pulse -->
          ${m?`
            <div class="absolute inset-0 animate-pulse">
              <div class="w-6 h-6 bg-red-400 rounded-full opacity-40"></div>
            </div>
          `:""}
          
          <!-- Main drone icon -->
          <div class="relative w-6 h-6 rounded-full border-2 flex items-center justify-center transform transition-transform hover:scale-110"
               style="background-color: #161b22; border-color: ${p}">
            <!-- Drone symbol -->
            <svg class="w-3 h-3" style="color: ${p}" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2l3.5 3.5h-7L12 2zM5.5 8.5L2 12l3.5 3.5V8.5zM18.5 8.5v7L22 12l-3.5-3.5zM8.5 18.5L12 22l3.5-3.5h-7z"/>
              <circle cx="12" cy="12" r="2"/>
            </svg>
          </div>
          
          <!-- Battery indicator -->
          <div class="absolute -bottom-1 -right-1 w-3 h-1.5 rounded-sm border"
               style="background-color: ${f}; border-color: #30363d">
          </div>
          
          <!-- Status indicator dot -->
          <div class="absolute -top-1 -right-1 w-2 h-2 rounded-full"
               style="background-color: ${p}">
          </div>
        </div>
      `,className:"drone-marker",iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]})},o=p=>{const f=new Date(p),g=new Date().getTime()-f.getTime(),l=Math.floor(g/1e3);return l<60?`${l}s ago`:l<3600?`${Math.floor(l/60)}m ago`:`${Math.floor(l/3600)}h ago`},h=(p=>p>-50?{level:"Excellent",color:"#238636"}:p>-70?{level:"Good",color:"#d29922"}:p>-90?{level:"Poor",color:"#da3633"}:{level:"Very Poor",color:"#f85149"})(t.signalStrength);return!t.position.lat||!t.position.lng?null:e.jsx(Se,{position:[t.position.lat,t.position.lng],icon:c(),eventHandlers:{click:a},children:e.jsx(Me,{className:"drone-popup",maxWidth:320,minWidth:280,children:e.jsxs("div",{className:"bg-dark-secondary text-text-primary p-4 rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:t.name}),e.jsx("p",{className:"text-text-secondary text-sm",children:t.id})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium",style:{backgroundColor:n(t.status)+"20",color:n(t.status)},children:t.status.toUpperCase()})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Y,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Battery"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-dark-border rounded-full h-1.5",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-300",style:{width:`${t.batteryLevel}%`,backgroundColor:r(t.batteryLevel)}})}),e.jsxs("span",{className:"text-sm font-mono",children:[t.batteryLevel,"%"]})]})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ce,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Signal"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs",style:{color:h.color},children:h.level}),e.jsxs("span",{className:"text-sm font-mono text-text-secondary",children:[t.signalStrength,"dBm"]})]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Altitude"}),e.jsxs("span",{className:"font-mono",children:[t.position.alt.toFixed(1),"m"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Speed"}),e.jsxs("span",{className:"font-mono",children:[t.speed.toFixed(1)," m/s"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Heading"}),e.jsxs("span",{className:"font-mono",children:[t.heading.toFixed(0),"Â°"]})]})]}),t.currentMission&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-status-active"}),e.jsx("span",{className:"text-sm font-medium",children:"Active Mission"})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Mission"}),e.jsx("span",{children:t.currentMission.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Progress"}),e.jsxs("span",{children:[t.currentMission.progress,"%"]})]}),t.currentMission.eta&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"ETA"}),e.jsx("span",{children:t.currentMission.eta})]})]})]}),t.alerts&&t.alerts.length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(R,{className:"w-4 h-4 text-status-warning"}),e.jsxs("span",{className:"text-sm font-medium text-status-warning",children:[t.alerts.length," Alert",t.alerts.length>1?"s":""]})]}),e.jsxs("div",{className:"space-y-1",children:[t.alerts.slice(0,2).map((p,f)=>e.jsx("div",{className:"text-xs p-2 bg-dark-primary rounded border-l-2",style:{borderLeftColor:p.severity==="critical"?"#da3633":"#d29922"},children:p.message},f)),t.alerts.length>2&&e.jsxs("p",{className:"text-xs text-text-secondary",children:["+",t.alerts.length-2," more alerts"]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-border text-xs text-text-muted",children:["Last updated: ",o(t.lastUpdate)]})]})})})},xs=({mission:t})=>{const s=o=>{switch(o.toLowerCase()){case"active":case"in_progress":return"#1f6feb";case"completed":return"#238636";case"failed":case"cancelled":return"#da3633";case"pending":default:return"#8b949e"}},a=(o,d)=>{const h=o.completed||d<(t.currentWaypoint||0),p=d===(t.currentWaypoint||0);return Ce.divIcon({html:`
        <div class="relative">
          <div class="w-4 h-4 rounded-full border-2 flex items-center justify-center text-xs font-bold"
               style="background-color: ${h?"#238636":p?"#1f6feb":"#161b22"}; 
                      border-color: ${h?"#238636":p?"#1f6feb":"#8b949e"};
                      color: #f0f6fc">
            ${d+1}
          </div>
          ${p?`
            <div class="absolute inset-0 animate-ping">
              <div class="w-4 h-4 bg-blue-400 rounded-full opacity-30"></div>
            </div>
          `:""}
        </div>
      `,className:"waypoint-marker",iconSize:[16,16],iconAnchor:[8,8],popupAnchor:[0,-8]})},r=o=>{switch(o.toLowerCase()){case"pickup":return"ðŸ“¦";case"delivery":return"ðŸšš";case"hover":return"â¸ï¸";case"survey":return"ðŸ“·";default:return"ðŸ“"}};if(!t.waypoints||t.waypoints.length===0)return null;const n=t.waypoints.filter(o=>o.position.lat&&o.position.lng).map(o=>[o.position.lat,o.position.lng]);if(n.length===0)return null;const c=s(t.status);return e.jsxs(e.Fragment,{children:[e.jsx(Ye,{positions:n,pathOptions:{color:c,weight:3,opacity:.8,dashArray:t.status==="pending"?"10, 5":void 0}}),t.waypoints.map((o,d)=>!o.position.lat||!o.position.lng?null:e.jsx(Se,{position:[o.position.lat,o.position.lng],icon:a(o,d),children:e.jsx(Me,{className:"waypoint-popup",maxWidth:250,children:e.jsxs("div",{className:"bg-dark-secondary text-text-primary p-3 rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-semibold",children:["Waypoint ",d+1]}),e.jsx("span",{className:"text-lg",children:r(o.action)})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Action"}),e.jsx("span",{className:"capitalize",children:o.action})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Altitude"}),e.jsxs("span",{className:"font-mono",children:[o.position.alt,"m"]})]}),o.hoverTime&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Hover Time"}),e.jsxs("span",{className:"font-mono",children:[o.hoverTime,"s"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Status"}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${o.completed||d<(t.currentWaypoint||0)?"bg-green-900/30 text-green-400":d===(t.currentWaypoint||0)?"bg-blue-900/30 text-blue-400":"bg-gray-900/30 text-gray-400"}`,children:o.completed||d<(t.currentWaypoint||0)?"Completed":d===(t.currentWaypoint||0)?"Current":"Pending"})]})]}),o.notes&&e.jsx("div",{className:"mt-2 pt-2 border-t border-dark-border",children:e.jsx("p",{className:"text-xs text-text-secondary",children:o.notes})})]})})},`${t.id}-wp-${d}`))]})},ms=()=>{const t=et();return i.useEffect(()=>{const s=setTimeout(()=>{t.invalidateSize()},100);return()=>clearTimeout(s)},[t]),null},us=({drones:t,missions:s=[],selectedDroneId:a,onDroneSelect:r,className:n=""})=>{const[c,o]=i.useState([37.7749,-122.4194]),[d,h]=i.useState(12),p=i.useRef(null);i.useEffect(()=>{if(t.length>0){const g=t.filter(l=>l.position.lat&&l.position.lng);if(g.length>0){const l=g.reduce((S,x)=>S+x.position.lat,0)/g.length,j=g.reduce((S,x)=>S+x.position.lng,0)/g.length;o([l,j])}}},[t]),i.useEffect(()=>{const g=new ResizeObserver(()=>{setTimeout(()=>{window.dispatchEvent(new Event("resize"))},100)});return p.current&&g.observe(p.current),()=>{g.disconnect()}},[]);const f=g=>g>70?"#238636":g>30?"#d29922":g>15?"#da3633":"#f85149",m=g=>{switch(g.toLowerCase()){case"active":case"in_flight":return"#238636";case"charging":case"returning":return"#d29922";case"maintenance":case"emergency":return"#da3633";case"idle":default:return"#8b949e"}};return e.jsxs("div",{ref:p,className:`fleet-map-container relative h-full w-full bg-dark-primary rounded-lg overflow-hidden border border-dark-border ${n}`,children:[e.jsxs(E.div,{className:"absolute top-4 left-4 z-[1000] bg-dark-secondary/90 backdrop-blur-sm rounded-lg p-3 shadow-lg border border-dark-border",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsx("h3",{className:"text-text-primary font-semibold mb-2",children:"Fleet Overview"}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-status-operational"}),e.jsxs("span",{className:"text-text-secondary",children:[t.filter(g=>g.status==="active"||g.status==="in_flight").length," Active"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-status-warning"}),e.jsxs("span",{className:"text-text-secondary",children:[t.filter(g=>g.status==="charging"||g.status==="idle").length," Standby"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-status-critical"}),e.jsxs("span",{className:"text-text-secondary",children:[t.filter(g=>g.status==="maintenance"||g.status==="emergency").length," Issues"]})]})]})]}),e.jsx(E.div,{className:"absolute top-4 right-4 z-[1000] bg-dark-secondary/90 backdrop-blur-sm rounded-lg p-2 shadow-lg border border-dark-border",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{className:"px-3 py-1 text-xs bg-dark-tertiary hover:bg-dark-hover text-text-primary rounded border border-dark-border transition-colors",onClick:()=>h(Math.min(d+1,18)),children:"Zoom In"}),e.jsx("button",{className:"px-3 py-1 text-xs bg-dark-tertiary hover:bg-dark-hover text-text-primary rounded border border-dark-border transition-colors",onClick:()=>h(Math.max(d-1,1)),children:"Zoom Out"}),e.jsx("button",{className:"px-3 py-1 text-xs bg-dark-tertiary hover:bg-dark-hover text-text-primary rounded border border-dark-border transition-colors",onClick:()=>{if(t.length>0){const g=t.filter(l=>l.position.lat&&l.position.lng);if(g.length>0){const l=g.reduce((S,x)=>S+x.position.lat,0)/g.length,j=g.reduce((S,x)=>S+x.position.lng,0)/g.length;o([l,j]),h(12)}}},children:"Center Fleet"})]})}),e.jsx("div",{className:"absolute inset-0 w-full h-full",children:e.jsxs(Xe,{center:c,zoom:d,style:{height:"100%",width:"100%",minHeight:"400px"},zoomControl:!1,attributionControl:!1,className:"leaflet-container bg-dark-primary",children:[e.jsx(ms,{}),e.jsx(Ke,{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors Â© <a href="https://carto.com/attributions">CARTO</a>'}),s.map(g=>e.jsx(xs,{mission:g},g.id)),t.map(g=>e.jsx(ds,{drone:g,isSelected:g.id===a,onSelect:()=>r(g.id),getBatteryColor:f,getStatusColor:m},g.id))]})}),e.jsxs(E.div,{className:"absolute bottom-4 left-4 z-[1000] bg-dark-secondary/90 backdrop-blur-sm rounded-lg p-3 shadow-lg border border-dark-border",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[e.jsx("h4",{className:"text-text-primary font-medium text-sm mb-2",children:"Legend"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-status-operational border border-dark-border"}),e.jsx("span",{className:"text-text-secondary",children:"Active Drone"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-status-warning border border-dark-border"}),e.jsx("span",{className:"text-text-secondary",children:"Standby/Charging"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-status-critical border border-dark-border"}),e.jsx("span",{className:"text-text-secondary",children:"Issue/Maintenance"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-0.5 bg-status-active"}),e.jsx("span",{className:"text-text-secondary",children:"Mission Path"})]})]})]})]})},Fe=({level:t,voltage:s,size:a="md",showLabel:r=!1,showVoltage:n=!1,className:c=""})=>{const o=l=>l>70?"#238636":l>30?"#d29922":l>15?"#da3633":"#f85149",d=()=>{switch(a){case"sm":return"w-12";case"lg":return"w-20";default:return"w-16"}},h=()=>{switch(a){case"sm":return"h-6";case"lg":return"h-10";default:return"h-8"}},p=()=>{switch(a){case"sm":return"text-xs";case"lg":return"text-base";default:return"text-sm"}},f=o(t),m=t<30,g=t<15;return e.jsxs("div",{className:`flex items-center gap-2 ${c}`,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:`${d()} ${h()} border-2 rounded-sm relative overflow-hidden`,style:{borderColor:f},children:[e.jsx(E.div,{className:"h-full rounded-sm",style:{backgroundColor:f},initial:{width:0},animate:{width:`${Math.max(t,0)}%`},transition:{duration:.5,ease:"easeOut"}}),g&&e.jsx(E.div,{className:"absolute inset-0 bg-red-500",animate:{opacity:[.3,.7,.3]},transition:{duration:1,repeat:1/0}})]}),e.jsx("div",{className:`absolute -right-1 top-1/2 transform -translate-y-1/2 w-1 bg-current rounded-r-sm ${a==="sm"?"h-2":a==="lg"?"h-4":"h-3"}`,style:{color:f}}),m&&e.jsx("div",{className:"absolute -top-1 -right-1",children:e.jsx(Le,{className:`${a==="sm"?"w-3 h-3":"w-4 h-4"} text-red-500`})})]}),r&&e.jsxs("span",{className:`font-mono font-semibold ${p()}`,style:{color:f},children:[t.toFixed(0),"%"]})]}),n&&s&&e.jsx("div",{className:`text-text-secondary ${p()}`,children:e.jsxs("span",{className:"font-mono",children:[s.toFixed(1),"V"]})}),r&&a!=="sm"&&e.jsx("div",{className:`${p()} text-text-secondary`,children:g?"Critical":m?"Low":t>80?"Excellent":"Good"})]})},hs=({drone:t,isSelected:s,onSelect:a,onAction:r,index:n})=>{const c=f=>{switch(f.toLowerCase()){case"active":case"in_flight":return{color:"#238636",bgColor:"#238636",label:"Active",icon:_};case"charging":return{color:"#d29922",bgColor:"#d29922",label:"Charging",icon:Y};case"maintenance":return{color:"#da3633",bgColor:"#da3633",label:"Maintenance",icon:R};case"emergency":return{color:"#f85149",bgColor:"#f85149",label:"Emergency",icon:R};case"idle":default:return{color:"#8b949e",bgColor:"#8b949e",label:"Idle",icon:X}}},o=f=>{const m=new Date(f),l=new Date().getTime()-m.getTime(),j=Math.floor(l/1e3);return j<60?`${j}s ago`:j<3600?`${Math.floor(j/60)}m ago`:`${Math.floor(j/3600)}h ago`},d=c(t.status),h=d.icon,p=(f,m)=>{m.stopPropagation(),a()};return e.jsxs(E.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,delay:n*.05},onClick:a,className:`
        relative bg-dark-tertiary rounded-lg p-3 border cursor-pointer transition-all duration-200 hover:bg-dark-hover mb-2 w-full
        ${s?"border-status-active shadow-glow":"border-dark-border hover:border-dark-hover"}
      `,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxs("div",{className:"flex-shrink-0 relative",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center border",style:{backgroundColor:d.bgColor+"20",borderColor:d.color},children:e.jsx(h,{className:"w-4 h-4",style:{color:d.color}})}),t.alerts&&t.alerts.length>0&&e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-status-warning rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-white text-[10px]",children:t.alerts.length})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-text-primary text-sm truncate",children:t.name}),e.jsx("span",{className:"text-text-secondary text-xs font-mono",children:t.id})]}),e.jsx("div",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium mt-1",style:{backgroundColor:d.color+"20",color:d.color},children:d.label})]})]}),e.jsx("button",{onClick:f=>p("view",f),className:"p-1.5 rounded hover:bg-dark-secondary transition-colors flex-shrink-0",title:"View Details",style:{color:"#1f6feb"},children:e.jsx(oe,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-text-secondary text-xs mb-1",children:"Battery"}),e.jsx(Fe,{level:t.batteryLevel,voltage:t.batteryVoltage,inFlight:["active","in_flight"].includes(t.status),status:t.status,size:"sm",showVoltage:!1})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-text-secondary text-xs mb-1",children:"Signal"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"flex items-end gap-0.5",children:[0,1,2,3].map(f=>e.jsx("div",{className:`w-0.5 rounded-sm ${f===0?"h-2":f===1?"h-3":"h-4"}`,style:{backgroundColor:t.signalStrength>-50-f*20?"#238636":"#30363d"}},f))}),e.jsxs("span",{className:"text-xs font-mono text-text-secondary",children:[t.signalStrength,"dBm"]})]})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-text-secondary text-xs mb-1",children:t.currentMission?"Mission":"Altitude"}),t.currentMission?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-status-active rounded-full"}),e.jsxs("span",{className:"truncate text-xs text-text-primary",children:[t.currentMission.progress,"%"]})]}):e.jsxs("div",{className:"text-xs text-text-primary",children:[t.position.alt.toFixed(0),"m"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2 pt-2 border-t border-dark-border text-xs",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-text-secondary",children:[t.speed.toFixed(1)," m/s"]}),t.alerts&&t.alerts.length>0&&e.jsxs("span",{className:"text-status-warning",children:[t.alerts.length," alerts"]})]}),e.jsx("span",{className:"text-text-muted",children:o(t.lastUpdate)})]})]})},ps=({stats:t})=>{const s=r=>r>70?"#238636":r>30?"#d29922":"#da3633",a=[{label:"Total Drones",value:t.total,color:"#8b949e",icon:null},{label:"Active",value:t.active,color:"#238636",icon:_},{label:"Avg Battery",value:`${t.avgBattery.toFixed(0)}%`,color:s(t.avgBattery),icon:Y},{label:"Alerts",value:t.alerts,color:t.alerts>0?"#d29922":"#8b949e",icon:R,highlight:t.alerts>0}];return e.jsx("div",{className:"grid grid-cols-4 gap-4",children:a.map((r,n)=>e.jsxs(E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:n*.1},className:`text-center p-3 rounded-lg ${r.highlight?"bg-dark-tertiary border border-status-warning/30":"bg-dark-tertiary"}`,children:[r.icon&&e.jsx("div",{className:"flex justify-center mb-1",children:e.jsx(r.icon,{className:"w-4 h-4",style:{color:r.color}})}),e.jsx("div",{className:"text-xl font-bold",style:{color:r.color},children:r.value}),e.jsx("div",{className:"text-xs text-text-secondary",children:r.label})]},r.label))})},gs=({drones:t,selectedDroneId:s,onDroneSelect:a,onDroneAction:r,className:n=""})=>{const[c,o]=i.useState("all"),[d,h]=i.useState("status"),p={total:t.length,active:t.filter(l=>l.status==="active"||l.status==="in_flight").length,charging:t.filter(l=>l.status==="charging").length,maintenance:t.filter(l=>l.status==="maintenance"||l.status==="emergency").length,idle:t.filter(l=>l.status==="idle").length,lowBattery:t.filter(l=>l.batteryLevel<30).length,alerts:t.reduce((l,j)=>{var S;return l+(((S=j.alerts)==null?void 0:S.length)||0)},0),avgBattery:t.length>0?t.reduce((l,j)=>l+j.batteryLevel,0)/t.length:0},f=t.filter(l=>{switch(c){case"active":return l.status==="active"||l.status==="in_flight";case"issues":return l.status==="maintenance"||l.status==="emergency"||l.alerts&&l.alerts.length>0;case"idle":return l.status==="idle"||l.status==="charging";default:return!0}}).sort((l,j)=>{switch(d){case"name":return l.name.localeCompare(j.name);case"battery":return j.batteryLevel-l.batteryLevel;case"status":const S={emergency:0,maintenance:1,active:2,in_flight:2,charging:3,idle:4};return(S[l.status]||5)-(S[j.status]||5);case"lastUpdate":return new Date(j.lastUpdate).getTime()-new Date(l.lastUpdate).getTime();default:return 0}}),m=[{value:"all",label:`All (${p.total})`,count:p.total},{value:"active",label:`Active (${p.active})`,count:p.active},{value:"issues",label:`Issues (${p.maintenance})`,count:p.maintenance},{value:"idle",label:`Idle (${p.idle+p.charging})`,count:p.idle+p.charging}],g=[{id:"1",type:"mission_complete",drone:"DRN001",message:"Delivery mission completed successfully",timestamp:new Date(Date.now()-3e5)},{id:"2",type:"battery_low",drone:"DRN003",message:"Battery level below 25%",timestamp:new Date(Date.now()-6e5)},{id:"3",type:"charging_start",drone:"DRN002",message:"Started charging at Station Alpha",timestamp:new Date(Date.now()-9e5)},{id:"4",type:"mission_start",drone:"DRN004",message:"Started emergency medical delivery",timestamp:new Date(Date.now()-12e5)},{id:"5",type:"maintenance",drone:"DRN005",message:"Scheduled maintenance completed",timestamp:new Date(Date.now()-18e5)}];return e.jsxs("div",{className:`h-full flex flex-col ${n}`,children:[e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsx(ps,{stats:p})}),e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"grid grid-cols-2 gap-1",children:m.map(l=>e.jsx("button",{onClick:()=>o(l.value),className:`px-2 py-1 rounded text-xs font-medium transition-all duration-200 ${c===l.value?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:l.label},l.value))}),e.jsxs("select",{value:d,onChange:l=>h(l.target.value),className:"w-full px-2 py-1 bg-dark-tertiary text-text-primary rounded border border-dark-border text-xs focus:outline-none focus:ring-1 focus:ring-status-active",children:[e.jsx("option",{value:"status",children:"Sort by Status"}),e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"battery",children:"Sort by Battery"}),e.jsx("option",{value:"lastUpdate",children:"Sort by Update"})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"p-2 space-y-2",children:[e.jsx(P,{mode:"popLayout",children:f.map((l,j)=>e.jsx(hs,{drone:l,isSelected:l.id===s,onSelect:()=>a(l.id),onAction:r,index:j},l.id))}),f.length===0&&e.jsxs("div",{className:"text-center py-8 text-text-secondary",children:[e.jsx(W,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No drones match filter"}),e.jsx("button",{onClick:()=>o("all"),className:"mt-2 px-2 py-1 bg-dark-tertiary text-text-primary rounded text-xs hover:bg-dark-hover transition-colors",children:"Show All"})]})]})}),e.jsx("div",{className:"border-t border-dark-border",children:e.jsxs("div",{className:"p-3",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-2",children:"Recent Activity"}),e.jsx("div",{className:"space-y-1",children:g.slice(0,3).map(l=>e.jsxs("div",{className:"text-xs text-text-secondary",children:[e.jsxs("span",{className:"font-medium",children:[l.drone,":"]})," ",l.message]},l.id))})]})})]})},fs=({strength:t,quality:s,size:a="md",showLabel:r=!1,showStrength:n=!1,className:c=""})=>{const o=l=>l>-50?{level:"Excellent",color:"#238636",bars:4}:l>-70?{level:"Good",color:"#d29922",bars:3}:l>-85?{level:"Fair",color:"#d29922",bars:2}:l>-95?{level:"Poor",color:"#da3633",bars:1}:{level:"Very Poor",color:"#f85149",bars:0},d=l=>{switch(a){case"sm":return l===0?"h-2":l===1?"h-3":l===2?"h-4":"h-5";case"lg":return l===0?"h-4":l===1?"h-6":l===2?"h-8":"h-10";default:return l===0?"h-3":l===1?"h-4":l===2?"h-5":"h-6"}},h=()=>{switch(a){case"sm":return"w-0.5";case"lg":return"w-1";default:return"w-0.5"}},p=()=>{switch(a){case"sm":return"text-xs";case"lg":return"text-base";default:return"text-sm"}},f=o(t),g=(s?{excellent:{level:"Excellent",color:"#238636",bars:4},good:{level:"Good",color:"#238636",bars:3},poor:{level:"Poor",color:"#da3633",bars:2},very_poor:{level:"Very Poor",color:"#f85149",bars:1}}[s]:null)||f;return e.jsxs("div",{className:`flex items-center gap-2 ${c}`,children:[e.jsx("div",{className:"flex items-end gap-0.5",children:[0,1,2,3].map(l=>e.jsx(E.div,{className:`${h()} ${d(l)} rounded-sm`,style:{backgroundColor:l<g.bars?g.color:"#30363d"},initial:{scaleY:0},animate:{scaleY:1},transition:{duration:.3,delay:l*.1}},l))}),r&&e.jsx("span",{className:`font-medium ${p()}`,style:{color:g.color},children:g.level}),n&&e.jsx("div",{className:`text-text-secondary ${p()}`,children:e.jsxs("span",{className:"font-mono",children:[t,"dBm"]})}),g.bars===0&&e.jsxs("div",{className:"relative",children:[e.jsx(de,{className:`${a==="sm"?"w-3 h-3":"w-4 h-4"} text-red-500`}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-0.5 h-full bg-red-500 rotate-45"})})]})]})},vs=({data:t})=>{var h;const[s,a]=i.useState("battery"),r=[{id:"battery",label:"Battery Level",color:"#238636",unit:"%",min:0,max:100,criticalLevel:20},{id:"altitude",label:"Altitude",color:"#1f6feb",unit:"m",min:0,max:Math.max(150,Math.max(...t.map(p=>p.altitude||0))+20)},{id:"speed",label:"Ground Speed",color:"#d29922",unit:"m/s",min:0,max:Math.max(20,Math.max(...t.map(p=>p.speed||0))+5)},{id:"signal",label:"Signal Strength",color:"#8957e5",unit:"dBm",min:-100,max:-30,criticalLevel:-90}],n=r.find(p=>p.id===s),c=p=>p.map(f=>({...f,time:new Date(f.timestamp).toLocaleTimeString("en-US",{hour12:!1,minute:"2-digit",second:"2-digit"})})),o=({active:p,payload:f,label:m})=>p&&f&&f.length?e.jsxs("div",{className:"bg-dark-secondary border border-dark-border rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"text-text-secondary text-sm",children:`Time: ${m}`}),e.jsx("p",{className:"text-text-primary font-semibold",children:`${n.label}: ${f[0].value.toFixed(1)}${n.unit}`})]}):null;if(t.length===0)return e.jsxs("div",{className:"text-center text-text-secondary py-8",children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸ“ˆ"}),e.jsx("p",{children:"No telemetry data available"}),e.jsx("p",{className:"text-sm",children:"Charts will appear once data starts flowing"})]});const d=c(t);return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(p=>e.jsx("button",{onClick:()=>a(p.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${s===p.id?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:p.color}}),p.label]})},p.id))}),e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-dark-tertiary rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-text-primary font-semibold",children:[n.label," Over Time"]}),e.jsxs("div",{className:"text-text-secondary text-sm",children:["Last ",d.length," data points"]})]}),e.jsx("div",{className:"h-64",children:e.jsx(tt,{width:"100%",height:"100%",children:e.jsxs(st,{data:d,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(at,{strokeDasharray:"3 3",stroke:"#30363d"}),e.jsx(rt,{dataKey:"time",stroke:"#8b949e",fontSize:12,interval:"preserveStartEnd"}),e.jsx(nt,{stroke:"#8b949e",fontSize:12,domain:[n.min,n.max]}),e.jsx(it,{content:e.jsx(o,{})}),n.criticalLevel!==void 0&&e.jsx(lt,{y:n.criticalLevel,stroke:"#da3633",strokeDasharray:"5 5",label:{value:"Critical",position:"top",fill:"#da3633",fontSize:10}}),e.jsx(ot,{type:"monotone",dataKey:s,stroke:n.color,strokeWidth:2,dot:{fill:n.color,strokeWidth:2,r:3},activeDot:{r:5,stroke:n.color,strokeWidth:2},connectNulls:!1})]})})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Current Value:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-text-primary",children:d.length>0&&((h=d[d.length-1][s])==null?void 0:h.toFixed(1))||"N/A"}),e.jsx("span",{className:"text-text-secondary",children:n.unit})]})]}),d.length>1&&e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:"text-text-secondary",children:"Trend:"}),(()=>{const p=d[d.length-1][s],f=d[d.length-2][s],m=p-f,g=m>0,l=m<0;return e.jsxs("div",{className:`flex items-center gap-1 text-sm ${g?"text-green-400":l?"text-red-400":"text-text-secondary"}`,children:[e.jsx("span",{children:g?"â†—":l?"â†˜":"â†’"}),e.jsxs("span",{children:[Math.abs(m).toFixed(2)," ",n.unit]})]})})()]})]})]},s),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:["min","max","avg","current"].map(p=>{let f,m;const g=d.map(l=>l[s]).filter(l=>l!=null);switch(p){case"min":f=g.length>0?Math.min(...g):0,m="Minimum";break;case"max":f=g.length>0?Math.max(...g):0,m="Maximum";break;case"avg":f=g.length>0?g.reduce((l,j)=>l+j,0)/g.length:0,m="Average";break;case"current":f=g.length>0?g[g.length-1]:0,m="Current";break;default:f=0,m=""}return e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3",children:[e.jsx("div",{className:"text-text-secondary text-sm",children:m}),e.jsx("div",{className:"text-xl font-bold text-text-primary",children:f.toFixed(1)}),e.jsx("div",{className:"text-xs text-text-secondary",children:n.unit})]},p)})})]})},ys=({alerts:t,droneId:s,onAcknowledge:a,onResolve:r,onDismiss:n})=>{const c=m=>{switch(m){case"critical":return{color:"#f85149",bgColor:"#da3633",icon:W,label:"Critical"};case"error":return{color:"#da3633",bgColor:"#da3633",icon:W,label:"Error"};case"warning":return{color:"#d29922",bgColor:"#d29922",icon:R,label:"Warning"};case"info":return{color:"#1f6feb",bgColor:"#1f6feb",icon:ue,label:"Info"};default:return{color:"#8b949e",bgColor:"#8b949e",icon:ue,label:"Unknown"}}},o=m=>{const g=new Date(m),j=new Date().getTime()-g.getTime(),S=Math.floor(j/1e3),x=Math.floor(S/60),b=Math.floor(x/60);return S<60?`${S}s ago`:x<60?`${x}m ago`:b<24?`${b}h ago`:g.toLocaleDateString()},d=[...t].sort((m,g)=>{const l={critical:4,error:3,warning:2,info:1},j=(l[g.severity]||0)-(l[m.severity]||0);return j!==0?j:new Date(g.timestamp).getTime()-new Date(m.timestamp).getTime()}),h=d.filter(m=>!m.resolved),p=d.filter(m=>m.resolved);if(t.length===0)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx(_,{className:"w-12 h-12 mx-auto text-status-operational mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"No Active Alerts"}),e.jsx("p",{className:"text-text-secondary",children:"All systems are operating normally"})]});const f=({alert:m,index:g})=>{const l=c(m.severity),j=l.icon;return e.jsx(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:g*.1},className:`bg-dark-tertiary rounded-lg border-l-4 p-4 ${m.acknowledged?"opacity-75":""} ${m.resolved?"opacity-50":""}`,style:{borderLeftColor:l.color},children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx(j,{className:"w-5 h-5",style:{color:l.color}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium",style:{backgroundColor:l.bgColor+"20",color:l.color},children:l.label}),m.category&&e.jsx("span",{className:"px-2 py-1 bg-dark-border text-text-secondary rounded text-xs",children:m.category}),m.acknowledged&&e.jsx("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-400 rounded text-xs",children:"Acknowledged"}),m.resolved&&e.jsx("span",{className:"px-2 py-1 bg-green-900/30 text-green-400 rounded text-xs",children:"Resolved"})]}),e.jsx("p",{className:"text-text-primary text-sm mb-2",children:m.message}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-text-secondary",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-3 h-3"}),o(m.timestamp)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"Drone:"}),e.jsx("span",{className:"font-mono",children:s})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[!m.resolved&&!m.acknowledged&&a&&e.jsx("button",{onClick:()=>a(m.id),className:"px-2 py-1 bg-blue-900/30 text-blue-400 hover:bg-blue-900/50 rounded text-xs transition-colors",title:"Acknowledge alert",children:"Ack"}),m.acknowledged&&!m.resolved&&r&&e.jsx("button",{onClick:()=>r(m.id),className:"px-2 py-1 bg-green-900/30 text-green-400 hover:bg-green-900/50 rounded text-xs transition-colors",title:"Mark as resolved",children:"Resolve"}),n&&e.jsx("button",{onClick:()=>n(m.id),className:"p-1 text-text-secondary hover:text-text-primary transition-colors",title:"Dismiss alert",children:e.jsx(Z,{className:"w-4 h-4"})})]})]})})};return e.jsxs("div",{className:"space-y-6",children:[h.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["Active Alerts (",h.length,")"]}),h.filter(m=>m.severity==="critical"||m.severity==="error").length>0&&e.jsxs("div",{className:"flex items-center gap-1 text-status-critical text-sm",children:[e.jsx(R,{className:"w-4 h-4"}),"Attention Required"]})]}),e.jsx("div",{className:"space-y-3",children:h.map((m,g)=>e.jsx(f,{alert:m,index:g},m.id))})]}),p.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:["Recent Resolved (",p.length,")"]}),e.jsx("div",{className:"space-y-3",children:p.slice(0,5).map((m,g)=>e.jsx(f,{alert:m,index:g},m.id))}),p.length>5&&e.jsxs("p",{className:"text-text-secondary text-sm mt-3 text-center",children:["+",p.length-5," more resolved alerts"]})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Alert Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Total Alerts"}),e.jsx("div",{className:"text-xl font-bold text-text-primary",children:t.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Active"}),e.jsx("div",{className:"text-xl font-bold text-status-warning",children:h.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Critical"}),e.jsx("div",{className:"text-xl font-bold text-status-critical",children:t.filter(m=>m.severity==="critical"&&!m.resolved).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Resolved"}),e.jsx("div",{className:"text-xl font-bold text-status-operational",children:p.length})]})]})]})]})},bs=({drone:t,isLive:s=!0,className:a=""})=>{var f;const[r,n]=i.useState("overview"),[c,o]=i.useState([]);if(i.useEffect(()=>{if(t&&s){const m={timestamp:Date.now(),battery:t.batteryLevel,altitude:t.position.alt,speed:t.speed,signalStrength:t.signalStrength};o(g=>[...g,m].slice(-50))}},[t,s]),!t)return e.jsx("div",{className:`h-full w-full flex items-center justify-center ${a}`,children:e.jsxs("div",{className:"text-center text-text-secondary",children:[e.jsx(me,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Drone Selected"}),e.jsx("p",{className:"text-sm",children:"Select a drone from the map or fleet list to view telemetry data."})]})});const d=m=>{const g=new Date(m),j=new Date().getTime()-g.getTime(),S=Math.floor(j/1e3);return S<60?`${S}s ago`:S<3600?`${Math.floor(S/60)}m ago`:`${Math.floor(S/3600)}h ago`},h=m=>{switch(m.toLowerCase()){case"active":case"in_flight":return"#238636";case"charging":case"returning":return"#d29922";case"maintenance":case"emergency":return"#da3633";case"idle":default:return"#8b949e"}},p=[{id:"overview",label:"Overview",icon:me},{id:"charts",label:"Charts",icon:B},{id:"alerts",label:"Alerts",icon:R,count:((f=t.alerts)==null?void 0:f.length)||0},{id:"system",label:"System",icon:de}];return e.jsxs("div",{className:`h-full w-full flex flex-col overflow-hidden ${a}`,children:[e.jsxs("div",{className:"flex-shrink-0 p-3 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:t.name}),e.jsx("p",{className:"text-text-secondary text-xs",children:t.id})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-status-operational rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Live"})]}),e.jsx("div",{className:"px-2 py-0.5 rounded text-xs font-medium border",style:{backgroundColor:h(t.status)+"20",color:h(t.status),borderColor:h(t.status)+"40"},children:t.status.toUpperCase()})]})]}),e.jsx("div",{className:"flex space-x-0.5",children:p.map(m=>e.jsxs("button",{onClick:()=>n(m.id),className:`px-2 py-1 rounded text-xs font-medium transition-all duration-200 flex items-center gap-1 ${r===m.id?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:[e.jsx(m.icon,{className:"w-3 h-3"}),m.label,m.count!==void 0&&m.count>0&&e.jsx("span",{className:"bg-status-critical text-white text-xs rounded-full px-1 py-0.5 min-w-[14px] text-center",children:m.count})]},m.id))})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto p-3",children:e.jsxs(P,{mode:"wait",children:[r==="overview"&&e.jsxs(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(Y,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Battery"})]}),e.jsx(Fe,{level:t.batteryLevel,voltage:t.batteryVoltage,showLabel:!0,size:"sm"})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(ce,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Signal"})]}),e.jsx(fs,{strength:t.signalStrength,quality:t.connectionQuality,showLabel:!0,size:"sm"})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(J,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Altitude"})]}),e.jsx("div",{className:"text-lg font-bold text-text-primary",children:t.position.alt.toFixed(1)}),e.jsx("div",{className:"text-xs text-text-secondary",children:"meters"})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(B,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Speed"})]}),e.jsx("div",{className:"text-lg font-bold text-text-primary",children:t.speed.toFixed(1)}),e.jsx("div",{className:"text-xs text-text-secondary",children:"m/s"})]})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-3",children:[e.jsxs("h3",{className:"font-medium text-text-primary mb-2 flex items-center gap-1",children:[e.jsx(Vt,{className:"w-4 h-4"}),"Position & Orientation"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Latitude"}),e.jsxs("span",{className:"font-mono text-text-primary",children:[t.position.lat.toFixed(6),"Â°"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Longitude"}),e.jsxs("span",{className:"font-mono text-text-primary",children:[t.position.lng.toFixed(6),"Â°"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Heading"}),e.jsxs("span",{className:"font-mono text-text-primary",children:[t.heading.toFixed(1),"Â°"]})]})]})]}),t.currentMission&&e.jsxs("div",{className:"bg-dark-tertiary rounded p-3",children:[e.jsxs("h3",{className:"font-medium text-text-primary mb-2 flex items-center gap-1",children:[e.jsx(_,{className:"w-4 h-4"}),"Current Mission"]}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Mission"}),e.jsx("span",{className:"text-text-primary truncate ml-2",children:t.currentMission.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Progress"}),e.jsxs("span",{className:"text-text-primary",children:[t.currentMission.progress,"%"]})]}),t.currentMission.eta&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"ETA"}),e.jsx("span",{className:"text-text-primary",children:t.currentMission.eta})]}),e.jsx("div",{className:"w-full bg-dark-border rounded-full h-1.5 mt-2",children:e.jsx("div",{className:"bg-status-active h-1.5 rounded-full transition-all duration-300",style:{width:`${t.currentMission.progress}%`}})})]})]})]},"overview"),r==="charts"&&e.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:e.jsx(vs,{data:c,drone:t})},"charts"),r==="alerts"&&e.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:e.jsx(ys,{alerts:t.alerts||[],droneId:t.id})},"alerts"),r==="system"&&e.jsxs(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"space-y-4",children:[e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"System Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Firmware"}),e.jsx("span",{className:"text-text-primary font-mono",children:t.firmware||"v1.12.3"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Hardware"}),e.jsx("span",{className:"text-text-primary",children:t.hardware||"Pixhawk 4"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Uptime"}),e.jsx("span",{className:"text-text-primary",children:t.uptime||"2h 34m"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Last Update"}),e.jsx("span",{className:"text-text-primary",children:d(t.lastUpdate)})]})]})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-text-primary mb-3 flex items-center gap-2",children:[e.jsx(_t,{className:"w-5 h-5"}),"Environmental"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Temperature"}),e.jsxs("div",{className:"font-mono text-text-primary",children:[t.temperature||28.5,"Â°C"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Humidity"}),e.jsxs("div",{className:"font-mono text-text-primary",children:[t.humidity||65,"%"]})]})]})]})]},"system")]})})})]})};var O=(t=>(t.CONNECTING="connecting",t.CONNECTED="connected",t.DISCONNECTED="disconnected",t.RECONNECTING="reconnecting",t.ERROR="error",t))(O||{});const js={url:"ws://localhost:3001/telemetry",reconnectInterval:3e3,maxReconnectAttempts:10,heartbeatInterval:3e4,connectionTimeout:1e4};class ws{constructor(s){$(this,"ws",null);$(this,"config");$(this,"connectionState","disconnected");$(this,"reconnectAttempts",0);$(this,"reconnectTimer",null);$(this,"heartbeatTimer",null);$(this,"connectionTimer",null);$(this,"onConnectionStateChange",null);$(this,"onMessage",null);$(this,"onDroneUpdate",null);$(this,"onMissionUpdate",null);$(this,"onFleetAlert",null);$(this,"stats",{messagesReceived:0,messagesProcessed:0,lastMessageTime:null,connectionUptime:null,reconnectCount:0});this.config={...js,...s}}connect(){if(this.connectionState==="connected"||this.connectionState==="connecting"){console.warn("WebSocket already connected or connecting");return}this.setConnectionState("connecting"),this.clearTimers();try{this.ws=new WebSocket(this.config.url),this.setupEventHandlers(),this.startConnectionTimeout()}catch(s){console.error("Failed to create WebSocket connection:",s),this.setConnectionState("error",s),this.scheduleReconnect()}}disconnect(){console.log("Disconnecting from telemetry service..."),this.clearTimers(),this.ws&&(this.ws.close(1e3,"Client disconnect"),this.ws=null),this.setConnectionState("disconnected"),this.reconnectAttempts=0}setConnectionStateCallback(s){this.onConnectionStateChange=s}onTelemetryMessage(s){this.onMessage=s}onDroneDataUpdate(s){this.onDroneUpdate=s}onMissionDataUpdate(s){this.onMissionUpdate=s}onFleetAlertReceived(s){this.onFleetAlert=s}getConnectionState(){return this.connectionState}getStatistics(){return{...this.stats,connectionState:this.connectionState,reconnectAttempts:this.reconnectAttempts,uptime:this.stats.connectionUptime?Date.now()-this.stats.connectionUptime.getTime():0}}isConnected(){return this.connectionState==="connected"}setupEventHandlers(){this.ws&&(this.ws.onopen=()=>{console.log("Connected to telemetry service"),this.clearConnectionTimeout(),this.setConnectionState("connected"),this.reconnectAttempts=0,this.stats.connectionUptime=new Date,this.stats.reconnectCount++,this.startHeartbeat()},this.ws.onmessage=s=>{try{const a=JSON.parse(s.data);this.handleMessage(a)}catch(a){console.error("Failed to parse telemetry message:",a,s.data)}},this.ws.onclose=s=>{console.log("WebSocket connection closed:",s.code,s.reason),this.clearTimers(),s.code!==1e3?(this.setConnectionState("disconnected"),this.scheduleReconnect()):this.setConnectionState("disconnected")},this.ws.onerror=s=>{console.error("WebSocket error:",s),this.setConnectionState("error",new Error("WebSocket connection error"))})}handleMessage(s){this.stats.messagesReceived++,this.stats.lastMessageTime=new Date,this.onMessage&&this.onMessage(s);try{switch(s.type){case"drone_update":const a=s;this.onDroneUpdate&&this.onDroneUpdate(a.data);break;case"mission_update":const r=s;this.onMissionUpdate&&this.onMissionUpdate(r.data);break;case"fleet_alert":const n=s;this.onFleetAlert&&this.onFleetAlert(n.data);break;case"heartbeat":console.debug("Heartbeat received from server");break;default:console.warn("Unknown message type:",s.type)}this.stats.messagesProcessed++}catch(a){console.error("Failed to process telemetry message:",a,s)}}setConnectionState(s,a){this.connectionState!==s&&(this.connectionState=s,console.log(`WebSocket state changed to: ${s}`),this.onConnectionStateChange&&this.onConnectionStateChange(s,a))}scheduleReconnect(){if(this.reconnectAttempts>=this.config.maxReconnectAttempts){console.error("Max reconnect attempts reached"),this.setConnectionState("error",new Error("Max reconnect attempts exceeded"));return}this.reconnectAttempts++,this.setConnectionState("reconnecting"),console.log(`Attempting to reconnect in ${this.config.reconnectInterval}ms (attempt ${this.reconnectAttempts}/${this.config.maxReconnectAttempts})`),this.reconnectTimer=setTimeout(()=>{this.connect()},this.config.reconnectInterval)}startHeartbeat(){this.heartbeatTimer=setInterval(()=>{var s;if(((s=this.ws)==null?void 0:s.readyState)===WebSocket.OPEN)try{this.ws.send(JSON.stringify({type:"ping",timestamp:new Date().toISOString()}))}catch(a){console.error("Failed to send heartbeat:",a)}},this.config.heartbeatInterval)}startConnectionTimeout(){this.connectionTimer=setTimeout(()=>{var s;this.connectionState==="connecting"&&(console.error("Connection timeout"),this.setConnectionState("error",new Error("Connection timeout")),(s=this.ws)==null||s.close(),this.scheduleReconnect())},this.config.connectionTimeout)}clearConnectionTimeout(){this.connectionTimer&&(clearTimeout(this.connectionTimer),this.connectionTimer=null)}clearTimers(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null),this.clearConnectionTimeout()}}const V=new ws,Ns=({connectionState:t,error:s,className:a=""})=>{const n=(()=>{switch(t){case O.CONNECTED:return{icon:_,color:"#238636",bgColor:"#238636",text:"Connected",description:"Real-time telemetry active",pulse:!1};case O.CONNECTING:return{icon:ie,color:"#d29922",bgColor:"#d29922",text:"Connecting",description:"Establishing connection...",pulse:!0};case O.RECONNECTING:return{icon:ie,color:"#d29922",bgColor:"#d29922",text:"Reconnecting",description:"Attempting to reconnect...",pulse:!0};case O.ERROR:return{icon:R,color:"#da3633",bgColor:"#da3633",text:"Error",description:s||"Connection failed",pulse:!1};case O.DISCONNECTED:default:return{icon:W,color:"#8b949e",bgColor:"#8b949e",text:"Disconnected",description:"No telemetry connection",pulse:!1}}})(),c=n.icon;return e.jsxs("div",{className:`flex items-center gap-3 ${a}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(P,{children:n.pulse&&e.jsx(E.div,{className:"absolute inset-0 rounded-full",style:{backgroundColor:n.color},initial:{scale:1,opacity:.3},animate:{scale:1.5,opacity:0},exit:{scale:1,opacity:.3},transition:{duration:1.5,repeat:1/0,repeatType:"loop"}})}),e.jsx(E.div,{className:"w-8 h-8 rounded-full border-2 flex items-center justify-center",style:{backgroundColor:n.bgColor+"20",borderColor:n.color},animate:n.pulse?{rotate:360}:{},transition:n.pulse?{duration:2,repeat:1/0,ease:"linear"}:{},children:e.jsx(c,{className:"w-4 h-4",style:{color:n.color}})})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",style:{color:n.color},children:n.text}),e.jsx("div",{className:"text-text-muted text-xs",children:n.description})]})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-1 text-xs text-text-secondary",children:[e.jsx(de,{className:"w-3 h-3"}),e.jsx("span",{children:"ws://localhost:3001/telemetry"})]}),(t===O.ERROR||s)&&e.jsx(E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"hidden lg:block",children:e.jsxs("div",{className:"bg-dark-tertiary border border-red-800 rounded-lg p-2 max-w-xs",children:[e.jsx("div",{className:"text-xs text-red-300 font-medium mb-1",children:"Connection Error"}),e.jsx("div",{className:"text-xs text-text-secondary",children:s||"Unable to connect to telemetry service"}),e.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Check if the telemetry service is running on port 3001"})]})})]})},ks=({className:t=""})=>{const[s,a]=i.useState({overall:"safe",lastCheck:Date.now(),criticalAlerts:0,warningAlerts:0,activeDrones:0,dronesAtRisk:0,totalAlerts:0}),[r,n]=i.useState([]),[c,o]=i.useState(!1),[d,h]=i.useState(!1);i.useEffect(()=>{const u=()=>{try{const y=new WebSocket("ws://localhost:3005/safety-ws");return y.onopen=()=>{console.log("Safety WebSocket connected"),o(!0),y.send(JSON.stringify({type:"subscribe",channels:["battery_alerts","safety_alerts","emergency_alerts","all_alerts"]})),y.send(JSON.stringify({type:"get_alerts"}))},y.onmessage=N=>{try{const L=JSON.parse(N.data);p(L)}catch(L){console.error("Failed to parse safety message:",L)}},y.onclose=()=>{console.log("Safety WebSocket disconnected"),o(!1),setTimeout(u,5e3)},y.onerror=N=>{console.error("Safety WebSocket error:",N),o(!1)},y}catch(y){return console.error("Failed to initialize safety connection:",y),o(!1),null}},k=u();return()=>{k&&k.close()}},[]);const p=u=>{switch(u.type){case"battery_alert":case"safety_alert":case"emergency_alert":n(k=>[u.data,...k.slice(0,19)]);break;case"system_safety_status":a(u.data.status);break;case"alerts_data":n(u.data.alerts||[]);break;case"alert_resolved":n(k=>k.filter(y=>y.id!==u.data.alertId));break}},f=u=>{switch(u){case"safe":return"text-green-400 bg-green-900/20";case"caution":return"text-yellow-400 bg-yellow-900/20";case"warning":return"text-orange-400 bg-orange-900/20";case"critical":return"text-red-400 bg-red-900/20";default:return"text-gray-400 bg-gray-900/20"}},m=u=>{switch(u){case"safe":return e.jsx(ae,{className:"w-5 h-5"});case"caution":case"warning":return e.jsx(ge,{className:"w-5 h-5"});case"critical":return e.jsx(R,{className:"w-5 h-5"});default:return e.jsx(ae,{className:"w-5 h-5"})}},g=u=>{if(u.type==="battery")return e.jsx(Le,{className:"w-4 h-4"});switch(u.severity){case"critical":return e.jsx(R,{className:"w-4 h-4"});case"warning":return e.jsx(ge,{className:"w-4 h-4"});default:return e.jsx(bt,{className:"w-4 h-4"})}},l=u=>{switch(u){case"critical":return"text-red-400 bg-red-900/20 border-red-500/30";case"warning":return"text-orange-400 bg-orange-900/20 border-orange-500/30";case"info":return"text-blue-400 bg-blue-900/20 border-blue-500/30";default:return"text-gray-400 bg-gray-900/20 border-gray-500/30"}},j=u=>{const k=new Date(u),N=new Date().getTime()-k.getTime();return N<6e4?"Just now":N<36e5?`${Math.floor(N/6e4)}m ago`:N<864e5?`${Math.floor(N/36e5)}h ago`:k.toLocaleDateString()},S=async u=>{try{console.log(`Acknowledging alert: ${u}`),n(k=>k.map(y=>y.id===u?{...y,acknowledged:!0}:y))}catch(k){console.error("Failed to acknowledge alert:",k)}},x=async u=>{try{console.log(`Resolving alert: ${u}`),n(k=>k.filter(y=>y.id!==u))}catch(k){console.error("Failed to resolve alert:",k)}},b=d?r:r.slice(0,5);return e.jsxs("div",{className:`bg-dark-secondary rounded-lg border border-dark-border ${t}`,children:[e.jsxs("div",{className:"p-4 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Safety Monitor"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${c?"bg-green-400":"bg-red-400"}`}),e.jsx("span",{className:"text-xs text-text-secondary",children:c?"Connected":"Disconnected"})]})]}),e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border ${f(s.overall)}`,children:[m(s.overall),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium capitalize",children:["System Status: ",s.overall]}),e.jsx("div",{className:"text-sm opacity-80",children:s.dronesAtRisk>0?`${s.dronesAtRisk} drone${s.dronesAtRisk>1?"s":""} at risk`:"All drones operating safely"})]}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:[s.totalAlerts," alerts"]}),e.jsxs("div",{className:"opacity-70",children:[s.criticalAlerts," critical"]})]})]})]}),e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:s.activeDrones}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Active Drones"})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:s.criticalAlerts}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Critical Alerts"})]})]})}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 pb-2",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:"Recent Alerts"}),r.length>5&&e.jsx("button",{onClick:()=>h(!d),className:"text-xs text-status-active hover:text-status-active/80 transition-colors",children:d?"Show Less":`Show All (${r.length})`})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 pb-4 space-y-2",children:e.jsx(P,{children:b.length>0?b.map(u=>e.jsx(E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},className:`p-3 rounded-lg border ${l(u.severity)}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[g(u),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-medium uppercase tracking-wide",children:u.type.replace("_"," ")}),u.droneId&&e.jsx("span",{className:"text-xs text-text-secondary",children:u.droneId}),e.jsx("span",{className:"text-xs text-text-secondary ml-auto",children:j(u.timestamp)})]}),e.jsx("div",{className:"text-sm text-text-primary mb-2",children:u.message}),u.type==="battery"&&u.data&&e.jsxs("div",{className:"text-xs text-text-secondary mb-2",children:["Battery: ",u.data.batteryLevel,"%",u.data.batteryVoltage&&` (${u.data.batteryVoltage}V)`]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!u.acknowledged&&e.jsxs("button",{onClick:()=>S(u.id),className:"flex items-center gap-1 text-xs text-status-active hover:text-status-active/80 transition-colors",children:[e.jsx(_,{className:"w-3 h-3"}),"Acknowledge"]}),u.acknowledged&&!u.resolved&&e.jsxs("button",{onClick:()=>x(u.id),className:"flex items-center gap-1 text-xs text-green-400 hover:text-green-300 transition-colors",children:[e.jsx(W,{className:"w-3 h-3"}),"Resolve"]}),u.acknowledged&&e.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-400",children:[e.jsx(_,{className:"w-3 h-3"}),"Acknowledged"]})]})]})]})},u.id)):e.jsxs("div",{className:"text-center py-8 text-text-secondary",children:[e.jsx(ae,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("div",{className:"text-sm",children:"No active safety alerts"}),e.jsx("div",{className:"text-xs opacity-70 mt-1",children:"All systems operating normally"})]})})})]}),e.jsx("div",{className:"px-4 py-2 border-t border-dark-border",children:e.jsxs("div",{className:"flex items-center gap-1 text-xs text-text-secondary",children:[e.jsx(X,{className:"w-3 h-3"}),"Last update: ",j(new Date(s.lastCheck).toISOString())]})})]})},Oe=({waypoints:t,onWaypointsChange:s,disabled:a=!1,className:r=""})=>{const[n,c]=i.useState(null),[o,d]=i.useState(!1),[h,p]=i.useState({position:{lat:37.7749,lng:-122.4194,alt:50},action:"navigation",hoverTime:0,notes:""}),f=[{value:"navigation",label:"Navigate",icon:"ðŸ§­",description:"Fly to location"},{value:"pickup",label:"Pickup",icon:"ðŸ“¦",description:"Pickup item"},{value:"delivery",label:"Delivery",icon:"ðŸšš",description:"Deliver item"},{value:"hover",label:"Hover",icon:"ðŸš",description:"Hover in place"},{value:"survey",label:"Survey",icon:"ðŸ”",description:"Survey area"},{value:"landing",label:"Land",icon:"ðŸ›¬",description:"Land drone"},{value:"takeoff",label:"Takeoff",icon:"ðŸ›«",description:"Takeoff drone"}],m=()=>{p({position:{lat:37.7749,lng:-122.4194,alt:50},action:"navigation",hoverTime:0,notes:""})},g=()=>{if(!h.position.lat||!h.position.lng)return;const y={id:`waypoint-${Date.now()}`,position:h.position,action:h.action,hoverTime:h.hoverTime||0,notes:h.notes||"",completed:!1};s([...t,y]),m(),d(!1)},l=y=>{const N=t[y];p({position:N.position,action:N.action,hoverTime:N.hoverTime,notes:N.notes}),c(y)},j=()=>{if(n===null)return;const y=[...t];y[n]={...y[n],position:h.position,action:h.action,hoverTime:h.hoverTime||0,notes:h.notes||""},s(y),c(null),m()},S=()=>{c(null),d(!1),m()},x=y=>{const N=t.filter((L,w)=>w!==y);s(N)},b=(y,N)=>{if(N==="up"&&y===0||N==="down"&&y===t.length-1)return;const L=[...t],w=N==="up"?y-1:y+1;[L[y],L[w]]=[L[w],L[y]],s(L)},u=y=>f.find(N=>N.value===y)||f[0],k=(y,N)=>{const w=y.lat*Math.PI/180,M=N.lat*Math.PI/180,A=(N.lat-y.lat)*Math.PI/180,v=(N.lng-y.lng)*Math.PI/180,C=Math.sin(A/2)*Math.sin(A/2)+Math.cos(w)*Math.cos(M)*Math.sin(v/2)*Math.sin(v/2),D=2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C));return Math.round(6371e3*D)};return e.jsxs("div",{className:`space-y-4 ${r}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Waypoints"}),e.jsxs("p",{className:"text-sm text-text-secondary",children:[t.length," waypoint",t.length!==1?"s":"",t.length>1&&e.jsxs("span",{className:"ml-2",children:["Total distance: ~",t.reduce((y,N,L)=>L===0?y:y+k(t[L-1].position,N.position),0),"m"]})]})]}),!a&&e.jsxs("button",{onClick:()=>d(!0),disabled:o||n!==null,className:`flex items-center gap-2 px-3 py-2 bg-status-active hover:bg-status-active/80 
                     text-white rounded-lg text-sm font-medium transition-colors
                     disabled:opacity-50 disabled:cursor-not-allowed`,children:[e.jsx(q,{className:"w-4 h-4"}),"Add Waypoint"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(P,{children:t.map((y,N)=>e.jsx(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-dark-tertiary rounded-lg border border-dark-border",children:n===N?e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(fe,{data:h,onChange:p,actionOptions:f}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs("button",{onClick:S,className:`flex items-center gap-1 px-3 py-2 text-text-secondary hover:text-text-primary 
                               transition-colors text-sm`,children:[e.jsx(Z,{className:"w-4 h-4"}),"Cancel"]}),e.jsxs("button",{onClick:j,className:`flex items-center gap-1 px-3 py-2 bg-status-active hover:bg-status-active/80 
                               text-white rounded transition-colors text-sm`,children:[e.jsx($e,{className:"w-4 h-4"}),"Save"]})]})]}):e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-lg",children:u(y.action).icon}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-text-primary",children:[N+1,". ",u(y.action).label]}),e.jsx("p",{className:"text-sm text-text-secondary",children:u(y.action).description})]}),y.completed&&e.jsx("span",{className:`px-2 py-1 bg-status-operational/20 text-status-operational 
                                         text-xs font-medium rounded-full`,children:"âœ“ Completed"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Position:"}),e.jsxs("div",{className:"font-mono text-text-primary",children:[y.position.lat.toFixed(6),", ",y.position.lng.toFixed(6)]}),e.jsxs("div",{className:"font-mono text-text-secondary",children:["Alt: ",y.position.alt,"m"]})]}),e.jsxs("div",{children:[y.action==="hover"&&y.hoverTime&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Hover Time:"}),e.jsxs("div",{className:"text-text-primary",children:[y.hoverTime,"s"]})]}),N>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Distance:"}),e.jsxs("div",{className:"text-text-primary",children:["~",k(t[N-1].position,y.position),"m"]})]})]})]}),y.notes&&e.jsxs("div",{className:"mt-2 p-2 bg-dark-hover rounded text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:"Notes:"}),e.jsx("div",{className:"text-text-primary mt-1",children:y.notes})]})]}),!a&&!y.completed&&e.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[e.jsx("button",{onClick:()=>b(N,"up"),disabled:N===0,className:`p-1 text-text-secondary hover:text-text-primary transition-colors
                                   disabled:opacity-30 disabled:cursor-not-allowed`,title:"Move up",children:e.jsx($t,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>b(N,"down"),disabled:N===t.length-1,className:`p-1 text-text-secondary hover:text-text-primary transition-colors
                                   disabled:opacity-30 disabled:cursor-not-allowed`,title:"Move down",children:e.jsx(Mt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>l(N),disabled:n!==null||o,className:`p-1 text-text-secondary hover:text-status-warning transition-colors
                                   disabled:opacity-30 disabled:cursor-not-allowed`,title:"Edit waypoint",children:e.jsx(Re,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>x(N),disabled:n!==null||o,className:`p-1 text-text-secondary hover:text-status-critical transition-colors
                                   disabled:opacity-30 disabled:cursor-not-allowed`,title:"Delete waypoint",children:e.jsx(Te,{className:"w-4 h-4"})})]})]})})},y.id||N))}),e.jsx(P,{children:o&&e.jsxs(E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-dark-tertiary rounded-lg border border-dark-border p-4",children:[e.jsxs("h4",{className:"text-text-primary font-medium mb-4 flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5"}),"Add New Waypoint"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(fe,{data:h,onChange:p,actionOptions:f}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs("button",{onClick:S,className:`flex items-center gap-1 px-3 py-2 text-text-secondary hover:text-text-primary 
                             transition-colors text-sm`,children:[e.jsx(Z,{className:"w-4 h-4"}),"Cancel"]}),e.jsxs("button",{onClick:g,disabled:!h.position.lat||!h.position.lng,className:`flex items-center gap-1 px-3 py-2 bg-status-active hover:bg-status-active/80 
                             text-white rounded transition-colors text-sm
                             disabled:opacity-50 disabled:cursor-not-allowed`,children:[e.jsx(q,{className:"w-4 h-4"}),"Add Waypoint"]})]})]})]})})]}),t.length===0&&e.jsxs("div",{className:"text-center py-8 text-text-secondary",children:[e.jsx(J,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("h4",{className:"text-lg font-medium mb-2",children:"No waypoints added"}),e.jsx("p",{className:"text-sm mb-4",children:"Add waypoints to define the mission route"}),!a&&e.jsx("button",{onClick:()=>d(!0),className:`px-4 py-2 bg-status-active hover:bg-status-active/80 text-white rounded-lg
                       transition-colors text-sm font-medium`,children:"Add First Waypoint"})]})]})},fe=({data:t,onChange:s,actionOptions:a})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Position"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("input",{type:"number",step:"0.000001",placeholder:"Latitude",value:t.position.lat,onChange:r=>s({...t,position:{...t.position,lat:parseFloat(r.target.value)||0}}),className:`w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm
                       text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active`}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Latitude"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",step:"0.000001",placeholder:"Longitude",value:t.position.lng,onChange:r=>s({...t,position:{...t.position,lng:parseFloat(r.target.value)||0}}),className:`w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm
                       text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active`}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Longitude"})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",min:"0",max:"1000",placeholder:"Altitude",value:t.position.alt,onChange:r=>s({...t,position:{...t.position,alt:parseInt(r.target.value)||0}}),className:`w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm
                       text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active`}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Altitude (m)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Action"}),e.jsx("select",{value:t.action,onChange:r=>s({...t,action:r.target.value}),className:`w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm
                   text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active`,children:a.map(r=>e.jsxs("option",{value:r.value,children:[r.icon," ",r.label," - ",r.description]},r.value))})]}),t.action==="hover"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Hover Time (seconds)"}),e.jsx("input",{type:"number",min:"1",max:"3600",value:t.hoverTime||0,onChange:r=>s({...t,hoverTime:parseInt(r.target.value)||0}),className:`w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm
                     text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Notes (optional)"}),e.jsx("textarea",{rows:2,placeholder:"Additional notes about this waypoint...",value:t.notes||"",onChange:r=>s({...t,notes:r.target.value}),className:`w-full px-3 py-2 bg-dark-hover border border-dark-border rounded text-sm
                   text-text-primary focus:outline-none focus:ring-1 focus:ring-status-active
                   resize-none`})]})]}),Ss={},ve=t=>{let s;const a=new Set,r=(f,m)=>{const g=typeof f=="function"?f(s):f;if(!Object.is(g,s)){const l=s;s=m??(typeof g!="object"||g===null)?g:Object.assign({},s,g),a.forEach(j=>j(s,l))}},n=()=>s,h={setState:r,getState:n,getInitialState:()=>p,subscribe:f=>(a.add(f),()=>a.delete(f)),destroy:()=>{(Ss?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),a.clear()}},p=s=t(r,n,h);return h},Ms=t=>t?ve(t):ve;var Ie={exports:{}},We={},Pe={exports:{}},_e={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q=i;function Cs(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var Ds=typeof Object.is=="function"?Object.is:Cs,Es=Q.useState,Ls=Q.useEffect,As=Q.useLayoutEffect,$s=Q.useDebugValue;function Rs(t,s){var a=s(),r=Es({inst:{value:a,getSnapshot:s}}),n=r[0].inst,c=r[1];return As(function(){n.value=a,n.getSnapshot=s,re(n)&&c({inst:n})},[t,a,s]),Ls(function(){return re(n)&&c({inst:n}),t(function(){re(n)&&c({inst:n})})},[t]),$s(a),a}function re(t){var s=t.getSnapshot;t=t.value;try{var a=s();return!Ds(t,a)}catch{return!0}}function Ts(t,s){return s()}var Fs=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Ts:Rs;_e.useSyncExternalStore=Q.useSyncExternalStore!==void 0?Q.useSyncExternalStore:Fs;Pe.exports=_e;var Os=Pe.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var te=i,Is=Os;function Ws(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var Ps=typeof Object.is=="function"?Object.is:Ws,_s=Is.useSyncExternalStore,Bs=te.useRef,Us=te.useEffect,zs=te.useMemo,Vs=te.useDebugValue;We.useSyncExternalStoreWithSelector=function(t,s,a,r,n){var c=Bs(null);if(c.current===null){var o={hasValue:!1,value:null};c.current=o}else o=c.current;c=zs(function(){function h(l){if(!p){if(p=!0,f=l,l=r(l),n!==void 0&&o.hasValue){var j=o.value;if(n(j,l))return m=j}return m=l}if(j=m,Ps(f,l))return j;var S=r(l);return n!==void 0&&n(j,S)?(f=l,j):(f=l,m=S)}var p=!1,f,m,g=a===void 0?null:a;return[function(){return h(s())},g===null?void 0:function(){return h(g())}]},[s,a,r,n]);var d=_s(t,c[0],c[1]);return Us(function(){o.hasValue=!0,o.value=d},[d]),Vs(d),d};Ie.exports=We;var Hs=Ie.exports;const Zs=Je(Hs),Be={},{useDebugValue:qs}=ke,{useSyncExternalStoreWithSelector:Qs}=Zs;let ye=!1;const Gs=t=>t;function Js(t,s=Gs,a){(Be?"production":void 0)!=="production"&&a&&!ye&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),ye=!0);const r=Qs(t.subscribe,t.getState,t.getServerState||t.getInitialState,s,a);return qs(r),r}const Ys=t=>{(Be?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const s=typeof t=="function"?Ms(t):t,a=(r,n)=>Js(s,r,n);return Object.assign(a,s),a},Ue=t=>Ys,Xs=t=>(s,a,r)=>{const n=r.subscribe;return r.subscribe=(o,d,h)=>{let p=o;if(d){const f=(h==null?void 0:h.equalityFn)||Object.is;let m=o(r.getState());p=g=>{const l=o(g);if(!f(m,l)){const j=m;d(m=l,j)}},h!=null&&h.fireImmediately&&d(m,m)}return n(p)},t(s,a,r)},ze=Xs,G="http://localhost:3001/api",Ks="ws://localhost:3001/ws";let I=null,K=0;const ea=5,T=Ue()(ze((t,s)=>({missions:{},activeMissions:[],selectedMissionId:null,missionStats:null,wsConnected:!1,wsError:null,lastUpdate:null,loading:!1,creating:!1,updating:!1,deleting:!1,setMissions:a=>{const r={};a.forEach(n=>{r[n.id]=n}),t({missions:r,lastUpdate:new Date().toISOString()})},setActiveMissions:a=>t({activeMissions:a}),setMissionStats:a=>t({missionStats:a}),selectMission:a=>t({selectedMissionId:a}),createMission:async a=>{t({creating:!0});try{const r=await fetch(`${G}/missions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!r.ok){const o=await r.json();throw new Error(o.message||"Failed to create mission")}const c=(await r.json()).data;return t(o=>({missions:{...o.missions,[c.id]:c},creating:!1,lastUpdate:new Date().toISOString()})),c}catch(r){throw t({creating:!1}),r}},updateMission:async(a,r)=>{t({updating:!0});try{const n=await fetch(`${G}/missions/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){const d=await n.json();throw new Error(d.message||"Failed to update mission")}const o=(await n.json()).data;return t(d=>({missions:{...d.missions,[a]:o},updating:!1,lastUpdate:new Date().toISOString()})),o}catch(n){throw t({updating:!1}),n}},deleteMission:async a=>{t({deleting:!0});try{const r=await fetch(`${G}/missions/${a}`,{method:"DELETE"});if(!r.ok){const n=await r.json();throw new Error(n.message||"Failed to delete mission")}t(n=>{const{[a]:c,...o}=n.missions;return{missions:o,selectedMissionId:n.selectedMissionId===a?null:n.selectedMissionId,activeMissions:n.activeMissions.filter(d=>d.id!==a),deleting:!1,lastUpdate:new Date().toISOString()}})}catch(r){throw t({deleting:!1}),r}},assignMissionToDrone:async(a,r)=>{try{const n=await fetch(`${G}/missions/${a}/assign`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({droneId:r})});if(!n.ok){const d=await n.json();throw new Error(d.message||"Failed to assign mission")}const o=(await n.json()).data;t(d=>({missions:{...d.missions,[a]:o},lastUpdate:new Date().toISOString()}))}catch(n){throw n}},updateMissionProgress:async(a,r,n)=>{try{const c=await fetch(`${G}/missions/${a}/progress`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({progress:r,currentWaypoint:n})});if(!c.ok){const o=await c.json();throw new Error(o.message||"Failed to update progress")}t(o=>{const d=o.missions[a];return d?{missions:{...o.missions,[a]:{...d,progress:r,currentWaypoint:n??d.currentWaypoint}},lastUpdate:new Date().toISOString()}:o})}catch(c){throw c}},setWsConnected:a=>t({wsConnected:a}),setWsError:a=>t({wsError:a}),handleMissionEvent:(a,r)=>{const n=s();switch(a){case"mission_created":t({missions:{...n.missions,[r.id]:r},lastUpdate:new Date().toISOString()});break;case"mission_updated":t({missions:{...n.missions,[r.id]:r},lastUpdate:new Date().toISOString()});break;case"mission_deleted":const{[r.id]:c,...o}=n.missions;t({missions:o,selectedMissionId:n.selectedMissionId===r.id?null:n.selectedMissionId,activeMissions:n.activeMissions.filter(h=>h.id!==r.id),lastUpdate:new Date().toISOString()});break;case"mission_assigned":n.missions[r.missionId]&&t({missions:{...n.missions,[r.missionId]:r.mission},lastUpdate:new Date().toISOString()});break;case"mission_progress":const d=n.missions[r.missionId];d&&t({missions:{...n.missions,[r.missionId]:{...d,progress:r.progress,currentWaypoint:r.currentWaypoint,status:r.status||d.status}},lastUpdate:new Date().toISOString()});break;default:console.log("Unknown mission event:",a,r)}},getMissionById:a=>s().missions[a],getMissionsByDrone:a=>Object.values(s().missions).filter(n=>n.assignedDrone===a),getMissionsByStatus:a=>Object.values(s().missions).filter(n=>n.status===a),clearMissions:()=>t({missions:{},activeMissions:[],selectedMissionId:null,missionStats:null,lastUpdate:null})}))),Ve=()=>{if((I==null?void 0:I.readyState)!==WebSocket.OPEN)try{I=new WebSocket(Ks),I.onopen=()=>{console.log("Mission WebSocket connected"),T.getState().setWsConnected(!0),T.getState().setWsError(null),K=0,I==null||I.send(JSON.stringify({type:"subscribe_missions",requestId:`sub-${Date.now()}`}))},I.onmessage=t=>{try{const s=JSON.parse(t.data),{type:a,data:r}=s;switch((a.startsWith("mission_")||a.startsWith("waypoint_"))&&T.getState().handleMissionEvent(a,r),a){case"mission_stats":T.getState().setMissionStats(r);break;case"active_missions":T.getState().setActiveMissions(r);break;default:console.log("Mission WebSocket message:",a,r)}}catch(s){console.error("Error parsing WebSocket message:",s)}},I.onclose=t=>{console.log("Mission WebSocket disconnected:",t.code,t.reason),T.getState().setWsConnected(!1),K<ea&&(K++,setTimeout(Ve,2e3*K))},I.onerror=t=>{console.error("Mission WebSocket error:",t),T.getState().setWsError("WebSocket connection error")}}catch(t){console.error("Failed to create WebSocket connection:",t),T.getState().setWsError("Failed to connect to mission service")}},ta=()=>{Ve()},sa=()=>{const{selectedMissionId:t,missions:s}=T();return t?s[t]:null},le=({isOpen:t,onClose:s,onMissionCreated:a})=>{const{createMission:r,creating:n}=T(),[c,o]=i.useState({name:"",description:"",priority:5,waypoints:[]}),[d,h]=i.useState(null),p=[{value:1,label:"Very Low",color:"text-gray-400"},{value:2,label:"Low",color:"text-blue-400"},{value:3,label:"Low-Medium",color:"text-blue-300"},{value:4,label:"Medium-Low",color:"text-yellow-400"},{value:5,label:"Medium",color:"text-yellow-300"},{value:6,label:"Medium-High",color:"text-orange-400"},{value:7,label:"High",color:"text-orange-300"},{value:8,label:"High-Critical",color:"text-red-400"},{value:9,label:"Critical",color:"text-red-300"},{value:10,label:"Emergency",color:"text-red-200"}],f=()=>{o({name:"",description:"",priority:5,waypoints:[]}),h(null)},m=()=>{f(),s()},g=()=>{if(!c.name.trim())return h("Mission name is required"),!1;if(c.name.length>100)return h("Mission name must be less than 100 characters"),!1;if(c.waypoints.length===0)return h("At least one waypoint is required"),!1;if(c.waypoints.length>50)return h("Maximum 50 waypoints allowed"),!1;for(let b=0;b<c.waypoints.length;b++){const u=c.waypoints[b];if(!u.position.lat||!u.position.lng)return h(`Waypoint ${b+1}: Invalid coordinates`),!1;if(Math.abs(u.position.lat)>90)return h(`Waypoint ${b+1}: Invalid latitude (must be -90 to 90)`),!1;if(Math.abs(u.position.lng)>180)return h(`Waypoint ${b+1}: Invalid longitude (must be -180 to 180)`),!1;if(u.position.alt<0||u.position.alt>1e3)return h(`Waypoint ${b+1}: Invalid altitude (must be 0-1000m)`),!1;if(u.action==="hover"&&(!u.hoverTime||u.hoverTime<=0))return h(`Waypoint ${b+1}: Hover time required for hover action`),!1}return!0},l=async b=>{if(b.preventDefault(),h(null),!!g())try{const u=await r({name:c.name.trim(),description:c.description.trim(),priority:c.priority,waypoints:c.waypoints.map((k,y)=>({...k,sequence:y})),status:"pending"});a==null||a(u),m()}catch(u){h(u.message||"Failed to create mission")}},j=b=>p.find(u=>u.value===b)||p[4],S=()=>{if(c.waypoints.length<2)return 0;let b=0;const u=10;for(let k=1;k<c.waypoints.length;k++){const y=c.waypoints[k-1],N=c.waypoints[k],L=6371e3,w=y.position.lat*Math.PI/180,M=N.position.lat*Math.PI/180,A=(N.position.lat-y.position.lat)*Math.PI/180,v=(N.position.lng-y.position.lng)*Math.PI/180,C=Math.sin(A/2)*Math.sin(A/2)+Math.cos(w)*Math.cos(M)*Math.sin(v/2)*Math.sin(v/2),D=2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C)),U=L*D;b+=U/u,N.hoverTime&&(b+=N.hoverTime)}return Math.round(b)},x=b=>{const u=Math.floor(b/3600),k=Math.floor(b%3600/60),y=b%60;return u>0?`${u}h ${k}m ${y}s`:k>0?`${k}m ${y}s`:`${y}s`};return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[10001] p-4",children:e.jsxs(E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:`bg-dark-secondary rounded-lg border border-dark-border shadow-xl
                   w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden`,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"w-6 h-6 text-status-active"}),e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Create New Mission"})]}),e.jsx("button",{onClick:m,className:"p-2 hover:bg-dark-hover rounded-lg transition-colors",children:e.jsx(Z,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsxs("form",{onSubmit:l,className:"flex flex-col flex-1 min-h-0",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 scrollbar-thin scrollbar-thumb-dark-border scrollbar-track-transparent",children:[d&&e.jsxs("div",{className:`flex items-center gap-2 p-3 bg-status-critical/10 border border-status-critical/20 
                            rounded-lg text-status-critical`,children:[e.jsx(R,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:d})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-text-primary",children:"Mission Details"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Mission Name *"}),e.jsx("input",{type:"text",required:!0,maxLength:100,placeholder:"e.g., Emergency Medical Delivery",value:c.name,onChange:b=>o({...c,name:b.target.value}),className:`w-full px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg
                             text-text-primary placeholder-text-secondary focus:outline-none 
                             focus:ring-2 focus:ring-status-active`}),e.jsxs("div",{className:"text-xs text-text-secondary mt-1",children:[c.name.length,"/100 characters"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Description"}),e.jsx("textarea",{rows:3,maxLength:1e3,placeholder:"Describe the mission objectives and requirements...",value:c.description,onChange:b=>o({...c,description:b.target.value}),className:`w-full px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg
                             text-text-primary placeholder-text-secondary focus:outline-none 
                             focus:ring-2 focus:ring-status-active resize-none`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-primary mb-2",children:"Priority"}),e.jsx("select",{value:c.priority,onChange:b=>o({...c,priority:parseInt(b.target.value)}),className:`w-full px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg
                             text-text-primary focus:outline-none focus:ring-2 focus:ring-status-active`,children:p.map(b=>e.jsxs("option",{value:b.value,className:"bg-dark-tertiary",children:[b.value," - ",b.label]},b.value))}),e.jsx("div",{className:`text-xs mt-1 ${j(c.priority).color}`,children:j(c.priority).label})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-text-primary",children:"Mission Summary"}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Waypoints:"}),e.jsx("div",{className:"text-text-primary font-medium",children:c.waypoints.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Priority:"}),e.jsx("div",{className:`font-medium ${j(c.priority).color}`,children:j(c.priority).label})]})]}),c.waypoints.length>1&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:"Estimated Duration:"}),e.jsx("div",{className:"text-text-primary font-medium",children:x(S())})]}),e.jsxs("div",{className:"text-xs text-text-secondary",children:["Status: ",e.jsx("span",{className:"text-status-warning",children:"Pending Assignment"})]})]})]})]}),e.jsx("div",{children:e.jsx(Oe,{waypoints:c.waypoints,onWaypointsChange:b=>{o({...c,waypoints:b}),h(null)}})})]}),e.jsxs("div",{className:"flex-shrink-0 flex items-center justify-between p-6 border-t border-dark-border bg-dark-tertiary",children:[e.jsx("div",{className:"text-sm text-text-secondary",children:c.waypoints.length>0?e.jsxs("span",{children:["Mission ready to create with ",c.waypoints.length," waypoints"]}):e.jsx("span",{children:"Add waypoints to define the mission route"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:m,disabled:n,className:`px-4 py-2 text-text-secondary hover:text-text-primary transition-colors
                         disabled:opacity-50 disabled:cursor-not-allowed`,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:n||!c.name.trim()||c.waypoints.length===0,className:`flex items-center gap-2 px-6 py-2 bg-status-active hover:bg-status-active/80 
                         text-white rounded-lg font-medium transition-colors
                         disabled:opacity-50 disabled:cursor-not-allowed`,children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"w-4 h-4"}),"Create Mission"]})})]})]})]})]})}):null},He=[{id:"drone-001",name:"Alpha-1",status:"in_flight",position:{lat:37.7749,lng:-122.4194,alt:120.5},batteryLevel:87,batteryVoltage:22.4,speed:12.3,heading:245,signalStrength:-45,connectionQuality:"excellent",lastUpdate:new Date().toISOString(),currentMission:{id:"mission-001",name:"Downtown Delivery Route",progress:65,eta:"14:30",status:"active"},alerts:[{id:"alert-001",severity:"warning",message:"Approaching restricted airspace",timestamp:new Date(Date.now()-3e5).toISOString(),category:"navigation"}],temperature:28.5,humidity:65,firmware:"v1.12.3",hardware:"Pixhawk 4 Mini",uptime:"2h 34m",totalFlightTime:847,totalMissions:23,lastMaintenance:new Date(Date.now()-7*24*60*60*1e3).toISOString()},{id:"drone-002",name:"Beta-2",status:"charging",position:{lat:37.7849,lng:-122.4094,alt:2.1},batteryLevel:23,batteryVoltage:18.2,speed:0,heading:0,signalStrength:-52,connectionQuality:"good",lastUpdate:new Date().toISOString(),alerts:[{id:"alert-002",severity:"info",message:"Charging in progress - 47 minutes remaining",timestamp:new Date(Date.now()-6e5).toISOString(),category:"system"}],temperature:32.1,humidity:68,firmware:"v1.12.3",hardware:"Pixhawk 4 Pro",uptime:"5h 12m",totalFlightTime:1203,totalMissions:31,lastMaintenance:new Date(Date.now()-3*24*60*60*1e3).toISOString()},{id:"drone-003",name:"Charlie-3",status:"in_flight",position:{lat:37.7649,lng:-122.4294,alt:89.2},batteryLevel:45,batteryVoltage:20.1,speed:8.7,heading:180,signalStrength:-67,connectionQuality:"good",lastUpdate:new Date().toISOString(),currentMission:{id:"mission-002",name:"Harbor Security Patrol",progress:38,eta:"15:45",status:"active"},temperature:30.8,humidity:72,firmware:"v1.12.3",hardware:"Pixhawk 4 Mini",uptime:"1h 58m",totalFlightTime:592,totalMissions:18,lastMaintenance:new Date(Date.now()-14*24*60*60*1e3).toISOString()},{id:"drone-004",name:"Delta-4",status:"active",position:{lat:37.7549,lng:-122.4394,alt:45.8},batteryLevel:92,batteryVoltage:23.1,speed:6.2,heading:90,signalStrength:-38,connectionQuality:"excellent",lastUpdate:new Date().toISOString(),currentMission:{id:"mission-003",name:"Medical Supply Delivery",progress:15,eta:"16:20",status:"active"},temperature:26.3,humidity:58,firmware:"v1.12.3",hardware:"Pixhawk 4 Pro",uptime:"8h 45m",totalFlightTime:1847,totalMissions:45,lastMaintenance:new Date(Date.now()-2*24*60*60*1e3).toISOString()},{id:"drone-005",name:"Echo-5",status:"maintenance",position:{lat:37.7449,lng:-122.4494,alt:0},batteryLevel:78,batteryVoltage:21.8,speed:0,heading:0,signalStrength:-88,connectionQuality:"poor",lastUpdate:new Date(Date.now()-9e5).toISOString(),alerts:[{id:"alert-003",severity:"critical",message:"Motor #3 temperature exceeds safe limits",timestamp:new Date(Date.now()-12e5).toISOString(),category:"hardware"},{id:"alert-004",severity:"warning",message:"GPS signal degraded - position accuracy reduced",timestamp:new Date(Date.now()-8e5).toISOString(),category:"navigation"},{id:"alert-005",severity:"info",message:"Scheduled maintenance required",timestamp:new Date(Date.now()-6e5).toISOString(),category:"maintenance"}],temperature:45.2,humidity:55,firmware:"v1.12.2",hardware:"Pixhawk 4 Mini",uptime:"12h 22m",totalFlightTime:2341,totalMissions:67,lastMaintenance:new Date(Date.now()-21*24*60*60*1e3).toISOString()}],aa=[{id:"mission-001",name:"Downtown Delivery",progress:65,eta:"14:30",status:"active",waypoints:[{id:"wp-001",position:{lat:37.7749,lng:-122.4194,alt:120},action:"pickup",completed:!0},{id:"wp-002",position:{lat:37.7849,lng:-122.4094,alt:100},action:"delivery",completed:!1}],assignedDrone:"drone-001",priority:1,createdAt:new Date(Date.now()-36e5).toISOString(),startedAt:new Date(Date.now()-18e5).toISOString()},{id:"mission-002",name:"Harbor Patrol",progress:38,eta:"15:45",status:"active",waypoints:[{id:"wp-003",position:{lat:37.7649,lng:-122.4294,alt:80},action:"survey",completed:!1}],assignedDrone:"drone-003",priority:2,createdAt:new Date(Date.now()-72e5).toISOString(),startedAt:new Date(Date.now()-27e5).toISOString()}],ra=[{id:"fleet-alert-001",severity:"critical",message:"Drone Echo-5 motor temperature critical",timestamp:new Date(Date.now()-12e5).toISOString(),droneId:"drone-005",droneName:"Echo-5",type:"system",priority:1,details:{temperature:45.2,threshold:40}},{id:"fleet-alert-002",severity:"warning",message:"Drone Alpha-1 approaching restricted airspace",timestamp:new Date(Date.now()-3e5).toISOString(),droneId:"drone-001",droneName:"Alpha-1",type:"safety",priority:2,details:{zone:"SFO_RESTRICTED",distance:150}}];class na{constructor(){$(this,"updateInterval",null);$(this,"onDroneUpdate");$(this,"droneFlightPatterns",new Map);this.initializeFlightPatterns()}initializeFlightPatterns(){this.droneFlightPatterns.set("drone-001",{type:"circular",center:{lat:37.7749,lng:-122.4194},radius:.002,currentAngle:0,speed:1e-4}),this.droneFlightPatterns.set("drone-002",{type:"stationary",center:{lat:37.7849,lng:-122.4094},radius:0,currentAngle:0,speed:0}),this.droneFlightPatterns.set("drone-003",{type:"linear",start:{lat:37.7649,lng:-122.4294},end:{lat:37.7549,lng:-122.4094},progress:.3,direction:1,speed:.01}),this.droneFlightPatterns.set("drone-004",{type:"waypoint",waypoints:[{lat:37.7549,lng:-122.4394},{lat:37.7649,lng:-122.4294},{lat:37.7749,lng:-122.4094}],currentWaypoint:0,progress:.15,speed:.005}),this.droneFlightPatterns.set("drone-005",{type:"stationary",center:{lat:37.7449,lng:-122.4494},radius:0,currentAngle:0,speed:0})}start(){console.log("ðŸ”§ Starting enhanced mock telemetry service for 5 drones"),console.log("ðŸ“ Flight patterns initialized: Circular patrol, Linear patrol, Waypoint mission"),this.updateInterval=setInterval(()=>{He.forEach((s,a)=>{this.updateDroneRealistic(s),setTimeout(()=>{this.onDroneUpdate&&this.onDroneUpdate({...s})},a*200)})},1500)}updateDroneRealistic(s){const a=this.droneFlightPatterns.get(s.id);a&&(this.updatePosition(s,a),this.updateTelemetry(s),this.updateMissionProgress(s),this.simulateAlerts(s),s.lastUpdate=new Date().toISOString())}updatePosition(s,a){switch(a.type){case"circular":a.currentAngle+=a.speed,s.position.lat=a.center.lat+Math.cos(a.currentAngle)*a.radius,s.position.lng=a.center.lng+Math.sin(a.currentAngle)*a.radius,s.position.alt=80+Math.sin(a.currentAngle*2)*20,s.heading=(a.currentAngle*180/Math.PI+90)%360,s.speed=8+Math.random()*4;break;case"linear":const r=a;r.progress+=r.direction*r.speed,(r.progress>=1||r.progress<=0)&&(r.direction*=-1,r.progress=Math.max(0,Math.min(1,r.progress))),s.position.lat=r.start.lat+(r.end.lat-r.start.lat)*r.progress,s.position.lng=r.start.lng+(r.end.lng-r.start.lng)*r.progress,s.position.alt=60+Math.sin(r.progress*Math.PI)*30;const n=r.end.lat-r.start.lat,c=r.end.lng-r.start.lng;s.heading=Math.atan2(c,n)*180/Math.PI*r.direction%360,s.speed=6+Math.random()*3;break;case"waypoint":const o=a;o.progress+=o.speed,o.progress>=1&&(o.currentWaypoint=(o.currentWaypoint+1)%o.waypoints.length,o.progress=0);const d=o.waypoints[o.currentWaypoint],h=o.waypoints[(o.currentWaypoint+1)%o.waypoints.length];s.position.lat=d.lat+(h.lat-d.lat)*o.progress,s.position.lng=d.lng+(h.lng-d.lng)*o.progress,s.position.alt=45+Math.random()*10;const p=h.lat-d.lat,f=h.lng-d.lng;s.heading=Math.atan2(f,p)*180/Math.PI,s.speed=5+Math.random()*3;break;case"stationary":s.position.lat+=(Math.random()-.5)*5e-6,s.position.lng+=(Math.random()-.5)*5e-6,s.speed=0;break}}updateTelemetry(s){s.status==="active"||s.status==="in_flight"?(s.batteryLevel=Math.max(5,s.batteryLevel-.08-Math.random()*.05),s.batteryVoltage=18+s.batteryLevel/100*5.5):s.status==="charging"&&(s.batteryLevel=Math.min(100,s.batteryLevel+.3+Math.random()*.2),s.batteryVoltage=18+s.batteryLevel/100*5.5);const a=s.signalStrength;s.signalStrength=a+(Math.random()-.5)*10,s.signalStrength>-50?s.connectionQuality="excellent":s.signalStrength>-70?s.connectionQuality="good":s.signalStrength>-90?s.connectionQuality="poor":s.connectionQuality="very_poor";const r=(Math.random()-.5)*2;s.temperature=(s.temperature||28)+r,(s.status==="active"||s.status==="in_flight")&&(s.temperature=Math.min(50,(s.temperature||28)+.1)),s.humidity=Math.max(40,Math.min(85,(s.humidity||60)+(Math.random()-.5)*5))}updateMissionProgress(s){if(s.currentMission&&(s.status==="active"||s.status==="in_flight")){s.currentMission.progress=Math.min(99,s.currentMission.progress+.2+Math.random()*.3);const a=100-s.currentMission.progress,r=Math.round(a*2),n=new Date(Date.now()+r*6e4);s.currentMission.eta=n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}}simulateAlerts(s){var a,r,n;s.batteryLevel<20&&!((a=s.alerts)!=null&&a.some(c=>c.category==="battery"))&&(s.alerts=s.alerts||[],s.alerts.unshift({id:`alert-battery-${Date.now()}`,severity:s.batteryLevel<15?"critical":"warning",message:`Battery level ${s.batteryLevel.toFixed(1)}% - ${s.batteryLevel<15?"Return to base immediately":"Consider returning to base"}`,timestamp:new Date().toISOString(),category:"battery"})),(s.temperature||0)>40&&!((r=s.alerts)!=null&&r.some(c=>c.message.includes("temperature")))&&(s.alerts=s.alerts||[],s.alerts.unshift({id:`alert-temp-${Date.now()}`,severity:"warning",message:`Temperature elevated: ${(n=s.temperature)==null?void 0:n.toFixed(1)}Â°C`,timestamp:new Date().toISOString(),category:"system"})),s.alerts&&s.alerts.length>3&&(s.alerts=s.alerts.slice(0,3))}stop(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),console.log("ðŸ”§ Mock telemetry service stopped")}onDroneDataUpdate(s){this.onDroneUpdate=s}}const be=new na,F=Ue()(ze((t,s)=>({connectionState:O.DISCONNECTED,connectionError:null,lastUpdate:null,drones:{},missions:{},alerts:[],selectedDroneId:null,stats:{messagesReceived:0,messagesProcessed:0,connectionUptime:0,reconnectCount:0},setConnectionState:(a,r)=>{t({connectionState:a,connectionError:r||null})},updateDrone:a=>{t(r=>({drones:{...r.drones,[a.id]:{...a,lastUpdate:new Date().toISOString()}},lastUpdate:new Date}))},updateMission:a=>{t(r=>({missions:{...r.missions,[a.id]:a},lastUpdate:new Date}))},addAlert:a=>{t(r=>({alerts:[a,...r.alerts.slice(0,99)],lastUpdate:new Date}))},dismissAlert:a=>{t(r=>({alerts:r.alerts.filter(n=>n.id!==a)}))},selectDrone:a=>{t({selectedDroneId:a})},updateStats:a=>{t({stats:a})},getDroneById:a=>s().drones[a],getActiveDrones:()=>{const{drones:a}=s();return Object.values(a).filter(r=>r.status==="active"||r.status==="in_flight")},getDronesWithIssues:()=>{const{drones:a}=s();return Object.values(a).filter(r=>r.status==="maintenance"||r.status==="emergency"||r.batteryLevel<20||r.signalStrength<-90||r.alerts&&r.alerts.length>0)},getIdleDrones:()=>{const{drones:a}=s();return Object.values(a).filter(r=>r.status==="idle")},getCriticalAlerts:()=>{const{alerts:a}=s();return a.filter(r=>r.severity==="critical")},getFleetSummary:()=>{const{drones:a}=s(),r=Object.values(a);if(r.length===0)return{total:0,active:0,idle:0,issues:0,charging:0,maintenance:0,avgBattery:0,avgSignal:0};const n=r.reduce((c,o)=>{switch(c.total++,o.status){case"active":case"in_flight":c.active++;break;case"idle":c.idle++;break;case"charging":c.charging++;break;case"maintenance":case"emergency":c.maintenance++;break}return(o.batteryLevel<20||o.signalStrength<-90||o.alerts&&o.alerts.length>0)&&c.issues++,c.totalBattery+=o.batteryLevel,c.totalSignal+=o.signalStrength,c},{total:0,active:0,idle:0,issues:0,charging:0,maintenance:0,totalBattery:0,totalSignal:0});return{total:n.total,active:n.active,idle:n.idle,issues:n.issues,charging:n.charging,maintenance:n.maintenance,avgBattery:Math.round(n.totalBattery/n.total),avgSignal:Math.round(n.totalSignal/n.total)}},connect:()=>{const a=s();V.setConnectionStateCallback((n,c)=>{a.setConnectionState(n,c==null?void 0:c.message),(n===O.ERROR||n===O.DISCONNECTED)&&setTimeout(()=>{console.log("ðŸ”§ WebSocket connection failed, using mock data for development"),He.forEach(o=>a.updateDrone(o)),aa.forEach(o=>a.updateMission(o)),ra.forEach(o=>a.addAlert(o)),be.onDroneDataUpdate(o=>{a.updateDrone(o)}),be.start()},1e3)}),V.onDroneDataUpdate(n=>{a.updateDrone(n)}),V.onMissionDataUpdate(n=>{a.updateMission(n)}),V.onFleetAlertReceived(n=>{a.addAlert(n)}),setInterval(()=>{const n=V.getStatistics();a.updateStats(n)},5e3),V.connect()},disconnect:()=>{V.disconnect(),t({connectionState:O.DISCONNECTED,connectionError:null})},isConnected:()=>s().connectionState===O.CONNECTED})));let je=!1;const ia=()=>{if(!je){je=!0;const{connect:t}=F.getState();t(),F.subscribe(s=>s.connectionState,(s,a)=>{a&&s!==a&&console.log(`Fleet store connection state: ${a} â†’ ${s}`)}),F.subscribe(s=>Object.keys(s.drones).length,(s,a)=>{a!==void 0&&s!==a&&console.log(`Fleet store drone count: ${a} â†’ ${s}`)})}},la=()=>{const t=F(a=>a.selectedDroneId),s=F(a=>a.getDroneById);return t&&s(t)||null},oa=()=>F(t=>({state:t.connectionState,error:t.connectionError,isConnected:t.isConnected(),lastUpdate:t.lastUpdate})),Ze=({mission:t,isOpen:s,onClose:a,onAssigned:r})=>{var L;const n=F(w=>Object.values(w.drones)),{assignMissionToDrone:c,missions:o}=T(),[d,h]=i.useState(null),[p,f]=i.useState(!1),[m,g]=i.useState([]);i.useEffect(()=>{s&&l()},[s,t,n]);const l=()=>{const w=n.map(M=>{const A=[],v=[];let C=100;(M.status==="maintenance"||M.status==="emergency")&&(A.push(`Drone is in ${M.status} mode`),C-=100),M.status==="charging"&&(v.push("Drone is currently charging"),C-=20),M.batteryLevel<30?(A.push(`Low battery: ${M.batteryLevel}%`),C-=50):M.batteryLevel<50&&(v.push(`Medium battery: ${M.batteryLevel}%`),C-=20),M.signalStrength<50&&(v.push(`Weak signal: ${M.signalStrength}%`),C-=10);const D=Object.values(o).find(z=>z.assignedDrone===M.id&&["pending","active","paused"].includes(z.status));if(D&&(A.push(`Already assigned to: ${D.name}`),C-=80),t.waypoints&&t.waypoints.length>0){const z=t.waypoints[0],se=j(M.position,z.position);se>5e4&&(v.push(`Far from start: ${(se/1e3).toFixed(1)}km`),C-=15)}t.priority>=8&&(C+=10),M.totalFlightTime&&M.totalFlightTime>3600&&(v.push("Drone has been flying for extended time"),C-=5);const U=C>0&&A.length===0;return{drone:M,compatible:U,score:Math.max(0,C),issues:A,warnings:v}});w.sort((M,A)=>A.score-M.score),g(w)},j=(w,M)=>{const v=w.lat*Math.PI/180,C=M.lat*Math.PI/180,D=(M.lat-w.lat)*Math.PI/180,U=(M.lng-w.lng)*Math.PI/180,z=Math.sin(D/2)*Math.sin(D/2)+Math.cos(v)*Math.cos(C)*Math.sin(U/2)*Math.sin(U/2);return 6371e3*(2*Math.atan2(Math.sqrt(z),Math.sqrt(1-z)))},S=w=>{switch(w){case"active":case"in_flight":return"text-status-operational bg-status-operational/10";case"idle":return"text-status-active bg-status-active/10";case"charging":return"text-status-warning bg-status-warning/10";case"maintenance":case"emergency":return"text-status-critical bg-status-critical/10";default:return"text-text-secondary bg-text-secondary/10"}},x=w=>w>70?"text-status-operational":w>30?"text-status-warning":"text-status-critical",b=w=>w.compatible?w.score>=80?e.jsx(_,{className:"w-5 h-5 text-status-operational"}):w.score>=60?e.jsx(X,{className:"w-5 h-5 text-status-warning"}):e.jsx(R,{className:"w-5 h-5 text-status-warning"}):e.jsx(W,{className:"w-5 h-5 text-status-critical"}),u=async()=>{if(d){f(!0);try{await c(t.id,d),r==null||r(t.id,d),a()}catch(w){console.error("Failed to assign mission:",w)}finally{f(!1)}}},k=w=>{if(!t.waypoints||t.waypoints.length===0)return null;const M=10;let A=0,v=w.drone.position;const C=j(v,t.waypoints[0].position);A+=C/M;for(let D=1;D<t.waypoints.length;D++){const U=j(t.waypoints[D-1].position,t.waypoints[D].position);A+=U/M,t.waypoints[D].hoverTime&&(A+=t.waypoints[D].hoverTime)}return A},y=w=>{const M=Math.floor(w/3600),A=Math.floor(w%3600/60);return M>0?`${M}h ${A}m`:`${A}m`};if(!s)return null;const N=m.find(w=>w.drone.id===d);return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[10001] p-4",children:e.jsxs(E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:`bg-dark-secondary rounded-lg border border-dark-border shadow-xl
                   w-full max-w-4xl max-h-[90vh] overflow-hidden`,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-text-primary",children:"Assign Mission to Drone"}),e.jsxs("p",{className:"text-text-secondary mt-1",children:["Mission: ",e.jsx("span",{className:"font-medium",children:t.name})]})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-dark-hover rounded-lg transition-colors",children:e.jsx(W,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-1/2 border-r border-dark-border",children:[e.jsxs("div",{className:"p-4 border-b border-dark-border",children:[e.jsxs("h3",{className:"font-medium text-text-primary",children:["Available Drones (",m.length,")"]}),e.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Select a drone to assign this mission"})]}),e.jsx("div",{className:"overflow-y-auto max-h-[60vh] p-4 space-y-3",children:m.map(w=>e.jsxs(E.div,{className:`p-4 rounded-lg border cursor-pointer transition-all
                    ${d===w.drone.id?"border-status-active bg-status-active/5":"border-dark-border hover:border-dark-hover bg-dark-tertiary hover:bg-dark-hover"}
                    ${w.compatible?"":"opacity-50"}
                  `,onClick:()=>w.compatible&&h(w.drone.id),whileHover:w.compatible?{scale:1.02}:{},whileTap:w.compatible?{scale:.98}:{},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[b(w),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary",children:w.drone.name}),e.jsx("p",{className:"text-sm text-text-secondary",children:w.drone.id})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${S(w.drone.status)}`,children:w.drone.status.toUpperCase()}),e.jsxs("div",{className:"text-sm font-medium text-text-primary",children:["Score: ",w.score,"/100"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:`w-4 h-4 ${x(w.drone.batteryLevel)}`}),e.jsxs("span",{className:x(w.drone.batteryLevel),children:[w.drone.batteryLevel,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ce,{className:"w-4 h-4 text-text-secondary"}),e.jsxs("span",{className:"text-text-primary",children:[w.drone.signalStrength,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"w-4 h-4 text-text-secondary"}),e.jsxs("span",{className:"text-text-primary text-xs",children:[w.drone.position.lat.toFixed(3),", ",w.drone.position.lng.toFixed(3)]})]})]}),w.issues.length>0&&e.jsx("div",{className:"mb-2",children:w.issues.map((M,A)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs text-status-critical",children:[e.jsx(W,{className:"w-3 h-3"}),M]},A))}),w.warnings.length>0&&e.jsx("div",{className:"mb-2",children:w.warnings.map((M,A)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs text-status-warning",children:[e.jsx(R,{className:"w-3 h-3"}),M]},A))}),w.compatible&&e.jsxs("div",{className:"text-xs text-text-secondary",children:["Estimated flight time: ",y(k(w)||0)]})]},w.drone.id))})]}),e.jsx("div",{className:"w-1/2 flex flex-col",children:N?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 border-b border-dark-border",children:[e.jsx("h3",{className:"font-medium text-text-primary mb-2",children:"Assignment Preview"}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-dark-tertiary rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-text-primary",children:t.name}),e.jsx("div",{className:"text-xs text-text-secondary",children:"Mission"})]}),e.jsx(ft,{className:"w-5 h-5 text-status-active"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-text-primary",children:N.drone.name}),e.jsx("div",{className:"text-xs text-text-secondary",children:"Drone"})]})]})]}),e.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Mission Details"}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Priority:"}),e.jsxs("span",{className:"text-text-primary font-medium",children:["Level ",t.priority]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Waypoints:"}),e.jsx("span",{className:"text-text-primary font-medium",children:((L=t.waypoints)==null?void 0:L.length)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Status:"}),e.jsx("span",{className:"text-status-warning font-medium",children:t.status.toUpperCase()})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Drone Readiness"}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Compatibility Score:"}),e.jsxs("span",{className:"text-text-primary font-medium",children:[N.score,"/100"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Battery Level:"}),e.jsxs("span",{className:`font-medium ${x(N.drone.batteryLevel)}`,children:[N.drone.batteryLevel,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Signal Strength:"}),e.jsxs("span",{className:"text-text-primary font-medium",children:[N.drone.signalStrength,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Current Status:"}),e.jsx("span",{className:"text-text-primary font-medium",children:N.drone.status.toUpperCase()})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Flight Estimate"}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Estimated Duration:"}),e.jsx("span",{className:"text-text-primary font-medium",children:y(k(N)||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Distance to Start:"}),e.jsx("span",{className:"text-text-primary font-medium",children:t.waypoints&&t.waypoints.length>0?`${(j(N.drone.position,t.waypoints[0].position)/1e3).toFixed(1)}km`:"N/A"})]})]})]}),(N.issues.length>0||N.warnings.length>0)&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Considerations"}),e.jsxs("div",{className:"space-y-2",children:[N.issues.map((w,M)=>e.jsxs("div",{className:"flex items-start gap-2 p-2 bg-status-critical/10 rounded text-sm",children:[e.jsx(W,{className:"w-4 h-4 text-status-critical mt-0.5"}),e.jsx("span",{className:"text-status-critical",children:w})]},M)),N.warnings.map((w,M)=>e.jsxs("div",{className:"flex items-start gap-2 p-2 bg-status-warning/10 rounded text-sm",children:[e.jsx(R,{className:"w-4 h-4 text-status-warning mt-0.5"}),e.jsx("span",{className:"text-status-warning",children:w})]},M))]})]})]})}),e.jsx("div",{className:"p-4 border-t border-dark-border",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-text-secondary",children:N.compatible?"Ready to assign mission":"Cannot assign due to compatibility issues"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,disabled:p,className:`px-4 py-2 text-text-secondary hover:text-text-primary transition-colors
                                 disabled:opacity-50 disabled:cursor-not-allowed`,children:"Cancel"}),e.jsx("button",{onClick:u,disabled:!N.compatible||p,className:`flex items-center gap-2 px-6 py-2 bg-status-active hover:bg-status-active/80 
                                 text-white rounded-lg font-medium transition-colors
                                 disabled:opacity-50 disabled:cursor-not-allowed`,children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Assigning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4"}),"Assign Mission"]})})]})]})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(H,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Select a Drone"}),e.jsx("p",{className:"text-text-secondary",children:"Choose a drone from the list to see assignment details"})]})})})]})]})})},ca=({mission:t,onAssigned:s,className:a=""})=>{const r=F(x=>Object.values(x.drones)),{assignMissionToDrone:n,missions:c}=T(),[o,d]=i.useState(!1),[h,p]=i.useState(!1),f=()=>r.filter(x=>!(x.status==="maintenance"||x.status==="emergency"||x.batteryLevel<30||Object.values(c).some(u=>u.assignedDrone===x.id&&["pending","active","paused"].includes(u.status)))),m=()=>{var u;const x=f();if(x.length===0)return null;const b=x.map(k=>{let y=0;if(y+=Math.floor(k.batteryLevel*.3),y+=Math.floor(k.signalStrength*.2),k.status==="idle"?y+=30:k.status==="charging"?y+=20:(k.status==="active"||k.status==="in_flight")&&(y+=10),t.waypoints&&t.waypoints.length>0){const N=g(k.position,t.waypoints[0].position),L=Math.max(0,20-N/5e3);y+=L}return{drone:k,score:y}});return b.sort((k,y)=>y.score-k.score),((u=b[0])==null?void 0:u.drone)||null},g=(x,b)=>{const k=x.lat*Math.PI/180,y=b.lat*Math.PI/180,N=(b.lat-x.lat)*Math.PI/180,L=(b.lng-x.lng)*Math.PI/180,w=Math.sin(N/2)*Math.sin(N/2)+Math.cos(k)*Math.cos(y)*Math.sin(L/2)*Math.sin(L/2);return 6371e3*(2*Math.atan2(Math.sqrt(w),Math.sqrt(1-w)))},l=async x=>{d(!0);try{await n(t.id,x),s==null||s(t.id,x),p(!1)}catch(b){console.error("Failed to assign mission:",b)}finally{d(!1)}},j=f(),S=m();if(t.assignedDrone){const x=r.find(b=>b.id===t.assignedDrone);return e.jsxs("div",{className:`flex items-center gap-2 text-sm ${a}`,children:[e.jsx(_,{className:"w-4 h-4 text-status-operational"}),e.jsx("span",{className:"text-text-secondary",children:"Assigned to:"}),e.jsx("span",{className:"text-text-primary font-medium",children:(x==null?void 0:x.name)||t.assignedDrone})]})}return j.length===0?e.jsxs("div",{className:`flex items-center gap-2 text-sm text-status-critical ${a}`,children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"No available drones"})]}):e.jsx("div",{className:`relative ${a}`,children:h?e.jsxs(E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:`absolute top-0 left-0 z-10 bg-dark-secondary border border-dark-border 
                     rounded-lg shadow-lg p-3 min-w-80`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:"Choose Drone"}),e.jsx("button",{onClick:()=>p(!1),className:"text-text-secondary hover:text-text-primary",children:e.jsx(W,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:j.map(x=>{const b=x.id===(S==null?void 0:S.id),u=x.batteryLevel<50||x.signalStrength<70;return e.jsxs("button",{onClick:()=>l(x.id),disabled:o,className:`w-full p-3 text-left border border-dark-border hover:border-dark-hover 
                           rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed
                           hover:bg-dark-hover`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-text-primary",children:x.name}),b&&e.jsx("span",{className:"px-2 py-0.5 bg-status-active text-white text-xs rounded-full",children:"Best Match"})]}),u&&e.jsx(R,{className:"w-4 h-4 text-status-warning"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs text-text-secondary",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Battery:"}),e.jsxs("div",{className:`font-medium ${x.batteryLevel>70?"text-status-operational":x.batteryLevel>30?"text-status-warning":"text-status-critical"}`,children:[x.batteryLevel,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Signal:"}),e.jsxs("div",{className:"text-text-primary font-medium",children:[x.signalStrength,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Status:"}),e.jsx("div",{className:"text-text-primary font-medium capitalize",children:x.status})]})]}),t.waypoints&&t.waypoints.length>0&&e.jsxs("div",{className:"mt-2 text-xs text-text-secondary",children:["Distance to start: ",(g(x.position,t.waypoints[0].position)/1e3).toFixed(1),"km"]})]},x.id)})})]}):e.jsx("div",{className:"flex items-center gap-2",children:S&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>l(S.id),disabled:o,className:`flex items-center gap-2 px-3 py-2 bg-status-active hover:bg-status-active/80 
                         text-white rounded-lg text-sm font-medium transition-colors
                         disabled:opacity-50 disabled:cursor-not-allowed`,children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Assigning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4"}),"Auto-assign to ",S.name]})}),e.jsxs("button",{onClick:()=>p(!0),className:`px-3 py-2 border border-dark-border hover:border-dark-hover 
                         text-text-secondary hover:text-text-primary rounded-lg text-sm transition-colors`,children:["Choose Drone (",j.length," available)"]})]})})})},da=({className:t=""})=>{const{missions:s,missionStats:a,selectedMissionId:r,selectMission:n,deleteMission:c,updateMission:o}=T(),[d,h]=i.useState(!1),[p,f]=i.useState(null),[m,g]=i.useState(""),[l,j]=i.useState("all"),[S,x]=i.useState("all"),b=Object.values(s),u=b.filter(v=>{var C;return!(m&&!v.name.toLowerCase().includes(m.toLowerCase())&&!((C=v.description)!=null&&C.toLowerCase().includes(m.toLowerCase()))||l!=="all"&&v.status!==l||S!=="all"&&(S==="high"&&v.priority<7||S==="medium"&&(v.priority<4||v.priority>6)||S==="low"&&v.priority>3))}),k=[...u].sort((v,C)=>v.status==="active"&&C.status!=="active"?-1:C.status==="active"&&v.status!=="active"?1:v.priority!==C.priority?C.priority-v.priority:new Date(C.createdAt).getTime()-new Date(v.createdAt).getTime()),y=v=>{switch(v){case"active":return"text-status-operational bg-status-operational/10 border-status-operational/20";case"completed":return"text-status-active bg-status-active/10 border-status-active/20";case"pending":return"text-status-warning bg-status-warning/10 border-status-warning/20";case"failed":return"text-status-critical bg-status-critical/10 border-status-critical/20";case"cancelled":return"text-text-secondary bg-text-secondary/10 border-text-secondary/20";case"paused":return"text-status-warning bg-status-warning/10 border-status-warning/20";default:return"text-text-secondary bg-text-secondary/10 border-text-secondary/20"}},N=v=>v>=8?"text-red-400":v>=6?"text-orange-400":v>=4?"text-yellow-400":"text-blue-400",L=async(v,C)=>{try{await o(v.id,{status:C})}catch(D){console.error("Failed to update mission status:",D)}},w=async v=>{if(window.confirm("Are you sure you want to delete this mission?"))try{await c(v)}catch(C){console.error("Failed to delete mission:",C)}},M=v=>new Date(v).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),A=v=>{if(!v)return"N/A";const C=Math.floor(v/3600),D=Math.floor(v%3600/60);return C>0?`${C}h ${D}m`:`${D}m`};return e.jsxs("div",{className:`space-y-6 ${t}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Missions"}),e.jsxs("p",{className:"text-text-secondary mt-1",children:[b.length," total missions",a&&e.jsxs("span",{className:"ml-4",children:[a.active," active â€¢ ",a.completed," completed â€¢ ",a.pending," pending"]})]})]}),e.jsxs("button",{onClick:()=>h(!0),className:`flex items-center gap-2 px-4 py-2 bg-status-active hover:bg-status-active/80 
                   text-white rounded-lg font-medium transition-colors`,children:[e.jsx(q,{className:"w-5 h-5"}),"New Mission"]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-dark-secondary rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(he,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-text-secondary"}),e.jsx("input",{type:"text",placeholder:"Search missions...",value:m,onChange:v=>g(v.target.value),className:`w-full pl-10 pr-4 py-2 bg-dark-tertiary border border-dark-border rounded-lg
                     text-text-primary placeholder-text-secondary focus:outline-none 
                     focus:ring-2 focus:ring-status-active`})]}),e.jsxs("select",{value:l,onChange:v=>j(v.target.value),className:`px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg
                   text-text-primary focus:outline-none focus:ring-2 focus:ring-status-active`,children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"paused",children:"Paused"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsxs("select",{value:S,onChange:v=>x(v.target.value),className:`px-3 py-2 bg-dark-tertiary border border-dark-border rounded-lg
                   text-text-primary focus:outline-none focus:ring-2 focus:ring-status-active`,children:[e.jsx("option",{value:"all",children:"All Priority"}),e.jsx("option",{value:"high",children:"High (7-10)"}),e.jsx("option",{value:"medium",children:"Medium (4-6)"}),e.jsx("option",{value:"low",children:"Low (1-3)"})]}),e.jsxs("div",{className:"flex items-center text-text-secondary",children:[e.jsx(Ut,{className:"w-4 h-4 mr-2"}),u.length," of ",b.length]})]}),e.jsx("div",{className:"space-y-3",children:e.jsx(P,{children:k.map(v=>{var C;return e.jsx(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`p-4 bg-dark-secondary rounded-lg border border-dark-border
                        hover:border-dark-hover transition-colors cursor-pointer
                        ${r===v.id?"ring-2 ring-status-active":""}`,onClick:()=>n(r===v.id?null:v.id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:v.name}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${y(v.status)}`,children:v.status.toUpperCase()}),e.jsxs("span",{className:`text-sm font-medium ${N(v.priority)}`,children:["Priority ",v.priority]})]}),v.description&&e.jsx("p",{className:"text-text-secondary text-sm mb-3 line-clamp-2",children:v.description}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Waypoints:"}),e.jsx("div",{className:"text-text-primary font-medium",children:((C=v.waypoints)==null?void 0:C.length)||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Progress:"}),e.jsxs("div",{className:"text-text-primary font-medium",children:[v.progress,"%",v.status==="active"&&e.jsx("div",{className:"w-full bg-dark-border rounded-full h-1.5 mt-1",children:e.jsx("div",{className:"bg-status-active h-1.5 rounded-full transition-all duration-300",style:{width:`${v.progress}%`}})})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:v.assignedDrone?"Assigned:":"Created:"}),e.jsx("div",{className:"text-text-primary font-medium",children:v.assignedDrone||M(v.createdAt)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Duration:"}),e.jsx("div",{className:"text-text-primary font-medium",children:v.actualDuration?A(v.actualDuration):v.estimatedDuration?`~${A(v.estimatedDuration)}`:"N/A"})]})]}),v.status==="pending"&&e.jsx("div",{className:"mt-4 pt-3 border-t border-dark-border",children:e.jsx(ca,{mission:v,onAssigned:()=>{console.log("Mission assigned successfully")}})})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[v.status==="pending"&&e.jsx("button",{onClick:D=>{D.stopPropagation(),L(v,"active")},className:"p-2 text-status-operational hover:bg-status-operational/10 rounded-lg transition-colors",title:"Start mission",children:e.jsx(pe,{className:"w-4 h-4"})}),v.status==="active"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:D=>{D.stopPropagation(),L(v,"paused")},className:"p-2 text-status-warning hover:bg-status-warning/10 rounded-lg transition-colors",title:"Pause mission",children:e.jsx(Gt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:D=>{D.stopPropagation(),L(v,"cancelled")},className:"p-2 text-status-critical hover:bg-status-critical/10 rounded-lg transition-colors",title:"Stop mission",children:e.jsx(rs,{className:"w-4 h-4"})})]}),v.status==="paused"&&e.jsx("button",{onClick:D=>{D.stopPropagation(),L(v,"active")},className:"p-2 text-status-operational hover:bg-status-operational/10 rounded-lg transition-colors",title:"Resume mission",children:e.jsx(pe,{className:"w-4 h-4"})}),v.status==="pending"&&!v.assignedDrone&&e.jsx("button",{onClick:D=>{D.stopPropagation(),f(v)},className:`p-2 text-text-secondary hover:text-status-active hover:bg-status-active/10 
                               rounded-lg transition-colors`,title:"Assign to drone",children:e.jsx(H,{className:"w-4 h-4"})}),e.jsx("button",{onClick:D=>{D.stopPropagation(),n(v.id)},className:`p-2 text-text-secondary hover:text-text-primary hover:bg-dark-hover 
                             rounded-lg transition-colors`,title:"View details",children:e.jsx(oe,{className:"w-4 h-4"})}),["pending","paused"].includes(v.status)&&e.jsx("button",{onClick:D=>{D.stopPropagation(),console.log("Edit mission:",v.id)},className:`p-2 text-text-secondary hover:text-status-warning hover:bg-status-warning/10 
                               rounded-lg transition-colors`,title:"Edit mission",children:e.jsx(Re,{className:"w-4 h-4"})}),!["active"].includes(v.status)&&e.jsx("button",{onClick:D=>{D.stopPropagation(),w(v.id)},className:`p-2 text-text-secondary hover:text-status-critical hover:bg-status-critical/10 
                               rounded-lg transition-colors`,title:"Delete mission",children:e.jsx(Te,{className:"w-4 h-4"})})]})]})},v.id)})})}),k.length===0&&e.jsx("div",{className:"text-center py-12",children:m||l!=="all"||S!=="all"?e.jsxs("div",{children:[e.jsx(he,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"No missions found"}),e.jsx("p",{className:"text-text-secondary mb-4",children:"No missions match your current filters"}),e.jsx("button",{onClick:()=>{g(""),j("all"),x("all")},className:`px-4 py-2 bg-dark-tertiary hover:bg-dark-hover text-text-primary 
                         rounded-lg transition-colors`,children:"Clear Filters"})]}):e.jsxs("div",{children:[e.jsx(q,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"No missions created"}),e.jsx("p",{className:"text-text-secondary mb-4",children:"Create your first mission to get started"}),e.jsx("button",{onClick:()=>h(!0),className:`px-6 py-2 bg-status-active hover:bg-status-active/80 text-white 
                         rounded-lg font-medium transition-colors`,children:"Create Mission"})]})}),e.jsx(le,{isOpen:d,onClose:()=>h(!1),onMissionCreated:()=>{console.log("Mission created successfully")}}),p&&e.jsx(Ze,{mission:p,isOpen:!0,onClose:()=>f(null),onAssigned:()=>{f(null),console.log("Mission assigned successfully")}})]})},we=({className:t="",compact:s=!1})=>{var b;const{missions:a,activeMissions:r,missionStats:n,selectMission:c,assignMissionToDrone:o}=T(),d=F(u=>{const k=u.selectedDroneId;return k?u.drones[k]:null}),h=sa(),[p,f]=i.useState(!1),[m,g]=i.useState(!1),l=d?Object.values(a).filter(u=>u.assignedDrone===d.id):[],j=u=>{switch(u){case"active":return"text-status-operational";case"completed":return"text-status-active";case"pending":return"text-status-warning";case"failed":return"text-status-critical";case"cancelled":return"text-text-secondary";case"paused":return"text-status-warning";default:return"text-text-secondary"}},S=async u=>{if(d)try{await o(u,d.id)}catch(k){console.error("Failed to assign mission:",k)}},x=u=>new Date(u).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return s?e.jsxs("div",{className:`bg-dark-secondary rounded-lg border border-dark-border p-4 ${t}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),"Missions"]}),e.jsx("button",{onClick:()=>f(!0),className:"p-1 text-text-secondary hover:text-status-active transition-colors",children:e.jsx(q,{className:"w-4 h-4"})})]}),n&&e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4 text-sm",children:[e.jsxs("div",{className:"text-center p-2 bg-dark-tertiary rounded",children:[e.jsx("div",{className:"text-status-operational font-medium",children:n.active}),e.jsx("div",{className:"text-text-secondary text-xs",children:"Active"})]}),e.jsxs("div",{className:"text-center p-2 bg-dark-tertiary rounded",children:[e.jsx("div",{className:"text-status-warning font-medium",children:n.pending}),e.jsx("div",{className:"text-text-secondary text-xs",children:"Pending"})]}),e.jsxs("div",{className:"text-center p-2 bg-dark-tertiary rounded",children:[e.jsx("div",{className:"text-status-active font-medium",children:n.today}),e.jsx("div",{className:"text-text-secondary text-xs",children:"Today"})]})]}),e.jsx("div",{className:"space-y-2",children:r.slice(0,3).map(u=>e.jsx("div",{className:"p-2 bg-dark-tertiary rounded cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>c(u.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-text-primary text-sm truncate",children:u.name}),e.jsxs("div",{className:"text-xs text-text-secondary",children:[u.assignedDrone||"Unassigned"," â€¢ ",u.progress,"%"]})]}),e.jsx("div",{className:"w-8 h-1 bg-dark-border rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-status-active transition-all",style:{width:`${u.progress}%`}})})]})},u.id))}),r.length===0&&e.jsx("div",{className:"text-center text-text-secondary text-sm py-4",children:"No active missions"}),e.jsx(le,{isOpen:p,onClose:()=>f(!1)})]}):e.jsxs("div",{className:`bg-dark-secondary rounded-lg border border-dark-border ${t}`,children:[e.jsxs("div",{className:"p-4 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h2",{className:"text-lg font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(B,{className:"w-6 h-6"}),"Mission Control"]}),e.jsxs("button",{onClick:()=>f(!0),className:`px-3 py-1 bg-status-active hover:bg-status-active/80 text-white 
                     rounded text-sm font-medium transition-colors flex items-center gap-1`,children:[e.jsx(q,{className:"w-4 h-4"}),"New"]})]}),n&&e.jsxs("div",{className:"grid grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-status-operational font-medium",children:n.active}),e.jsx("div",{className:"text-text-secondary text-xs",children:"Active"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-status-warning font-medium",children:n.pending}),e.jsx("div",{className:"text-text-secondary text-xs",children:"Pending"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-status-active font-medium",children:n.completed}),e.jsx("div",{className:"text-text-secondary text-xs",children:"Completed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-text-primary font-medium",children:n.today}),e.jsx("div",{className:"text-text-secondary text-xs",children:"Today"})]})]})]}),e.jsx("div",{className:"p-4 space-y-4",children:h?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:h.name}),e.jsx("p",{className:"text-sm text-text-secondary",children:h.description})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${j(h.status)}`,children:h.status.toUpperCase()})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-text-secondary",children:"Progress"}),e.jsxs("span",{className:"text-text-primary font-medium",children:[h.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-dark-border rounded-full h-2",children:e.jsx("div",{className:"bg-status-active h-2 rounded-full transition-all duration-300",style:{width:`${h.progress}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Priority:"}),e.jsxs("div",{className:"text-text-primary font-medium",children:["Level ",h.priority]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Waypoints:"}),e.jsx("div",{className:"text-text-primary font-medium",children:((b=h.waypoints)==null?void 0:b.length)||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Assigned:"}),e.jsx("div",{className:"text-text-primary font-medium",children:h.assignedDrone||"Unassigned"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Created:"}),e.jsx("div",{className:"text-text-primary font-medium",children:x(h.createdAt)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[h.waypoints&&h.waypoints.length>0&&e.jsxs("button",{onClick:()=>g(!m),className:`flex items-center gap-1 px-3 py-2 bg-dark-tertiary hover:bg-dark-hover 
                           text-text-primary rounded text-sm transition-colors`,children:[e.jsx(J,{className:"w-4 h-4"}),m?"Hide":"Show"," Waypoints"]}),d&&h.status==="pending"&&!h.assignedDrone&&e.jsxs("button",{onClick:()=>S(h.id),className:`flex items-center gap-1 px-3 py-2 bg-status-active hover:bg-status-active/80 
                           text-white rounded text-sm transition-colors`,children:["Assign to ",d.name]})]}),e.jsx(P,{children:m&&h.waypoints&&e.jsx(E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-dark-border pt-4",children:e.jsx(Oe,{waypoints:h.waypoints,onWaypointsChange:()=>{},disabled:!0})})})]}):d&&l.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-medium text-text-primary",children:[d.name," Missions (",l.length,")"]}),l.map(u=>{var k;return e.jsx("div",{className:"p-3 bg-dark-tertiary rounded-lg cursor-pointer hover:bg-dark-hover transition-colors",onClick:()=>c(u.id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-text-primary",children:u.name}),e.jsx("p",{className:"text-sm text-text-secondary truncate",children:u.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-text-secondary",children:[e.jsxs("span",{children:["Priority ",u.priority]}),e.jsxs("span",{children:[((k=u.waypoints)==null?void 0:k.length)||0," waypoints"]}),e.jsxs("span",{children:[u.progress,"% complete"]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs ${j(u.status)}`,children:u.status}),e.jsx("button",{onClick:y=>{y.stopPropagation(),c(u.id)},className:"p-1 text-text-secondary hover:text-text-primary transition-colors",children:e.jsx(oe,{className:"w-4 h-4"})})]})]})},u.id)})]}):e.jsx("div",{className:"text-center py-8",children:d?e.jsxs("div",{children:[e.jsx(B,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"No missions assigned"}),e.jsxs("p",{className:"text-text-secondary mb-4",children:[d.name," has no missions assigned"]}),e.jsx("button",{onClick:()=>f(!0),className:`px-4 py-2 bg-status-active hover:bg-status-active/80 text-white 
                           rounded-lg font-medium transition-colors`,children:"Create Mission"})]}):e.jsxs("div",{children:[e.jsx(Ae,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Mission Overview"}),e.jsx("p",{className:"text-text-secondary mb-4",children:"Select a drone to view its missions or create a new mission"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"p-3 bg-dark-tertiary rounded",children:[e.jsx("div",{className:"text-status-operational font-medium text-lg",children:r.length}),e.jsx("div",{className:"text-text-secondary",children:"Active Missions"})]}),e.jsxs("div",{className:"p-3 bg-dark-tertiary rounded",children:[e.jsx("div",{className:"text-text-primary font-medium text-lg",children:Object.keys(a).length}),e.jsx("div",{className:"text-text-secondary",children:"Total Missions"})]})]})]})})}),e.jsx(le,{isOpen:p,onClose:()=>f(!1)})]})},xa=({className:t=""})=>{const s=F(x=>Object.values(x.drones)),a=F(x=>x.drones),{missions:r,updateMission:n}=T(),[c,o]=i.useState(null),[d,h]=i.useState("all"),p=i.useMemo(()=>Object.values(r).filter(x=>["pending","active","paused"].includes(x.status)).map(x=>{const b=x.assignedDrone?a[x.assignedDrone]:null,u=[];let k="unassigned";return x.assignedDrone&&(b?(k="assigned",(b.status==="maintenance"||b.status==="emergency")&&(u.push(`Drone is in ${b.status} mode`),k="conflict"),b.batteryLevel<20?(u.push(`Critical battery: ${b.batteryLevel}%`),k="conflict"):b.batteryLevel<30&&u.push(`Low battery: ${b.batteryLevel}%`),b.signalStrength<30&&u.push(`Poor signal: ${b.signalStrength}%`)):(u.push("Assigned drone not found"),k="conflict")),{mission:x,drone:b,status:k,issues:u}}).sort((x,b)=>{if(x.mission.priority!==b.mission.priority)return b.mission.priority-x.mission.priority;if(x.status!==b.status){const u={conflict:0,unassigned:1,assigned:2};return u[x.status]-u[b.status]}return new Date(b.mission.createdAt).getTime()-new Date(x.mission.createdAt).getTime()}),[r,a]),f=p.filter(x=>{switch(d){case"assigned":return x.status==="assigned"&&x.issues.length===0;case"unassigned":return x.status==="unassigned";case"issues":return x.status==="conflict"||x.issues.length>0;default:return!0}}),m=x=>{switch(x.status){case"assigned":return x.issues.length>0?e.jsx(R,{className:"w-5 h-5 text-status-warning"}):e.jsx(_,{className:"w-5 h-5 text-status-operational"});case"conflict":return e.jsx(Z,{className:"w-5 h-5 text-status-critical"});case"unassigned":default:return e.jsx(X,{className:"w-5 h-5 text-text-secondary"})}},g=x=>{switch(x.status){case"assigned":return x.issues.length>0?"border-status-warning bg-status-warning/5":"border-status-operational bg-status-operational/5";case"conflict":return"border-status-critical bg-status-critical/5";case"unassigned":default:return"border-text-secondary bg-text-secondary/5"}},l=async x=>{try{await n(x,{assignedDrone:void 0})}catch(b){console.error("Failed to unassign mission:",b)}},j=()=>s.filter(x=>["maintenance","emergency"].includes(x.status)||x.batteryLevel<30?!1:!Object.values(r).some(u=>u.assignedDrone===x.id&&["pending","active","paused"].includes(u.status))).length,S={total:p.length,assigned:p.filter(x=>x.status==="assigned"&&x.issues.length===0).length,unassigned:p.filter(x=>x.status==="unassigned").length,issues:p.filter(x=>x.status==="conflict"||x.issues.length>0).length,availableDrones:j()};return e.jsxs("div",{className:`space-y-6 ${t}`,children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Assignment Manager"}),e.jsxs("p",{className:"text-text-secondary mt-1",children:["Manage mission-to-drone assignments â€¢ ",S.availableDrones," drones available"]})]})}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-dark-secondary rounded-lg border border-dark-border p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-text-primary",children:S.total}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Total Missions"})]}),e.jsxs("div",{className:"bg-dark-secondary rounded-lg border border-dark-border p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-status-operational",children:S.assigned}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Assigned"})]}),e.jsxs("div",{className:"bg-dark-secondary rounded-lg border border-dark-border p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-text-secondary",children:S.unassigned}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Unassigned"})]}),e.jsxs("div",{className:"bg-dark-secondary rounded-lg border border-dark-border p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-status-warning",children:S.issues}),e.jsx("div",{className:"text-sm text-text-secondary",children:"Issues"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-dark-secondary rounded-lg border border-dark-border",children:[e.jsx("span",{className:"text-text-secondary font-medium",children:"Filter:"}),e.jsx("div",{className:"flex gap-2",children:[{value:"all",label:`All (${S.total})`},{value:"assigned",label:`Assigned (${S.assigned})`},{value:"unassigned",label:`Unassigned (${S.unassigned})`},{value:"issues",label:`Issues (${S.issues})`}].map(x=>e.jsx("button",{onClick:()=>h(x.value),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${d===x.value?"bg-status-active text-white":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:x.label},x.value))})]}),e.jsx("div",{className:"space-y-3",children:e.jsx(P,{children:f.map(x=>{var b;return e.jsx(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`p-6 rounded-lg border-2 transition-all ${g(x)}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[m(x),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:x.mission.name}),e.jsxs("p",{className:"text-sm text-text-secondary",children:["Priority ",x.mission.priority," â€¢ ",((b=x.mission.waypoints)==null?void 0:b.length)||0," waypoints"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Mission Status"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Status:"}),e.jsx("span",{className:"text-text-primary capitalize",children:x.mission.status})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Progress:"}),e.jsxs("span",{className:"text-text-primary",children:[x.mission.progress,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Created:"}),e.jsx("span",{className:"text-text-primary",children:new Date(x.mission.createdAt).toLocaleDateString()})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-text-primary mb-2",children:"Assignment"}),e.jsx("div",{className:"space-y-1 text-sm",children:x.drone?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Assigned to:"}),e.jsx("span",{className:"text-text-primary font-medium",children:x.drone.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Drone Status:"}),e.jsx("span",{className:"text-text-primary capitalize",children:x.drone.status})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Battery:"}),e.jsxs("span",{className:`font-medium ${x.drone.batteryLevel>70?"text-status-operational":x.drone.batteryLevel>30?"text-status-warning":"text-status-critical"}`,children:[x.drone.batteryLevel,"%"]})]})]}):e.jsx("div",{className:"text-text-secondary",children:"No drone assigned"})})]})]}),x.issues.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"font-medium text-status-warning mb-2 flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4"}),"Issues"]}),e.jsx("div",{className:"space-y-1",children:x.issues.map((u,k)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("div",{className:"w-1 h-1 bg-status-warning rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{className:"text-status-warning",children:u})]},k))})]}),x.mission.description&&e.jsx("p",{className:"text-sm text-text-secondary line-clamp-2",children:x.mission.description})]}),e.jsx("div",{className:"flex flex-col gap-2 ml-6",children:x.status==="unassigned"?e.jsxs("button",{onClick:()=>o(x.mission),className:`flex items-center gap-2 px-4 py-2 bg-status-active hover:bg-status-active/80 
                               text-white rounded-lg text-sm font-medium transition-colors`,children:[e.jsx(H,{className:"w-4 h-4"}),"Assign Drone"]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>o(x.mission),className:`flex items-center gap-2 px-4 py-2 bg-dark-tertiary hover:bg-dark-hover 
                                 text-text-primary rounded-lg text-sm font-medium transition-colors border border-dark-border`,children:[e.jsx(ie,{className:"w-4 h-4"}),"Reassign"]}),e.jsxs("button",{onClick:()=>l(x.mission.id),className:`flex items-center gap-2 px-4 py-2 text-text-secondary hover:text-status-critical 
                                 hover:bg-status-critical/10 rounded-lg text-sm transition-colors`,children:[e.jsx(Z,{className:"w-4 h-4"}),"Unassign"]})]})})]})},x.mission.id)})})}),f.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(H,{className:"w-12 h-12 mx-auto text-text-secondary opacity-50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:d==="all"?"No missions to assign":`No ${d} missions`}),e.jsx("p",{className:"text-text-secondary mb-4",children:d==="all"?"Create missions to start managing assignments":"Change the filter to see other missions"}),d!=="all"&&e.jsx("button",{onClick:()=>h("all"),className:`px-4 py-2 bg-dark-tertiary hover:bg-dark-hover text-text-primary 
                       rounded-lg transition-colors`,children:"Show All Missions"})]}),c&&e.jsx(Ze,{mission:c,isOpen:!0,onClose:()=>o(null),onAssigned:()=>{o(null)}})]})},Ne=({className:t="",onClose:s})=>{var d;const[a,r]=i.useState(!1),[n,c]=i.useState("panel"),o=[{mode:"panel",label:"Panel",icon:Ae,description:"Compact mission overview"},{mode:"list",label:"List",icon:B,description:"All missions list"},{mode:"assignments",label:"Assignments",icon:H,description:"Mission assignments"}];return a?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[10000] p-4",children:e.jsxs(E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:`bg-dark-secondary rounded-lg border border-dark-border shadow-xl
                   w-full max-w-7xl max-h-[95vh] overflow-hidden flex flex-col`,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-text-primary flex items-center gap-3",children:[e.jsx(B,{className:"w-7 h-7 text-status-active"}),"Mission Control Center"]}),e.jsx("p",{className:"text-text-secondary mt-1",children:"Manage missions, assignments, and drone operations"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex bg-dark-tertiary rounded-lg p-1",children:o.map(h=>e.jsxs("button",{onClick:()=>c(h.mode),className:`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ${n===h.mode?"bg-status-active text-white":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,title:h.description,children:[e.jsx(h.icon,{className:"w-4 h-4"}),h.label]},h.mode))}),e.jsx("button",{onClick:()=>{s?s():r(!1)},className:"p-2 hover:bg-dark-hover rounded-lg transition-colors",children:e.jsx(Z,{className:"w-5 h-5 text-text-secondary"})})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden p-6",children:e.jsxs(P,{mode:"wait",children:[n==="panel"&&e.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"h-full",children:e.jsx(we,{className:"h-full"})},"panel"),n==="list"&&e.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"h-full overflow-y-auto",children:e.jsx(da,{})},"list"),n==="assignments"&&e.jsx(E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"h-full overflow-y-auto",children:e.jsx(xa,{})},"assignments")]})}),e.jsx("div",{className:"p-6 border-t border-dark-border bg-dark-tertiary",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-text-secondary",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-status-operational rounded-full"}),e.jsx("span",{children:"Mission Service Connected"})]}),e.jsxs("div",{className:"text-text-secondary",children:["Last update: ",new Date().toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:["Current View: ",e.jsx("span",{className:"text-text-primary font-medium",children:(d=o.find(h=>h.mode===n))==null?void 0:d.label})]}),e.jsx("button",{onClick:()=>{s?s():r(!1)},className:"px-3 py-1 text-text-secondary hover:text-text-primary transition-colors",children:"Close"})]})]})})]})}):e.jsxs("div",{className:`${t}`,children:[e.jsx(we,{compact:!0}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsxs("button",{onClick:()=>r(!0),className:`flex items-center gap-2 px-4 py-2 bg-dark-tertiary hover:bg-dark-hover 
                     text-text-primary rounded-lg border border-dark-border transition-colors`,children:[e.jsx(Ft,{className:"w-4 h-4"}),"Mission Controls"]})})]})};function ma(){const{state:t,isConnected:s,error:a}=oa(),r=F(l=>Object.values(l.drones)),n=F(l=>l.selectedDroneId),c=la(),o=F(l=>l.selectDrone),[d,h]=i.useState(!1),[p,f]=i.useState(!1);i.useEffect(()=>{ia(),ta()},[]);const m=l=>{o(l)},g=(l,j)=>{console.log(`Action "${j}" requested for drone ${l}`)};return e.jsxs("div",{className:"min-h-screen bg-dark-primary text-text-primary flex",children:[e.jsxs("div",{className:`
        transition-all duration-300 ease-in-out bg-dark-secondary border-r border-dark-border
        ${d?"w-16":"w-80"}
        flex flex-col h-screen
      `,children:[e.jsxs("div",{className:"p-4 border-b border-dark-border flex items-center justify-between",children:[!d&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Fleet Control"}),e.jsx("p",{className:"text-text-secondary text-xs",children:"5 drones active"})]}),e.jsx("button",{onClick:()=>h(!d),className:"p-2 hover:bg-dark-hover rounded-lg transition-colors",title:d?"Expand sidebar":"Collapse sidebar",children:d?e.jsx(Lt,{className:"w-5 h-5 text-text-secondary"}):e.jsx(Dt,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[!d&&e.jsx(gs,{drones:r,selectedDroneId:n||void 0,onDroneSelect:m,onDroneAction:g,className:"h-full"}),d&&e.jsx("div",{className:"p-2 space-y-2",children:r.slice(0,8).map(l=>e.jsx("button",{onClick:()=>m(l.id),className:`
                    w-full p-2 rounded-lg border transition-all duration-200
                    ${l.id===n?"border-status-active bg-status-active/10":"border-dark-border hover:border-dark-hover hover:bg-dark-hover"}
                  `,title:`${l.name} - ${l.status}`,children:e.jsx("div",{className:"w-8 h-8 mx-auto rounded-full border flex items-center justify-center",style:{backgroundColor:l.status==="active"||l.status==="in_flight"?"#238636":l.status==="charging"?"#d29922":l.status==="maintenance"?"#da3633":"#8b949e",borderColor:l.status==="active"||l.status==="in_flight"?"#238636":l.status==="charging"?"#d29922":l.status==="maintenance"?"#da3633":"#8b949e"},children:e.jsx("span",{className:"text-xs font-bold text-white",children:l.name.split("-")[1]||l.name.charAt(0)})})},l.id))})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col h-screen",children:[e.jsx("header",{className:"bg-dark-secondary border-b border-dark-border px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Multi-Drone Fleet Management System"}),e.jsx("p",{className:"text-text-secondary text-sm",children:"Real-time fleet monitoring and control dashboard"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>f(!0),className:`flex items-center gap-2 px-4 py-2 bg-status-active hover:bg-status-active/80 
                         text-white rounded-lg font-medium transition-colors`,children:[e.jsx(B,{className:"w-5 h-5"}),"Mission Center"]}),e.jsx(Ns,{connectionState:t,isConnected:s,error:a||void 0})]})]})}),e.jsx("main",{className:"flex-1 p-4 overflow-hidden",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 h-full",children:[e.jsx("div",{className:"lg:col-span-2 h-full overflow-hidden",children:e.jsx(us,{drones:r,selectedDroneId:n||void 0,onDroneSelect:m,className:"h-full w-full"})}),e.jsxs("div",{className:"lg:col-span-1 h-full overflow-hidden flex flex-col gap-4",children:[e.jsx("div",{className:"flex-1 border border-dark-border rounded-lg bg-dark-secondary overflow-hidden",children:e.jsx(bs,{drone:c,isLive:s,className:"h-full w-full"})}),e.jsx("div",{className:"flex-1",children:e.jsx(ks,{className:"h-full"})}),e.jsx("div",{className:"flex-1",children:e.jsx(Ne,{})})]})]})})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",onClick:l=>{l.target===l.currentTarget&&f(!1)},children:e.jsx("div",{className:`bg-dark-secondary rounded-lg border border-dark-border shadow-2xl
                         w-full max-w-7xl max-h-[95vh] overflow-hidden relative z-[10000]`,onClick:l=>l.stopPropagation(),children:e.jsx(Ne,{className:"h-full",onClose:()=>f(!1)})})})]})}ne.createRoot(document.getElementById("root")).render(e.jsx(ke.StrictMode,{children:e.jsx(ma,{})}));
//# sourceMappingURL=index-DTX5PRQV.js.map
