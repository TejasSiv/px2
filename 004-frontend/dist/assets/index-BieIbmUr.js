var ne=Object.defineProperty;var ie=(s,t,a)=>t in s?ne(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var v=(s,t,a)=>ie(s,typeof t!="symbol"?t+"":t,a);import{r as c,a as le,g as oe,R as H}from"./vendor-DJ1oPbzn.js";import{M as Z,P as G,l as Q,a as ce,b as de,T as me,u as ue}from"./maps-DYzuhxqw.js";import{m as y,A as R}from"./ui-Bb994duZ.js";import{R as xe,L as he,C as pe,X as ge,Y as fe,T as ve,a as ye,b as be}from"./charts-WATkrfCP.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const u of n)if(u.type==="childList")for(const o of u.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(n){const u={};return n.integrity&&(u.integrity=n.integrity),n.referrerPolicy&&(u.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?u.credentials="include":n.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(n){if(n.ep)return;n.ep=!0;const u=a(n);fetch(n.href,u)}})();var q={exports:{}},D={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var je=c,we=Symbol.for("react.element"),Ne=Symbol.for("react.fragment"),ke=Object.prototype.hasOwnProperty,Se=je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ce={key:!0,ref:!0,__self:!0,__source:!0};function Y(s,t,a){var r,n={},u=null,o=null;a!==void 0&&(u=""+a),t.key!==void 0&&(u=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)ke.call(t,r)&&!Ce.hasOwnProperty(r)&&(n[r]=t[r]);if(s&&s.defaultProps)for(r in t=s.defaultProps,t)n[r]===void 0&&(n[r]=t[r]);return{$$typeof:we,type:s,key:u,ref:o,props:n,_owner:Se.current}}D.Fragment=Ne;D.jsx=Y;D.jsxs=Y;q.exports=D;var e=q.exports,$={},I=le;$.createRoot=I.createRoot,$.hydrateRoot=I.hydrateRoot;function Me({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const F=c.forwardRef(Me);function De({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 10.5h.375c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125H21M3.75 18h15A2.25 2.25 0 0 0 21 15.75v-6a2.25 2.25 0 0 0-2.25-2.25h-15A2.25 2.25 0 0 0 1.5 9.75v6A2.25 2.25 0 0 0 3.75 18Z"}))}const E=c.forwardRef(De);function Ee({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))}const Le=c.forwardRef(Ee);function Ae({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const C=c.forwardRef(Ae);function $e({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const Re=c.forwardRef($e);function Te({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}const Oe=c.forwardRef(Te);function Ie({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const X=c.forwardRef(Ie);function Fe({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 0 0 2.25-2.25V6.75a2.25 2.25 0 0 0-2.25-2.25H6.75A2.25 2.25 0 0 0 4.5 6.75v10.5a2.25 2.25 0 0 0 2.25 2.25Zm.75-12h9v9h-9v-9Z"}))}const P=c.forwardRef(Fe);function Pe({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const N=c.forwardRef(Pe);function We({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const _e=c.forwardRef(We);function Be({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.362 5.214A8.252 8.252 0 0 1 12 21 8.25 8.25 0 0 1 6.038 7.047 8.287 8.287 0 0 0 9 9.601a8.983 8.983 0 0 1 3.361-6.867 8.21 8.21 0 0 0 3 2.48Z"}),c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18a3.75 3.75 0 0 0 .495-7.468 5.99 5.99 0 0 0-1.925 3.547 5.975 5.975 0 0 1-2.133-1.001A3.75 3.75 0 0 0 12 18Z"}))}const Ue=c.forwardRef(Be);function Ve({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"}))}const ze=c.forwardRef(Ve);function He({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const W=c.forwardRef(He);function Ze({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const Ge=c.forwardRef(Ze);function Qe({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}))}const _=c.forwardRef(Qe);function qe({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.348 14.652a3.75 3.75 0 0 1 0-5.304m5.304 0a3.75 3.75 0 0 1 0 5.304m-7.425 2.121a6.75 6.75 0 0 1 0-9.546m9.546 0a6.75 6.75 0 0 1 0 9.546M5.106 18.894c-3.808-3.807-3.808-9.98 0-13.788m13.788 0c3.808 3.807 3.808 9.98 0 13.788M12 12h.008v.008H12V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const J=c.forwardRef(qe);function Ye({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.288 15.038a5.25 5.25 0 0 1 7.424 0M5.106 11.856c3.807-3.808 9.98-3.808 13.788 0M1.924 8.674c5.565-5.565 14.587-5.565 20.152 0M12.53 18.22l-.53.53-.53-.53a.75.75 0 0 1 1.06 0Z"}))}const T=c.forwardRef(Ye);function Xe({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const M=c.forwardRef(Xe);function Je({title:s,titleId:t,...a},r){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},a),s?c.createElement("title",{id:t},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Ke=c.forwardRef(Je),et=({drone:s,isSelected:t,onSelect:a,getBatteryColor:r,getStatusColor:n})=>{const u=()=>{const m=n(s.status),h=r(s.batteryLevel),l=s.batteryLevel<30;return Q.divIcon({html:`
        <div class="relative">
          <!-- Pulse animation for selected drone -->
          ${t?`
            <div class="absolute inset-0 animate-ping">
              <div class="w-6 h-6 bg-blue-400 rounded-full opacity-30"></div>
            </div>
          `:""}
          
          <!-- Low battery warning pulse -->
          ${l?`
            <div class="absolute inset-0 animate-pulse">
              <div class="w-6 h-6 bg-red-400 rounded-full opacity-40"></div>
            </div>
          `:""}
          
          <!-- Main drone icon -->
          <div class="relative w-6 h-6 rounded-full border-2 flex items-center justify-center transform transition-transform hover:scale-110"
               style="background-color: #161b22; border-color: ${m}">
            <!-- Drone symbol -->
            <svg class="w-3 h-3" style="color: ${m}" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2l3.5 3.5h-7L12 2zM5.5 8.5L2 12l3.5 3.5V8.5zM18.5 8.5v7L22 12l-3.5-3.5zM8.5 18.5L12 22l3.5-3.5h-7z"/>
              <circle cx="12" cy="12" r="2"/>
            </svg>
          </div>
          
          <!-- Battery indicator -->
          <div class="absolute -bottom-1 -right-1 w-3 h-1.5 rounded-sm border"
               style="background-color: ${h}; border-color: #30363d">
          </div>
          
          <!-- Status indicator dot -->
          <div class="absolute -top-1 -right-1 w-2 h-2 rounded-full"
               style="background-color: ${m}">
          </div>
        </div>
      `,className:"drone-marker",iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]})},o=m=>{const h=new Date(m),d=new Date().getTime()-h.getTime(),i=Math.floor(d/1e3);return i<60?`${i}s ago`:i<3600?`${Math.floor(i/60)}m ago`:`${Math.floor(i/3600)}h ago`},p=(m=>m>-50?{level:"Excellent",color:"#238636"}:m>-70?{level:"Good",color:"#d29922"}:m>-90?{level:"Poor",color:"#da3633"}:{level:"Very Poor",color:"#f85149"})(s.signalStrength);return!s.position.lat||!s.position.lng?null:e.jsx(Z,{position:[s.position.lat,s.position.lng],icon:u(),eventHandlers:{click:a},children:e.jsx(G,{className:"drone-popup",maxWidth:320,minWidth:280,children:e.jsxs("div",{className:"bg-dark-secondary text-text-primary p-4 rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.name}),e.jsx("p",{className:"text-text-secondary text-sm",children:s.id})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium",style:{backgroundColor:n(s.status)+"20",color:n(s.status)},children:s.status.toUpperCase()})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(E,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Battery"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-dark-border rounded-full h-1.5",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-300",style:{width:`${s.batteryLevel}%`,backgroundColor:r(s.batteryLevel)}})}),e.jsxs("span",{className:"text-sm font-mono",children:[s.batteryLevel,"%"]})]})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(J,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Signal"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs",style:{color:p.color},children:p.level}),e.jsxs("span",{className:"text-sm font-mono text-text-secondary",children:[s.signalStrength,"dBm"]})]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Altitude"}),e.jsxs("span",{className:"font-mono",children:[s.position.alt.toFixed(1),"m"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Speed"}),e.jsxs("span",{className:"font-mono",children:[s.speed.toFixed(1)," m/s"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Heading"}),e.jsxs("span",{className:"font-mono",children:[s.heading.toFixed(0),"°"]})]})]}),s.currentMission&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-status-active"}),e.jsx("span",{className:"text-sm font-medium",children:"Active Mission"})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Mission"}),e.jsx("span",{children:s.currentMission.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Progress"}),e.jsxs("span",{children:[s.currentMission.progress,"%"]})]}),s.currentMission.eta&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"ETA"}),e.jsx("span",{children:s.currentMission.eta})]})]})]}),s.alerts&&s.alerts.length>0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(N,{className:"w-4 h-4 text-status-warning"}),e.jsxs("span",{className:"text-sm font-medium text-status-warning",children:[s.alerts.length," Alert",s.alerts.length>1?"s":""]})]}),e.jsxs("div",{className:"space-y-1",children:[s.alerts.slice(0,2).map((m,h)=>e.jsx("div",{className:"text-xs p-2 bg-dark-primary rounded border-l-2",style:{borderLeftColor:m.severity==="critical"?"#da3633":"#d29922"},children:m.message},h)),s.alerts.length>2&&e.jsxs("p",{className:"text-xs text-text-secondary",children:["+",s.alerts.length-2," more alerts"]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-border text-xs text-text-muted",children:["Last updated: ",o(s.lastUpdate)]})]})})})},tt=({mission:s})=>{const t=o=>{switch(o.toLowerCase()){case"active":case"in_progress":return"#1f6feb";case"completed":return"#238636";case"failed":case"cancelled":return"#da3633";case"pending":default:return"#8b949e"}},a=(o,x)=>{const p=o.completed||x<(s.currentWaypoint||0),m=x===(s.currentWaypoint||0);return Q.divIcon({html:`
        <div class="relative">
          <div class="w-4 h-4 rounded-full border-2 flex items-center justify-center text-xs font-bold"
               style="background-color: ${p?"#238636":m?"#1f6feb":"#161b22"}; 
                      border-color: ${p?"#238636":m?"#1f6feb":"#8b949e"};
                      color: #f0f6fc">
            ${x+1}
          </div>
          ${m?`
            <div class="absolute inset-0 animate-ping">
              <div class="w-4 h-4 bg-blue-400 rounded-full opacity-30"></div>
            </div>
          `:""}
        </div>
      `,className:"waypoint-marker",iconSize:[16,16],iconAnchor:[8,8],popupAnchor:[0,-8]})},r=o=>{switch(o.toLowerCase()){case"pickup":return"📦";case"delivery":return"🚚";case"hover":return"⏸️";case"survey":return"📷";default:return"📍"}};if(!s.waypoints||s.waypoints.length===0)return null;const n=s.waypoints.filter(o=>o.position.lat&&o.position.lng).map(o=>[o.position.lat,o.position.lng]);if(n.length===0)return null;const u=t(s.status);return e.jsxs(e.Fragment,{children:[e.jsx(ce,{positions:n,pathOptions:{color:u,weight:3,opacity:.8,dashArray:s.status==="pending"?"10, 5":void 0}}),s.waypoints.map((o,x)=>!o.position.lat||!o.position.lng?null:e.jsx(Z,{position:[o.position.lat,o.position.lng],icon:a(o,x),children:e.jsx(G,{className:"waypoint-popup",maxWidth:250,children:e.jsxs("div",{className:"bg-dark-secondary text-text-primary p-3 rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h4",{className:"font-semibold",children:["Waypoint ",x+1]}),e.jsx("span",{className:"text-lg",children:r(o.action)})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Action"}),e.jsx("span",{className:"capitalize",children:o.action})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Altitude"}),e.jsxs("span",{className:"font-mono",children:[o.position.alt,"m"]})]}),o.hoverTime&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Hover Time"}),e.jsxs("span",{className:"font-mono",children:[o.hoverTime,"s"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Status"}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${o.completed||x<(s.currentWaypoint||0)?"bg-green-900/30 text-green-400":x===(s.currentWaypoint||0)?"bg-blue-900/30 text-blue-400":"bg-gray-900/30 text-gray-400"}`,children:o.completed||x<(s.currentWaypoint||0)?"Completed":x===(s.currentWaypoint||0)?"Current":"Pending"})]})]}),o.notes&&e.jsx("div",{className:"mt-2 pt-2 border-t border-dark-border",children:e.jsx("p",{className:"text-xs text-text-secondary",children:o.notes})})]})})},`${s.id}-wp-${x}`))]})},st=()=>{const s=ue();return c.useEffect(()=>{const t=setTimeout(()=>{s.invalidateSize()},100);return()=>clearTimeout(t)},[s]),null},at=({drones:s,missions:t=[],selectedDroneId:a,onDroneSelect:r,className:n=""})=>{const[u,o]=c.useState([37.7749,-122.4194]),[x,p]=c.useState(12),m=c.useRef(null);c.useEffect(()=>{if(s.length>0){const d=s.filter(i=>i.position.lat&&i.position.lng);if(d.length>0){const i=d.reduce((f,j)=>f+j.position.lat,0)/d.length,g=d.reduce((f,j)=>f+j.position.lng,0)/d.length;o([i,g])}}},[s]),c.useEffect(()=>{const d=new ResizeObserver(()=>{setTimeout(()=>{window.dispatchEvent(new Event("resize"))},100)});return m.current&&d.observe(m.current),()=>{d.disconnect()}},[]);const h=d=>d>70?"#238636":d>30?"#d29922":d>15?"#da3633":"#f85149",l=d=>{switch(d.toLowerCase()){case"active":case"in_flight":return"#238636";case"charging":case"returning":return"#d29922";case"maintenance":case"emergency":return"#da3633";case"idle":default:return"#8b949e"}};return e.jsxs("div",{ref:m,className:`fleet-map-container relative h-full w-full bg-dark-primary rounded-lg overflow-hidden border border-dark-border ${n}`,children:[e.jsxs(y.div,{className:"absolute top-4 left-4 z-[1000] bg-dark-secondary/90 backdrop-blur-sm rounded-lg p-3 shadow-lg border border-dark-border",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsx("h3",{className:"text-text-primary font-semibold mb-2",children:"Fleet Overview"}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-status-operational"}),e.jsxs("span",{className:"text-text-secondary",children:[s.filter(d=>d.status==="active"||d.status==="in_flight").length," Active"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-status-warning"}),e.jsxs("span",{className:"text-text-secondary",children:[s.filter(d=>d.status==="charging"||d.status==="idle").length," Standby"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-status-critical"}),e.jsxs("span",{className:"text-text-secondary",children:[s.filter(d=>d.status==="maintenance"||d.status==="emergency").length," Issues"]})]})]})]}),e.jsx(y.div,{className:"absolute top-4 right-4 z-[1000] bg-dark-secondary/90 backdrop-blur-sm rounded-lg p-2 shadow-lg border border-dark-border",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{className:"px-3 py-1 text-xs bg-dark-tertiary hover:bg-dark-hover text-text-primary rounded border border-dark-border transition-colors",onClick:()=>p(Math.min(x+1,18)),children:"Zoom In"}),e.jsx("button",{className:"px-3 py-1 text-xs bg-dark-tertiary hover:bg-dark-hover text-text-primary rounded border border-dark-border transition-colors",onClick:()=>p(Math.max(x-1,1)),children:"Zoom Out"}),e.jsx("button",{className:"px-3 py-1 text-xs bg-dark-tertiary hover:bg-dark-hover text-text-primary rounded border border-dark-border transition-colors",onClick:()=>{if(s.length>0){const d=s.filter(i=>i.position.lat&&i.position.lng);if(d.length>0){const i=d.reduce((f,j)=>f+j.position.lat,0)/d.length,g=d.reduce((f,j)=>f+j.position.lng,0)/d.length;o([i,g]),p(12)}}},children:"Center Fleet"})]})}),e.jsx("div",{className:"absolute inset-0 w-full h-full",children:e.jsxs(de,{center:u,zoom:x,style:{height:"100%",width:"100%",minHeight:"400px"},zoomControl:!1,attributionControl:!1,className:"leaflet-container bg-dark-primary",children:[e.jsx(st,{}),e.jsx(me,{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors © <a href="https://carto.com/attributions">CARTO</a>'}),t.map(d=>e.jsx(tt,{mission:d},d.id)),s.map(d=>e.jsx(et,{drone:d,isSelected:d.id===a,onSelect:()=>r(d.id),getBatteryColor:h,getStatusColor:l},d.id))]})}),e.jsxs(y.div,{className:"absolute bottom-4 left-4 z-[1000] bg-dark-secondary/90 backdrop-blur-sm rounded-lg p-3 shadow-lg border border-dark-border",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[e.jsx("h4",{className:"text-text-primary font-medium text-sm mb-2",children:"Legend"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-status-operational border border-dark-border"}),e.jsx("span",{className:"text-text-secondary",children:"Active Drone"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-status-warning border border-dark-border"}),e.jsx("span",{className:"text-text-secondary",children:"Standby/Charging"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-status-critical border border-dark-border"}),e.jsx("span",{className:"text-text-secondary",children:"Issue/Maintenance"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-0.5 bg-status-active"}),e.jsx("span",{className:"text-text-secondary",children:"Mission Path"})]})]})]})]})},rt=({drone:s,isSelected:t,onSelect:a,onAction:r,index:n})=>{const u=h=>{switch(h.toLowerCase()){case"active":case"in_flight":return{color:"#238636",bgColor:"#238636",label:"Active",icon:C};case"charging":return{color:"#d29922",bgColor:"#d29922",label:"Charging",icon:E};case"maintenance":return{color:"#da3633",bgColor:"#da3633",label:"Maintenance",icon:N};case"emergency":return{color:"#f85149",bgColor:"#f85149",label:"Emergency",icon:N};case"idle":default:return{color:"#8b949e",bgColor:"#8b949e",label:"Idle",icon:X}}},o=h=>{const l=new Date(h),i=new Date().getTime()-l.getTime(),g=Math.floor(i/1e3);return g<60?`${g}s ago`:g<3600?`${Math.floor(g/60)}m ago`:`${Math.floor(g/3600)}h ago`},x=u(s.status),p=x.icon,m=(h,l)=>{l.stopPropagation(),a()};return e.jsxs(y.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,delay:n*.05},onClick:a,className:`
        relative bg-dark-tertiary rounded-lg p-3 border cursor-pointer transition-all duration-200 hover:bg-dark-hover mb-2 w-full
        ${t?"border-status-active shadow-glow":"border-dark-border hover:border-dark-hover"}
      `,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxs("div",{className:"flex-shrink-0 relative",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center border",style:{backgroundColor:x.bgColor+"20",borderColor:x.color},children:e.jsx(p,{className:"w-4 h-4",style:{color:x.color}})}),s.alerts&&s.alerts.length>0&&e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-status-warning rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold text-white text-[10px]",children:s.alerts.length})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-text-primary text-sm truncate",children:s.name}),e.jsx("span",{className:"text-text-secondary text-xs font-mono",children:s.id})]}),e.jsx("div",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium mt-1",style:{backgroundColor:x.color+"20",color:x.color},children:x.label})]})]}),e.jsx("button",{onClick:h=>m("view",h),className:"p-1.5 rounded hover:bg-dark-secondary transition-colors flex-shrink-0",title:"View Details",style:{color:"#1f6feb"},children:e.jsx(_e,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-text-secondary text-xs mb-1",children:"Battery"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-dark-border rounded-full h-1.5",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-300",style:{width:`${s.batteryLevel}%`,backgroundColor:s.batteryLevel>30?"#238636":s.batteryLevel>15?"#d29922":"#da3633"}})}),e.jsxs("span",{className:"text-xs font-mono text-text-primary",children:[s.batteryLevel.toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-text-secondary text-xs mb-1",children:"Signal"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"flex items-end gap-0.5",children:[0,1,2,3].map(h=>e.jsx("div",{className:`w-0.5 rounded-sm ${h===0?"h-2":h===1?"h-3":"h-4"}`,style:{backgroundColor:s.signalStrength>-50-h*20?"#238636":"#30363d"}},h))}),e.jsxs("span",{className:"text-xs font-mono text-text-secondary",children:[s.signalStrength,"dBm"]})]})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-text-secondary text-xs mb-1",children:s.currentMission?"Mission":"Altitude"}),s.currentMission?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-status-active rounded-full"}),e.jsxs("span",{className:"truncate text-xs text-text-primary",children:[s.currentMission.progress,"%"]})]}):e.jsxs("div",{className:"text-xs text-text-primary",children:[s.position.alt.toFixed(0),"m"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2 pt-2 border-t border-dark-border text-xs",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-text-secondary",children:[s.speed.toFixed(1)," m/s"]}),s.alerts&&s.alerts.length>0&&e.jsxs("span",{className:"text-status-warning",children:[s.alerts.length," alerts"]})]}),e.jsx("span",{className:"text-text-muted",children:o(s.lastUpdate)})]})]})},nt=({stats:s})=>{const t=r=>r>70?"#238636":r>30?"#d29922":"#da3633",a=[{label:"Total Drones",value:s.total,color:"#8b949e",icon:null},{label:"Active",value:s.active,color:"#238636",icon:C},{label:"Avg Battery",value:`${s.avgBattery.toFixed(0)}%`,color:t(s.avgBattery),icon:E},{label:"Alerts",value:s.alerts,color:s.alerts>0?"#d29922":"#8b949e",icon:N,highlight:s.alerts>0}];return e.jsx("div",{className:"grid grid-cols-4 gap-4",children:a.map((r,n)=>e.jsxs(y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:n*.1},className:`text-center p-3 rounded-lg ${r.highlight?"bg-dark-tertiary border border-status-warning/30":"bg-dark-tertiary"}`,children:[r.icon&&e.jsx("div",{className:"flex justify-center mb-1",children:e.jsx(r.icon,{className:"w-4 h-4",style:{color:r.color}})}),e.jsx("div",{className:"text-xl font-bold",style:{color:r.color},children:r.value}),e.jsx("div",{className:"text-xs text-text-secondary",children:r.label})]},r.label))})},it=({drones:s,selectedDroneId:t,onDroneSelect:a,onDroneAction:r,className:n=""})=>{const[u,o]=c.useState("all"),[x,p]=c.useState("status"),m={total:s.length,active:s.filter(i=>i.status==="active"||i.status==="in_flight").length,charging:s.filter(i=>i.status==="charging").length,maintenance:s.filter(i=>i.status==="maintenance"||i.status==="emergency").length,idle:s.filter(i=>i.status==="idle").length,lowBattery:s.filter(i=>i.batteryLevel<30).length,alerts:s.reduce((i,g)=>{var f;return i+(((f=g.alerts)==null?void 0:f.length)||0)},0),avgBattery:s.length>0?s.reduce((i,g)=>i+g.batteryLevel,0)/s.length:0},h=s.filter(i=>{switch(u){case"active":return i.status==="active"||i.status==="in_flight";case"issues":return i.status==="maintenance"||i.status==="emergency"||i.alerts&&i.alerts.length>0;case"idle":return i.status==="idle"||i.status==="charging";default:return!0}}).sort((i,g)=>{switch(x){case"name":return i.name.localeCompare(g.name);case"battery":return g.batteryLevel-i.batteryLevel;case"status":const f={emergency:0,maintenance:1,active:2,in_flight:2,charging:3,idle:4};return(f[i.status]||5)-(f[g.status]||5);case"lastUpdate":return new Date(g.lastUpdate).getTime()-new Date(i.lastUpdate).getTime();default:return 0}}),l=[{value:"all",label:`All (${m.total})`,count:m.total},{value:"active",label:`Active (${m.active})`,count:m.active},{value:"issues",label:`Issues (${m.maintenance})`,count:m.maintenance},{value:"idle",label:`Idle (${m.idle+m.charging})`,count:m.idle+m.charging}],d=[{id:"1",type:"mission_complete",drone:"DRN001",message:"Delivery mission completed successfully",timestamp:new Date(Date.now()-3e5)},{id:"2",type:"battery_low",drone:"DRN003",message:"Battery level below 25%",timestamp:new Date(Date.now()-6e5)},{id:"3",type:"charging_start",drone:"DRN002",message:"Started charging at Station Alpha",timestamp:new Date(Date.now()-9e5)},{id:"4",type:"mission_start",drone:"DRN004",message:"Started emergency medical delivery",timestamp:new Date(Date.now()-12e5)},{id:"5",type:"maintenance",drone:"DRN005",message:"Scheduled maintenance completed",timestamp:new Date(Date.now()-18e5)}];return e.jsxs("div",{className:`h-full flex flex-col ${n}`,children:[e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsx(nt,{stats:m})}),e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"grid grid-cols-2 gap-1",children:l.map(i=>e.jsx("button",{onClick:()=>o(i.value),className:`px-2 py-1 rounded text-xs font-medium transition-all duration-200 ${u===i.value?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:i.label},i.value))}),e.jsxs("select",{value:x,onChange:i=>p(i.target.value),className:"w-full px-2 py-1 bg-dark-tertiary text-text-primary rounded border border-dark-border text-xs focus:outline-none focus:ring-1 focus:ring-status-active",children:[e.jsx("option",{value:"status",children:"Sort by Status"}),e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"battery",children:"Sort by Battery"}),e.jsx("option",{value:"lastUpdate",children:"Sort by Update"})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"p-2 space-y-2",children:[e.jsx(R,{mode:"popLayout",children:h.map((i,g)=>e.jsx(rt,{drone:i,isSelected:i.id===t,onSelect:()=>a(i.id),onAction:r,index:g},i.id))}),h.length===0&&e.jsxs("div",{className:"text-center py-8 text-text-secondary",children:[e.jsx(M,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No drones match filter"}),e.jsx("button",{onClick:()=>o("all"),className:"mt-2 px-2 py-1 bg-dark-tertiary text-text-primary rounded text-xs hover:bg-dark-hover transition-colors",children:"Show All"})]})]})}),e.jsx("div",{className:"border-t border-dark-border",children:e.jsxs("div",{className:"p-3",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary mb-2",children:"Recent Activity"}),e.jsx("div",{className:"space-y-1",children:d.slice(0,3).map(i=>e.jsxs("div",{className:"text-xs text-text-secondary",children:[e.jsxs("span",{className:"font-medium",children:[i.drone,":"]})," ",i.message]},i.id))})]})})]})},lt=({level:s,voltage:t,size:a="md",showLabel:r=!1,showVoltage:n=!1,className:u=""})=>{const o=i=>i>70?"#238636":i>30?"#d29922":i>15?"#da3633":"#f85149",x=()=>{switch(a){case"sm":return"w-12";case"lg":return"w-20";default:return"w-16"}},p=()=>{switch(a){case"sm":return"h-6";case"lg":return"h-10";default:return"h-8"}},m=()=>{switch(a){case"sm":return"text-xs";case"lg":return"text-base";default:return"text-sm"}},h=o(s),l=s<30,d=s<15;return e.jsxs("div",{className:`flex items-center gap-2 ${u}`,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:`${x()} ${p()} border-2 rounded-sm relative overflow-hidden`,style:{borderColor:h},children:[e.jsx(y.div,{className:"h-full rounded-sm",style:{backgroundColor:h},initial:{width:0},animate:{width:`${Math.max(s,0)}%`},transition:{duration:.5,ease:"easeOut"}}),d&&e.jsx(y.div,{className:"absolute inset-0 bg-red-500",animate:{opacity:[.3,.7,.3]},transition:{duration:1,repeat:1/0}})]}),e.jsx("div",{className:`absolute -right-1 top-1/2 transform -translate-y-1/2 w-1 bg-current rounded-r-sm ${a==="sm"?"h-2":a==="lg"?"h-4":"h-3"}`,style:{color:h}}),l&&e.jsx("div",{className:"absolute -top-1 -right-1",children:e.jsx(Le,{className:`${a==="sm"?"w-3 h-3":"w-4 h-4"} text-red-500`})})]}),r&&e.jsxs("span",{className:`font-mono font-semibold ${m()}`,style:{color:h},children:[s.toFixed(0),"%"]})]}),n&&t&&e.jsx("div",{className:`text-text-secondary ${m()}`,children:e.jsxs("span",{className:"font-mono",children:[t.toFixed(1),"V"]})}),r&&a!=="sm"&&e.jsx("div",{className:`${m()} text-text-secondary`,children:d?"Critical":l?"Low":s>80?"Excellent":"Good"})]})},ot=({strength:s,quality:t,size:a="md",showLabel:r=!1,showStrength:n=!1,className:u=""})=>{const o=i=>i>-50?{level:"Excellent",color:"#238636",bars:4}:i>-70?{level:"Good",color:"#d29922",bars:3}:i>-85?{level:"Fair",color:"#d29922",bars:2}:i>-95?{level:"Poor",color:"#da3633",bars:1}:{level:"Very Poor",color:"#f85149",bars:0},x=i=>{switch(a){case"sm":return i===0?"h-2":i===1?"h-3":i===2?"h-4":"h-5";case"lg":return i===0?"h-4":i===1?"h-6":i===2?"h-8":"h-10";default:return i===0?"h-3":i===1?"h-4":i===2?"h-5":"h-6"}},p=()=>{switch(a){case"sm":return"w-0.5";case"lg":return"w-1";default:return"w-0.5"}},m=()=>{switch(a){case"sm":return"text-xs";case"lg":return"text-base";default:return"text-sm"}},h=o(s),d=(t?{excellent:{level:"Excellent",color:"#238636",bars:4},good:{level:"Good",color:"#238636",bars:3},poor:{level:"Poor",color:"#da3633",bars:2},very_poor:{level:"Very Poor",color:"#f85149",bars:1}}[t]:null)||h;return e.jsxs("div",{className:`flex items-center gap-2 ${u}`,children:[e.jsx("div",{className:"flex items-end gap-0.5",children:[0,1,2,3].map(i=>e.jsx(y.div,{className:`${p()} ${x(i)} rounded-sm`,style:{backgroundColor:i<d.bars?d.color:"#30363d"},initial:{scaleY:0},animate:{scaleY:1},transition:{duration:.3,delay:i*.1}},i))}),r&&e.jsx("span",{className:`font-medium ${m()}`,style:{color:d.color},children:d.level}),n&&e.jsx("div",{className:`text-text-secondary ${m()}`,children:e.jsxs("span",{className:"font-mono",children:[s,"dBm"]})}),d.bars===0&&e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:`${a==="sm"?"w-3 h-3":"w-4 h-4"} text-red-500`}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-0.5 h-full bg-red-500 rotate-45"})})]})]})},ct=({data:s})=>{var p;const[t,a]=c.useState("battery"),r=[{id:"battery",label:"Battery Level",color:"#238636",unit:"%",min:0,max:100,criticalLevel:20},{id:"altitude",label:"Altitude",color:"#1f6feb",unit:"m",min:0,max:Math.max(150,Math.max(...s.map(m=>m.altitude||0))+20)},{id:"speed",label:"Ground Speed",color:"#d29922",unit:"m/s",min:0,max:Math.max(20,Math.max(...s.map(m=>m.speed||0))+5)},{id:"signal",label:"Signal Strength",color:"#8957e5",unit:"dBm",min:-100,max:-30,criticalLevel:-90}],n=r.find(m=>m.id===t),u=m=>m.map(h=>({...h,time:new Date(h.timestamp).toLocaleTimeString("en-US",{hour12:!1,minute:"2-digit",second:"2-digit"})})),o=({active:m,payload:h,label:l})=>m&&h&&h.length?e.jsxs("div",{className:"bg-dark-secondary border border-dark-border rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"text-text-secondary text-sm",children:`Time: ${l}`}),e.jsx("p",{className:"text-text-primary font-semibold",children:`${n.label}: ${h[0].value.toFixed(1)}${n.unit}`})]}):null;if(s.length===0)return e.jsxs("div",{className:"text-center text-text-secondary py-8",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📈"}),e.jsx("p",{children:"No telemetry data available"}),e.jsx("p",{className:"text-sm",children:"Charts will appear once data starts flowing"})]});const x=u(s);return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(m=>e.jsx("button",{onClick:()=>a(m.id),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${t===m.id?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:m.color}}),m.label]})},m.id))}),e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-dark-tertiary rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-text-primary font-semibold",children:[n.label," Over Time"]}),e.jsxs("div",{className:"text-text-secondary text-sm",children:["Last ",x.length," data points"]})]}),e.jsx("div",{className:"h-64",children:e.jsx(xe,{width:"100%",height:"100%",children:e.jsxs(he,{data:x,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(pe,{strokeDasharray:"3 3",stroke:"#30363d"}),e.jsx(ge,{dataKey:"time",stroke:"#8b949e",fontSize:12,interval:"preserveStartEnd"}),e.jsx(fe,{stroke:"#8b949e",fontSize:12,domain:[n.min,n.max]}),e.jsx(ve,{content:e.jsx(o,{})}),n.criticalLevel!==void 0&&e.jsx(ye,{y:n.criticalLevel,stroke:"#da3633",strokeDasharray:"5 5",label:{value:"Critical",position:"top",fill:"#da3633",fontSize:10}}),e.jsx(be,{type:"monotone",dataKey:t,stroke:n.color,strokeWidth:2,dot:{fill:n.color,strokeWidth:2,r:3},activeDot:{r:5,stroke:n.color,strokeWidth:2},connectNulls:!1})]})})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Current Value:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-text-primary",children:x.length>0&&((p=x[x.length-1][t])==null?void 0:p.toFixed(1))||"N/A"}),e.jsx("span",{className:"text-text-secondary",children:n.unit})]})]}),x.length>1&&e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:"text-text-secondary",children:"Trend:"}),(()=>{const m=x[x.length-1][t],h=x[x.length-2][t],l=m-h,d=l>0,i=l<0;return e.jsxs("div",{className:`flex items-center gap-1 text-sm ${d?"text-green-400":i?"text-red-400":"text-text-secondary"}`,children:[e.jsx("span",{children:d?"↗":i?"↘":"→"}),e.jsxs("span",{children:[Math.abs(l).toFixed(2)," ",n.unit]})]})})()]})]})]},t),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:["min","max","avg","current"].map(m=>{let h,l;const d=x.map(i=>i[t]).filter(i=>i!=null);switch(m){case"min":h=d.length>0?Math.min(...d):0,l="Minimum";break;case"max":h=d.length>0?Math.max(...d):0,l="Maximum";break;case"avg":h=d.length>0?d.reduce((i,g)=>i+g,0)/d.length:0,l="Average";break;case"current":h=d.length>0?d[d.length-1]:0,l="Current";break;default:h=0,l=""}return e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-3",children:[e.jsx("div",{className:"text-text-secondary text-sm",children:l}),e.jsx("div",{className:"text-xl font-bold text-text-primary",children:h.toFixed(1)}),e.jsx("div",{className:"text-xs text-text-secondary",children:n.unit})]},m)})})]})},dt=({alerts:s,droneId:t,onAcknowledge:a,onResolve:r,onDismiss:n})=>{const u=l=>{switch(l){case"critical":return{color:"#f85149",bgColor:"#da3633",icon:M,label:"Critical"};case"error":return{color:"#da3633",bgColor:"#da3633",icon:M,label:"Error"};case"warning":return{color:"#d29922",bgColor:"#d29922",icon:N,label:"Warning"};case"info":return{color:"#1f6feb",bgColor:"#1f6feb",icon:W,label:"Info"};default:return{color:"#8b949e",bgColor:"#8b949e",icon:W,label:"Unknown"}}},o=l=>{const d=new Date(l),g=new Date().getTime()-d.getTime(),f=Math.floor(g/1e3),j=Math.floor(f/60),O=Math.floor(j/60);return f<60?`${f}s ago`:j<60?`${j}m ago`:O<24?`${O}h ago`:d.toLocaleDateString()},x=[...s].sort((l,d)=>{const i={critical:4,error:3,warning:2,info:1},g=(i[d.severity]||0)-(i[l.severity]||0);return g!==0?g:new Date(d.timestamp).getTime()-new Date(l.timestamp).getTime()}),p=x.filter(l=>!l.resolved),m=x.filter(l=>l.resolved);if(s.length===0)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx(C,{className:"w-12 h-12 mx-auto text-status-operational mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"No Active Alerts"}),e.jsx("p",{className:"text-text-secondary",children:"All systems are operating normally"})]});const h=({alert:l,index:d})=>{const i=u(l.severity),g=i.icon;return e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:d*.1},className:`bg-dark-tertiary rounded-lg border-l-4 p-4 ${l.acknowledged?"opacity-75":""} ${l.resolved?"opacity-50":""}`,style:{borderLeftColor:i.color},children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx(g,{className:"w-5 h-5",style:{color:i.color}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium",style:{backgroundColor:i.bgColor+"20",color:i.color},children:i.label}),l.category&&e.jsx("span",{className:"px-2 py-1 bg-dark-border text-text-secondary rounded text-xs",children:l.category}),l.acknowledged&&e.jsx("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-400 rounded text-xs",children:"Acknowledged"}),l.resolved&&e.jsx("span",{className:"px-2 py-1 bg-green-900/30 text-green-400 rounded text-xs",children:"Resolved"})]}),e.jsx("p",{className:"text-text-primary text-sm mb-2",children:l.message}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-text-secondary",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-3 h-3"}),o(l.timestamp)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"Drone:"}),e.jsx("span",{className:"font-mono",children:t})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[!l.resolved&&!l.acknowledged&&a&&e.jsx("button",{onClick:()=>a(l.id),className:"px-2 py-1 bg-blue-900/30 text-blue-400 hover:bg-blue-900/50 rounded text-xs transition-colors",title:"Acknowledge alert",children:"Ack"}),l.acknowledged&&!l.resolved&&r&&e.jsx("button",{onClick:()=>r(l.id),className:"px-2 py-1 bg-green-900/30 text-green-400 hover:bg-green-900/50 rounded text-xs transition-colors",title:"Mark as resolved",children:"Resolve"}),n&&e.jsx("button",{onClick:()=>n(l.id),className:"p-1 text-text-secondary hover:text-text-primary transition-colors",title:"Dismiss alert",children:e.jsx(Ke,{className:"w-4 h-4"})})]})]})})};return e.jsxs("div",{className:"space-y-6",children:[p.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["Active Alerts (",p.length,")"]}),p.filter(l=>l.severity==="critical"||l.severity==="error").length>0&&e.jsxs("div",{className:"flex items-center gap-1 text-status-critical text-sm",children:[e.jsx(N,{className:"w-4 h-4"}),"Attention Required"]})]}),e.jsx("div",{className:"space-y-3",children:p.map((l,d)=>e.jsx(h,{alert:l,index:d},l.id))})]}),m.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:["Recent Resolved (",m.length,")"]}),e.jsx("div",{className:"space-y-3",children:m.slice(0,5).map((l,d)=>e.jsx(h,{alert:l,index:d},l.id))}),m.length>5&&e.jsxs("p",{className:"text-text-secondary text-sm mt-3 text-center",children:["+",m.length-5," more resolved alerts"]})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-text-primary mb-3",children:"Alert Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Total Alerts"}),e.jsx("div",{className:"text-xl font-bold text-text-primary",children:s.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Active"}),e.jsx("div",{className:"text-xl font-bold text-status-warning",children:p.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Critical"}),e.jsx("div",{className:"text-xl font-bold text-status-critical",children:s.filter(l=>l.severity==="critical"&&!l.resolved).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Resolved"}),e.jsx("div",{className:"text-xl font-bold text-status-operational",children:m.length})]})]})]})]})},mt=({drone:s,isLive:t=!0,className:a=""})=>{var h;const[r,n]=c.useState("overview"),[u,o]=c.useState([]);if(c.useEffect(()=>{if(s&&t){const l={timestamp:Date.now(),battery:s.batteryLevel,altitude:s.position.alt,speed:s.speed,signalStrength:s.signalStrength};o(d=>[...d,l].slice(-50))}},[s,t]),!s)return e.jsx("div",{className:`h-full w-full flex items-center justify-center ${a}`,children:e.jsxs("div",{className:"text-center text-text-secondary",children:[e.jsx(P,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Drone Selected"}),e.jsx("p",{className:"text-sm",children:"Select a drone from the map or fleet list to view telemetry data."})]})});const x=l=>{const d=new Date(l),g=new Date().getTime()-d.getTime(),f=Math.floor(g/1e3);return f<60?`${f}s ago`:f<3600?`${Math.floor(f/60)}m ago`:`${Math.floor(f/3600)}h ago`},p=l=>{switch(l.toLowerCase()){case"active":case"in_flight":return"#238636";case"charging":case"returning":return"#d29922";case"maintenance":case"emergency":return"#da3633";case"idle":default:return"#8b949e"}},m=[{id:"overview",label:"Overview",icon:P},{id:"charts",label:"Charts",icon:_},{id:"alerts",label:"Alerts",icon:N,count:((h=s.alerts)==null?void 0:h.length)||0},{id:"system",label:"System",icon:T}];return e.jsxs("div",{className:`h-full w-full flex flex-col overflow-hidden ${a}`,children:[e.jsxs("div",{className:"flex-shrink-0 p-3 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:s.name}),e.jsx("p",{className:"text-text-secondary text-xs",children:s.id})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-status-operational rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Live"})]}),e.jsx("div",{className:"px-2 py-0.5 rounded text-xs font-medium border",style:{backgroundColor:p(s.status)+"20",color:p(s.status),borderColor:p(s.status)+"40"},children:s.status.toUpperCase()})]})]}),e.jsx("div",{className:"flex space-x-0.5",children:m.map(l=>e.jsxs("button",{onClick:()=>n(l.id),className:`px-2 py-1 rounded text-xs font-medium transition-all duration-200 flex items-center gap-1 ${r===l.id?"bg-dark-tertiary text-text-primary border border-dark-border":"text-text-secondary hover:text-text-primary hover:bg-dark-hover"}`,children:[e.jsx(l.icon,{className:"w-3 h-3"}),l.label,l.count!==void 0&&l.count>0&&e.jsx("span",{className:"bg-status-critical text-white text-xs rounded-full px-1 py-0.5 min-w-[14px] text-center",children:l.count})]},l.id))})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto p-3",children:e.jsxs(R,{mode:"wait",children:[r==="overview"&&e.jsxs(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(E,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Battery"})]}),e.jsx(lt,{level:s.batteryLevel,voltage:s.batteryVoltage,showLabel:!0,size:"sm"})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(J,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Signal"})]}),e.jsx(ot,{strength:s.signalStrength,quality:s.connectionQuality,showLabel:!0,size:"sm"})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(Ge,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Altitude"})]}),e.jsx("div",{className:"text-lg font-bold text-text-primary",children:s.position.alt.toFixed(1)}),e.jsx("div",{className:"text-xs text-text-secondary",children:"meters"})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(_,{className:"w-4 h-4 text-text-secondary"}),e.jsx("span",{className:"text-xs text-text-secondary",children:"Speed"})]}),e.jsx("div",{className:"text-lg font-bold text-text-primary",children:s.speed.toFixed(1)}),e.jsx("div",{className:"text-xs text-text-secondary",children:"m/s"})]})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded p-3",children:[e.jsxs("h3",{className:"font-medium text-text-primary mb-2 flex items-center gap-1",children:[e.jsx(ze,{className:"w-4 h-4"}),"Position & Orientation"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Latitude"}),e.jsxs("span",{className:"font-mono text-text-primary",children:[s.position.lat.toFixed(6),"°"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Longitude"}),e.jsxs("span",{className:"font-mono text-text-primary",children:[s.position.lng.toFixed(6),"°"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Heading"}),e.jsxs("span",{className:"font-mono text-text-primary",children:[s.heading.toFixed(1),"°"]})]})]})]}),s.currentMission&&e.jsxs("div",{className:"bg-dark-tertiary rounded p-3",children:[e.jsxs("h3",{className:"font-medium text-text-primary mb-2 flex items-center gap-1",children:[e.jsx(C,{className:"w-4 h-4"}),"Current Mission"]}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Mission"}),e.jsx("span",{className:"text-text-primary truncate ml-2",children:s.currentMission.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Progress"}),e.jsxs("span",{className:"text-text-primary",children:[s.currentMission.progress,"%"]})]}),s.currentMission.eta&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"ETA"}),e.jsx("span",{className:"text-text-primary",children:s.currentMission.eta})]}),e.jsx("div",{className:"w-full bg-dark-border rounded-full h-1.5 mt-2",children:e.jsx("div",{className:"bg-status-active h-1.5 rounded-full transition-all duration-300",style:{width:`${s.currentMission.progress}%`}})})]})]})]},"overview"),r==="charts"&&e.jsx(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:e.jsx(ct,{data:u,drone:s})},"charts"),r==="alerts"&&e.jsx(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:e.jsx(dt,{alerts:s.alerts||[],droneId:s.id})},"alerts"),r==="system"&&e.jsxs(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"space-y-4",children:[e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"System Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Firmware"}),e.jsx("span",{className:"text-text-primary font-mono",children:s.firmware||"v1.12.3"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Hardware"}),e.jsx("span",{className:"text-text-primary",children:s.hardware||"Pixhawk 4"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Uptime"}),e.jsx("span",{className:"text-text-primary",children:s.uptime||"2h 34m"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-text-secondary",children:"Last Update"}),e.jsx("span",{className:"text-text-primary",children:x(s.lastUpdate)})]})]})]}),e.jsxs("div",{className:"bg-dark-tertiary rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-text-primary mb-3 flex items-center gap-2",children:[e.jsx(Ue,{className:"w-5 h-5"}),"Environmental"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Temperature"}),e.jsxs("div",{className:"font-mono text-text-primary",children:[s.temperature||28.5,"°C"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-secondary",children:"Humidity"}),e.jsxs("div",{className:"font-mono text-text-primary",children:[s.humidity||65,"%"]})]})]})]})]},"system")]})})})]})};var b=(s=>(s.CONNECTING="connecting",s.CONNECTED="connected",s.DISCONNECTED="disconnected",s.RECONNECTING="reconnecting",s.ERROR="error",s))(b||{});const ut={url:"ws://localhost:3001/telemetry",reconnectInterval:3e3,maxReconnectAttempts:10,heartbeatInterval:3e4,connectionTimeout:1e4};class xt{constructor(t){v(this,"ws",null);v(this,"config");v(this,"connectionState","disconnected");v(this,"reconnectAttempts",0);v(this,"reconnectTimer",null);v(this,"heartbeatTimer",null);v(this,"connectionTimer",null);v(this,"onConnectionStateChange",null);v(this,"onMessage",null);v(this,"onDroneUpdate",null);v(this,"onMissionUpdate",null);v(this,"onFleetAlert",null);v(this,"stats",{messagesReceived:0,messagesProcessed:0,lastMessageTime:null,connectionUptime:null,reconnectCount:0});this.config={...ut,...t}}connect(){if(this.connectionState==="connected"||this.connectionState==="connecting"){console.warn("WebSocket already connected or connecting");return}this.setConnectionState("connecting"),this.clearTimers();try{this.ws=new WebSocket(this.config.url),this.setupEventHandlers(),this.startConnectionTimeout()}catch(t){console.error("Failed to create WebSocket connection:",t),this.setConnectionState("error",t),this.scheduleReconnect()}}disconnect(){console.log("Disconnecting from telemetry service..."),this.clearTimers(),this.ws&&(this.ws.close(1e3,"Client disconnect"),this.ws=null),this.setConnectionState("disconnected"),this.reconnectAttempts=0}setConnectionStateCallback(t){this.onConnectionStateChange=t}onTelemetryMessage(t){this.onMessage=t}onDroneDataUpdate(t){this.onDroneUpdate=t}onMissionDataUpdate(t){this.onMissionUpdate=t}onFleetAlertReceived(t){this.onFleetAlert=t}getConnectionState(){return this.connectionState}getStatistics(){return{...this.stats,connectionState:this.connectionState,reconnectAttempts:this.reconnectAttempts,uptime:this.stats.connectionUptime?Date.now()-this.stats.connectionUptime.getTime():0}}isConnected(){return this.connectionState==="connected"}setupEventHandlers(){this.ws&&(this.ws.onopen=()=>{console.log("Connected to telemetry service"),this.clearConnectionTimeout(),this.setConnectionState("connected"),this.reconnectAttempts=0,this.stats.connectionUptime=new Date,this.stats.reconnectCount++,this.startHeartbeat()},this.ws.onmessage=t=>{try{const a=JSON.parse(t.data);this.handleMessage(a)}catch(a){console.error("Failed to parse telemetry message:",a,t.data)}},this.ws.onclose=t=>{console.log("WebSocket connection closed:",t.code,t.reason),this.clearTimers(),t.code!==1e3?(this.setConnectionState("disconnected"),this.scheduleReconnect()):this.setConnectionState("disconnected")},this.ws.onerror=t=>{console.error("WebSocket error:",t),this.setConnectionState("error",new Error("WebSocket connection error"))})}handleMessage(t){this.stats.messagesReceived++,this.stats.lastMessageTime=new Date,this.onMessage&&this.onMessage(t);try{switch(t.type){case"drone_update":const a=t;this.onDroneUpdate&&this.onDroneUpdate(a.data);break;case"mission_update":const r=t;this.onMissionUpdate&&this.onMissionUpdate(r.data);break;case"fleet_alert":const n=t;this.onFleetAlert&&this.onFleetAlert(n.data);break;case"heartbeat":console.debug("Heartbeat received from server");break;default:console.warn("Unknown message type:",t.type)}this.stats.messagesProcessed++}catch(a){console.error("Failed to process telemetry message:",a,t)}}setConnectionState(t,a){this.connectionState!==t&&(this.connectionState=t,console.log(`WebSocket state changed to: ${t}`),this.onConnectionStateChange&&this.onConnectionStateChange(t,a))}scheduleReconnect(){if(this.reconnectAttempts>=this.config.maxReconnectAttempts){console.error("Max reconnect attempts reached"),this.setConnectionState("error",new Error("Max reconnect attempts exceeded"));return}this.reconnectAttempts++,this.setConnectionState("reconnecting"),console.log(`Attempting to reconnect in ${this.config.reconnectInterval}ms (attempt ${this.reconnectAttempts}/${this.config.maxReconnectAttempts})`),this.reconnectTimer=setTimeout(()=>{this.connect()},this.config.reconnectInterval)}startHeartbeat(){this.heartbeatTimer=setInterval(()=>{var t;if(((t=this.ws)==null?void 0:t.readyState)===WebSocket.OPEN)try{this.ws.send(JSON.stringify({type:"ping",timestamp:new Date().toISOString()}))}catch(a){console.error("Failed to send heartbeat:",a)}},this.config.heartbeatInterval)}startConnectionTimeout(){this.connectionTimer=setTimeout(()=>{var t;this.connectionState==="connecting"&&(console.error("Connection timeout"),this.setConnectionState("error",new Error("Connection timeout")),(t=this.ws)==null||t.close(),this.scheduleReconnect())},this.config.connectionTimeout)}clearConnectionTimeout(){this.connectionTimer&&(clearTimeout(this.connectionTimer),this.connectionTimer=null)}clearTimers(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null),this.clearConnectionTimeout()}}const k=new xt,ht=({connectionState:s,error:t,className:a=""})=>{const n=(()=>{switch(s){case b.CONNECTED:return{icon:C,color:"#238636",bgColor:"#238636",text:"Connected",description:"Real-time telemetry active",pulse:!1};case b.CONNECTING:return{icon:F,color:"#d29922",bgColor:"#d29922",text:"Connecting",description:"Establishing connection...",pulse:!0};case b.RECONNECTING:return{icon:F,color:"#d29922",bgColor:"#d29922",text:"Reconnecting",description:"Attempting to reconnect...",pulse:!0};case b.ERROR:return{icon:N,color:"#da3633",bgColor:"#da3633",text:"Error",description:t||"Connection failed",pulse:!1};case b.DISCONNECTED:default:return{icon:M,color:"#8b949e",bgColor:"#8b949e",text:"Disconnected",description:"No telemetry connection",pulse:!1}}})(),u=n.icon;return e.jsxs("div",{className:`flex items-center gap-3 ${a}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(R,{children:n.pulse&&e.jsx(y.div,{className:"absolute inset-0 rounded-full",style:{backgroundColor:n.color},initial:{scale:1,opacity:.3},animate:{scale:1.5,opacity:0},exit:{scale:1,opacity:.3},transition:{duration:1.5,repeat:1/0,repeatType:"loop"}})}),e.jsx(y.div,{className:"w-8 h-8 rounded-full border-2 flex items-center justify-center",style:{backgroundColor:n.bgColor+"20",borderColor:n.color},animate:n.pulse?{rotate:360}:{},transition:n.pulse?{duration:2,repeat:1/0,ease:"linear"}:{},children:e.jsx(u,{className:"w-4 h-4",style:{color:n.color}})})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",style:{color:n.color},children:n.text}),e.jsx("div",{className:"text-text-muted text-xs",children:n.description})]})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-1 text-xs text-text-secondary",children:[e.jsx(T,{className:"w-3 h-3"}),e.jsx("span",{children:"ws://localhost:3001/telemetry"})]}),(s===b.ERROR||t)&&e.jsx(y.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"hidden lg:block",children:e.jsxs("div",{className:"bg-dark-tertiary border border-red-800 rounded-lg p-2 max-w-xs",children:[e.jsx("div",{className:"text-xs text-red-300 font-medium mb-1",children:"Connection Error"}),e.jsx("div",{className:"text-xs text-text-secondary",children:t||"Unable to connect to telemetry service"}),e.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Check if the telemetry service is running on port 3001"})]})})]})},pt={},B=s=>{let t;const a=new Set,r=(h,l)=>{const d=typeof h=="function"?h(t):h;if(!Object.is(d,t)){const i=t;t=l??(typeof d!="object"||d===null)?d:Object.assign({},t,d),a.forEach(g=>g(t,i))}},n=()=>t,p={setState:r,getState:n,getInitialState:()=>m,subscribe:h=>(a.add(h),()=>a.delete(h)),destroy:()=>{(pt?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),a.clear()}},m=t=s(r,n,p);return p},gt=s=>s?B(s):B;var K={exports:{}},ee={},te={exports:{}},se={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S=c;function ft(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var vt=typeof Object.is=="function"?Object.is:ft,yt=S.useState,bt=S.useEffect,jt=S.useLayoutEffect,wt=S.useDebugValue;function Nt(s,t){var a=t(),r=yt({inst:{value:a,getSnapshot:t}}),n=r[0].inst,u=r[1];return jt(function(){n.value=a,n.getSnapshot=t,A(n)&&u({inst:n})},[s,a,t]),bt(function(){return A(n)&&u({inst:n}),s(function(){A(n)&&u({inst:n})})},[s]),wt(a),a}function A(s){var t=s.getSnapshot;s=s.value;try{var a=t();return!vt(s,a)}catch{return!0}}function kt(s,t){return t()}var St=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?kt:Nt;se.useSyncExternalStore=S.useSyncExternalStore!==void 0?S.useSyncExternalStore:St;te.exports=se;var Ct=te.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L=c,Mt=Ct;function Dt(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var Et=typeof Object.is=="function"?Object.is:Dt,Lt=Mt.useSyncExternalStore,At=L.useRef,$t=L.useEffect,Rt=L.useMemo,Tt=L.useDebugValue;ee.useSyncExternalStoreWithSelector=function(s,t,a,r,n){var u=At(null);if(u.current===null){var o={hasValue:!1,value:null};u.current=o}else o=u.current;u=Rt(function(){function p(i){if(!m){if(m=!0,h=i,i=r(i),n!==void 0&&o.hasValue){var g=o.value;if(n(g,i))return l=g}return l=i}if(g=l,Et(h,i))return g;var f=r(i);return n!==void 0&&n(g,f)?(h=i,g):(h=i,l=f)}var m=!1,h,l,d=a===void 0?null:a;return[function(){return p(t())},d===null?void 0:function(){return p(d())}]},[t,a,r,n]);var x=Lt(s,u[0],u[1]);return $t(function(){o.hasValue=!0,o.value=x},[x]),Tt(x),x};K.exports=ee;var Ot=K.exports;const It=oe(Ot),ae={},{useDebugValue:Ft}=H,{useSyncExternalStoreWithSelector:Pt}=It;let U=!1;const Wt=s=>s;function _t(s,t=Wt,a){(ae?"production":void 0)!=="production"&&a&&!U&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),U=!0);const r=Pt(s.subscribe,s.getState,s.getServerState||s.getInitialState,t,a);return Ft(r),r}const Bt=s=>{(ae?"production":void 0)!=="production"&&typeof s!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof s=="function"?gt(s):s,a=(r,n)=>_t(t,r,n);return Object.assign(a,t),a},Ut=s=>Bt,Vt=s=>(t,a,r)=>{const n=r.subscribe;return r.subscribe=(o,x,p)=>{let m=o;if(x){const h=(p==null?void 0:p.equalityFn)||Object.is;let l=o(r.getState());m=d=>{const i=o(d);if(!h(l,i)){const g=l;x(l=i,g)}},p!=null&&p.fireImmediately&&x(l,l)}return n(m)},s(t,a,r)},zt=Vt,re=[{id:"drone-001",name:"Alpha-1",status:"in_flight",position:{lat:37.7749,lng:-122.4194,alt:120.5},batteryLevel:87,batteryVoltage:22.4,speed:12.3,heading:245,signalStrength:-45,connectionQuality:"excellent",lastUpdate:new Date().toISOString(),currentMission:{id:"mission-001",name:"Downtown Delivery Route",progress:65,eta:"14:30",status:"active"},alerts:[{id:"alert-001",severity:"warning",message:"Approaching restricted airspace",timestamp:new Date(Date.now()-3e5).toISOString(),category:"navigation"}],temperature:28.5,humidity:65,firmware:"v1.12.3",hardware:"Pixhawk 4 Mini",uptime:"2h 34m",totalFlightTime:847,totalMissions:23,lastMaintenance:new Date(Date.now()-7*24*60*60*1e3).toISOString()},{id:"drone-002",name:"Beta-2",status:"charging",position:{lat:37.7849,lng:-122.4094,alt:2.1},batteryLevel:23,batteryVoltage:18.2,speed:0,heading:0,signalStrength:-52,connectionQuality:"good",lastUpdate:new Date().toISOString(),alerts:[{id:"alert-002",severity:"info",message:"Charging in progress - 47 minutes remaining",timestamp:new Date(Date.now()-6e5).toISOString(),category:"system"}],temperature:32.1,humidity:68,firmware:"v1.12.3",hardware:"Pixhawk 4 Pro",uptime:"5h 12m",totalFlightTime:1203,totalMissions:31,lastMaintenance:new Date(Date.now()-3*24*60*60*1e3).toISOString()},{id:"drone-003",name:"Charlie-3",status:"in_flight",position:{lat:37.7649,lng:-122.4294,alt:89.2},batteryLevel:45,batteryVoltage:20.1,speed:8.7,heading:180,signalStrength:-67,connectionQuality:"good",lastUpdate:new Date().toISOString(),currentMission:{id:"mission-002",name:"Harbor Security Patrol",progress:38,eta:"15:45",status:"active"},temperature:30.8,humidity:72,firmware:"v1.12.3",hardware:"Pixhawk 4 Mini",uptime:"1h 58m",totalFlightTime:592,totalMissions:18,lastMaintenance:new Date(Date.now()-14*24*60*60*1e3).toISOString()},{id:"drone-004",name:"Delta-4",status:"active",position:{lat:37.7549,lng:-122.4394,alt:45.8},batteryLevel:92,batteryVoltage:23.1,speed:6.2,heading:90,signalStrength:-38,connectionQuality:"excellent",lastUpdate:new Date().toISOString(),currentMission:{id:"mission-003",name:"Medical Supply Delivery",progress:15,eta:"16:20",status:"active"},temperature:26.3,humidity:58,firmware:"v1.12.3",hardware:"Pixhawk 4 Pro",uptime:"8h 45m",totalFlightTime:1847,totalMissions:45,lastMaintenance:new Date(Date.now()-2*24*60*60*1e3).toISOString()},{id:"drone-005",name:"Echo-5",status:"maintenance",position:{lat:37.7449,lng:-122.4494,alt:0},batteryLevel:78,batteryVoltage:21.8,speed:0,heading:0,signalStrength:-88,connectionQuality:"poor",lastUpdate:new Date(Date.now()-9e5).toISOString(),alerts:[{id:"alert-003",severity:"critical",message:"Motor #3 temperature exceeds safe limits",timestamp:new Date(Date.now()-12e5).toISOString(),category:"hardware"},{id:"alert-004",severity:"warning",message:"GPS signal degraded - position accuracy reduced",timestamp:new Date(Date.now()-8e5).toISOString(),category:"navigation"},{id:"alert-005",severity:"info",message:"Scheduled maintenance required",timestamp:new Date(Date.now()-6e5).toISOString(),category:"maintenance"}],temperature:45.2,humidity:55,firmware:"v1.12.2",hardware:"Pixhawk 4 Mini",uptime:"12h 22m",totalFlightTime:2341,totalMissions:67,lastMaintenance:new Date(Date.now()-21*24*60*60*1e3).toISOString()}],Ht=[{id:"mission-001",name:"Downtown Delivery",progress:65,eta:"14:30",status:"active",waypoints:[{id:"wp-001",position:{lat:37.7749,lng:-122.4194,alt:120},action:"pickup",completed:!0},{id:"wp-002",position:{lat:37.7849,lng:-122.4094,alt:100},action:"delivery",completed:!1}],assignedDrone:"drone-001",priority:1,createdAt:new Date(Date.now()-36e5).toISOString(),startedAt:new Date(Date.now()-18e5).toISOString()},{id:"mission-002",name:"Harbor Patrol",progress:38,eta:"15:45",status:"active",waypoints:[{id:"wp-003",position:{lat:37.7649,lng:-122.4294,alt:80},action:"survey",completed:!1}],assignedDrone:"drone-003",priority:2,createdAt:new Date(Date.now()-72e5).toISOString(),startedAt:new Date(Date.now()-27e5).toISOString()}],Zt=[{id:"fleet-alert-001",severity:"critical",message:"Drone Echo-5 motor temperature critical",timestamp:new Date(Date.now()-12e5).toISOString(),droneId:"drone-005",droneName:"Echo-5",type:"system",priority:1,details:{temperature:45.2,threshold:40}},{id:"fleet-alert-002",severity:"warning",message:"Drone Alpha-1 approaching restricted airspace",timestamp:new Date(Date.now()-3e5).toISOString(),droneId:"drone-001",droneName:"Alpha-1",type:"safety",priority:2,details:{zone:"SFO_RESTRICTED",distance:150}}];class Gt{constructor(){v(this,"updateInterval",null);v(this,"onDroneUpdate");v(this,"droneFlightPatterns",new Map);this.initializeFlightPatterns()}initializeFlightPatterns(){this.droneFlightPatterns.set("drone-001",{type:"circular",center:{lat:37.7749,lng:-122.4194},radius:.002,currentAngle:0,speed:1e-4}),this.droneFlightPatterns.set("drone-002",{type:"stationary",center:{lat:37.7849,lng:-122.4094},radius:0,currentAngle:0,speed:0}),this.droneFlightPatterns.set("drone-003",{type:"linear",start:{lat:37.7649,lng:-122.4294},end:{lat:37.7549,lng:-122.4094},progress:.3,direction:1,speed:.01}),this.droneFlightPatterns.set("drone-004",{type:"waypoint",waypoints:[{lat:37.7549,lng:-122.4394},{lat:37.7649,lng:-122.4294},{lat:37.7749,lng:-122.4094}],currentWaypoint:0,progress:.15,speed:.005}),this.droneFlightPatterns.set("drone-005",{type:"stationary",center:{lat:37.7449,lng:-122.4494},radius:0,currentAngle:0,speed:0})}start(){console.log("🔧 Starting enhanced mock telemetry service for 5 drones"),console.log("📍 Flight patterns initialized: Circular patrol, Linear patrol, Waypoint mission"),this.updateInterval=setInterval(()=>{re.forEach((t,a)=>{this.updateDroneRealistic(t),setTimeout(()=>{this.onDroneUpdate&&this.onDroneUpdate({...t})},a*200)})},1500)}updateDroneRealistic(t){const a=this.droneFlightPatterns.get(t.id);a&&(this.updatePosition(t,a),this.updateTelemetry(t),this.updateMissionProgress(t),this.simulateAlerts(t),t.lastUpdate=new Date().toISOString())}updatePosition(t,a){switch(a.type){case"circular":a.currentAngle+=a.speed,t.position.lat=a.center.lat+Math.cos(a.currentAngle)*a.radius,t.position.lng=a.center.lng+Math.sin(a.currentAngle)*a.radius,t.position.alt=80+Math.sin(a.currentAngle*2)*20,t.heading=(a.currentAngle*180/Math.PI+90)%360,t.speed=8+Math.random()*4;break;case"linear":const r=a;r.progress+=r.direction*r.speed,(r.progress>=1||r.progress<=0)&&(r.direction*=-1,r.progress=Math.max(0,Math.min(1,r.progress))),t.position.lat=r.start.lat+(r.end.lat-r.start.lat)*r.progress,t.position.lng=r.start.lng+(r.end.lng-r.start.lng)*r.progress,t.position.alt=60+Math.sin(r.progress*Math.PI)*30;const n=r.end.lat-r.start.lat,u=r.end.lng-r.start.lng;t.heading=Math.atan2(u,n)*180/Math.PI*r.direction%360,t.speed=6+Math.random()*3;break;case"waypoint":const o=a;o.progress+=o.speed,o.progress>=1&&(o.currentWaypoint=(o.currentWaypoint+1)%o.waypoints.length,o.progress=0);const x=o.waypoints[o.currentWaypoint],p=o.waypoints[(o.currentWaypoint+1)%o.waypoints.length];t.position.lat=x.lat+(p.lat-x.lat)*o.progress,t.position.lng=x.lng+(p.lng-x.lng)*o.progress,t.position.alt=45+Math.random()*10;const m=p.lat-x.lat,h=p.lng-x.lng;t.heading=Math.atan2(h,m)*180/Math.PI,t.speed=5+Math.random()*3;break;case"stationary":t.position.lat+=(Math.random()-.5)*5e-6,t.position.lng+=(Math.random()-.5)*5e-6,t.speed=0;break}}updateTelemetry(t){t.status==="active"||t.status==="in_flight"?(t.batteryLevel=Math.max(5,t.batteryLevel-.08-Math.random()*.05),t.batteryVoltage=18+t.batteryLevel/100*5.5):t.status==="charging"&&(t.batteryLevel=Math.min(100,t.batteryLevel+.3+Math.random()*.2),t.batteryVoltage=18+t.batteryLevel/100*5.5);const a=t.signalStrength;t.signalStrength=a+(Math.random()-.5)*10,t.signalStrength>-50?t.connectionQuality="excellent":t.signalStrength>-70?t.connectionQuality="good":t.signalStrength>-90?t.connectionQuality="poor":t.connectionQuality="very_poor";const r=(Math.random()-.5)*2;t.temperature=(t.temperature||28)+r,(t.status==="active"||t.status==="in_flight")&&(t.temperature=Math.min(50,(t.temperature||28)+.1)),t.humidity=Math.max(40,Math.min(85,(t.humidity||60)+(Math.random()-.5)*5))}updateMissionProgress(t){if(t.currentMission&&(t.status==="active"||t.status==="in_flight")){t.currentMission.progress=Math.min(99,t.currentMission.progress+.2+Math.random()*.3);const a=100-t.currentMission.progress,r=Math.round(a*2),n=new Date(Date.now()+r*6e4);t.currentMission.eta=n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}}simulateAlerts(t){var a,r,n;t.batteryLevel<20&&!((a=t.alerts)!=null&&a.some(u=>u.category==="battery"))&&(t.alerts=t.alerts||[],t.alerts.unshift({id:`alert-battery-${Date.now()}`,severity:t.batteryLevel<15?"critical":"warning",message:`Battery level ${t.batteryLevel.toFixed(1)}% - ${t.batteryLevel<15?"Return to base immediately":"Consider returning to base"}`,timestamp:new Date().toISOString(),category:"battery"})),(t.temperature||0)>40&&!((r=t.alerts)!=null&&r.some(u=>u.message.includes("temperature")))&&(t.alerts=t.alerts||[],t.alerts.unshift({id:`alert-temp-${Date.now()}`,severity:"warning",message:`Temperature elevated: ${(n=t.temperature)==null?void 0:n.toFixed(1)}°C`,timestamp:new Date().toISOString(),category:"system"})),t.alerts&&t.alerts.length>3&&(t.alerts=t.alerts.slice(0,3))}stop(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null),console.log("🔧 Mock telemetry service stopped")}onDroneDataUpdate(t){this.onDroneUpdate=t}}const V=new Gt,w=Ut()(zt((s,t)=>({connectionState:b.DISCONNECTED,connectionError:null,lastUpdate:null,drones:{},missions:{},alerts:[],selectedDroneId:null,stats:{messagesReceived:0,messagesProcessed:0,connectionUptime:0,reconnectCount:0},setConnectionState:(a,r)=>{s({connectionState:a,connectionError:r||null})},updateDrone:a=>{s(r=>({drones:{...r.drones,[a.id]:{...a,lastUpdate:new Date().toISOString()}},lastUpdate:new Date}))},updateMission:a=>{s(r=>({missions:{...r.missions,[a.id]:a},lastUpdate:new Date}))},addAlert:a=>{s(r=>({alerts:[a,...r.alerts.slice(0,99)],lastUpdate:new Date}))},dismissAlert:a=>{s(r=>({alerts:r.alerts.filter(n=>n.id!==a)}))},selectDrone:a=>{s({selectedDroneId:a})},updateStats:a=>{s({stats:a})},getDroneById:a=>t().drones[a],getActiveDrones:()=>{const{drones:a}=t();return Object.values(a).filter(r=>r.status==="active"||r.status==="in_flight")},getDronesWithIssues:()=>{const{drones:a}=t();return Object.values(a).filter(r=>r.status==="maintenance"||r.status==="emergency"||r.batteryLevel<20||r.signalStrength<-90||r.alerts&&r.alerts.length>0)},getIdleDrones:()=>{const{drones:a}=t();return Object.values(a).filter(r=>r.status==="idle")},getCriticalAlerts:()=>{const{alerts:a}=t();return a.filter(r=>r.severity==="critical")},getFleetSummary:()=>{const{drones:a}=t(),r=Object.values(a);if(r.length===0)return{total:0,active:0,idle:0,issues:0,charging:0,maintenance:0,avgBattery:0,avgSignal:0};const n=r.reduce((u,o)=>{switch(u.total++,o.status){case"active":case"in_flight":u.active++;break;case"idle":u.idle++;break;case"charging":u.charging++;break;case"maintenance":case"emergency":u.maintenance++;break}return(o.batteryLevel<20||o.signalStrength<-90||o.alerts&&o.alerts.length>0)&&u.issues++,u.totalBattery+=o.batteryLevel,u.totalSignal+=o.signalStrength,u},{total:0,active:0,idle:0,issues:0,charging:0,maintenance:0,totalBattery:0,totalSignal:0});return{total:n.total,active:n.active,idle:n.idle,issues:n.issues,charging:n.charging,maintenance:n.maintenance,avgBattery:Math.round(n.totalBattery/n.total),avgSignal:Math.round(n.totalSignal/n.total)}},connect:()=>{const a=t();k.setConnectionStateCallback((n,u)=>{a.setConnectionState(n,u==null?void 0:u.message),(n===b.ERROR||n===b.DISCONNECTED)&&setTimeout(()=>{console.log("🔧 WebSocket connection failed, using mock data for development"),re.forEach(o=>a.updateDrone(o)),Ht.forEach(o=>a.updateMission(o)),Zt.forEach(o=>a.addAlert(o)),V.onDroneDataUpdate(o=>{a.updateDrone(o)}),V.start()},1e3)}),k.onDroneDataUpdate(n=>{a.updateDrone(n)}),k.onMissionDataUpdate(n=>{a.updateMission(n)}),k.onFleetAlertReceived(n=>{a.addAlert(n)}),setInterval(()=>{const n=k.getStatistics();a.updateStats(n)},5e3),k.connect()},disconnect:()=>{k.disconnect(),s({connectionState:b.DISCONNECTED,connectionError:null})},isConnected:()=>t().connectionState===b.CONNECTED})));let z=!1;const Qt=()=>{if(!z){z=!0;const{connect:s}=w.getState();s(),w.subscribe(t=>t.connectionState,(t,a)=>{a&&t!==a&&console.log(`Fleet store connection state: ${a} → ${t}`)}),w.subscribe(t=>Object.keys(t.drones).length,(t,a)=>{a!==void 0&&t!==a&&console.log(`Fleet store drone count: ${a} → ${t}`)})}},qt=()=>{const s=w(a=>a.selectedDroneId),t=w(a=>a.getDroneById);return s&&t(s)||null},Yt=()=>w(s=>({state:s.connectionState,error:s.connectionError,isConnected:s.isConnected(),lastUpdate:s.lastUpdate}));function Xt(){const{state:s,isConnected:t,error:a}=Yt(),r=w(l=>Object.values(l.drones)),n=w(l=>l.selectedDroneId),u=qt(),o=w(l=>l.selectDrone),[x,p]=c.useState(!1);c.useEffect(()=>{Qt()},[]);const m=l=>{o(l)},h=(l,d)=>{console.log(`Action "${d}" requested for drone ${l}`)};return e.jsxs("div",{className:"min-h-screen bg-dark-primary text-text-primary flex",children:[e.jsxs("div",{className:`
        transition-all duration-300 ease-in-out bg-dark-secondary border-r border-dark-border
        ${x?"w-16":"w-80"}
        flex flex-col h-screen
      `,children:[e.jsxs("div",{className:"p-4 border-b border-dark-border flex items-center justify-between",children:[!x&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Fleet Control"}),e.jsx("p",{className:"text-text-secondary text-xs",children:"5 drones active"})]}),e.jsx("button",{onClick:()=>p(!x),className:"p-2 hover:bg-dark-hover rounded-lg transition-colors",title:x?"Expand sidebar":"Collapse sidebar",children:x?e.jsx(Oe,{className:"w-5 h-5 text-text-secondary"}):e.jsx(Re,{className:"w-5 h-5 text-text-secondary"})})]}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[!x&&e.jsx(it,{drones:r,selectedDroneId:n||void 0,onDroneSelect:m,onDroneAction:h,className:"h-full"}),x&&e.jsx("div",{className:"p-2 space-y-2",children:r.slice(0,8).map(l=>e.jsx("button",{onClick:()=>m(l.id),className:`
                    w-full p-2 rounded-lg border transition-all duration-200
                    ${l.id===n?"border-status-active bg-status-active/10":"border-dark-border hover:border-dark-hover hover:bg-dark-hover"}
                  `,title:`${l.name} - ${l.status}`,children:e.jsx("div",{className:"w-8 h-8 mx-auto rounded-full border flex items-center justify-center",style:{backgroundColor:l.status==="active"||l.status==="in_flight"?"#238636":l.status==="charging"?"#d29922":l.status==="maintenance"?"#da3633":"#8b949e",borderColor:l.status==="active"||l.status==="in_flight"?"#238636":l.status==="charging"?"#d29922":l.status==="maintenance"?"#da3633":"#8b949e"},children:e.jsx("span",{className:"text-xs font-bold text-white",children:l.name.split("-")[1]||l.name.charAt(0)})})},l.id))})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col h-screen",children:[e.jsx("header",{className:"bg-dark-secondary border-b border-dark-border px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Multi-Drone Fleet Management System"}),e.jsx("p",{className:"text-text-secondary text-sm",children:"Real-time fleet monitoring and control dashboard"})]}),e.jsx(ht,{connectionState:s,isConnected:t,error:a||void 0})]})}),e.jsx("main",{className:"flex-1 p-4 overflow-hidden",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 h-full",children:[e.jsx("div",{className:"lg:col-span-2 h-full overflow-hidden",children:e.jsx(at,{drones:r,selectedDroneId:n||void 0,onDroneSelect:m,className:"h-full w-full"})}),e.jsx("div",{className:"lg:col-span-1 h-full overflow-hidden",children:e.jsx("div",{className:"h-full w-full border border-dark-border rounded-lg bg-dark-secondary overflow-hidden",children:e.jsx(mt,{drone:u,isLive:t,className:"h-full w-full"})})})]})})]})]})}$.createRoot(document.getElementById("root")).render(e.jsx(H.StrictMode,{children:e.jsx(Xt,{})}));
//# sourceMappingURL=index-BieIbmUr.js.map
